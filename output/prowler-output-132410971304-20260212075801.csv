AUTH_METHOD;TIMESTAMP;ACCOUNT_UID;ACCOUNT_NAME;ACCOUNT_EMAIL;ACCOUNT_ORGANIZATION_UID;ACCOUNT_ORGANIZATION_NAME;ACCOUNT_TAGS;FINDING_UID;PROVIDER;CHECK_ID;CHECK_TITLE;CHECK_TYPE;STATUS;STATUS_EXTENDED;MUTED;SERVICE_NAME;SUBSERVICE_NAME;SEVERITY;RESOURCE_TYPE;RESOURCE_UID;RESOURCE_NAME;RESOURCE_DETAILS;RESOURCE_TAGS;PARTITION;REGION;DESCRIPTION;RISK;RELATED_URL;REMEDIATION_RECOMMENDATION_TEXT;REMEDIATION_RECOMMENDATION_URL;REMEDIATION_CODE_NATIVEIAC;REMEDIATION_CODE_TERRAFORM;REMEDIATION_CODE_CLI;REMEDIATION_CODE_OTHER;COMPLIANCE;CATEGORIES;DEPENDS_ON;RELATED_TO;NOTES;PROWLER_VERSION;ADDITIONAL_URLS
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-account_maintain_current_contact_details-132410971304-ap-northeast-2-132410971304;aws;account_maintain_current_contact_details;AWS account contact information is current;Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices;MANUAL;Login to the AWS Console. Choose your account name on the top right of the window -> My Account -> Contact Information.;False;account;;medium;Other;arn:aws:iam::132410971304:root;132410971304;;;aws;ap-northeast-2;**AWS account contact information** is current for the **primary contact** and the **alternate contacts** for `security`, `billing`, and `operations`, with accurate email addresses and phone numbers.;"Outdated or single-person contacts delay **security notifications**, slow **incident response**, and complicate **account recovery**.

AWS may throttle services during abuse mitigation, reducing **availability**. Missed alerts enable ongoing misuse, risking **data exfiltration** and unauthorized changes (**integrity**).";;"Adopt:
- **Primary** and **alternate contacts** for `security`, `billing`, `operations`
- Shared, monitored aliases and SMS-capable phone numbers (non-personal)
- Centralized management across accounts with periodic reviews
- **Least privilege** for who can modify contact data
- Regular reachability tests and documented ownership";https://hub.prowler.com/check/account_maintain_current_contact_details;;"```hcl
# Set the Security alternate contact for the AWS account
resource ""aws_account_alternate_contact"" ""<example_resource_name>"" {
  alternate_contact_type = ""SECURITY""  # Critical: ensures AWS can reach your security team
  email_address          = ""<SECURITY_EMAIL>""  # Critical: contact destination
  name                   = ""<SECURITY_CONTACT_NAME>""
  phone_number           = ""<SECURITY_PHONE>""
  title                  = ""Security""
}
```";"aws account put-alternate-contact --alternate-contact-type=SECURITY --email-address=<SECURITY_EMAIL> --name=""<SECURITY_CONTACT_NAME>"" --phone-number=""<SECURITY_PHONE>"" --title=""Security""";"1. Sign in to the AWS Management Console
2. Open Billing and Cost Management, then click your account name > Account
3. Under Contact information, click Edit, update details, then Update
4. Under Alternate contacts, click Edit
5. Enter Security contact name, email, and phone (use a team alias), then Update
6. Repeat for Billing and Operations if needed";AWS-Well-Architected-Framework-Security-Pillar: SEC03-BP03, SEC10-BP01 | ISO27001-2022: A.5.5 | CIS-1.5: 1.1 | NIS2: 2.2.3, 3.5.3.a, 5.1.7.b | CIS-5.0: 1.1 | KISA-ISMS-P-2023: 2.10.2 | CIS-1.4: 1.1 | C5-2025: IAM-03.01AS, IAM-06.06B, SSO-05.06B, SIM-01.03B, INQ-02.01B | ENS-RD2022: op.ext.7.aws.am.1 | CIS-4.0.1: 1.1 | CIS-2.0: 1.1 | CIS-3.0: 1.1 | AWS-Account-Security-Onboarding: Billing, emergency, security contacts | KISA-ISMS-P-2023-korean: 2.10.2;;;;;5.18.1;https://docs.prowler.com/checks/aws/iam-policies/iam_18-maintain-contact-details#aws-console | https://repost.aws/knowledge-center/update-phone-number | https://support.stax.io/docs/accounts/update-aws-account-contact-details | https://maartenbruntink.nl/blog/2022/09/26/aws-account-hygiene-101-mass-updating-alternate-account-contacts/ | https://docs.aws.amazon.com/security-ir/latest/userguide/update-account-contact-info.html | https://docs.aws.amazon.com/accounts/latest/reference/manage-acct-update-contact-primary.html | https://repost.aws/knowledge-center/add-update-billing-contact | https://aws.amazon.com/blogs/security/update-the-alternate-security-contact-across-your-aws-accounts-for-timely-security-notifications/ | https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_accounts_update_contacts.html | https://docs.aws.amazon.com/accounts/latest/reference/manage-acct-update-contact-alternate.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-account_maintain_different_contact_details_to_security_billing_and_operations-132410971304-ap-northeast-2-132410971304;aws;account_maintain_different_contact_details_to_security_billing_and_operations;AWS account has distinct Security, Billing, and Operations contact details, different from each other and from the root contact;Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;FAIL;SECURITY, BILLING and OPERATIONS contacts not found or they are not different between each other and between ROOT contact.;False;account;;medium;Other;arn:aws:iam::132410971304:root;132410971304;;;aws;ap-northeast-2;**AWS account alternate contacts** are defined for **Security**, **Billing**, and **Operations** with `name`, `email`, and `phone`. The finding evaluates that all three exist, are distinct from one another, and differ from the **primary (root) contact**.;Missing or shared contacts can delay response to abuse alerts, credential compromise, or billing anomalies, reducing **availability** (possible AWS traffic throttling) and raising **confidentiality** and **integrity** risk through extended exposure. If AWS cannot reach you, urgent mitigation may disrupt service.;;"Maintain distinct, monitored **Security**, **Billing**, and **Operations** alternate contacts that differ from the root contact.
- Use team aliases and 24x7 phones
- Review and test contact paths regularly
- Centralize at org level for consistency

Applies **operational resilience** and **separation of duties**.";https://hub.prowler.com/check/account_maintain_different_contact_details_to_security_billing_and_operations;;"```hcl
# Set distinct alternate contacts for SECURITY, BILLING, and OPERATIONS
# Critical: each resource sets a required contact type to satisfy the check

resource ""aws_account_alternate_contact"" ""security"" {
  alternate_contact_type = ""SECURITY""  # Sets SECURITY contact
  email_address          = ""security@example.com""
  name                   = ""Security Team""
  phone_number           = ""+1-555-0100""
  title                  = ""Security""
}

resource ""aws_account_alternate_contact"" ""billing"" {
  alternate_contact_type = ""BILLING""   # Sets BILLING contact
  email_address          = ""billing@example.com""
  name                   = ""Billing Team""
  phone_number           = ""+1-555-0101""
  title                  = ""Billing""
}

resource ""aws_account_alternate_contact"" ""operations"" {
  alternate_contact_type = ""OPERATIONS"" # Sets OPERATIONS contact
  email_address          = ""operations@example.com""
  name                   = ""Operations Team""
  phone_number           = ""+1-555-0102""
  title                  = ""Operations""
}
```";;"1. Sign in to the AWS Management Console with a user that can edit account contacts (root, or IAM with account:PutAlternateContact)
2. In the upper right, click your account name > Account
3. Scroll to ""Alternate contacts"" and click Edit
4. Add all three contacts with unique details:
   - Billing contact (distinct name, email, phone)
   - Operations contact (distinct name, email, phone)
   - Security contact (distinct name, email, phone)
5. Ensure each contactâ€™s email/phone differs from each other and from the primary (root) contact, then click Update";ISO27001-2022: A.5.6 | KISA-ISMS-P-2023: 2.10.2 | C5-2025: OIS-04.03B, IAM-06.06B, SSO-05.06B, SIM-01.03B, INQ-02.01B | KISA-ISMS-P-2023-korean: 2.10.2;resilience;;;;5.18.1;https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/account_alternate_contact | https://docs.prowler.com/checks/aws/iam-policies/iam_18-maintain-contact-details#aws-console | https://docs.aws.amazon.com/accounts/latest/reference/manage-acct-update-contact-alternate.html | https://builder.aws.com/content/2qRw97fe8JFwfk2AbpJ3sYNpNvM/aws-bulk-update-alternate-contacts-across-organization | https://github.com/aws-samples/aws-account-alternate-contact-with-terraform | https://trendmicro.com/cloudoneconformity/knowledge-base/aws/IAM/account-security-alternate-contacts.html | https://repost.aws/articles/ARDFbpt-bvQ8iuErnqVVcCXQ/managing-aws-organization-alternate-contacts-via-csv
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-account_security_contact_information_is_registered-132410971304-ap-northeast-2-132410971304;aws;account_security_contact_information_is_registered;AWS account has security alternate contact registered;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices;MANUAL;Login to the AWS Console. Choose your account name on the top right of the window -> My Account -> Alternate Contacts -> Security Section.;False;account;;medium;Other;arn:aws:iam::132410971304:root;132410971304;;;aws;ap-northeast-2;Account settings contain a **Security alternate contact** in Alternate Contacts (name, `EmailAddress`, `PhoneNumber`) for targeted AWS security notifications.;"Missing or outdated **security contact** can delay or prevent AWS advisories from reaching responders, increasing risk to:
- Confidentiality: data exfiltration from undetected compromise
- Integrity: unauthorized changes persist longer
- Availability: resource abuse (e.g., cryptomining) and outages";;"Define and maintain a **Security alternate contact**:
- Use a monitored alias (e.g., `security@domain`) and team phone
- Apply to every account (prefer Org-wide automation)
- Review after org/personnel changes and test delivery
- Document ownership and escalation paths
Align with **incident response** and **least privilege** principles.";https://hub.prowler.com/check/account_security_contact_information_is_registered;;"```hcl
# Set the SECURITY alternate contact for the current AWS account
resource ""aws_account_alternate_contact"" ""<example_resource_name>"" {
  alternate_contact_type = ""SECURITY""  # Critical: sets Security contact type
  email_address          = ""security@example.com""  # Contact email
  name                   = ""Security Team""         # Contact name
  phone_number           = ""+1-555-0100""          # Contact phone
}
```";aws account put-alternate-contact --alternate-contact-type SECURITY --email-address <EMAIL_ADDRESS> --name <CONTACT_NAME> --phone-number <PHONE_NUMBER>;"1. Sign in to the AWS Management Console as the root user or an admin with account:PutAlternateContact
2. Click your account name (top-right) and select My Account (or Account)
3. Scroll to Alternate Contacts and click Edit in the Security section
4. Enter Security Email, Name, and Phone Number
5. Click Update (or Save changes)";AWS-Well-Architected-Framework-Security-Pillar: SEC03-BP03, SEC10-BP01 | ISO27001-2022: A.5.5 | CIS-1.5: 1.2 | NIS2: 1.1.1.a, 1.2.3, 2.2.1, 3.1.2.d, 3.5.3.a, 5.1.7.b | CIS-5.0: 1.2 | KISA-ISMS-P-2023: 2.10.2 | CIS-1.4: 1.2 | C5-2025: OIS-06.01B, SSO-05.06B, SIM-01.03B | ENS-RD2022: op.ext.7.aws.am.1 | CIS-4.0.1: 1.2 | AWS-Foundational-Security-Best-Practices: Account.1 | CIS-2.0: 1.2 | CIS-3.0: 1.2 | PCI-4.0: A1.2.3.1 | AWS-Account-Security-Onboarding: Billing, emergency, security contacts | KISA-ISMS-P-2023-korean: 2.10.2;;;;;5.18.1;https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/account_alternate_contact | https://docs.prowler.com/checks/aws/iam-policies/iam_19/ | https://support.icompaas.com/support/solutions/articles/62000234161-1-2-ensure-security-contact-information-is-registered-manual- | https://www.plerion.com/cloud-knowledge-base/ensure-security-contact-information-is-registered | https://repost.aws/articles/ARDFbpt-bvQ8iuErnqVVcCXQ/managing-aws-organization-alternate-contacts-via-csv
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-account_security_questions_are_registered_in_the_aws_account-132410971304-ap-northeast-2-132410971304;aws;account_security_questions_are_registered_in_the_aws_account;[DEPRECATED] AWS root user has security challenge questions configured;Software and Configuration Checks/AWS Security Best Practices;MANUAL;Login to the AWS Console as root. Choose your account name on the top right of the window -> My Account -> Configure Security Challenge Questions.;False;account;;medium;Other;arn:aws:iam::132410971304:root;132410971304;;;aws;ap-northeast-2;[DEPRECATED] **AWS account root** configuration may include legacy **security challenge questions** for support identity verification. This evaluates whether those questions are set on the account. *New configuration is discontinued by AWS and remaining support for this feature is time-limited.*;Absence of these questions can limit support-assisted recovery if root credentials or MFA are lost, reducing **availability** and slowing **incident response**. Reliance on KBA also weakens **confidentiality** due to **social engineering**. Treat this as a recovery gap and adopt stronger, phishing-resistant factors.;;"Favor stronger recovery instead of KBA:
- Enforce **MFA for root** and minimize root use
- Keep **alternate contacts** and root email current and protected
- Establish a tightly controlled **break-glass role**, applying least privilege and separation of duties
- Document and test recovery procedures; monitor root activity";https://hub.prowler.com/check/account_security_questions_are_registered_in_the_aws_account;;;;"1. Sign in to the AWS Management Console
2. Navigate to your AWS account settings page at https://console.aws.amazon.com/billing/home?#/account/
3. Scroll down to Configure Security Challenge Questions section and click the Edit link
4. Select three different questions made available by Amazon and provide appropriate answers
5. Store the answers in a secure but accessible location
6. Click the Update button to save the changes";AWS-Well-Architected-Framework-Security-Pillar: SEC03-BP03, SEC10-BP01 | CIS-1.5: 1.3 | KISA-ISMS-P-2023: 2.5.1, 2.5.3, 2.10.2 | CIS-1.4: 1.3 | ENS-RD2022: op.ext.7.aws.am.1 | CIS-4.0.1: 1.3 | CIS-2.0: 1.3 | CIS-3.0: 1.3 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.3, 2.10.2;;;;;5.18.1;https://docs.prowler.com/checks/aws/iam-policies/iam_15 | https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/IAM/security-challenge-questions.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudtrail_bucket_requires_mfa_delete-132410971304-ap-northeast-2-security-cloudtail;aws;cloudtrail_bucket_requires_mfa_delete;CloudTrail trail S3 bucket has MFA delete enabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;FAIL;Trail security-cloudtail bucket (aws-cloudtrail-logs-132410971304-0971c04b) does not have MFA delete enabled.;False;cloudtrail;;medium;AwsCloudTrailTrail;arn:aws:cloudtrail:ap-northeast-2:132410971304:trail/security-cloudtail;security-cloudtail;;;aws;ap-northeast-2;"**CloudTrail log buckets** for actively logging trails are evaluated for **MFA Delete** on the associated S3 bucket. The assessment determines whether `MFA Delete` is configured on the in-account log bucket; *if the bucket resides in another account, its configuration should be verified separately*.";Without **MFA Delete**, stolen or over-privileged credentials can permanently delete log versions or change versioning, compromising log **integrity** and **availability**. This enables attacker cover-ups, hinders **forensics**, and weakens evidence for investigations.;;Enable `MFA Delete` on the CloudTrail log bucket with versioning enabled. Enforce **least privilege** so only tightly controlled identities can delete or alter logs, and require MFA for such actions. Apply **defense in depth** using a dedicated logging account and log file integrity validation.;https://hub.prowler.com/check/cloudtrail_bucket_requires_mfa_delete;;;"aws s3api put-bucket-versioning --bucket <CLOUDTRAIL_BUCKET_NAME> --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa ""<MFA_SERIAL> <MFA_CODE>""";"1. Sign in to the AWS Management Console as the root user with MFA enabled
2. Open AWS CloudShell (from the top navigation bar)
3. Run:
   ```bash
   aws s3api put-bucket-versioning --bucket <CLOUDTRAIL_BUCKET_NAME> --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa ""<MFA_SERIAL> <MFA_CODE>""
   ```";NIS2: 11.7.2 | NIST-CSF-2.0: ds_3 | KISA-ISMS-P-2023: 2.5.3, 2.9.4, 2.10.1, 2.10.2 | C5-2025: AM-07.02B, OPS-16.01B, IAM-09.02B, IAM-09.01AC, COM-04.01AC, PSS-05.01B, PSS-07.02B, PSS-12.03AC | ENS-RD2022: op.exp.8.r4.aws.ct.3 | CIS-2.0: 2.1.2 | CCC: CCC.AuditLog.CN04.AR01, CCC.AuditLog.CN05.AR01, CCC.AuditLog.CN07.AR01, CCC.AuditLog.CN09.AR01, CCC.Core.CN09.AR01 | KISA-ISMS-P-2023-korean: 2.5.3, 2.9.4, 2.10.1, 2.10.2;identity-access | forensics-ready;;;;5.18.1;https://docs.aws.amazon.com/AmazonS3/latest/userguide/MultiFactorAuthenticationDelete.html | https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudTrail/cloudtrail-bucket-mfa-delete-enabled.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudtrail_kms_encryption_enabled-132410971304-ap-northeast-2-security-cloudtail;aws;cloudtrail_kms_encryption_enabled;CloudTrail trail logs are encrypted at rest with a KMS key;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;PASS;Multiregion trail security-cloudtail has encryption enabled.;False;cloudtrail;;medium;AwsCloudTrailTrail;arn:aws:cloudtrail:ap-northeast-2:132410971304:trail/security-cloudtail;security-cloudtail;;;aws;ap-northeast-2;**AWS CloudTrail trails** are evaluated for use of **SSE-KMS** with a customer-managed KMS key to encrypt delivered log files at rest in S3. Trails without a configured KMS key are identified. *Applies to single-Region and multi-Region trails.*;Absent a **customer-managed KMS key**, log protection relies only on storage permissions. Bucket misconfigurations or stolen credentials can expose audit data, aiding evasion and lateral movement. Missing key-level controls, rotation, and usage audit weaken **confidentiality** and **forensic integrity**.;;Enable **SSE-KMS** on every trail using a **customer-managed KMS key**. Apply **least privilege** so only authorized roles can `Decrypt`, and enforce **separation of duties** between key admins and log readers. Rotate keys and monitor key usage to provide **defense in depth** for CloudTrail data.;https://hub.prowler.com/check/cloudtrail_kms_encryption_enabled;"```yaml
# CloudFormation: enable KMS encryption for an existing/new CloudTrail
Resources:
  <example_resource_name>:
    Type: AWS::CloudTrail::Trail
    Properties:
      S3BucketName: <example_resource_name>
      KmsKeyId: <example_resource_id>  # Critical: sets the KMS key to encrypt CloudTrail logs at rest
```";"```hcl
# Enable KMS encryption for CloudTrail
resource ""aws_cloudtrail"" ""<example_resource_name>"" {
  name           = ""<example_resource_name>""
  s3_bucket_name = ""<example_resource_name>""
  kms_key_id     = ""<example_resource_id>"" # Critical: uses this KMS key to encrypt CloudTrail logs
}
```";aws cloudtrail update-trail --name <trail_name> --kms-key-id <kms_key_arn_or_id>;"1. In the AWS Console, go to CloudTrail > Trails
2. Select the trail <trail_name>, click Edit
3. Under Log file encryption, choose Use a KMS key and select <cloudtrail_kms_key>
4. Click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC08-BP02 | ISO27001-2022: A.8.11, A.8.15, A.8.16, A.8.24 | AWS-Foundational-Technical-Review: SDAT-002 | PCI-3.2.1: 3.4, 3.4.1, 3.4.1.a, 3.4.1.c, 3.4.a, 3.4.b, 3.4.d, 8.2, 8.2.1, 8.2.1.a | CIS-1.5: 3.7 | NIS2: 9.2.a | NIST-800-171-Revision-2: 3_3_8, 3_13_11, 3_13_16 | NIST-800-53-Revision-4: au_9, sc_28 | NIST-CSF-2.0: ds_1, ds_5, pt_1, pt_4 | CISA: your-systems-3, your-data-1 | CIS-5.0: 3.5 | GxP-21-CFR-Part-11: 11.10-c, 11.30 | NIST-800-53-Revision-5: au_9_3, cm_6_a, cm_9_b, cp_9_d, sc_8_3, sc_8_4, sc_13_a, sc_28_1, si_19_4 | GDPR: article_25, article_30, article_32 | ProwlerThreatScore-1.0: 4.2.3 | KISA-ISMS-P-2023: 2.7.2, 2.10.1, 2.10.2 | GxP-EU-Annex-11: 7.1-data-storage-damage-protection | FedRamp-Moderate-Revision-4: au-9, sc-28 | CIS-1.4: 3.7 | C5-2025: OIS-08.02B, OPS-11.02AC, OPS-13.03B, OPS-26.01AS, OPS-31.01B, IAM-07.03B, IAM-08.06B, CRY-01.02AC, CRY-05.02B, CRY-05.01AC, CRY-10.01AC, CRY-11.01B, SIM-03.06B, SIM-03.07B, COM-04.01AC, PSS-04.04B, PSS-12.02B, PSS-12.03AC | FedRAMP-Low-Revision-4: au-9 | ENS-RD2022: op.exp.8.r4.aws.ct.4, op.exp.8.r4.aws.ct.7 | NIST-CSF-1.1: ds_1 | CIS-4.0.1: 3.5 | AWS-Foundational-Security-Best-Practices: CloudTrail.2 | CIS-2.0: 3.7 | CCC: CCC.AuditLog.CN02.AR01, CCC.AuditLog.CN03.AR01, CCC.AuditLog.CN04.AR01, CCC.AuditLog.CN05.AR01, CCC.AuditLog.CN09.AR01, CCC.AuditLog.CN10.AR01, CCC.Logging.CN01.AR01, CCC.Logging.CN01.AR02, CCC.Logging.CN05.AR01, CCC.Logging.CN07.AR01, CCC.Core.CN09.AR01, CCC.Core.CN09.AR02, CCC.Core.CN09.AR03, CCC.Core.CN02.AR01, CCC.Core.CN04.AR03 | HIPAA: 164_308_a_1_ii_b, 164_308_a_1_ii_d, 164_308_a_4_ii_a, 164_312_a_2_iv, 164_312_c_1, 164_312_c_2, 164_312_e_2_ii | CIS-3.0: 3.5 | RBI-Cyber-Security-Framework: annex_i_1_3 | PCI-4.0: 10.3.2.4, 10.3.3.6, 10.3.4.5, 3.5.1.5, 8.3.2.9, A1.2.1.11 | KISA-ISMS-P-2023-korean: 2.7.2, 2.10.1, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-mla, ksi-svc;encryption;;;;5.18.1;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/encrypting-cloudtrail-log-files-with-aws-kms.html | https://trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudTrail/cloudtrail-logs-encrypted.html | https://www.stream.security/rules/ensure-cloudtrail-logs-are-encrypted-at-rest | https://www.clouddefense.ai/compliance-rules/cis-v130/logging/cis-v130-3-7
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudtrail_log_file_validation_enabled-132410971304-ap-northeast-2-security-cloudtail;aws;cloudtrail_log_file_validation_enabled;CloudTrail trail has log file validation enabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;PASS;Multiregion trail security-cloudtail has log file validation enabled.;False;cloudtrail;;medium;AwsCloudTrailTrail;arn:aws:cloudtrail:ap-northeast-2:132410971304:trail/security-cloudtail;security-cloudtail;;;aws;ap-northeast-2;"**AWS CloudTrail trails** are evaluated for **log file integrity validation** being enabled (`LogFileValidationEnabled`).

When enabled, CloudTrail generates signed digest files to verify that S3-delivered log files remain unchanged.";"Without validation, adversaries can alter, forge, or delete audit entries without detection, compromising log **integrity** and non-repudiation.

This impairs investigations, enables alert evasion, and obscures unauthorized changes across regions or accounts.";;"Enable **log file integrity validation** on all trails (`LogFileValidationEnabled=true`).

Enforce **least privilege** on the logs bucket, retain and protect digest files (e.g., S3 Object Lock/MFA Delete), and monitor validation results to support **defense in depth**.";https://hub.prowler.com/check/cloudtrail_log_file_validation_enabled;"```yaml
# CloudFormation: Enable log file validation on a CloudTrail trail
Resources:
  <example_resource_name>:
    Type: AWS::CloudTrail::Trail
    Properties:
      S3BucketName: <example_resource_name>
      EnableLogFileValidation: true  # Critical: enables integrity validation for delivered log files
```";"```hcl
# Enable log file validation on a CloudTrail trail
resource ""aws_cloudtrail"" ""<example_resource_name>"" {
  name               = ""<example_resource_name>""
  s3_bucket_name     = ""<example_resource_name>""
  enable_log_file_validation = true  # Critical: ensures CloudTrail writes signed digests to detect tampering
}
```";aws cloudtrail update-trail --name <trail_name> --enable-log-file-validation;"1. Open the AWS Console and go to CloudTrail
2. Click Trails and select <trail_name>
3. Click Edit
4. In Additional/Advanced settings, check Enable log file validation
5. Click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC06-BP01, SEC06-BP06 | ISO27001-2022: A.8.15, A.8.16 | PCI-3.2.1: 10.5, 10.5.2, 10.5.5 | CIS-1.5: 3.2 | NIS2: 3.4.2.d | NIST-800-171-Revision-2: 3_3_8, 3_13_1 | NIST-800-53-Revision-4: si_7_1, si_7 | NIST-CSF-2.0: ds_6, pt_1 | CISA: your-systems-3 | CIS-5.0: 3.2 | GxP-21-CFR-Part-11: 11.10-a, 11.30 | NIST-800-53-Revision-5: au_9_a, cm_6_a, cm_9_b, pm_11_b, pm_17_b, sa_1_1, sa_10_1, sc_16_1, si_1_a_2, si_4_d, si_7_1, si_7_3, si_7_7, si_7_a | GDPR: article_25, article_32 | ProwlerThreatScore-1.0: 3.1.2 | KISA-ISMS-P-2023: 2.9.4, 2.10.1, 2.10.2 | FedRamp-Moderate-Revision-4: au-9, si-7-1, si-7 | CIS-1.4: 3.2 | C5-2025: AM-01.01AC, OPS-11.02AC, OPS-13.01AC, OPS-15.02AC, OPS-26.05B, OPS-26.01AS, DEV-08.02B, SIM-01.02AC, SIM-03.07B, COM-04.01AC, PSS-12.03AC | FedRAMP-Low-Revision-4: ac-2, au-2, au-9 | ENS-RD2022: op.exp.8.aws.ct.3 | SOC2: cc_7_3, pi_1_3 | NIST-CSF-1.1: ds_6, ds_7 | CIS-4.0.1: 3.2 | AWS-Foundational-Security-Best-Practices: CloudTrail.4 | CIS-2.0: 3.2 | CCC: CCC.AuditLog.CN01.AR01, CCC.AuditLog.CN01.AR02, CCC.AuditLog.CN02.AR01, CCC.AuditLog.CN03.AR01, CCC.Logging.CN01.AR01, CCC.Logging.CN07.AR01, CCC.Core.CN09.AR01, CCC.Core.CN09.AR02, CCC.Core.CN09.AR03, CCC.Core.CN04.AR01, CCC.Core.CN04.AR03 | HIPAA: 164_308_a_1_ii_b, 164_308_a_1_ii_d, 164_312_b, 164_312_c_1, 164_312_c_2 | CIS-3.0: 3.2 | PCI-4.0: 10.3.2.5, 10.3.3.7, 10.3.4.6, A1.2.1.12 | KISA-ISMS-P-2023-korean: 2.9.4, 2.10.1, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-cmt, ksi-mla;logging | forensics-ready;;;;5.18.1;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-log-file-validation-intro.html | https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-log-file-validation-enabling.html | https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudTrail/cloudtrail-log-file-integrity-validation.html | https://deepwiki.com/acantril/learn-cantrill-io-labs/7.1-cloudtrail-log-file-integrity
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudtrail_logs_s3_bucket_access_logging_enabled-132410971304-ap-northeast-2-security-cloudtail;aws;cloudtrail_logs_s3_bucket_access_logging_enabled;CloudTrail trail destination S3 bucket has access logging enabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;FAIL;Multiregion Trail security-cloudtail S3 bucket access logging is not enabled for bucket aws-cloudtrail-logs-132410971304-0971c04b.;False;cloudtrail;;medium;AwsCloudTrailTrail;arn:aws:cloudtrail:ap-northeast-2:132410971304:trail/security-cloudtail;security-cloudtail;;;aws;ap-northeast-2;"CloudTrail trails deliver logs to an S3 bucket; this evaluates whether that bucket has **S3 server access logging** enabled to record requests against it.

*If the destination bucket is outside the account or audit scope, a manual review is indicated.*";Without access logging on the CloudTrail logs bucket, access and changes to log files lack an independent audit trail. Attackers could read, delete, or replace logs without attribution, undermining **log confidentiality** and **integrity**, and slowing **incident response**.;;Enable **S3 server access logging** on the CloudTrail logs bucket and write logs to a separate, tightly controlled bucket. Apply **least privilege**, enable **versioning**, and consider **Object Lock** to deter tampering. Centralize monitoring to support defense-in-depth and rapid investigation.;https://hub.prowler.com/check/cloudtrail_logs_s3_bucket_access_logging_enabled;"```yaml
# CloudFormation: enable S3 access logging on the CloudTrail destination bucket
Resources:
  <example_log_bucket_name>:
    Type: AWS::S3::Bucket

  <example_cloudtrail_bucket>:
    Type: AWS::S3::Bucket
    Properties:
      LoggingConfiguration:
        DestinationBucketName: !Ref <example_log_bucket_name>  # Critical: turns on server access logging to this destination bucket
        # This enables access logging so the check passes
```";"```hcl
# Enable access logging on the CloudTrail S3 bucket
resource ""aws_s3_bucket"" ""<example_log_bucket_name>"" {
  bucket = ""<example_log_bucket_name>""
}

resource ""aws_s3_bucket"" ""<example_bucket_name>"" {
  bucket = ""<example_bucket_name>""
}

resource ""aws_s3_bucket_logging"" ""<example_resource_name>"" {
  bucket        = aws_s3_bucket.<example_bucket_name>.id
  target_bucket = aws_s3_bucket.<example_log_bucket_name>.id  # Critical: enables server access logging to the target bucket
}
```";"aws s3api put-bucket-logging --bucket <CLOUDTRAIL_BUCKET_NAME> --bucket-logging-status ""{\""LoggingEnabled\"":{\""TargetBucket\"":\""<TARGET_BUCKET_NAME>\""}}""";"1. In the AWS Console, go to S3 and open the bucket used by your CloudTrail trail
2. Select the Properties tab
3. In Server access logging, click Edit
4. Enable logging and choose a different destination S3 bucket for the logs
5. Click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP01 | ISO27001-2022: A.8.15, A.8.16 | CIS-1.5: 3.6 | NIS2: 3.2.3.c, 11.1.1, 11.2.2.f | NIST-CSF-2.0: pt_1 | CIS-5.0: 3.4 | GDPR: article_25 | ProwlerThreatScore-1.0: 3.1.3 | KISA-ISMS-P-2023: 2.9.4, 2.10.1, 2.10.2, 2.11.3 | CIS-1.4: 3.6 | C5-2025: AM-01.01AC, OPS-11.02AC, OPS-15.01B, OPS-15.02B, OPS-15.03B, OPS-15.01AC, OPS-26.05B, OPS-26.01AS, IAM-07.04B, IAM-10.01B, SSO-05.01AC, SIM-03.07B, COM-04.01AC, INQ-04.01AC, PSS-04.05B, PSS-12.03AC | ENS-RD2022: op.exp.8.r1.aws.ct.6, op.exp.8.r4.aws.ct.5 | SOC2: cc_a_1_1 | ISO27001-2013: A.12.4.O | CIS-4.0.1: 3.4 | AWS-Foundational-Security-Best-Practices: CloudTrail.7 | CIS-2.0: 3.6 | CCC: CCC.AuditLog.CN02.AR01, CCC.AuditLog.CN04.AR01, CCC.AuditLog.CN05.AR01, CCC.Logging.CN01.AR01, CCC.Logging.CN05.AR01, CCC.ObjStor.CN06.AR01, CCC.Core.CN09.AR02, CCC.Core.CN09.AR03 | CIS-3.0: 3.4 | AWS-Account-Security-Onboarding: Send S3 access logs for critical buckets to separate S3 bucket, Confirm that logs are present in S3 bucket and SIEM | KISA-ISMS-P-2023-korean: 2.9.4, 2.10.1, 2.10.2, 2.11.3;logging | forensics-ready;;;;5.18.1;https://docs.aws.amazon.com/securityhub/latest/userguide/cloudtrail-controls.html | https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_changes_to_network_acls_alarm_configured-132410971304-ap-northeast-2-132410971304;aws;cloudwatch_changes_to_network_acls_alarm_configured;CloudWatch log metric filter and alarm exist for Network ACL (NACL) change events;Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Software and Configuration Checks/AWS Security Best Practices/Runtime Behavior Analysis;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;False;cloudwatch;;medium;AwsCloudWatchAlarm;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;;;aws;ap-northeast-2;CloudTrail records for **Network ACL changes** are matched by a CloudWatch Logs metric filter with an associated alarm for events like `CreateNetworkAcl`, `CreateNetworkAclEntry`, `DeleteNetworkAcl`, `DeleteNetworkAclEntry`, `ReplaceNetworkAclEntry`, and `ReplaceNetworkAclAssociation`.;Absent monitoring of **NACL changes** reduces detection of policy tampering, risking loss of **confidentiality** (opened ingress/egress), degraded network **integrity** (lateral movement, bypassed segmentation), and reduced **availability** (traffic blackholes or lockouts).;;Implement a CloudWatch Logs metric filter and alarm for NACL change events from CloudTrail and route alerts to responders. Enforce **least privilege** on NACL management, require **change control**, and use **defense in depth** with configuration monitoring and flow logs to validate and monitor network posture.;https://hub.prowler.com/check/cloudwatch_changes_to_network_acls_alarm_configured;"```yaml
# CloudFormation to alert on NACL changes
Resources:
  MetricFilter:
    Type: AWS::Logs::MetricFilter
    Properties:
      LogGroupName: ""<example_resource_name>""  # CRITICAL: CloudTrail log group to monitor
      FilterPattern: '{ ($.eventName = CreateNetworkAcl) || ($.eventName = CreateNetworkAclEntry) || ($.eventName = DeleteNetworkAcl) || ($.eventName = DeleteNetworkAclEntry) || ($.eventName = ReplaceNetworkAclEntry) || ($.eventName = ReplaceNetworkAclAssociation) }'  # CRITICAL: detects NACL changes
      MetricTransformations:
        - MetricValue: ""1""
          MetricNamespace: ""CISBenchmark""
          MetricName: ""nacl_changes""

  NaclChangesAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties:
      AlarmName: ""nacl_changes""
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: ""nacl_changes""   # CRITICAL: alarm targets the metric from the filter
      Namespace: ""CISBenchmark""
      Period: 300
      Statistic: Sum
      Threshold: 1
```";"```hcl
# CloudWatch metric filter and alarm for NACL changes
resource ""aws_cloudwatch_log_metric_filter"" ""nacl"" {
  name           = ""nacl_changes""
  log_group_name = ""<example_resource_name>""  # CloudTrail log group
  pattern        = ""{ ($.eventName = CreateNetworkAcl) || ($.eventName = CreateNetworkAclEntry) || ($.eventName = DeleteNetworkAcl) || ($.eventName = DeleteNetworkAclEntry) || ($.eventName = ReplaceNetworkAclEntry) || ($.eventName = ReplaceNetworkAclAssociation) }""  # CRITICAL: detects NACL changes

  metric_transformation {
    name      = ""nacl_changes""
    namespace = ""CISBenchmark""
    value     = ""1""
  }
}

resource ""aws_cloudwatch_metric_alarm"" ""nacl"" {
  alarm_name          = ""nacl_changes""
  comparison_operator = ""GreaterThanOrEqualToThreshold""
  evaluation_periods  = 1
  metric_name         = ""nacl_changes""   # CRITICAL: alarm targets the metric from the filter
  namespace           = ""CISBenchmark""
  period              = 300
  statistic           = ""Sum""
  threshold           = 1
}
```";;"1. In the AWS Console, go to CloudWatch > Log groups and open the CloudTrail log group
2. Metric filters tab > Create metric filter
3. Set Filter pattern to:
   { ($.eventName = CreateNetworkAcl) || ($.eventName = CreateNetworkAclEntry) || ($.eventName = DeleteNetworkAcl) || ($.eventName = DeleteNetworkAclEntry) || ($.eventName = ReplaceNetworkAclEntry) || ($.eventName = ReplaceNetworkAclAssociation) }
4. Next > Filter name: nacl_changes; Metric namespace: CISBenchmark; Metric name: nacl_changes; Metric value: 1 > Create metric filter
5. Select the new metric filter > Create alarm
6. Set Statistic: Sum, Period: 5 minutes, Threshold type: Static, Condition: Greater/Equal, Threshold: 1
7. Next through actions (optional) > Name: nacl_changes > Create alarm";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP04 | ISO27001-2022: A.8.15, A.8.16 | CIS-1.5: 4.11 | NIS2: 2.2.3, 3.2.3.a, 3.2.3.c, 3.2.3.f, 6.4.1 | NIST-800-171-Revision-2: 3_6_1, 3_6_2, 3_12_4 | NIST-800-53-Revision-4: ac_2_4, au_6_1, au_6_3, au_7_1, ca_7, ir_4_1, si_4_2, si_4_4, si_4_5, si_4 | NIST-CSF-2.0: ra_5, cm_1, dp_4 | CIS-5.0: 4.11 | NIST-800-53-Revision-5: au_6_1, au_6_5, au_12_3, au_14_a, au_14_b, ca_2_2, ca_7, ca_7_b, pm_14_a_1, pm_14_b, pm_31, sc_36_1_a, si_2_a, si_4_12, si_5_1, si_5_b | ProwlerThreatScore-1.0: 3.3.12 | KISA-ISMS-P-2023: 2.9.4, 2.10.1, 2.10.2, 2.11.3 | FedRamp-Moderate-Revision-4: ac-2-4, au-6-1-3, au-7-1, ca-7-a-b, ir-4-1, ir-4-1, si-4-2, si-4-4, si-4-5, si-4-a-b-c | CIS-1.4: 4.11 | C5-2025: OIS-04.03B, OIS-04.01AC, OIS-04.02AC, HR-03.02AC, AM-09.03AC, OPS-11.02AC, OPS-13.03AC, OPS-26.05B, OPS-26.01AS, OPS-26.06B, PSS-04.01B | FedRAMP-Low-Revision-4: ac-2, ca-7, ir-4 | FFIEC: d5-dr-de-b-1, d5-dr-de-b-3 | SOC2: cc_5_2, cc_7_2, cc_7_3, cc_7_4 | NIST-CSF-1.1: ae_5, cm_2, cm_5, cp_4, ra_5 | ISO27001-2013: A.12.4.D | CIS-4.0.1: 4.11 | CIS-2.0: 4.11 | CCC: CCC.AuditLog.CN03.AR02, CCC.Logging.CN07.AR01, CCC.Monitor.CN02.AR01, CCC.Core.CN09.AR03, CCC.Core.CN04.AR01 | HIPAA: 164_308_a_6_i | CIS-3.0: 4.11 | MITRE-ATTACK: T1496 | KISA-ISMS-P-2023-korean: 2.9.4, 2.10.1, 2.10.2, 2.11.3 | FedRAMP-20x-KSI-Low-25.05C: ksi-cmt;logging;;;Logging and Monitoring;5.18.1;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html | https://www.clouddefense.ai/compliance-rules/cis-v130/monitoring/cis-v130-4-11 | https://support.icompaas.com/support/solutions/articles/62000084031-ensure-a-log-metric-filter-and-alarm-exist-for-changes-to-network-access-control-lists-nacl- | https://trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudWatchLogs/network-acl-changes-alarm.html | https://support.icompaas.com/support/solutions/articles/62000233134-4-11-ensure-network-access-control-list-nacl-changes-are-monitored-manual-
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_changes_to_network_gateways_alarm_configured-132410971304-ap-northeast-2-132410971304;aws;cloudwatch_changes_to_network_gateways_alarm_configured;CloudWatch Logs metric filter and alarm exist for changes to network gateways;Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Software and Configuration Checks/AWS Security Best Practices/Runtime Behavior Analysis | Software and Configuration Checks/AWS Security Best Practices/Network Reachability | TTPs/Command and Control;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;False;cloudwatch;;medium;AwsCloudWatchAlarm;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;;;aws;ap-northeast-2;CloudWatch log metric filters and alarms for **network gateway changes** are identified by matching CloudTrail events such as `CreateCustomerGateway`, `DeleteCustomerGateway`, `AttachInternetGateway`, `CreateInternetGateway`, `DeleteInternetGateway`, and `DetachInternetGateway` in log groups that receive trail logs.;Without this monitoring, gateway changes can expose private networks to the Internet or break connectivity. Adversaries or mistakes can enable data exfiltration, bypass network inspection, and trigger outages via deletions or detachments, impacting **confidentiality** and **availability**.;;Send CloudTrail to CloudWatch Logs and create a metric filter for the listed gateway events with an alarm that notifies responders. Enforce **least privilege** for gateway modifications, require change approvals, and route alerts to monitored channels as part of **defense in depth**.;https://hub.prowler.com/check/cloudwatch_changes_to_network_gateways_alarm_configured;"```yaml
# CloudFormation: Create metric filter and alarm for network gateway changes
Resources:
  NetworkGatewayMetricFilter:
    Type: AWS::Logs::MetricFilter
    Properties:
      LogGroupName: <example_resource_name>
      FilterPattern: '{ ($.eventName = CreateCustomerGateway) || ($.eventName = DeleteCustomerGateway) || ($.eventName = AttachInternetGateway) || ($.eventName = CreateInternetGateway) || ($.eventName = DeleteInternetGateway) || ($.eventName = DetachInternetGateway) }'  # Critical: matches gateway change events
      MetricTransformations:
        - MetricName: <example_resource_name>
          MetricNamespace: <example_resource_name>
          MetricValue: ""1""

  NetworkGatewayAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties:
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: <example_resource_name>  # Critical: alarm targets the metric created by the filter
      Namespace: <example_resource_name>
      Period: 300
      Statistic: Sum
      Threshold: 1
```";"```hcl
# CloudWatch Logs metric filter for network gateway changes
resource ""aws_cloudwatch_log_metric_filter"" ""<example_resource_name>"" {
  name           = ""<example_resource_name>""
  log_group_name = ""<example_resource_name>""
  pattern        = ""{ ($.eventName = CreateCustomerGateway) || ($.eventName = DeleteCustomerGateway) || ($.eventName = AttachInternetGateway) || ($.eventName = CreateInternetGateway) || ($.eventName = DeleteInternetGateway) || ($.eventName = DetachInternetGateway) }"" # Critical: matches gateway change events

  metric_transformation {
    name      = ""<example_resource_name>""
    namespace = ""<example_resource_name>""
    value     = ""1""
  }
}

# Alarm on the metric filter
resource ""aws_cloudwatch_metric_alarm"" ""<example_resource_name>"" {
  alarm_name          = ""<example_resource_name>""
  comparison_operator = ""GreaterThanOrEqualToThreshold""
  evaluation_periods  = 1
  metric_name         = ""<example_resource_name>""   # Critical: must match metric from the filter
  namespace           = ""<example_resource_name>""
  period              = 300
  statistic           = ""Sum""
  threshold           = 1
}
```";;"1. In the AWS Console, go to CloudWatch > Logs > Log groups and open the CloudTrail log group
2. Create metric filter:
   - Filter pattern: { ($.eventName = CreateCustomerGateway) || ($.eventName = DeleteCustomerGateway) || ($.eventName = AttachInternetGateway) || ($.eventName = CreateInternetGateway) || ($.eventName = DeleteInternetGateway) || ($.eventName = DetachInternetGateway) }
   - Metric name: <example_resource_name>
   - Metric namespace: <example_resource_name>
   - Metric value: 1
3. From the filter, choose Create alarm:
   - Statistic: Sum, Period: 5 minutes, Threshold: >= 1, Evaluation periods: 1
   - Create the alarm (actions optional)
";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP04 | ISO27001-2022: A.8.15, A.8.16 | CIS-1.5: 4.12 | NIS2: 2.2.3, 3.2.3.a, 3.2.3.c, 3.2.3.f, 3.2.4, 6.4.1 | NIST-800-171-Revision-2: 3_6_1, 3_6_2, 3_12_4 | NIST-800-53-Revision-4: ac_2_4, au_6_1, au_6_3, au_7_1, ca_7, ir_4_1, si_4_2, si_4_4, si_4_5, si_4 | NIST-CSF-2.0: ra_5, ae_2, ae_3, cm_1, dp_4 | CIS-5.0: 4.12 | NIST-800-53-Revision-5: au_6_1, au_6_5, au_12_3, au_14_a, au_14_b, ca_2_2, ca_7, ca_7_b, pm_14_a_1, pm_14_b, pm_31, sc_36_1_a, si_2_a, si_4_12, si_5_1, si_5_b | ProwlerThreatScore-1.0: 3.3.13 | KISA-ISMS-P-2023: 2.9.4, 2.10.1, 2.10.2, 2.11.3 | FedRamp-Moderate-Revision-4: ac-2-4, au-6-1-3, au-7-1, ca-7-a-b, ir-4-1, ir-4-1, si-4-2, si-4-4, si-4-5, si-4-a-b-c | CIS-1.4: 4.12 | C5-2025: OIS-04.03B, OIS-04.01AC, OIS-04.02AC, HR-03.02AC, AM-09.03AC, OPS-11.02AC, OPS-13.03AC, OPS-26.05B, OPS-26.01AS, OPS-26.06B, COS-03.02B, PSS-04.01B | FedRAMP-Low-Revision-4: ir-4 | FFIEC: d5-dr-de-b-1, d5-dr-de-b-3 | SOC2: cc_5_2, cc_7_2, cc_7_3, cc_7_4 | NIST-CSF-1.1: ae_5, cm_2, cm_5, cp_4, ra_5 | ISO27001-2013: A.12.4.C | CIS-4.0.1: 4.12 | CIS-2.0: 4.12 | CCC: CCC.AuditLog.CN03.AR02, CCC.Logging.CN07.AR01, CCC.Monitor.CN02.AR01, CCC.Core.CN09.AR03, CCC.Core.CN04.AR01 | HIPAA: 164_308_a_6_i | CIS-3.0: 4.12 | MITRE-ATTACK: T1496 | KISA-ISMS-P-2023-korean: 2.9.4, 2.10.1, 2.10.2, 2.11.3 | FedRAMP-20x-KSI-Low-25.05C: ksi-cmt;logging;;;Logging and Monitoring;5.18.1;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html | https://support.icompaas.com/support/solutions/articles/62000083807-ensure-a-log-metric-filter-and-alarm-exist-for-changes-to-network-gateways | https://docs.aws.amazon.com/securityhub/latest/userguide/cloudwatch-controls.html#cloudwatch-12 | https://paper.bobylive.com/Security/CIS/CIS_Amazon_Web_Services_Foundations_Benchmark_v1_3_0.pdf
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_changes_to_network_route_tables_alarm_configured-132410971304-ap-northeast-2-132410971304;aws;cloudwatch_changes_to_network_route_tables_alarm_configured;Account monitors VPC route table changes with a CloudWatch Logs metric filter and alarm;Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Software and Configuration Checks/AWS Security Best Practices | TTPs/Defense Evasion | Effects/Data Exfiltration;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;False;cloudwatch;;medium;AwsCloudWatchAlarm;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;;;aws;ap-northeast-2;**VPC route table changes** are captured from **CloudTrail logs** by a **CloudWatch Logs metric filter** with an associated **alarm** for events like `CreateRoute`, `CreateRouteTable`, `ReplaceRoute`, `ReplaceRouteTableAssociation`, `DeleteRoute`, `DeleteRouteTable`, and `DisassociateRouteTable`.;Without monitoring of **route table changes**, unauthorized or accidental edits can redirect traffic, bypass inspection, or blackhole routes, impacting **confidentiality** (exfiltration), **integrity** (tampered paths), and **availability** (outages from misrouted traffic).;;Implement a **CloudWatch Logs metric filter and alarm** on CloudTrail for these route table events and notify responders. Enforce **least privilege** for route modifications, require **change control**, and apply **defense in depth** with VPC Flow Logs and guardrails to prevent and quickly contain unsafe routing changes.;https://hub.prowler.com/check/cloudwatch_changes_to_network_route_tables_alarm_configured;"```yaml
# CloudFormation: Metric filter + alarm for VPC route table changes
Resources:
  RouteTableChangeMetricFilter:
    Type: AWS::Logs::MetricFilter
    Properties:
      LogGroupName: ""<example_resource_name>""
      # CRITICAL: Detect EC2 route table change events in CloudTrail logs
      # Includes eventSource and the required eventNames
      FilterPattern: '{($.eventSource = ec2.amazonaws.com) && (($.eventName = CreateRoute) || ($.eventName = CreateRouteTable) || ($.eventName = ReplaceRoute) || ($.eventName = ReplaceRouteTableAssociation) || ($.eventName = DeleteRouteTable) || ($.eventName = DeleteRoute) || ($.eventName = DisassociateRouteTable))}'
      MetricTransformations:
        - MetricValue: ""1""
          MetricNamespace: ""<example_resource_name>""
          MetricName: ""<example_resource_name>""

  RouteTableChangeAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties:
      # CRITICAL: Alarm on the metric from the filter above
      Namespace: ""<example_resource_name>""
      MetricName: ""<example_resource_name>""
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      Period: 300
      Statistic: Sum
      Threshold: 1
```";"```hcl
# Metric filter + alarm for VPC route table changes
resource ""aws_cloudwatch_log_metric_filter"" ""routes"" {
  name           = ""<example_resource_name>""
  log_group_name = ""<example_resource_name>""
  # CRITICAL: Detect EC2 route table change events in CloudTrail logs
  pattern = ""{($.eventSource = ec2.amazonaws.com) && (($.eventName = CreateRoute) || ($.eventName = CreateRouteTable) || ($.eventName = ReplaceRoute) || ($.eventName = ReplaceRouteTableAssociation) || ($.eventName = DeleteRouteTable) || ($.eventName = DeleteRoute) || ($.eventName = DisassociateRouteTable))}""

  metric_transformation {
    name      = ""<example_resource_name>""
    namespace = ""<example_resource_name>""
    value     = ""1""
  }
}

resource ""aws_cloudwatch_metric_alarm"" ""routes"" {
  alarm_name          = ""<example_resource_name>""
  # CRITICAL: Alarm targets the metric from the filter above
  metric_name         = ""<example_resource_name>""
  namespace           = ""<example_resource_name>""
  comparison_operator = ""GreaterThanOrEqualToThreshold""
  evaluation_periods  = 1
  period              = 300
  statistic           = ""Sum""
  threshold           = 1
}
```";;"1. In the AWS console, open CloudWatch > Log groups and select your CloudTrail log group
2. Go to Metric filters > Create metric filter
3. Set Filter pattern to:
   {($.eventSource = ec2.amazonaws.com) && (($.eventName = CreateRoute) || ($.eventName = CreateRouteTable) || ($.eventName = ReplaceRoute) || ($.eventName = ReplaceRouteTableAssociation) || ($.eventName = DeleteRouteTable) || ($.eventName = DeleteRoute) || ($.eventName = DisassociateRouteTable))}
4. Name the metric and set Metric value to 1; choose any namespace/name
5. Create the filter
6. From the filter, click Create alarm
7. Set Statistic: Sum, Period: 5 minutes, Threshold type: Static, Threshold: 1, Whenever: Greater/Equal
8. Create the alarm (notifications optional)";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP04 | CIS-1.5: 4.13 | NIS2: 2.2.3, 3.2.3.a, 3.2.3.f, 3.2.4, 6.4.1 | NIST-800-171-Revision-2: 3_6_1, 3_6_2, 3_12_4 | NIST-800-53-Revision-4: ac_2_4, au_6_1, au_6_3, au_7_1, ca_7, ir_4_1, si_4_2, si_4_4, si_4_5, si_4 | NIST-CSF-2.0: ae_2, ae_3, cm_1, dp_4 | CIS-5.0: 4.13 | NIST-800-53-Revision-5: au_6_1, au_6_5, au_12_3, au_14_a, au_14_b, ca_2_2, ca_7, ca_7_b, pm_14_a_1, pm_14_b, pm_31, sc_36_1_a, si_2_a, si_4_12, si_5_1, si_5_b | ProwlerThreatScore-1.0: 3.3.14 | KISA-ISMS-P-2023: 2.9.4, 2.10.1, 2.10.2, 2.11.3 | FedRamp-Moderate-Revision-4: ac-2-4, au-6-1-3, au-7-1, ca-7-a-b, ir-4-1, ir-4-1, si-4-2, si-4-4, si-4-5, si-4-a-b-c | CIS-1.4: 4.13 | C5-2025: OIS-04.03B, OIS-04.01AC, OIS-04.02AC, HR-03.02AC, AM-09.03AC, OPS-13.03AC, OPS-26.06B, COS-03.02B, PSS-04.01B | FedRAMP-Low-Revision-4: ir-4 | FFIEC: d5-dr-de-b-1, d5-dr-de-b-3 | SOC2: cc_5_2, cc_7_2, cc_7_3, cc_7_4 | NIST-CSF-1.1: ae_5, cm_2, cm_5, cp_4, ra_5 | ISO27001-2013: A.12.4.B | CIS-4.0.1: 4.13 | CIS-2.0: 4.13 | CCC: CCC.AuditLog.CN03.AR02, CCC.Logging.CN07.AR01, CCC.Monitor.CN02.AR01, CCC.Core.CN09.AR03, CCC.Core.CN04.AR01 | HIPAA: 164_308_a_6_i | CIS-3.0: 4.13 | MITRE-ATTACK: T1496 | KISA-ISMS-P-2023-korean: 2.9.4, 2.10.1, 2.10.2, 2.11.3 | FedRAMP-20x-KSI-Low-25.05C: ksi-cmt;logging;;;;5.18.1;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_changes_to_vpcs_alarm_configured-132410971304-ap-northeast-2-132410971304;aws;cloudwatch_changes_to_vpcs_alarm_configured;AWS account has a CloudWatch Logs metric filter and alarm for VPC changes;Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;False;cloudwatch;;medium;AwsCloudWatchAlarm;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;;;aws;ap-northeast-2;**CloudTrail events** for **VPC configuration changes** are captured in CloudWatch Logs with a metric filter and an associated alarm. The filter targets actions like `CreateVpc`, `DeleteVpc`, `ModifyVpcAttribute`, and VPC peering operations to surface when network topology is altered.;Without alerting on VPC changes, unauthorized or accidental edits to routes, peering, or attributes can go unnoticed, exposing private networks and enabling data exfiltration (C), lateral movement and traffic tampering (I), and outages from misrouted or bridged networks (A).;;Create a CloudWatch Logs metric filter and alarm on CloudTrail for critical **VPC change events**, and notify responders. Apply **least privilege** to network changes, require change approvals, and use **defense in depth** (segmentation, route controls) to prevent and contain unauthorized modifications.;https://hub.prowler.com/check/cloudwatch_changes_to_vpcs_alarm_configured;"```yaml
# CloudFormation: Create a metric filter and alarm for VPC changes
Resources:
  VPCChangesMetricFilter:
    Type: AWS::Logs::MetricFilter
    Properties:
      LogGroupName: <example_log_group_name>
      FilterPattern: '{ ($.eventName = CreateVpc) || ($.eventName = DeleteVpc) || ($.eventName = ModifyVpcAttribute) || ($.eventName = AcceptVpcPeeringConnection) || ($.eventName = CreateVpcPeeringConnection) || ($.eventName = DeleteVpcPeeringConnection) || ($.eventName = RejectVpcPeeringConnection) || ($.eventName = AttachClassicLinkVpc) || ($.eventName = DetachClassicLinkVpc) || ($.eventName = DisableVpcClassicLink) || ($.eventName = EnableVpcClassicLink) }' # Critical: matches VPC change events
      MetricTransformations:
        - MetricName: vpc_changes_metric
          MetricNamespace: CISBenchmark
          MetricValue: ""1""  # Critical: emits a metric on matching events

  VPCChangesAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties:
      MetricName: vpc_changes_metric  # Critical: alarm monitors the metric above
      Namespace: CISBenchmark
      Statistic: Sum
      Period: 300
      EvaluationPeriods: 1
      Threshold: 1
      ComparisonOperator: GreaterThanOrEqualToThreshold
```";"```hcl
# Metric filter for VPC changes
resource ""aws_cloudwatch_log_metric_filter"" ""<example_resource_name>"" {
  name           = ""<example_resource_name>""
  log_group_name = ""<example_log_group_name>""
  pattern        = ""{ ($.eventName = CreateVpc) || ($.eventName = DeleteVpc) || ($.eventName = ModifyVpcAttribute) || ($.eventName = AcceptVpcPeeringConnection) || ($.eventName = CreateVpcPeeringConnection) || ($.eventName = DeleteVpcPeeringConnection) || ($.eventName = RejectVpcPeeringConnection) || ($.eventName = AttachClassicLinkVpc) || ($.eventName = DetachClassicLinkVpc) || ($.eventName = DisableVpcClassicLink) || ($.eventName = EnableVpcClassicLink) }"" # Critical: matches VPC change events

  metric_transformation {
    name      = ""<example_resource_name>""   # Critical: metric created by the filter
    namespace = ""CISBenchmark""
    value     = ""1""
  }
}

# Alarm on the VPC changes metric
resource ""aws_cloudwatch_metric_alarm"" ""<example_resource_name>"" {
  metric_name        = ""<example_resource_name>""  # Critical: alarm monitors the filter's metric
  namespace          = ""CISBenchmark""
  statistic          = ""Sum""
  period             = 300
  evaluation_periods = 1
  threshold          = 1
  comparison_operator = ""GreaterThanOrEqualToThreshold""
}
```";;"1. In the AWS Console, go to CloudWatch > Log groups and open the CloudTrail log group
2. Choose Create metric filter
3. For Filter pattern, paste:
   { ($.eventName = CreateVpc) || ($.eventName = DeleteVpc) || ($.eventName = ModifyVpcAttribute) || ($.eventName = AcceptVpcPeeringConnection) || ($.eventName = CreateVpcPeeringConnection) || ($.eventName = DeleteVpcPeeringConnection) || ($.eventName = RejectVpcPeeringConnection) || ($.eventName = AttachClassicLinkVpc) || ($.eventName = DetachClassicLinkVpc) || ($.eventName = DisableVpcClassicLink) || ($.eventName = EnableVpcClassicLink) }
4. Name the filter and set Metric namespace to CISBenchmark, Metric name to vpc_changes_metric, Metric value to 1; create the filter
5. Select the new filter and choose Create alarm
6. Set Statistic to Sum, Period 5 minutes, Threshold type Static, Whenever Greater/Equal 1, Evaluation periods 1
7. Create the alarm (actions/notifications are optional and not required for pass)
";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP04 | ISO27001-2022: A.8.15, A.8.16, A.8.20, A.8.21, A.8.22 | CIS-1.5: 4.14 | NIS2: 2.2.3, 3.2.3.c, 3.2.3.f, 3.2.4, 6.4.1 | NIST-800-171-Revision-2: 3_6_1, 3_6_2, 3_12_4 | NIST-800-53-Revision-4: ac_2_4, au_6_1, au_6_3, au_7_1, ca_7, ir_4_1, si_4_2, si_4_4, si_4_5, si_4 | NIST-CSF-2.0: ra_5, ae_2, cm_1 | CIS-5.0: 4.14 | NIST-800-53-Revision-5: au_6_1, au_6_5, au_12_3, au_14_a, au_14_b, ca_2_2, ca_7, ca_7_b, pm_14_a_1, pm_14_b, pm_31, sc_36_1_a, si_2_a, si_4_12, si_5_1, si_5_b | ProwlerThreatScore-1.0: 3.3.15 | KISA-ISMS-P-2023: 2.9.4, 2.10.1, 2.10.2, 2.11.3 | FedRamp-Moderate-Revision-4: ac-2-4, au-6-1-3, au-7-1, ca-7-a-b, ir-4-1, ir-4-1, si-4-2, si-4-4, si-4-5, si-4-a-b-c | CIS-1.4: 4.14 | C5-2025: OIS-04.03B, OIS-04.01AC, OIS-04.02AC, HR-03.02AC, AM-09.03AC, OPS-11.02AC, OPS-13.03AC, OPS-26.05B, OPS-26.01AS, OPS-26.06B, COS-03.02B, PSS-04.01B | FedRAMP-Low-Revision-4: ir-4 | FFIEC: d5-dr-de-b-1, d5-dr-de-b-3 | SOC2: cc_5_2, cc_7_2, cc_7_3, cc_7_4 | NIST-CSF-1.1: ae_5, cm_2, cm_5, cp_4, ra_5 | ISO27001-2013: A.12.4.A | CIS-4.0.1: 4.14 | CIS-2.0: 4.14 | CCC: CCC.AuditLog.CN03.AR02, CCC.Logging.CN07.AR01, CCC.Monitor.CN02.AR01, CCC.Core.CN09.AR03, CCC.Core.CN04.AR01 | HIPAA: 164_308_a_6_i | CIS-3.0: 4.14 | MITRE-ATTACK: T1496 | KISA-ISMS-P-2023-korean: 2.9.4, 2.10.1, 2.10.2, 2.11.3 | FedRAMP-20x-KSI-Low-25.05C: ksi-cmt;logging;;;Logging and Monitoring;5.18.1;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_cross_account_sharing_disabled-132410971304-ap-northeast-2-132410971304;aws;cloudwatch_cross_account_sharing_disabled;CloudWatch does not allow cross-account sharing;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Effects/Data Exposure;PASS;CloudWatch doesn't allow cross-account sharing.;False;cloudwatch;;medium;AwsIamRole;arn:aws:iam:ap-northeast-2:132410971304:role;132410971304;;;aws;ap-northeast-2;**Amazon CloudWatch** cross-account sharing via the `CloudWatch-CrossAccountSharingRole` allows other AWS accounts to view your metrics, dashboards, and alarms. The presence of this role indicates that sharing is active.;Granting other accounts visibility into observability data reduces **confidentiality** and enables **reconnaissance**. Adversaries or over-privileged partners can map architectures, profile workloads, and spot alerting gaps, increasing chances of **lateral movement** and **evasion**.;;Disable **cross-account sharing** unless strictly required. If needed, restrict access to specific trusted accounts, scope read-only permissions to only necessary resources, and use a dedicated monitoring account. Apply **least privilege** and **separation of duties**, and regularly audit role trust and access patterns.;https://hub.prowler.com/check/cloudwatch_cross_account_sharing_disabled;;;aws cloudformation delete-stack --stack-name CloudWatch-CrossAccountSharingRole;"1. Sign in to the AWS Management Console and open IAM
2. Go to Roles
3. Find and select the role named ""CloudWatch-CrossAccountSharingRole""
4. Click Delete and confirm
5. If deletion is blocked because it is managed by CloudFormation: open CloudFormation, select the stack named ""CloudWatch-CrossAccountSharingRole"", and click Delete";AWS-Well-Architected-Framework-Security-Pillar: SEC03-BP01 | KISA-ISMS-P-2023: 2.6.2, 2.10.1, 2.10.2 | C5-2025: OIS-04.01AC, PSS-04.01B | ENS-RD2022: op.acc.4.aws.iam.1 | SOC2: pi_1_4 | KISA-ISMS-P-2023-korean: 2.6.2, 2.10.1, 2.10.2;trust-boundaries | identity-access;;;;5.18.1;https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/Cross-Account-Cross-Region.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_log_group_kms_encryption_enabled-132410971304-ap-northeast-2-/aws/eks/0201_test/cluster;aws;cloudwatch_log_group_kms_encryption_enabled;CloudWatch log group is encrypted with an AWS KMS key;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Effects/Data Exposure;FAIL;Log Group /aws/eks/0201_test/cluster does not have AWS KMS keys associated.;False;cloudwatch;;medium;Other;arn:aws:logs:ap-northeast-2:132410971304:log-group:/aws/eks/0201_test/cluster:*;/aws/eks/0201_test/cluster;;;aws;ap-northeast-2;**CloudWatch log groups** are assessed for **at-rest encryption** by checking if an **AWS KMS key** is associated with the log group via `kmsKeyId`.;"Without a **customer-managed KMS key**, logs rely on service-managed encryption, limiting control and auditability.
- Confidentiality: weaker key-policy barriers against unauthorized reads
- Integrity/availability: no custom rotation or rapid revoke, hindering incident response and compliance";;"Associate each log group with a **customer-managed KMS key** via `kmsKeyId`.
- Enforce **least privilege** in key and IAM policies, granting `kms:Decrypt` only to required principals
- Enable rotation and monitor key usage
- Separate keys by app/tenant to support **defense in depth** and rapid revocation";https://hub.prowler.com/check/cloudwatch_log_group_kms_encryption_enabled;"```yaml
# CloudFormation: Encrypt a CloudWatch Log Group with KMS
Resources:
  <example_resource_name>:
    Type: AWS::Logs::LogGroup
    Properties:
      KmsKeyId: arn:aws:kms:<REGION>:<ACCOUNT_ID>:key/<KEY_ID>  # Critical: associates a CMK to encrypt the log group
```";"```hcl
# Encrypt a CloudWatch Log Group with KMS
resource ""aws_cloudwatch_log_group"" ""<example_resource_name>"" {
  name       = ""<example_resource_name>""
  kms_key_id = ""arn:aws:kms:<REGION>:<ACCOUNT_ID>:key/<KEY_ID>"" # Critical: associates a CMK to encrypt the log group
}
```";aws logs associate-kms-key --log-group-name <LOG_GROUP_NAME> --kms-key-id arn:aws:kms:<REGION>:<ACCOUNT_ID>:key/<KEY_ID>;"1. In the AWS Console, go to CloudWatch > Log groups
2. Click Create log group and enter a name
3. Under Encryption, select KMS key and provide the key ARN
4. Click Create log group
5. For existing log groups, the console cannot attach a KMS key; use the CLI command provided";AWS-Well-Architected-Framework-Security-Pillar: SEC08-BP02 | ISO27001-2022: A.8.11, A.8.15, A.8.16, A.8.24 | PCI-3.2.1: 3.4, 3.4.1, 3.4.1.a, 3.4.1.c, 3.4.a, 3.4.b, 3.4.d, 8.2, 8.2.1, 8.2.1.a | NIST-800-171-Revision-2: 3_3_8, 3_13_11, 3_13_16 | NIST-800-53-Revision-4: au_9, sc_28 | NIST-CSF-2.0: ds_1, ds_5 | CISA: your-systems-3, your-data-2 | GxP-21-CFR-Part-11: 11.30 | NIST-800-53-Revision-5: au_9_3, cp_9_d, sc_8_3, sc_8_4, sc_13_a, sc_28_1, si_19_4 | GDPR: article_32 | KISA-ISMS-P-2023: 2.7.2, 2.10.1, 2.10.2 | GxP-EU-Annex-11: 7.1-data-storage-damage-protection | FedRamp-Moderate-Revision-4: au-9, sc-28 | C5-2025: OIS-04.01AC, OIS-08.02B, AM-01.01AC, OPS-11.02AC, OPS-13.03B, OPS-14.03B, OPS-26.05B, OPS-26.01AS, OPS-31.01B, IAM-07.03B, CRY-01.02AC, CRY-05.02B, CRY-05.01AC, PSS-04.01B, PSS-04.04B, PSS-12.02B | FedRAMP-Low-Revision-4: au-9 | SOC2: cc_7_3, pi_1_4 | NIST-CSF-1.1: ds_1 | CCC: CCC.Monitor.CN04.AR01, CCC.Core.CN09.AR03, CCC.Core.CN02.AR01, CCC.Core.CN04.AR03 | HIPAA: 164_308_a_1_ii_b, 164_308_a_4_ii_a, 164_312_a_2_iv, 164_312_e_2_ii | RBI-Cyber-Security-Framework: annex_i_1_3 | MITRE-ATTACK: T1040 | PCI-4.0: 10.3.2.3, 10.3.3.5, 10.3.4.4, 3.5.1.4, 8.3.2.8, A1.2.1.9 | KISA-ISMS-P-2023-korean: 2.7.2, 2.10.1, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-mla;encryption;;;;5.18.1;https://docs.aws.amazon.com/cli/latest/reference/logs/associate-kms-key.html | https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group | https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/logs/client/associate_kms_key.html | https://support.icompaas.com/support/solutions/articles/62000233436-ensure-cloudwatch-log-groups-are-protected-by-aws-kms | https://varunmanik1.medium.com/proactively-mitigating-a-medium-severity-prowler-issue-enabling-kms-encryption-for-cloudwatch-logs-51d43416c7fc
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_log_group_kms_encryption_enabled-132410971304-ap-northeast-2-/aws/eks/0202_test/cluster;aws;cloudwatch_log_group_kms_encryption_enabled;CloudWatch log group is encrypted with an AWS KMS key;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Effects/Data Exposure;FAIL;Log Group /aws/eks/0202_test/cluster does not have AWS KMS keys associated.;False;cloudwatch;;medium;Other;arn:aws:logs:ap-northeast-2:132410971304:log-group:/aws/eks/0202_test/cluster:*;/aws/eks/0202_test/cluster;;;aws;ap-northeast-2;**CloudWatch log groups** are assessed for **at-rest encryption** by checking if an **AWS KMS key** is associated with the log group via `kmsKeyId`.;"Without a **customer-managed KMS key**, logs rely on service-managed encryption, limiting control and auditability.
- Confidentiality: weaker key-policy barriers against unauthorized reads
- Integrity/availability: no custom rotation or rapid revoke, hindering incident response and compliance";;"Associate each log group with a **customer-managed KMS key** via `kmsKeyId`.
- Enforce **least privilege** in key and IAM policies, granting `kms:Decrypt` only to required principals
- Enable rotation and monitor key usage
- Separate keys by app/tenant to support **defense in depth** and rapid revocation";https://hub.prowler.com/check/cloudwatch_log_group_kms_encryption_enabled;"```yaml
# CloudFormation: Encrypt a CloudWatch Log Group with KMS
Resources:
  <example_resource_name>:
    Type: AWS::Logs::LogGroup
    Properties:
      KmsKeyId: arn:aws:kms:<REGION>:<ACCOUNT_ID>:key/<KEY_ID>  # Critical: associates a CMK to encrypt the log group
```";"```hcl
# Encrypt a CloudWatch Log Group with KMS
resource ""aws_cloudwatch_log_group"" ""<example_resource_name>"" {
  name       = ""<example_resource_name>""
  kms_key_id = ""arn:aws:kms:<REGION>:<ACCOUNT_ID>:key/<KEY_ID>"" # Critical: associates a CMK to encrypt the log group
}
```";aws logs associate-kms-key --log-group-name <LOG_GROUP_NAME> --kms-key-id arn:aws:kms:<REGION>:<ACCOUNT_ID>:key/<KEY_ID>;"1. In the AWS Console, go to CloudWatch > Log groups
2. Click Create log group and enter a name
3. Under Encryption, select KMS key and provide the key ARN
4. Click Create log group
5. For existing log groups, the console cannot attach a KMS key; use the CLI command provided";AWS-Well-Architected-Framework-Security-Pillar: SEC08-BP02 | ISO27001-2022: A.8.11, A.8.15, A.8.16, A.8.24 | PCI-3.2.1: 3.4, 3.4.1, 3.4.1.a, 3.4.1.c, 3.4.a, 3.4.b, 3.4.d, 8.2, 8.2.1, 8.2.1.a | NIST-800-171-Revision-2: 3_3_8, 3_13_11, 3_13_16 | NIST-800-53-Revision-4: au_9, sc_28 | NIST-CSF-2.0: ds_1, ds_5 | CISA: your-systems-3, your-data-2 | GxP-21-CFR-Part-11: 11.30 | NIST-800-53-Revision-5: au_9_3, cp_9_d, sc_8_3, sc_8_4, sc_13_a, sc_28_1, si_19_4 | GDPR: article_32 | KISA-ISMS-P-2023: 2.7.2, 2.10.1, 2.10.2 | GxP-EU-Annex-11: 7.1-data-storage-damage-protection | FedRamp-Moderate-Revision-4: au-9, sc-28 | C5-2025: OIS-04.01AC, OIS-08.02B, AM-01.01AC, OPS-11.02AC, OPS-13.03B, OPS-14.03B, OPS-26.05B, OPS-26.01AS, OPS-31.01B, IAM-07.03B, CRY-01.02AC, CRY-05.02B, CRY-05.01AC, PSS-04.01B, PSS-04.04B, PSS-12.02B | FedRAMP-Low-Revision-4: au-9 | SOC2: cc_7_3, pi_1_4 | NIST-CSF-1.1: ds_1 | CCC: CCC.Monitor.CN04.AR01, CCC.Core.CN09.AR03, CCC.Core.CN02.AR01, CCC.Core.CN04.AR03 | HIPAA: 164_308_a_1_ii_b, 164_308_a_4_ii_a, 164_312_a_2_iv, 164_312_e_2_ii | RBI-Cyber-Security-Framework: annex_i_1_3 | MITRE-ATTACK: T1040 | PCI-4.0: 10.3.2.3, 10.3.3.5, 10.3.4.4, 3.5.1.4, 8.3.2.8, A1.2.1.9 | KISA-ISMS-P-2023-korean: 2.7.2, 2.10.1, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-mla;encryption;;;;5.18.1;https://docs.aws.amazon.com/cli/latest/reference/logs/associate-kms-key.html | https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_log_group | https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/logs/client/associate_kms_key.html | https://support.icompaas.com/support/solutions/articles/62000233436-ensure-cloudwatch-log-groups-are-protected-by-aws-kms | https://varunmanik1.medium.com/proactively-mitigating-a-medium-severity-prowler-issue-enabling-kms-encryption-for-cloudwatch-logs-51d43416c7fc
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_log_group_no_secrets_in_logs-132410971304-ap-northeast-2-/aws/eks/0201_test/cluster;aws;cloudwatch_log_group_no_secrets_in_logs;CloudWatch log group contains no secrets in its log events;Software and Configuration Checks/AWS Security Best Practices/Runtime Behavior Analysis | Sensitive Data Identifications/Passwords | Sensitive Data Identifications/Security | Effects/Data Exposure;PASS;No secrets found in /aws/eks/0201_test/cluster log group.;False;cloudwatch;;medium;Other;arn:aws:logs:ap-northeast-2:132410971304:log-group:/aws/eks/0201_test/cluster:*;/aws/eks/0201_test/cluster;;;aws;ap-northeast-2;**CloudWatch Logs** log groups are analyzed for potential **secrets** embedded in log events across their streams. Detection flags patterns resembling credentials (API keys, passwords, tokens, keys) and reports the secret types and where they appear within the log group.;Leaked **credentials in logs** erode confidentiality and enable unauthorized API calls. Attackers reusing tokens/keys can escalate privileges, alter resources, and exfiltrate data. Subscriptions and exports widen exposure, and users with `logs:Unmask` can reveal values, increasing the blast radius.;;Avoid logging **secrets** via application sanitization and data minimization. Apply CloudWatch data protection policies to audit and mask sensitive patterns. Enforce *least privilege* for log readers and restrict `logs:Unmask`. Rotate exposed keys, reduce retention, and monitor findings to validate controls.;https://hub.prowler.com/check/cloudwatch_log_group_no_secrets_in_logs;"```yaml
# CloudFormation: apply data protection policy to mask secrets in a log group
Resources:
  LogGroup:
    Type: AWS::Logs::LogGroup
    Properties:
      LogGroupName: <example_resource_name>
      # Critical: Enables masking of detected credentials at egress so secrets aren't exposed
      DataProtectionPolicy: |
        {""Statement"":[{""DataIdentifier"":[""arn:aws:dataprotection::aws:data-identifier/Credentials""],""Operation"":{""Audit"":{""FindingsDestination"":{}}}},{""DataIdentifier"":[""arn:aws:dataprotection::aws:data-identifier/Credentials""],""Operation"":{""Deidentify"":{""MaskConfig"":{}}}}]}
```";"```hcl
# Apply a CloudWatch Logs data protection policy to mask secrets
resource ""aws_cloudwatch_log_group"" ""log_group"" {
  name = ""<example_resource_name>""

  # Critical: Masks detected credentials so secrets aren't visible and the check passes
  data_protection_policy = jsonencode({
    Statement = [
      {
        DataIdentifier = [
          ""arn:aws:dataprotection::aws:data-identifier/Credentials""
        ]
        Operation = { Audit = { FindingsDestination = {} } }
      },
      {
        DataIdentifier = [
          ""arn:aws:dataprotection::aws:data-identifier/Credentials""
        ]
        Operation = { Deidentify = { MaskConfig = {} } }
      }
    ]
  })
}
```";"aws logs put-data-protection-policy --log-group-identifier <example_resource_name> --policy-document '{""Statement"":[{""DataIdentifier"":[""arn:aws:dataprotection::aws:data-identifier/Credentials""],""Operation"":{""Audit"":{""FindingsDestination"":{}}}},{""DataIdentifier"":[""arn:aws:dataprotection::aws:data-identifier/Credentials""],""Operation"":{""Deidentify"":{""MaskConfig"":{}}}}]}'";"1. In AWS Console, go to CloudWatch > Logs > Log groups and open <example_resource_name>
2. Select the Data protection tab and click Create policy
3. Under Managed data identifiers, select Credentials (or AwsSecretKey if listed)
4. Click Activate data protection to save
5. Re-ingest or generate new logs to ensure sensitive data is masked";ISO27001-2022: A.8.15, A.8.16 | KISA-ISMS-P-2023: 2.9.4, 2.10.1, 2.10.2 | C5-2025: AM-01.01AC, OPS-11.01AC, OPS-11.02AC, OPS-13.03B, OPS-26.05B, OPS-26.01AS, PSS-04.01B | MITRE-ATTACK: T1552 | KISA-ISMS-P-2023-korean: 2.9.4, 2.10.1, 2.10.2;secrets;;;;5.18.1;https://support.icompaas.com/support/solutions/articles/62000233413-ensure-secrets-are-not-logged-in-cloudwatch-logs | https://awsfundamentals.com/blog/masking-sensitive-data-with-amazon-cloudwatch-logs-data-protection-policies | https://repost.aws/questions/QUermjg18CSMqfSKo4CuTAaA/hide-sensitive-data-in-cloudwatch-logs | https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/mask-sensitive-log-data.html | https://levelup.gitconnected.com/masking-sensitive-data-in-aws-cloudwatch-logs-1b3c66d0ddcb
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_log_group_no_secrets_in_logs-132410971304-ap-northeast-2-/aws/eks/0202_test/cluster;aws;cloudwatch_log_group_no_secrets_in_logs;CloudWatch log group contains no secrets in its log events;Software and Configuration Checks/AWS Security Best Practices/Runtime Behavior Analysis | Sensitive Data Identifications/Passwords | Sensitive Data Identifications/Security | Effects/Data Exposure;PASS;No secrets found in /aws/eks/0202_test/cluster log group.;False;cloudwatch;;medium;Other;arn:aws:logs:ap-northeast-2:132410971304:log-group:/aws/eks/0202_test/cluster:*;/aws/eks/0202_test/cluster;;;aws;ap-northeast-2;**CloudWatch Logs** log groups are analyzed for potential **secrets** embedded in log events across their streams. Detection flags patterns resembling credentials (API keys, passwords, tokens, keys) and reports the secret types and where they appear within the log group.;Leaked **credentials in logs** erode confidentiality and enable unauthorized API calls. Attackers reusing tokens/keys can escalate privileges, alter resources, and exfiltrate data. Subscriptions and exports widen exposure, and users with `logs:Unmask` can reveal values, increasing the blast radius.;;Avoid logging **secrets** via application sanitization and data minimization. Apply CloudWatch data protection policies to audit and mask sensitive patterns. Enforce *least privilege* for log readers and restrict `logs:Unmask`. Rotate exposed keys, reduce retention, and monitor findings to validate controls.;https://hub.prowler.com/check/cloudwatch_log_group_no_secrets_in_logs;"```yaml
# CloudFormation: apply data protection policy to mask secrets in a log group
Resources:
  LogGroup:
    Type: AWS::Logs::LogGroup
    Properties:
      LogGroupName: <example_resource_name>
      # Critical: Enables masking of detected credentials at egress so secrets aren't exposed
      DataProtectionPolicy: |
        {""Statement"":[{""DataIdentifier"":[""arn:aws:dataprotection::aws:data-identifier/Credentials""],""Operation"":{""Audit"":{""FindingsDestination"":{}}}},{""DataIdentifier"":[""arn:aws:dataprotection::aws:data-identifier/Credentials""],""Operation"":{""Deidentify"":{""MaskConfig"":{}}}}]}
```";"```hcl
# Apply a CloudWatch Logs data protection policy to mask secrets
resource ""aws_cloudwatch_log_group"" ""log_group"" {
  name = ""<example_resource_name>""

  # Critical: Masks detected credentials so secrets aren't visible and the check passes
  data_protection_policy = jsonencode({
    Statement = [
      {
        DataIdentifier = [
          ""arn:aws:dataprotection::aws:data-identifier/Credentials""
        ]
        Operation = { Audit = { FindingsDestination = {} } }
      },
      {
        DataIdentifier = [
          ""arn:aws:dataprotection::aws:data-identifier/Credentials""
        ]
        Operation = { Deidentify = { MaskConfig = {} } }
      }
    ]
  })
}
```";"aws logs put-data-protection-policy --log-group-identifier <example_resource_name> --policy-document '{""Statement"":[{""DataIdentifier"":[""arn:aws:dataprotection::aws:data-identifier/Credentials""],""Operation"":{""Audit"":{""FindingsDestination"":{}}}},{""DataIdentifier"":[""arn:aws:dataprotection::aws:data-identifier/Credentials""],""Operation"":{""Deidentify"":{""MaskConfig"":{}}}}]}'";"1. In AWS Console, go to CloudWatch > Logs > Log groups and open <example_resource_name>
2. Select the Data protection tab and click Create policy
3. Under Managed data identifiers, select Credentials (or AwsSecretKey if listed)
4. Click Activate data protection to save
5. Re-ingest or generate new logs to ensure sensitive data is masked";ISO27001-2022: A.8.15, A.8.16 | KISA-ISMS-P-2023: 2.9.4, 2.10.1, 2.10.2 | C5-2025: AM-01.01AC, OPS-11.01AC, OPS-11.02AC, OPS-13.03B, OPS-26.05B, OPS-26.01AS, PSS-04.01B | MITRE-ATTACK: T1552 | KISA-ISMS-P-2023-korean: 2.9.4, 2.10.1, 2.10.2;secrets;;;;5.18.1;https://support.icompaas.com/support/solutions/articles/62000233413-ensure-secrets-are-not-logged-in-cloudwatch-logs | https://awsfundamentals.com/blog/masking-sensitive-data-with-amazon-cloudwatch-logs-data-protection-policies | https://repost.aws/questions/QUermjg18CSMqfSKo4CuTAaA/hide-sensitive-data-in-cloudwatch-logs | https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/mask-sensitive-log-data.html | https://levelup.gitconnected.com/masking-sensitive-data-in-aws-cloudwatch-logs-1b3c66d0ddcb
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_log_group_retention_policy_specific_days_enabled-132410971304-ap-northeast-2-/aws/eks/0201_test/cluster;aws;cloudwatch_log_group_retention_policy_specific_days_enabled;CloudWatch log group has a retention policy of at least the configured minimum days or never expires;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls (USA) | Software and Configuration Checks/Industry and Regulatory Standards/PCI-DSS | Software and Configuration Checks/Industry and Regulatory Standards/SOC 2;PASS;Log Group /aws/eks/0201_test/cluster comply with 365 days retention period since it never expires.;False;cloudwatch;;medium;AwsLogsLogGroup;arn:aws:logs:ap-northeast-2:132410971304:log-group:/aws/eks/0201_test/cluster:*;/aws/eks/0201_test/cluster;;;aws;ap-northeast-2;**CloudWatch Log Groups** are assessed for a retention period at or above the configured threshold (e.g., `365` days) or for being set to **never expire**. Log groups with shorter retention are identified.;Short log retention erodes audit evidence. Adversaries can wait out the window, creating gaps in detection, forensics, and compliance reporting. This degrades the **availability** of historical logs and the **integrity** of incident timelines.;;Define a minimum retention baseline (e.g., `>=365` days) aligned to legal and investigative needs. Apply it consistently with documented exceptions. Automate enforcement, monitor changes, and restrict who can modify retention under **least privilege** and **defense in depth**.;https://hub.prowler.com/check/cloudwatch_log_group_retention_policy_specific_days_enabled;"```yaml
# CloudFormation: set retention on a CloudWatch Log Group
Resources:
  <example_resource_name>:
    Type: AWS::Logs::LogGroup
    Properties:
      LogGroupName: ""<example_resource_name>""
      RetentionInDays: <DAYS>  # Critical: sets log retention to the required minimum to pass the check
```";"```hcl
# Set retention on a CloudWatch Log Group
resource ""aws_cloudwatch_log_group"" ""<example_resource_name>"" {
  name              = ""<example_resource_name>""
  retention_in_days = <DAYS> # Critical: set to at least the required minimum to pass the check
}
```";aws logs put-retention-policy --log-group-name <LOG_GROUP_NAME> --retention-in-days <DAYS>;"1. In the AWS Console, go to CloudWatch > Log groups
2. Select the target log group
3. In the Expire events after/Retention column, click the current value
4. Choose a retention value >= <DAYS> or select Never expire
5. Click Save";AWS-Well-Architected-Framework-Security-Pillar: SEC03-BP06 | ISO27001-2022: A.8.15, A.8.16 | PCI-3.2.1: 10.1, 10.7, 10.7.b, 10.7.c | NIS2: 1.1.1.h, 3.2.3.c, 3.2.5, 4.2.2.f | NIST-800-171-Revision-2: 3_3_1, 3_6_1, 3_6_2 | NIST-800-53-Revision-4: au_11, si_12 | GxP-21-CFR-Part-11: 11.10-c, 11.10-e | NIST-800-53-Revision-5: ac_16_b, au_6_3, au_6_4, au_6_6, au_6_9, au_10, au_11, au_11_1, au_12_1, au_12_2, au_12_3, au_14_a, au_14_b, ca_7_b, pm_14_a_1, pm_14_b, pm_21_b, pm_31, sc_28_2, si_4_17, si_12 | ProwlerThreatScore-1.0: 3.2.2 | KISA-ISMS-P-2023: 2.9.4, 2.10.1, 2.10.2 | FedRamp-Moderate-Revision-4: au-6-1-3, au-11, si-12 | C5-2025: AM-01.01AC, OPS-11.02AC, OPS-14.01B, OPS-14.02B, OPS-26.05B, OPS-26.01AS, PI-03.02B, PSS-04.01B | FedRAMP-Low-Revision-4: au-11 | FFIEC: d2-ma-ma-b-1 | ENS-RD2022: op.exp.8.r3.aws.cw.1 | SOC2: cc_7_2, cc_7_3, cc_c_1_2 | CCC: CCC.Logging.CN02.AR01, CCC.Logging.CN02.AR02 | HIPAA: 164_312_b | RBI-Cyber-Security-Framework: annex_i_7_4 | PCI-4.0: 10.5.1.4, 3.2.1.3, 3.3.1.1.3, 3.3.1.3.3, 3.3.2.3, 3.3.3.3, 5.3.4.11 | KISA-ISMS-P-2023-korean: 2.9.4, 2.10.1, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-mla, ksi-mla-07;logging | forensics-ready;;;;5.18.1;https://trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudWatchLogs/cloudwatch-logs-retention-period.html | https://boto3.amazonaws.com/v1/documentation/api/1.26.93/reference/services/logs/client/put_retention_policy.html | https://medium.com/pareture/aws-cloudwatch-log-group-retention-periods-bb8a2fb9c358 | https://www.blinkops.com/blog/cloudwatch-retention | https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Logs.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_log_group_retention_policy_specific_days_enabled-132410971304-ap-northeast-2-/aws/eks/0202_test/cluster;aws;cloudwatch_log_group_retention_policy_specific_days_enabled;CloudWatch log group has a retention policy of at least the configured minimum days or never expires;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls (USA) | Software and Configuration Checks/Industry and Regulatory Standards/PCI-DSS | Software and Configuration Checks/Industry and Regulatory Standards/SOC 2;PASS;Log Group /aws/eks/0202_test/cluster comply with 365 days retention period since it never expires.;False;cloudwatch;;medium;AwsLogsLogGroup;arn:aws:logs:ap-northeast-2:132410971304:log-group:/aws/eks/0202_test/cluster:*;/aws/eks/0202_test/cluster;;;aws;ap-northeast-2;**CloudWatch Log Groups** are assessed for a retention period at or above the configured threshold (e.g., `365` days) or for being set to **never expire**. Log groups with shorter retention are identified.;Short log retention erodes audit evidence. Adversaries can wait out the window, creating gaps in detection, forensics, and compliance reporting. This degrades the **availability** of historical logs and the **integrity** of incident timelines.;;Define a minimum retention baseline (e.g., `>=365` days) aligned to legal and investigative needs. Apply it consistently with documented exceptions. Automate enforcement, monitor changes, and restrict who can modify retention under **least privilege** and **defense in depth**.;https://hub.prowler.com/check/cloudwatch_log_group_retention_policy_specific_days_enabled;"```yaml
# CloudFormation: set retention on a CloudWatch Log Group
Resources:
  <example_resource_name>:
    Type: AWS::Logs::LogGroup
    Properties:
      LogGroupName: ""<example_resource_name>""
      RetentionInDays: <DAYS>  # Critical: sets log retention to the required minimum to pass the check
```";"```hcl
# Set retention on a CloudWatch Log Group
resource ""aws_cloudwatch_log_group"" ""<example_resource_name>"" {
  name              = ""<example_resource_name>""
  retention_in_days = <DAYS> # Critical: set to at least the required minimum to pass the check
}
```";aws logs put-retention-policy --log-group-name <LOG_GROUP_NAME> --retention-in-days <DAYS>;"1. In the AWS Console, go to CloudWatch > Log groups
2. Select the target log group
3. In the Expire events after/Retention column, click the current value
4. Choose a retention value >= <DAYS> or select Never expire
5. Click Save";AWS-Well-Architected-Framework-Security-Pillar: SEC03-BP06 | ISO27001-2022: A.8.15, A.8.16 | PCI-3.2.1: 10.1, 10.7, 10.7.b, 10.7.c | NIS2: 1.1.1.h, 3.2.3.c, 3.2.5, 4.2.2.f | NIST-800-171-Revision-2: 3_3_1, 3_6_1, 3_6_2 | NIST-800-53-Revision-4: au_11, si_12 | GxP-21-CFR-Part-11: 11.10-c, 11.10-e | NIST-800-53-Revision-5: ac_16_b, au_6_3, au_6_4, au_6_6, au_6_9, au_10, au_11, au_11_1, au_12_1, au_12_2, au_12_3, au_14_a, au_14_b, ca_7_b, pm_14_a_1, pm_14_b, pm_21_b, pm_31, sc_28_2, si_4_17, si_12 | ProwlerThreatScore-1.0: 3.2.2 | KISA-ISMS-P-2023: 2.9.4, 2.10.1, 2.10.2 | FedRamp-Moderate-Revision-4: au-6-1-3, au-11, si-12 | C5-2025: AM-01.01AC, OPS-11.02AC, OPS-14.01B, OPS-14.02B, OPS-26.05B, OPS-26.01AS, PI-03.02B, PSS-04.01B | FedRAMP-Low-Revision-4: au-11 | FFIEC: d2-ma-ma-b-1 | ENS-RD2022: op.exp.8.r3.aws.cw.1 | SOC2: cc_7_2, cc_7_3, cc_c_1_2 | CCC: CCC.Logging.CN02.AR01, CCC.Logging.CN02.AR02 | HIPAA: 164_312_b | RBI-Cyber-Security-Framework: annex_i_7_4 | PCI-4.0: 10.5.1.4, 3.2.1.3, 3.3.1.1.3, 3.3.1.3.3, 3.3.2.3, 3.3.3.3, 5.3.4.11 | KISA-ISMS-P-2023-korean: 2.9.4, 2.10.1, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-mla, ksi-mla-07;logging | forensics-ready;;;;5.18.1;https://trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudWatchLogs/cloudwatch-logs-retention-period.html | https://boto3.amazonaws.com/v1/documentation/api/1.26.93/reference/services/logs/client/put_retention_policy.html | https://medium.com/pareture/aws-cloudwatch-log-group-retention-periods-bb8a2fb9c358 | https://www.blinkops.com/blog/cloudwatch-retention | https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/AWS_Logs.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_log_metric_filter_and_alarm_for_aws_config_configuration_changes_enabled-132410971304-ap-northeast-2-132410971304;aws;cloudwatch_log_metric_filter_and_alarm_for_aws_config_configuration_changes_enabled;CloudWatch Logs metric filter and alarm exist for AWS Config configuration changes;Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Software and Configuration Checks/AWS Security Best Practices/Runtime Behavior Analysis | TTPs/Defense Evasion;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;False;cloudwatch;;medium;AwsCloudWatchAlarm;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;;;aws;ap-northeast-2;CloudTrail logs in **CloudWatch Logs** are inspected for a metric filter and alarm that track **AWS Config configuration changes**, specifically `StopConfigurationRecorder`, `DeleteDeliveryChannel`, `PutDeliveryChannel`, and `PutConfigurationRecorder` events from `config.amazonaws.com`.;"Without alerting on **AWS Config changes**, actions like `StopConfigurationRecorder` or `DeleteDeliveryChannel` can silently suspend recording and delivery.

This degrades the **integrity** and **availability** of configuration audit data, enabling undetected changes and delaying incident response.";;Create a **CloudWatch Logs metric filter and alarm** for `config.amazonaws.com` events (`StopConfigurationRecorder`, `DeleteDeliveryChannel`, `PutDeliveryChannel`, `PutConfigurationRecorder`). Route CloudTrail to Logs, notify responders, and enforce **least privilege** and **separation of duties** on Config changes to prevent abuse.;https://hub.prowler.com/check/cloudwatch_log_metric_filter_and_alarm_for_aws_config_configuration_changes_enabled;"```yaml
# CloudFormation: Create metric filter and alarm for AWS Config changes
Resources:
  ConfigChangeMetricFilter:
    Type: AWS::Logs::MetricFilter
    Properties:
      LogGroupName: <example_resource_name>
      FilterPattern: ""{($.eventSource = config.amazonaws.com) && (($.eventName=StopConfigurationRecorder)||($.eventName=DeleteDeliveryChannel)||($.eventName=PutDeliveryChannel)||($.eventName=PutConfigurationRecorder))}""  # Critical: detects AWS Config configuration change events
      MetricTransformations:
        - MetricName: aws_config_changes_metric  # Critical: metric used by the alarm
          MetricNamespace: CISBenchmark
          MetricValue: ""1""

  ConfigChangeAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties:
      AlarmName: aws_config_changes_alarm
      MetricName: aws_config_changes_metric  # Critical: ties alarm to the metric filter
      Namespace: CISBenchmark
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      Period: 300
      Statistic: Sum
      Threshold: 1  # Critical: alarm on first occurrence
```";"```hcl
# CloudWatch Logs metric filter for AWS Config changes
resource ""aws_cloudwatch_log_metric_filter"" ""config_change"" {
  name           = ""aws_config_changes_metric""
  log_group_name = ""<example_resource_name>""
  pattern        = ""{($.eventSource = config.amazonaws.com) && (($.eventName=StopConfigurationRecorder)||($.eventName=DeleteDeliveryChannel)||($.eventName=PutDeliveryChannel)||($.eventName=PutConfigurationRecorder))}"" # Critical: detects AWS Config configuration change events

  metric_transformation {
    name      = ""aws_config_changes_metric""   # Critical: metric used by the alarm
    namespace = ""CISBenchmark""
    value     = ""1""
  }
}

# Alarm for the above metric
resource ""aws_cloudwatch_metric_alarm"" ""config_change"" {
  alarm_name          = ""aws_config_changes_alarm""
  metric_name         = ""aws_config_changes_metric""   # Critical: ties alarm to the metric filter
  namespace           = ""CISBenchmark""
  comparison_operator = ""GreaterThanOrEqualToThreshold""
  evaluation_periods  = 1
  period              = 300
  statistic           = ""Sum""
  threshold           = 1  # Critical: alarm on first occurrence
}
```";;"1. Open the CloudWatch console and go to Logs > Log groups
2. Select the CloudTrail log group that receives trail events
3. Create a metric filter with pattern:
   {($.eventSource = config.amazonaws.com) && (($.eventName=StopConfigurationRecorder)||($.eventName=DeleteDeliveryChannel)||($.eventName=PutDeliveryChannel)||($.eventName=PutConfigurationRecorder))}
   - Metric name: aws_config_changes_metric
   - Namespace: CISBenchmark
   - Value: 1
4. From the created metric filter, choose Create alarm
5. Set: Sum, Period 5 minutes, Threshold >= 1, Evaluation periods 1
6. Create the alarm (actions/notifications optional)";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP04 | ISO27001-2022: A.8.15, A.8.16 | CIS-1.5: 4.9 | NIS2: 2.2.3, 3.2.3.c, 3.2.3.f, 3.2.3.g, 3.5.4, 7.2.b | NIST-CSF-2.0: ov_3, ra_5, ip_8, pt_1, ae_1, ae_2, ae_3, cm_1, cm_7, dp_4 | CIS-5.0: 4.9 | GDPR: article_25 | ProwlerThreatScore-1.0: 3.3.10 | KISA-ISMS-P-2023: 2.10.1, 2.10.2, 2.11.3 | CIS-1.4: 4.9 | C5-2025: OIS-04.03B, OIS-04.01AC, OIS-04.02AC, HR-03.02AC, AM-01.01AC, AM-09.03AC, OPS-11.02AC, OPS-13.03AC, OPS-26.05B, OPS-26.01AS, OPS-26.06B, PSS-04.01B | SOC2: cc_5_2 | NIST-CSF-1.1: cm_2, ra_5, sc_4 | ISO27001-2013: A.12.4.F | CIS-4.0.1: 4.9 | CIS-2.0: 4.9 | CCC: CCC.Logging.CN01.AR02, CCC.Monitor.CN02.AR01, CCC.Core.CN04.AR01 | CIS-3.0: 4.9 | MITRE-ATTACK: T1496 | KISA-ISMS-P-2023-korean: 2.10.1, 2.10.2, 2.11.3 | FedRAMP-20x-KSI-Low-25.05C: ksi-cmt;logging;;;Logging and Monitoring;5.18.1;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_log_metric_filter_and_alarm_for_cloudtrail_configuration_changes_enabled-132410971304-ap-northeast-2-132410971304;aws;cloudwatch_log_metric_filter_and_alarm_for_cloudtrail_configuration_changes_enabled;CloudWatch Logs metric filter and alarm exist for CloudTrail configuration changes;Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Software and Configuration Checks/AWS Security Best Practices | TTPs/Defense Evasion;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;False;cloudwatch;;medium;AwsCloudWatchAlarm;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;;;aws;ap-northeast-2;"**CloudTrail logs** include a **metric filter** for trail configuration events (`CreateTrail`, `UpdateTrail`, `DeleteTrail`, `StartLogging`, `StopLogging`) with an associated **CloudWatch alarm** to alert on matches.

Evaluates the presence of this filter-and-alarm monitoring.";"Absent this monitoring, logging can be stopped or altered without notice, eroding visibility.

That enables covert activity and data exfiltration without audit evidence, harming confidentiality, the integrity of records, and the availability of reliable logs for detection and forensics.";;"Implement a **metric filter** for trail configuration events and a linked **alarm** that notifies response channels.

Apply **least privilege** and **separation of duties** for trail changes, add **defense in depth** with centralized logging and validation, and regularly test that alerts fire.";https://hub.prowler.com/check/cloudwatch_log_metric_filter_and_alarm_for_cloudtrail_configuration_changes_enabled;"```yaml
Resources:
  CloudTrailCfgMetricFilter:
    Type: AWS::Logs::MetricFilter
    Properties:
      LogGroupName: <example_resource_name> # CRITICAL: CloudTrail log group to monitor
      FilterPattern: ""{($.eventName = CreateTrail) || ($.eventName = UpdateTrail) || ($.eventName = DeleteTrail) || ($.eventName = StartLogging) || ($.eventName = StopLogging)}"" # CRITICAL: Detects CloudTrail config changes
      MetricTransformations:
        - MetricName: <example_resource_name>  # CRITICAL: Metric created by the filter
          MetricNamespace: <example_resource_name>
          MetricValue: ""1""

  CloudTrailCfgAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties:
      MetricName: <example_resource_name>      # CRITICAL: Alarm uses metric from filter
      Namespace: <example_resource_name>
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      Period: 300
      Statistic: Sum
      Threshold: 1
```";"```hcl
resource ""aws_cloudwatch_log_metric_filter"" ""cfg"" {
  name           = ""<example_resource_name>""
  log_group_name = ""<example_resource_name>"" # CRITICAL: CloudTrail log group
  pattern        = ""{($.eventName = CreateTrail) || ($.eventName = UpdateTrail) || ($.eventName = DeleteTrail) || ($.eventName = StartLogging) || ($.eventName = StopLogging)}"" # CRITICAL: Detects CloudTrail config changes

  metric_transformation {
    name      = ""<example_resource_name>""   # CRITICAL: Metric created by filter
    namespace = ""<example_resource_name>""
    value     = ""1""
  }
}

resource ""aws_cloudwatch_metric_alarm"" ""cfg"" {
  metric_name         = ""<example_resource_name>"" # CRITICAL: Uses metric from filter
  namespace           = ""<example_resource_name>""
  comparison_operator = ""GreaterThanOrEqualToThreshold""
  evaluation_periods  = 1
  period              = 300
  statistic           = ""Sum""
  threshold           = 1
}
```";;"1. In the AWS Console, go to CloudWatch > Log groups and open the log group used by CloudTrail
2. Create metric filter: Actions > Create metric filter
   - Filter pattern: {($.eventName = CreateTrail) || ($.eventName = UpdateTrail) || ($.eventName = DeleteTrail) || ($.eventName = StartLogging) || ($.eventName = StopLogging)}
   - Metric name: <example_resource_name>, Namespace: <example_resource_name>, Value: 1
   - Create metric filter
3. From the Metric filters tab, select the new filter and choose Create alarm
   - Threshold: Greater/Equal 1, Period: 5 minutes, Evaluation periods: 1
   - Create alarm";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP04 | ISO27001-2022: A.8.15, A.8.16 | CIS-1.5: 4.5 | NIS2: 2.2.3, 3.2.3.c, 3.2.3.f, 3.2.3.g, 3.2.4, 3.5.4, 7.2.b | NIST-CSF-2.0: ov_3, ra_5, ip_8, pt_1, ae_1, ae_2, ae_3, cm_1, cm_3, cm_7, dp_4 | CISA: your-data-2 | CIS-5.0: 4.5 | GDPR: article_25 | ProwlerThreatScore-1.0: 3.3.6 | KISA-ISMS-P-2023: 2.10.1, 2.10.2, 2.11.3 | CIS-1.4: 4.5 | C5-2025: OIS-04.03B, OIS-04.01AC, OIS-04.02AC, HR-03.02AC, AM-01.01AC, AM-09.03AC, OPS-11.02AC, OPS-13.03AC, OPS-26.05B, OPS-26.01AS, OPS-26.06B, SIM-03.07B, COM-04.01AC, PSS-04.01B | ENS-RD2022: op.exp.8.aws.ct.2, op.exp.8.r1.aws.ct.2, op.exp.8.r1.aws.ct.3 | SOC2: cc_5_2 | NIST-CSF-1.1: cm_2, ra_5, sc_4 | ISO27001-2013: A.12.4.J | CIS-4.0.1: 4.5 | CIS-2.0: 4.5 | CCC: CCC.AuditLog.CN03.AR01, CCC.AuditLog.CN03.AR02, CCC.LB.CN04.AR01, CCC.Logging.CN01.AR02, CCC.Logging.CN07.AR01, CCC.Monitor.CN01.AR01, CCC.Monitor.CN02.AR01, CCC.Core.CN09.AR02, CCC.Core.CN09.AR03, CCC.Core.CN04.AR01, CCC.Core.CN04.AR03 | CIS-3.0: 4.5 | MITRE-ATTACK: T1496 | AWS-Account-Security-Onboarding: Critical alert on cloudtrail settings changes | KISA-ISMS-P-2023-korean: 2.10.1, 2.10.2, 2.11.3 | FedRAMP-20x-KSI-Low-25.05C: ksi-cmt;logging;;;Logging and Monitoring;5.18.1;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html | https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_5 | https://docs.prowler.com/checks/aws/monitoring-policies/monitoring_5#fix---buildtime
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_log_metric_filter_authentication_failures-132410971304-ap-northeast-2-132410971304;aws;cloudwatch_log_metric_filter_authentication_failures;Account has a CloudWatch Logs metric filter and alarm for AWS Management Console authentication failures;Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/AWS Security Best Practices/Runtime Behavior Analysis | TTPs/Initial Access | TTPs/Credential Access;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;False;cloudwatch;;medium;AwsCloudWatchAlarm;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;;;aws;ap-northeast-2;"CloudWatch Logs metric filter and alarm for **AWS Management Console authentication failures**, sourced from CloudTrail (`eventName=ConsoleLogin`, `errorMessage=""Failed authentication""`).

Identifies whether these failures are converted into a metric and actively monitored by an alarm.";"Absent visibility into failed console logins enables undetected **brute-force** and **credential-stuffing** attempts, extending attacker dwell time.

Successful guesses can grant console access, risking data confidentiality, configuration integrity, and availability through destructive changes.";;"Implement a log metric filter for `ConsoleLogin` failures and attach a **CloudWatch alarm** with actionable notifications. Tune thresholds to reduce noise and route alerts to incident response.

Apply **least privilege** and enforce **MFA** to limit impact, and correlate alerts with source IP and user context.";https://hub.prowler.com/check/cloudwatch_log_metric_filter_authentication_failures;"```yaml
# CloudFormation: Metric filter and alarm for console authentication failures
Resources:
  MetricFilter:
    Type: AWS::Logs::MetricFilter
    Properties:
      LogGroupName: ""<example_resource_name>""
      FilterPattern: '{ ($.eventName = ConsoleLogin) && ($.errorMessage = ""Failed authentication"") }'  # Critical: matches failed console login events
      MetricTransformations:
        - MetricValue: ""1""
          MetricNamespace: ""<example_resource_name>""  # Critical: creates metric namespace
          MetricName: ""<example_resource_name>""       # Critical: creates metric name

  Alarm:
    Type: AWS::CloudWatch::Alarm
    Properties:
      MetricName: ""<example_resource_name>""   # Critical: alarm targets metric from filter
      Namespace: ""<example_resource_name>""    # Critical: must match metric's namespace
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      Period: 300
      Statistic: Sum
      Threshold: 1
```";"```hcl
# Metric filter and alarm for console authentication failures
resource ""aws_cloudwatch_log_metric_filter"" ""metric"" {
  name           = ""<example_resource_name>""
  log_group_name = ""<example_resource_name>""
  pattern        = ""{($.eventName = ConsoleLogin) && ($.errorMessage = \""Failed authentication\"") }"" # Critical: detects failed console logins

  metric_transformation {
    name      = ""<example_resource_name>""   # Critical: metric created by filter
    namespace = ""<example_resource_name>""   # Critical: metric namespace
    value     = ""1""
  }
}

resource ""aws_cloudwatch_metric_alarm"" ""alarm"" {
  metric_name          = aws_cloudwatch_log_metric_filter.metric.metric_transformation[0].name   # Critical: alarm references the filter's metric
  namespace            = aws_cloudwatch_log_metric_filter.metric.metric_transformation[0].namespace # Critical: must match
  comparison_operator  = ""GreaterThanOrEqualToThreshold""
  evaluation_periods   = 1
  period               = 300
  statistic            = ""Sum""
  threshold            = 1
}
```";;"1. In the AWS Console, open CloudWatch
2. Go to Logs > Log groups and select the CloudTrail log group receiving events
3. Open the Metric filters tab > Create metric filter
   - Filter pattern: { ($.eventName = ConsoleLogin) && ($.errorMessage = ""Failed authentication"") }
   - Assign any metric name and namespace, value 1, then create
4. On the created metric filter, select it and choose Create alarm
   - Statistic: Sum, Period: 5 minutes, Threshold type: Static, Threshold: >= 1
   - Create the alarm";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP04 | ISO27001-2022: A.8.15, A.8.16 | CIS-1.5: 4.6 | NIS2: 3.2.3.c, 3.2.3.d, 3.2.3.g, 3.5.4, 7.2.b | NIST-CSF-2.0: ra_5, ip_7, ip_8, pt_1, ae_2, cm_1, cm_3, cm_7, dp_4 | CIS-5.0: 4.6 | GDPR: article_25 | ProwlerThreatScore-1.0: 3.3.7 | KISA-ISMS-P-2023: 2.10.1, 2.10.2, 2.11.3 | CIS-1.4: 4.6 | C5-2025: OIS-04.01AC, OIS-04.02AC, HR-03.02AC, AM-01.01AC, AM-09.03AC, OPS-11.02AC, OPS-26.05B, OPS-26.01AS, OPS-26.06B, IAM-03.01AC, PSS-04.01B | ENS-RD2022: op.exp.8.aws.ct.5 | SOC2: pi_1_3 | NIST-CSF-1.1: cm_2, ra_5, sc_4 | ISO27001-2013: A.12.4.I | CIS-4.0.1: 4.6 | CIS-2.0: 4.6 | CCC: CCC.Monitor.CN02.AR01, CCC.Core.CN04.AR01, CCC.Core.CN04.AR03 | HIPAA: 164_308_a_5_ii_c, 164_308_a_6_i, 164_308_a_6_ii | CIS-3.0: 4.6 | MITRE-ATTACK: T1496 | AWS-Account-Security-Onboarding: Alert on rise of ConsoleLoginFailures events | KISA-ISMS-P-2023-korean: 2.10.1, 2.10.2, 2.11.3;logging;;;Logging and Monitoring;5.18.1;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html | https://www.intelligentdiscovery.io/controls/cloudwatch/cloudwatch-alarm-signin-failures | https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudWatchLogs/console-sign-in-failures-alarm.html | https://newsletter.simpleaws.dev/p/cloudtrail-cloudwatch-logs-login-detection-alert
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_log_metric_filter_aws_organizations_changes-132410971304-ap-northeast-2-132410971304;aws;cloudwatch_log_metric_filter_aws_organizations_changes;CloudWatch Logs metric filter and alarm exist for AWS Organizations changes;Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Software and Configuration Checks/AWS Security Best Practices/Runtime Behavior Analysis | TTPs/Privilege Escalation;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;False;cloudwatch;;medium;AwsCloudWatchAlarm;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;;;aws;ap-northeast-2;"**CloudWatch Logs** metric filters and alarms monitor **AWS Organizations** change events recorded by CloudTrail, including actions like `CreateAccount`, `AttachPolicy`, `MoveAccount`, and `UpdateOrganizationalUnit`.

The evaluation looks for a filter on the trail log group matching `organizations.amazonaws.com` events and an alarm linked to that metric.";Without alerting on **AWS Organizations changes**, attackers or misconfigurations can silently alter governance, enabling unauthorized access and policy bypass. They could create/remove accounts, change or detach SCPs, or delete the organization, risking data exposure (C), privilege escalation (I), and service disruption (A).;;Send CloudTrail events to **CloudWatch Logs**, add a metric filter for `organizations.amazonaws.com` change events, and attach an alarm that notifies responders. Enforce **least privilege** and **separation of duties** for org admins, require MFA and approvals, and regularly test alerts to ensure timely detection and response.;https://hub.prowler.com/check/cloudwatch_log_metric_filter_aws_organizations_changes;"```yaml
# CloudFormation: CloudWatch Logs metric filter and alarm for AWS Organizations changes
Resources:
  OrganizationsChangesMetricFilter:
    Type: AWS::Logs::MetricFilter
    Properties:
      LogGroupName: <example_log_group_name>
      FilterPattern: '{ ($.eventSource = organizations.amazonaws.com) && (($.eventName = ""AcceptHandshake"") || ($.eventName = ""AttachPolicy"") || ($.eventName = ""CancelHandshake"") || ($.eventName = ""CreateAccount"") || ($.eventName = ""CreateOrganization"") || ($.eventName = ""CreateOrganizationalUnit"") || ($.eventName = ""CreatePolicy"") || ($.eventName = ""DeclineHandshake"") || ($.eventName = ""DeleteOrganization"") || ($.eventName = ""DeleteOrganizationalUnit"") || ($.eventName = ""DeletePolicy"") || ($.eventName = ""EnableAllFeatures"") || ($.eventName = ""EnablePolicyType"") || ($.eventName = ""InviteAccountToOrganization"") || ($.eventName = ""LeaveOrganization"") || ($.eventName = ""DetachPolicy"") || ($.eventName = ""DisablePolicyType"") || ($.eventName = ""MoveAccount"") || ($.eventName = ""RemoveAccountFromOrganization"") || ($.eventName = ""UpdateOrganizationalUnit"") || ($.eventName = ""UpdatePolicy"")) }'  # Critical: matches AWS Organizations change events
      MetricTransformations:
        - MetricValue: ""1""
          MetricNamespace: CISBenchmark
          MetricName: <example_resource_name>  # Critical: creates metric used by the alarm

  OrganizationsChangesAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties:
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: <example_resource_name>   # Critical: alarms on the metric from the filter
      Namespace: CISBenchmark               # Critical: must match the metric filter namespace
      Period: 300
      Statistic: Sum
      Threshold: 1
```";"```hcl
# CloudWatch Logs metric filter for AWS Organizations changes
resource ""aws_cloudwatch_log_metric_filter"" ""organizations_changes"" {
  name           = ""<example_resource_name>""
  log_group_name = ""<example_log_group_name>""
  pattern        = ""{ ($.eventSource = organizations.amazonaws.com) && (($.eventName = \""AcceptHandshake\"") || ($.eventName = \""AttachPolicy\"") || ($.eventName = \""CancelHandshake\"") || ($.eventName = \""CreateAccount\"") || ($.eventName = \""CreateOrganization\"") || ($.eventName = \""CreateOrganizationalUnit\"") || ($.eventName = \""CreatePolicy\"") || ($.eventName = \""DeclineHandshake\"") || ($.eventName = \""DeleteOrganization\"") || ($.eventName = \""DeleteOrganizationalUnit\"") || ($.eventName = \""DeletePolicy\"") || ($.eventName = \""EnableAllFeatures\"") || ($.eventName = \""EnablePolicyType\"") || ($.eventName = \""InviteAccountToOrganization\"") || ($.eventName = \""LeaveOrganization\"") || ($.eventName = \""DetachPolicy\"") || ($.eventName = \""DisablePolicyType\"") || ($.eventName = \""MoveAccount\"") || ($.eventName = \""RemoveAccountFromOrganization\"") || ($.eventName = \""UpdateOrganizationalUnit\"") || ($.eventName = \""UpdatePolicy\"")) }""  # Critical: matches AWS Organizations change events

  metric_transformation {
    name      = ""<example_resource_name>""   # Critical: metric created by the filter
    namespace = ""CISBenchmark""              # Critical: used by the alarm
    value     = ""1""
  }
}

# Alarm on the metric generated by the filter
resource ""aws_cloudwatch_metric_alarm"" ""organizations_changes"" {
  alarm_name          = ""<example_resource_name>""
  comparison_operator = ""GreaterThanOrEqualToThreshold""
  evaluation_periods  = 1
  metric_name         = ""<example_resource_name>""  # Critical: matches metric filter name
  namespace           = ""CISBenchmark""             # Critical: matches metric filter namespace
  period              = 300
  statistic           = ""Sum""
  threshold           = 1
}
```";;"1. Open CloudWatch > Logs > Log groups and select the CloudTrail log group for your trail
2. Choose Create metric filter and set Filter pattern to:
   { ($.eventSource = organizations.amazonaws.com) && (($.eventName = ""AcceptHandshake"") || ($.eventName = ""AttachPolicy"") || ($.eventName = ""CancelHandshake"") || ($.eventName = ""CreateAccount"") || ($.eventName = ""CreateOrganization"") || ($.eventName = ""CreateOrganizationalUnit"") || ($.eventName = ""CreatePolicy"") || ($.eventName = ""DeclineHandshake"") || ($.eventName = ""DeleteOrganization"") || ($.eventName = ""DeleteOrganizationalUnit"") || ($.eventName = ""DeletePolicy"") || ($.eventName = ""EnableAllFeatures"") || ($.eventName = ""EnablePolicyType"") || ($.eventName = ""InviteAccountToOrganization"") || ($.eventName = ""LeaveOrganization"") || ($.eventName = ""DetachPolicy"") || ($.eventName = ""DisablePolicyType"") || ($.eventName = ""MoveAccount"") || ($.eventName = ""RemoveAccountFromOrganization"") || ($.eventName = ""UpdateOrganizationalUnit"") || ($.eventName = ""UpdatePolicy"")) }
3. Assign a metric: Namespace = CISBenchmark, Metric name = OrganizationsChanges, Metric value = 1, then Create metric filter
4. On the metric filter, select Create alarm; set Statistic = Sum, Period = 5 minutes, Threshold type = Static, Threshold = 1, Evaluation periods = 1; Create alarm";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP04 | ISO27001-2022: A.8.15, A.8.16 | CIS-1.5: 4.15 | NIS2: 2.2.3, 3.2.2, 3.2.3.b, 3.2.3.c, 3.2.3.f, 3.2.3.g, 3.5.4, 7.2.b, 11.5.2.d | NIST-CSF-2.0: ae_3, cm_7 | CIS-5.0: 4.15 | ProwlerThreatScore-1.0: 3.3.16 | KISA-ISMS-P-2023: 2.10.1, 2.10.2, 2.11.3 | CIS-1.4: 4.15 | C5-2025: OIS-04.03B, OIS-04.01AC, OIS-04.02AC, HR-03.02AC, AM-01.01AC, AM-09.03AC, OPS-11.02AC, OPS-26.05B, OPS-26.01AS, OPS-26.06B, PSS-04.01B | SOC2: cc_5_2 | CIS-4.0.1: 4.15 | CIS-2.0: 4.15 | CCC: CCC.AuditLog.CN03.AR02 | CIS-3.0: 4.15 | MITRE-ATTACK: T1496 | KISA-ISMS-P-2023-korean: 2.10.1, 2.10.2, 2.11.3 | FedRAMP-20x-KSI-Low-25.05C: ksi-cmt;logging;;;Logging and Monitoring;5.18.1;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html | https://support.icompaas.com/support/solutions/articles/62000228348-ensure-a-log-metric-filter-and-alarm-exist-for-aws-organizations-changes | https://www.plerion.com/cloud-knowledge-base/ensure-aws-organizations-changes-are-monitored | https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudWatchLogs/organizations-changes-alarm.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_log_metric_filter_disable_or_scheduled_deletion_of_kms_cmk-132410971304-ap-northeast-2-132410971304;aws;cloudwatch_log_metric_filter_disable_or_scheduled_deletion_of_kms_cmk;Account has a CloudWatch log metric filter and alarm for disabling or scheduled deletion of customer-managed KMS keys;Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Software and Configuration Checks/AWS Security Best Practices | Effects/Denial of Service;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;False;cloudwatch;;medium;AwsCloudWatchAlarm;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;;;aws;ap-northeast-2;CloudTrail events delivered to CloudWatch are evaluated for a **metric filter and alarm** that monitor **KMS CMK state changes**, specifically `DisableKey` and `ScheduleKeyDeletion` from `kms.amazonaws.com`.;Missing alerts on **CMK disablement or scheduled deletion** undermines **availability** and **integrity**: encrypted data may become undecryptable, backups unusable, and recovery impossible. Attackers or insiders can change key states unnoticed, causing outages and irreversible data loss.;;"Establish **CloudWatch metric filters and alarms** for `DisableKey` and `ScheduleKeyDeletion` CloudTrail events to enable rapid response.
- Apply **least privilege** to KMS administration
- Enforce **change control** and separation of duties
- Use deletion waiting periods and monitor all regions";https://hub.prowler.com/check/cloudwatch_log_metric_filter_disable_or_scheduled_deletion_of_kms_cmk;"```yaml
# CloudFormation: Metric filter and alarm for KMS key disable/deletion
Resources:
  MetricFilter:
    Type: AWS::Logs::MetricFilter
    Properties:
      LogGroupName: <example_resource_name>
      # CRITICAL: Detect KMS DisableKey or ScheduleKeyDeletion events from CloudTrail logs
      # This pattern is what the check looks for
      FilterPattern: '{($.eventSource = kms.amazonaws.com) && (($.eventName=DisableKey)||($.eventName=ScheduleKeyDeletion)) }'
      MetricTransformations:
        - MetricValue: ""1""
          MetricNamespace: CISBenchmark
          MetricName: disable_or_delete_cmk_changes_metric

  Alarm:
    Type: AWS::CloudWatch::Alarm
    Properties:
      # CRITICAL: Alarm on the metric created by the filter above
      MetricName: disable_or_delete_cmk_changes_metric
      Namespace: CISBenchmark
      Statistic: Sum
      Period: 300
      EvaluationPeriods: 1
      Threshold: 1
      ComparisonOperator: GreaterThanOrEqualToThreshold
```";"```hcl
# Metric filter for KMS DisableKey or ScheduleKeyDeletion
resource ""aws_cloudwatch_log_metric_filter"" ""cmk"" {
  name           = ""<example_resource_name>""
  log_group_name = ""<example_resource_name>"" # CRITICAL: CloudTrail log group
  # CRITICAL: Detect KMS key disable or scheduled deletion events
  pattern = ""{($.eventSource = kms.amazonaws.com) && (($.eventName=DisableKey)||($.eventName=ScheduleKeyDeletion)) }""

  metric_transformation {
    name      = ""disable_or_delete_cmk_changes_metric"" # CRITICAL: metric used by alarm
    namespace = ""CISBenchmark""
    value     = ""1""
  }
}

# Alarm for the metric above
resource ""aws_cloudwatch_metric_alarm"" ""cmk"" {
  alarm_name          = ""<example_resource_name>""
  comparison_operator = ""GreaterThanOrEqualToThreshold""
  evaluation_periods  = 1
  metric_name         = ""disable_or_delete_cmk_changes_metric"" # CRITICAL: same metric name
  namespace           = ""CISBenchmark""
  period              = 300
  statistic           = ""Sum""
  threshold           = 1
}
```";;"1. Open the AWS Console and go to CloudWatch > Log groups
2. Select the CloudTrail log group that receives your trail events
3. Choose Create metric filter
4. In Filter pattern, paste: {($.eventSource = kms.amazonaws.com) && (($.eventName=DisableKey)||($.eventName=ScheduleKeyDeletion)) }
5. Name the metric (e.g., disable_or_delete_cmk_changes_metric), set Namespace to CISBenchmark, Value to 1, then Create
6. From the Metric filters tab, select the new filter and click Create alarm
7. Set Statistic: Sum, Period: 5 minutes, Threshold type: Static, Threshold: 1, Comparison: Greater/Equal
8. Create the alarm (notification actions optional and not required for pass)";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP04 | ISO27001-2022: A.8.15, A.8.16 | CIS-1.5: 4.7 | NIS2: 3.2.3.c, 3.2.3.g, 3.5.4, 7.2.b | NIST-CSF-2.0: ae_2, cm_7 | CIS-5.0: 4.7 | GDPR: article_25 | ProwlerThreatScore-1.0: 3.3.8 | KISA-ISMS-P-2023: 2.10.1, 2.10.2, 2.11.3 | CIS-1.4: 4.7 | C5-2025: OIS-04.02AC, OIS-08.02B, HR-03.02AC, AM-01.01AC, AM-07.02B, AM-09.03AC, OPS-11.02AC, OPS-26.05B, OPS-26.01AS, OPS-26.06B, CRY-05.02B, PSS-04.01B | ENS-RD2022: op.exp.10.aws.cmk.4, op.exp.10.aws.cmk.5 | NIST-CSF-1.1: cm_2, ra_5, sc_4 | ISO27001-2013: A.10.1.C, A.12.4.H | CIS-4.0.1: 4.7 | CIS-2.0: 4.7 | CCC: CCC.AuditLog.CN03.AR02, CCC.Core.CN04.AR01 | CIS-3.0: 4.7 | MITRE-ATTACK: T1485, T1496 | KISA-ISMS-P-2023-korean: 2.10.1, 2.10.2, 2.11.3;logging;;;Logging and Monitoring;5.18.1;https://docs.aws.amazon.com/kms/latest/developerguide/deleting-keys-creating-cloudwatch-alarm.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_log_metric_filter_for_s3_bucket_policy_changes-132410971304-ap-northeast-2-132410971304;aws;cloudwatch_log_metric_filter_for_s3_bucket_policy_changes;CloudWatch log metric filter and alarm exist for S3 bucket policy changes;Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Software and Configuration Checks/AWS Security Best Practices/Runtime Behavior Analysis;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;False;cloudwatch;;medium;AwsCloudWatchAlarm;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;;;aws;ap-northeast-2;"**CloudTrail** logs are assessed for a **CloudWatch metric filter** matching S3 bucket configuration changes (ACL, policy, CORS, lifecycle, replication; e.g., `PutBucketPolicy`, `DeleteBucketPolicy`) and for an associated **CloudWatch alarm**.";Without alerting on S3 policy and ACL changes, unauthorized modifications can go unnoticed, weakening **confidentiality** and **integrity**. Misuse could expose buckets publicly, grant write/delete access, or alter replication paths, enabling data exfiltration and destructive actions.;;Establish and maintain **metric filters** and **alarms** for S3 bucket policy, ACL, CORS, lifecycle, and replication changes. Route alerts to monitored channels and integrate with SIEM. Enforce **least privilege**, require change reviews, and use **defense in depth** to prevent and quickly detect unsafe bucket policy changes.;https://hub.prowler.com/check/cloudwatch_log_metric_filter_for_s3_bucket_policy_changes;"```yaml
# CloudFormation: CloudWatch metric filter and alarm for S3 bucket policy changes
Resources:
  <example_resource_name>MetricFilter:
    Type: AWS::Logs::MetricFilter
    Properties:
      LogGroupName: <example_resource_name>  # Critical: CloudTrail log group to monitor
      FilterPattern: '{($.eventSource=s3.amazonaws.com) && (($.eventName=PutBucketAcl) || ($.eventName=PutBucketPolicy) || ($.eventName=PutBucketCors) || ($.eventName=PutBucketLifecycle) || ($.eventName=PutBucketReplication) || ($.eventName=DeleteBucketPolicy) || ($.eventName=DeleteBucketCors) || ($.eventName=DeleteBucketLifecycle) || ($.eventName=DeleteBucketReplication))}'  # Critical: detects S3 bucket policy changes
      MetricTransformations:
        - MetricName: <example_resource_name>
          MetricNamespace: <example_resource_name>
          MetricValue: ""1""

  <example_resource_name>Alarm:
    Type: AWS::CloudWatch::Alarm
    Properties:
      AlarmName: <example_resource_name>
      Namespace: <example_resource_name>   # Critical: must match metric filter
      MetricName: <example_resource_name>  # Critical: must match metric filter
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      Period: 300
      Statistic: Sum
      Threshold: 1
```";"```hcl
# CloudWatch metric filter for S3 bucket policy changes
resource ""aws_cloudwatch_log_metric_filter"" ""<example_resource_name>"" {
  name           = ""<example_resource_name>""
  log_group_name = ""<example_resource_name>""
  # Critical: detects S3 bucket policy changes from CloudTrail logs
  pattern = ""{($.eventSource=s3.amazonaws.com) && (($.eventName=PutBucketAcl) || ($.eventName=PutBucketPolicy) || ($.eventName=PutBucketCors) || ($.eventName=PutBucketLifecycle) || ($.eventName=PutBucketReplication) || ($.eventName=DeleteBucketPolicy) || ($.eventName=DeleteBucketCors) || ($.eventName=DeleteBucketLifecycle) || ($.eventName=DeleteBucketReplication))}""

  metric_transformation {
    name      = ""<example_resource_name>""
    namespace = ""<example_resource_name>""
    value     = ""1""
  }
}

# Alarm on the metric filter
resource ""aws_cloudwatch_metric_alarm"" ""<example_resource_name>"" {
  alarm_name          = ""<example_resource_name>""
  metric_name         = ""<example_resource_name>""  # Critical: matches metric filter
  namespace           = ""<example_resource_name>""  # Critical: matches metric filter
  comparison_operator = ""GreaterThanOrEqualToThreshold""
  evaluation_periods  = 1
  period              = 300
  statistic           = ""Sum""
  threshold           = 1
}
```";;"1. Open the CloudWatch console and go to Logs > Log groups.
2. Select the CloudTrail log group that receives your trail events.
3. Create metric filter:
   - Choose Create metric filter.
   - Filter pattern:
     ```
     {($.eventSource=s3.amazonaws.com) && (($.eventName=PutBucketAcl) || ($.eventName=PutBucketPolicy) || ($.eventName=PutBucketCors) || ($.eventName=PutBucketLifecycle) || ($.eventName=PutBucketReplication) || ($.eventName=DeleteBucketPolicy) || ($.eventName=DeleteBucketCors) || ($.eventName=DeleteBucketLifecycle) || ($.eventName=DeleteBucketReplication))}
     ```
   - Set Metric name and Namespace (any values) and Metric value = 1. Save.
4. From the Metric filters tab, select the new filter and choose Create alarm.
5. Set: Statistic = Sum, Period = 5 minutes, Threshold type = Static, Condition = Greater/Equal, Threshold = 1, Evaluation periods = 1. Create alarm.";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP04 | ISO27001-2022: A.8.15, A.8.16 | CIS-1.5: 4.8 | NIS2: 2.2.3, 3.2.3.b, 3.2.3.c, 3.2.3.f, 3.2.3.g, 3.5.4, 7.2.b | NIST-CSF-2.0: pt_1, ae_1, ae_2, cm_7 | CIS-5.0: 4.8 | GDPR: article_25 | ProwlerThreatScore-1.0: 3.3.9 | KISA-ISMS-P-2023: 2.10.1, 2.10.2, 2.11.3 | CIS-1.4: 4.8 | C5-2025: OIS-04.03B, OIS-04.01AC, OIS-04.02AC, HR-03.02AC, AM-01.01AC, AM-09.03AC, OPS-11.02AC, OPS-26.05B, OPS-26.01AS, OPS-26.06B, PSS-04.01B | SOC2: cc_5_2 | NIST-CSF-1.1: cm_2, ra_5, sc_4 | ISO27001-2013: A.12.4.G | CIS-4.0.1: 4.8 | CIS-2.0: 4.8 | CCC: CCC.AuditLog.CN03.AR02, CCC.Logging.CN01.AR02, CCC.Monitor.CN02.AR01, CCC.Core.CN04.AR01 | CIS-3.0: 4.8 | MITRE-ATTACK: T1496 | KISA-ISMS-P-2023-korean: 2.10.1, 2.10.2, 2.11.3 | FedRAMP-20x-KSI-Low-25.05C: ksi-cmt;logging;;;Logging and Monitoring;5.18.1;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html | https://support.icompaas.com/support/solutions/articles/62000086674-ensure-a-log-metric-filter-and-alarm-exist-for-s3-bucket-policy-changes | https://www.tenable.com/audits/items/CIS_Amazon_Web_Services_Foundations_v5.0.0_L1.audit:8101350d6907e07863ac6748689b3e12
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_log_metric_filter_policy_changes-132410971304-ap-northeast-2-132410971304;aws;cloudwatch_log_metric_filter_policy_changes;CloudWatch Logs metric filter and alarm exist for IAM policy changes;Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | TTPs/Privilege Escalation;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;False;cloudwatch;;medium;AwsCloudWatchAlarm;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;;;aws;ap-northeast-2;CloudWatch uses a metric filter and alarm to track **IAM policy changes** recorded by CloudTrail (e.g., `CreatePolicy`, `DeletePolicy`, version changes, inline policy edits, policy attach/detach). This finding reflects whether that filter and an associated alarm are present on the trail's log group.;Absent alerting on **IAM policy changes**, privilege modifications can go unnoticed, enabling **privilege escalation**, hidden backdoors, or permission revocations. This threatens **confidentiality** and **integrity**, and may impact **availability** if critical access is removed or misconfigured.;;"Create a metric filter for IAM policy create/update/delete and attach/detach events with an **alarm** to notify responders.
- Enforce **least privilege** and separation of duties for policy changes
- Require approvals and central logging across Regions/accounts
- Integrate alerts with incident response";https://hub.prowler.com/check/cloudwatch_log_metric_filter_policy_changes;"```yaml
# CloudFormation: Create metric filter and alarm for IAM policy changes
Resources:
  IAMPolicyChangeMetricFilter:
    Type: AWS::Logs::MetricFilter
    Properties:
      LogGroupName: <example_resource_name>  # IMPORTANT: CloudTrail log group to monitor
      # CRITICAL: Pattern matching IAM policy change events required by the check
      FilterPattern: '{($.eventName=DeleteGroupPolicy)||($.eventName=DeleteRolePolicy)||($.eventName=DeleteUserPolicy)||($.eventName=PutGroupPolicy)||($.eventName=PutRolePolicy)||($.eventName=PutUserPolicy)||($.eventName=CreatePolicy)||($.eventName=DeletePolicy)||($.eventName=CreatePolicyVersion)||($.eventName=DeletePolicyVersion)||($.eventName=AttachRolePolicy)||($.eventName=DetachRolePolicy)||($.eventName=AttachUserPolicy)||($.eventName=DetachUserPolicy)||($.eventName=AttachGroupPolicy)||($.eventName=DetachGroupPolicy)}'
      MetricTransformations:
        - MetricName: <example_resource_name>   # CRITICAL: Metric created from filter
          MetricNamespace: CISBenchmark        # CRITICAL: Namespace for the metric
          MetricValue: ""1""

  IAMPolicyChangeAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties:
      AlarmName: <example_resource_name>
      # CRITICAL: Alarm on the metric created above when >= 1 event occurs
      MetricName: <example_resource_name>
      Namespace: CISBenchmark
      Statistic: Sum
      Period: 300
      EvaluationPeriods: 1
      Threshold: 1
      ComparisonOperator: GreaterThanOrEqualToThreshold
```";"```hcl
# Terraform: Metric filter and alarm for IAM policy changes
resource ""aws_cloudwatch_log_metric_filter"" ""<example_resource_name>"" {
  name           = ""<example_resource_name>""
  log_group_name = ""<example_resource_name>""  # CloudTrail log group

  # CRITICAL: Pattern matching IAM policy change events required by the check
  pattern = ""{($.eventName=DeleteGroupPolicy)||($.eventName=DeleteRolePolicy)||($.eventName=DeleteUserPolicy)||($.eventName=PutGroupPolicy)||($.eventName=PutRolePolicy)||($.eventName=PutUserPolicy)||($.eventName=CreatePolicy)||($.eventName=DeletePolicy)||($.eventName=CreatePolicyVersion)||($.eventName=DeletePolicyVersion)||($.eventName=AttachRolePolicy)||($.eventName=DetachRolePolicy)||($.eventName=AttachUserPolicy)||($.eventName=DetachUserPolicy)||($.eventName=AttachGroupPolicy)||($.eventName=DetachGroupPolicy)}""

  metric_transformation {
    name      = ""<example_resource_name>""      # CRITICAL: Metric created from filter
    namespace = ""CISBenchmark""                 # CRITICAL: Namespace for the metric
    value     = ""1""
  }
}

resource ""aws_cloudwatch_metric_alarm"" ""<example_resource_name>"" {
  alarm_name          = ""<example_resource_name>""
  # CRITICAL: Alarm on the metric when >= 1 event occurs
  metric_name         = aws_cloudwatch_log_metric_filter.<example_resource_name>.metric_transformation[0].name
  namespace           = aws_cloudwatch_log_metric_filter.<example_resource_name>.metric_transformation[0].namespace
  statistic           = ""Sum""
  period              = 300
  evaluation_periods  = 1
  threshold           = 1
  comparison_operator = ""GreaterThanOrEqualToThreshold""
}
```";;"1. Open the CloudWatch console > Logs > Log groups and select the CloudTrail log group
2. Create metric filter:
   - Filter pattern: {($.eventName=DeleteGroupPolicy)||($.eventName=DeleteRolePolicy)||($.eventName=DeleteUserPolicy)||($.eventName=PutGroupPolicy)||($.eventName=PutRolePolicy)||($.eventName=PutUserPolicy)||($.eventName=CreatePolicy)||($.eventName=DeletePolicy)||($.eventName=CreatePolicyVersion)||($.eventName=DeletePolicyVersion)||($.eventName=AttachRolePolicy)||($.eventName=DetachRolePolicy)||($.eventName=AttachUserPolicy)||($.eventName=DetachUserPolicy)||($.eventName=AttachGroupPolicy)||($.eventName=DetachGroupPolicy)}
   - Metric name: <example_resource_name>
   - Namespace: CISBenchmark
   - Metric value: 1
3. On the Metric filters tab, select the new filter and choose Create alarm
4. Set: Statistic=Sum, Period=5 minutes, Threshold type=Static, Greater/Equal, Threshold=1, Evaluation periods=1
5. Create the alarm";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP04 | ISO27001-2022: A.8.15, A.8.16 | PCI-3.2.1: 8.1, 8.1.2 | CIS-1.5: 4.4 | NIS2: 2.2.3, 3.2.2, 3.2.3.b, 3.2.3.c, 3.2.3.f, 3.2.3.g, 3.5.4, 7.2.b, 11.5.2.d | NIST-CSF-2.0: ov_3, ae_2, cm_7 | CIS-5.0: 4.4 | GDPR: article_25 | ProwlerThreatScore-1.0: 3.3.5 | KISA-ISMS-P-2023: 2.10.1, 2.10.2, 2.11.3 | CIS-1.4: 4.4 | C5-2025: OIS-04.03B, OIS-04.01AC, OIS-04.02AC, HR-03.02AC, AM-01.01AC, AM-09.03AC, OPS-11.02AC, OPS-26.05B, OPS-26.01AS, OPS-26.06B, PSS-04.01B | ENS-RD2022: op.exp.8.aws.ct.5 | SOC2: cc_5_2, pi_1_3 | NIST-CSF-1.1: cm_2, ra_5, sc_4 | ISO27001-2013: A.12.4.K | CIS-4.0.1: 4.4 | CIS-2.0: 4.4 | CCC: CCC.AuditLog.CN03.AR02, CCC.Monitor.CN02.AR01, CCC.Core.CN04.AR01 | CIS-3.0: 4.4 | MITRE-ATTACK: T1496 | KISA-ISMS-P-2023-korean: 2.10.1, 2.10.2, 2.11.3 | FedRAMP-20x-KSI-Low-25.05C: ksi-cmt;logging;;;Logging and Monitoring;5.18.1;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html | https://www.clouddefense.ai/compliance-rules/cis-v140/monitoring/cis-v140-4-4 | https://www.intelligentdiscovery.io/controls/cloudwatch/cloudwatch-alarm-iam-policy-change
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_log_metric_filter_root_usage-132410971304-ap-northeast-2-132410971304;aws;cloudwatch_log_metric_filter_root_usage;Account has a CloudWatch Logs metric filter and alarm for root account usage;Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/AWS Security Best Practices | TTPs/Privilege Escalation;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;False;cloudwatch;;medium;AwsCloudWatchAlarm;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;;;aws;ap-northeast-2;"**CloudTrail** logs in CloudWatch include a metric filter for **root account activity** (`{ $.userIdentity.type = ""Root"" && $.userIdentity.invokedBy NOT EXISTS && $.eventType != ""AwsServiceEvent"" }`) and a linked CloudWatch alarm that triggers when the filter matches.";"Without alerting on **root activity**, full-privilege actions can proceed unnoticed, impacting:
- confidentiality via data access/exfiltration
- integrity via policy/config tampering
- availability via deletions or shutdowns
Delayed detection increases blast radius and persistence.";;"Enable real-time alerts for **root activity** using a log metric filter and a high-priority alarm with notifications.

Reduce exposure: enforce **least privilege**, keep root for *break-glass* with MFA, disable root access keys, and route alerts into incident response for **defense in depth**.";https://hub.prowler.com/check/cloudwatch_log_metric_filter_root_usage;"```yaml
# CloudFormation: Create metric filter and alarm for root account usage
Resources:
  RootUsageMetricFilter:
    Type: AWS::Logs::MetricFilter
    Properties:
      LogGroupName: ""<example_resource_name>""
      FilterPattern: '{ $.userIdentity.type = ""Root"" && $.userIdentity.invokedBy NOT EXISTS && $.eventType != ""AwsServiceEvent"" }'  # CRITICAL: detects root user actions not invoked by services
      MetricTransformations:
        - MetricValue: ""1""
          MetricNamespace: ""<example_resource_name>""  # CRITICAL: metric namespace used by the alarm
          MetricName: ""<example_resource_name>""       # CRITICAL: metric name used by the alarm

  RootUsageAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties:
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: ""<example_resource_name>""   # CRITICAL: alarms on the metric created by the filter
      Namespace: ""<example_resource_name>""
      Period: 300
      Statistic: Sum
      Threshold: 1
```";"```hcl
# CloudWatch Logs metric filter for root account usage
resource ""aws_cloudwatch_log_metric_filter"" ""<example_resource_name>"" {
  name           = ""<example_resource_name>""
  log_group_name = ""<example_resource_name>""
  pattern        = ""{ $.userIdentity.type = \""Root\"" && $.userIdentity.invokedBy NOT EXISTS && $.eventType != \""AwsServiceEvent\"" }"" # CRITICAL: detects root user actions

  metric_transformation {
    name      = ""<example_resource_name>""     # CRITICAL: metric used by the alarm
    namespace = ""<example_resource_name>""
    value     = ""1""
  }
}

# Alarm on the root usage metric
resource ""aws_cloudwatch_metric_alarm"" ""<example_resource_name>"" {
  comparison_operator = ""GreaterThanOrEqualToThreshold""
  evaluation_periods  = 1
  metric_name         = ""<example_resource_name>""   # CRITICAL: matches metric filter
  namespace           = ""<example_resource_name>""
  period              = 300
  statistic           = ""Sum""
  threshold           = 1
}
```";;"1. In the AWS console, open CloudWatch > Logs > Log groups and select the CloudTrail log group
2. Go to Metric filters > Create metric filter
3. For Filter pattern, enter: { $.userIdentity.type = ""Root"" && $.userIdentity.invokedBy NOT EXISTS && $.eventType != ""AwsServiceEvent"" }
4. Click Next, set any Filter name, set Metric namespace and Metric name, set Metric value to 1, then Create metric filter
5. Select the new metric filter and click Create alarm
6. Set Period to 5 minutes, Statistic to Sum, Threshold type Static with value 1, Evaluation periods 1, then Create alarm";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP04 | ISO27001-2022: A.8.15, A.8.16 | PCI-3.2.1: 7.2, 7.2.1 | CIS-1.5: 4.3 | NIS2: 2.3.1, 3.2.1, 3.2.2, 3.2.3.c, 3.2.3.e, 3.2.3.g, 3.5.4, 7.2.b, 9.2.c.vii | NIST-CSF-2.0: ip_8, ae_2, cm_7, dp_4 | CIS-5.0: 4.3 | GDPR: article_25 | ProwlerThreatScore-1.0: 3.3.4 | KISA-ISMS-P-2023: 2.10.1, 2.10.2, 2.11.3 | CIS-1.4: 4.3 | C5-2025: OIS-04.01AC, OIS-04.02AC, HR-03.02AC, AM-01.01AC, AM-09.03AC, OPS-11.02AC, OPS-26.05B, OPS-26.01AS, OPS-26.06B, IAM-03.01B, IAM-03.03B, IAM-06.04B, IAM-06.05B, PSS-04.01B | ENS-RD2022: op.exp.8.aws.ct.5, op.exp.8.aws.cw.1 | SOC2: pi_1_3 | NIST-CSF-1.1: cm_2, ra_5, sc_4 | ISO27001-2013: A.12.4.L | CIS-4.0.1: 4.3 | CIS-2.0: 4.3 | CCC: CCC.Core.CN04.AR01 | HIPAA: 164_308_a_6_i, 164_308_a_6_ii | CIS-3.0: 4.3 | MITRE-ATTACK: T1496 | AWS-Account-Security-Onboarding: Critical alert on every root user activity | KISA-ISMS-P-2023-korean: 2.10.1, 2.10.2, 2.11.3;logging;;;Logging and Monitoring;5.18.1;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html | https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudWatchLogs/root-account-usage-alarm.html | https://asecure.cloud/a/root_account_login/ | https://support.icompaas.com/support/solutions/articles/62000083624-ensure-a-log-metric-filter-and-alarm-exist-for-usage-of-root-account | https://www.intelligentdiscovery.io/controls/cloudwatch/cloudwatch-alarm-root-account-usage | https://aws.amazon.com/blogs/security/how-to-receive-notifications-when-your-aws-accounts-root-access-keys-are-used/ | https://www.tenable.com/audits/items/CIS_Amazon_Web_Services_Foundations_v1.5.0_L1.audit:000adfb028a1475075a6b5d2117f53f4
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_log_metric_filter_security_group_changes-132410971304-ap-northeast-2-132410971304;aws;cloudwatch_log_metric_filter_security_group_changes;CloudWatch Logs metric filter and alarm exist for security group changes;Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Software and Configuration Checks/AWS Security Best Practices/Runtime Behavior Analysis;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;False;cloudwatch;;medium;AwsCloudWatchAlarm;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;;;aws;ap-northeast-2;**CloudTrail** events for **security group configuration changes** are monitored using a **CloudWatch Logs metric filter** with an associated **alarm**. The filter targets actions like `AuthorizeSecurityGroupIngress/Egress`, `RevokeSecurityGroupIngress/Egress`, `CreateSecurityGroup`, and `DeleteSecurityGroup` to surface any security group modifications.;Without alerting on **security group changes**, unauthorized or mistaken rules can expose services to the Internet, enabling brute force and lateral movement (**confidentiality, integrity**). Deletions or restrictive edits can break connectivity (**availability**). Delayed detection increases attacker dwell time and impact.;;"Establish real-time alerts for **security group modifications** by sending CloudTrail to CloudWatch, creating metric filters and alarms, and notifying responders.
- Enforce **least privilege** on SG changes
- Use change management and tagging
- Centralize logs, test alarms, and maintain runbooks
- Layer with NACLs and WAF for **defense in depth**";https://hub.prowler.com/check/cloudwatch_log_metric_filter_security_group_changes;"```yaml
# CloudFormation: Create metric filter and alarm for Security Group changes
Resources:
  MetricFilter:
    Type: AWS::Logs::MetricFilter
    Properties:
      LogGroupName: <example_log_group_name>
      # Critical: Matches Security Group change events required by the check
      # This publishes a metric when these events appear in CloudTrail logs
      FilterPattern: '{ ($.eventName = AuthorizeSecurityGroupIngress) || ($.eventName = AuthorizeSecurityGroupEgress) || ($.eventName = RevokeSecurityGroupIngress) || ($.eventName = RevokeSecurityGroupEgress) || ($.eventName = CreateSecurityGroup) || ($.eventName = DeleteSecurityGroup) }'
      MetricTransformations:
        - MetricName: <example_metric_name>
          MetricNamespace: <example_metric_namespace>
          MetricValue: ""1""

  Alarm:
    Type: AWS::CloudWatch::Alarm
    Properties:
      # Critical: Alarm on the metric to satisfy the requirement
      MetricName: <example_metric_name>
      Namespace: <example_metric_namespace>
      Statistic: Sum
      Period: 300
      EvaluationPeriods: 1
      Threshold: 1
      ComparisonOperator: GreaterThanOrEqualToThreshold
```";"```hcl
# Metric filter for Security Group changes
resource ""aws_cloudwatch_log_metric_filter"" ""sg"" {
  name           = ""<example_resource_name>""
  log_group_name = ""<example_log_group_name>""
  # Critical: Matches Security Group change events required by the check
  pattern = ""{ ($.eventName = AuthorizeSecurityGroupIngress) || ($.eventName = AuthorizeSecurityGroupEgress) || ($.eventName = RevokeSecurityGroupIngress) || ($.eventName = RevokeSecurityGroupEgress) || ($.eventName = CreateSecurityGroup) || ($.eventName = DeleteSecurityGroup) }""

  metric_transformation {
    name      = ""<example_metric_name>""
    namespace = ""<example_metric_namespace>""
    value     = ""1""
  }
}

# Alarm for the above metric
resource ""aws_cloudwatch_metric_alarm"" ""sg"" {
  alarm_name          = ""<example_resource_name>""
  # Critical: Alarm on the SG change metric to pass the control
  metric_name         = ""<example_metric_name>""
  namespace           = ""<example_metric_namespace>""
  statistic           = ""Sum""
  period              = 300
  evaluation_periods  = 1
  threshold           = 1
  comparison_operator = ""GreaterThanOrEqualToThreshold""
}
```";;"1. Open the CloudWatch console > Logs > Log groups, and select the CloudTrail log group
2. Create metric filter with this pattern:
   { ($.eventName = AuthorizeSecurityGroupIngress) || ($.eventName = AuthorizeSecurityGroupEgress) || ($.eventName = RevokeSecurityGroupIngress) || ($.eventName = RevokeSecurityGroupEgress) || ($.eventName = CreateSecurityGroup) || ($.eventName = DeleteSecurityGroup) }
3. Assign metric: name <example_metric_name>, namespace <example_metric_namespace>, value 1, then create the filter
4. From the metric filter, choose Create alarm and set: Statistic Sum, Period 5 minutes, Threshold type Static, Greater/Equal 1, Evaluation periods 1, then create the alarm";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP04 | ISO27001-2022: A.8.15, A.8.16 | CIS-1.5: 4.10 | NIS2: 2.2.3, 3.2.2, 3.2.3.b, 3.2.3.c, 3.2.3.f, 3.2.3.g, 3.5.4, 11.5.2.d | NIST-CSF-2.0: ov_3, ip_8, ae_1, ae_2, cm_7, dp_4 | CIS-5.0: 4.10 | GDPR: article_25 | ProwlerThreatScore-1.0: 3.3.11 | KISA-ISMS-P-2023: 2.10.1, 2.10.2, 2.11.3 | CIS-1.4: 4.10 | C5-2025: OIS-04.03B, OIS-04.01AC, OIS-04.02AC, HR-03.02AC, AM-01.01AC, AM-09.03AC, OPS-11.02AC, OPS-26.05B, OPS-26.01AS, OPS-26.06B, PSS-04.01B | SOC2: cc_5_2 | NIST-CSF-1.1: cm_2, ra_5, sc_4 | ISO27001-2013: A.12.4.E | CIS-4.0.1: 4.10 | CIS-2.0: 4.10 | CCC: CCC.AuditLog.CN03.AR02, CCC.Monitor.CN02.AR01, CCC.Core.CN04.AR01 | CIS-3.0: 4.10 | MITRE-ATTACK: T1496 | KISA-ISMS-P-2023-korean: 2.10.1, 2.10.2, 2.11.3 | FedRAMP-20x-KSI-Low-25.05C: ksi-cmt;logging;;;Logging and Monitoring;5.18.1;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html | https://support.icompaas.com/support/solutions/articles/62000084030-ensure-a-log-metric-filter-and-alarm-exist-for-security-group-changes | https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/Alarm-On-Logs.html | https://asecure.cloud/a/cwalarm_securitygroup_changes/
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_log_metric_filter_sign_in_without_mfa-132410971304-ap-northeast-2-132410971304;aws;cloudwatch_log_metric_filter_sign_in_without_mfa;CloudWatch log metric filter and alarm exist for Management Console sign-in without MFA;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | TTPs/Initial Access | Unusual Behaviors/User;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;False;cloudwatch;;medium;AwsCloudWatchAlarm;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;;;aws;ap-northeast-2;"**CloudTrail logs** in CloudWatch are assessed for a metric filter and alarm that detect console logins where `$.eventName = ConsoleLogin` and `$.additionalEventData.MFAUsed != \""Yes\""`.

This reflects whether alerting exists for sign-ins that occur without **MFA**.";"Without alerting on non-MFA console logins, successful use of stolen passwords can go **undetected**, enabling:
- Unauthorized console access and IAM changes
- Data exfiltration or deletion

Impacts: loss of **confidentiality** and **integrity**, and potential **availability** disruption.";;"Enforce **MFA** for all console-capable identities and maintain alerts for `ConsoleLogin` with `MFAUsed != \""Yes\""`.

Apply **least privilege**, route alarms to monitored channels, and tune for SSO to reduce noise. Test alarms regularly and review coverage as part of **defense in depth**.";https://hub.prowler.com/check/cloudwatch_log_metric_filter_sign_in_without_mfa;"```yaml
# CloudFormation: Create metric filter and alarm for console sign-in without MFA
Resources:
  NoMFAConsoleSigninMetricFilter:
    Type: AWS::Logs::MetricFilter
    Properties:
      LogGroupName: ""<example_resource_name>""
      FilterPattern: '{ ($.eventName = ""ConsoleLogin"") && ($.additionalEventData.MFAUsed != ""Yes"") }' # CRITICAL: detects ConsoleLogin events without MFA
      MetricTransformations:
        - MetricName: ""<example_resource_name>""
          MetricNamespace: ""<example_resource_name>""
          MetricValue: ""1""  # CRITICAL: emits a metric on each match

  NoMFAConsoleSigninAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties:
      MetricName: ""<example_resource_name>""   # CRITICAL: alarm uses the metric from the filter
      Namespace: ""<example_resource_name>""
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      Period: 300
      Statistic: Sum
      Threshold: 1  # CRITICAL: alarm on first occurrence
```";"```hcl
# Create metric filter for console sign-in without MFA
resource ""aws_cloudwatch_log_metric_filter"" ""nomfa"" {
  name           = ""<example_resource_name>""
  log_group_name = ""<example_resource_name>""
  pattern        = ""{ ($.eventName = \""ConsoleLogin\"") && ($.additionalEventData.MFAUsed != \""Yes\"") }""  # CRITICAL: detects ConsoleLogin without MFA

  metric_transformation {
    name      = ""<example_resource_name>""
    namespace = ""<example_resource_name>""
    value     = ""1""  # CRITICAL: emits a count per match
  }
}

# Alarm on the emitted metric
resource ""aws_cloudwatch_metric_alarm"" ""nomfa"" {
  alarm_name          = ""<example_resource_name>""
  metric_name         = aws_cloudwatch_log_metric_filter.nomfa.metric_transformation[0].name  # CRITICAL: ties alarm to the metric
  namespace           = aws_cloudwatch_log_metric_filter.nomfa.metric_transformation[0].namespace
  comparison_operator = ""GreaterThanOrEqualToThreshold""
  evaluation_periods  = 1
  period              = 300
  statistic           = ""Sum""
  threshold           = 1  # CRITICAL: alarm on first event
}
```";;"1. In AWS Console, go to CloudWatch > Logs > Log groups and open the CloudTrail log group
2. Go to Metric filters > Create metric filter
3. Set Filter pattern to: { ($.eventName = ""ConsoleLogin"") && ($.additionalEventData.MFAUsed != ""Yes"") }
4. Next > set Filter name, Metric namespace, Metric name; set Metric value = 1; Create metric filter
5. Select the new filter > Create alarm
6. Set Statistic = Sum, Period = 5 minutes, Threshold type = Static, Threshold = 1, Whenever >= 1; Next
7. Skip actions if not needed, Name the alarm, Create alarm";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP04 | ISO27001-2022: A.8.15, A.8.16 | CIS-1.5: 4.2 | NIS2: 3.2.3.c, 3.2.3.d, 3.2.3.g, 3.5.4, 9.2.c.vii, 11.7.2 | CIS-5.0: 4.2 | GDPR: article_25 | ProwlerThreatScore-1.0: 3.3.3 | KISA-ISMS-P-2023: 2.10.1, 2.10.2, 2.11.3 | CIS-1.4: 4.2 | C5-2025: OIS-04.01AC, OIS-04.02AC, HR-03.02AC, AM-01.01AC, AM-09.03AC, OPS-11.02AC, OPS-16.01B, OPS-26.05B, OPS-26.01AS, OPS-26.06B, IAM-03.01AC, IAM-09.02B, IAM-09.01AC, PSS-04.01B, PSS-05.01B, PSS-07.02B | ENS-RD2022: op.exp.8.aws.ct.5 | NIST-CSF-1.1: cm_2, ra_5, sc_4 | ISO27001-2013: A.12.4.M | CIS-4.0.1: 4.2 | CIS-2.0: 4.2 | CCC: CCC.Core.CN04.AR01 | CIS-3.0: 4.2 | MITRE-ATTACK: T1496 | KISA-ISMS-P-2023-korean: 2.10.1, 2.10.2, 2.11.3;logging;;;Logging and Monitoring;5.18.1;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html | https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudWatchLogs/console-sign-in-without-mfa.html | https://www.tenable.com/audits/items/CIS_Amazon_Web_Services_Foundations_v3.0.0_L1.audit:1957056ee174cc38502d5f5f1864333b | https://www.clouddefense.ai/compliance-rules/gdpr/data-protection/log-metric-filter-console-login-mfa | https://www.intelligentdiscovery.io/controls/cloudwatch/cloudwatch-alarm-no-mfa | https://support.icompaas.com/support/solutions/articles/62000083605-ensure-a-log-metric-filter-and-alarm-exist-for-management-console-sign-in-without-mfa
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-cloudwatch_log_metric_filter_unauthorized_api_calls-132410971304-ap-northeast-2-132410971304;aws;cloudwatch_log_metric_filter_unauthorized_api_calls;CloudWatch Logs metric filter and alarm exist for unauthorized API calls;Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Software and Configuration Checks/AWS Security Best Practices/Runtime Behavior Analysis | TTPs/Initial Access/Unauthorized Access;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;False;cloudwatch;;medium;AwsCloudWatchAlarm;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;;;aws;ap-northeast-2;"**CloudWatch Logs** for CloudTrail include a metric filter that matches unauthorized API errors (`$.errorCode=""*UnauthorizedOperation""` or `$.errorCode=""AccessDenied*""`) and a linked alarm that triggers when events match the filter.";Without alerting on **unauthorized API calls**, permission probing and failed access by compromised identities can go unnoticed. Attackers can enumerate services, pivot, and attempt privilege escalation, threatening data **confidentiality** and **integrity**.;;"Enable real-time **alerting** by adding a CloudWatch Logs metric filter for unauthorized errors (`*UnauthorizedOperation`, `AccessDenied*`) and associating it with an alarm that notifies responders.
- Enforce **least privilege** to reduce noise
- Integrate with IR tooling for **defense in depth**";https://hub.prowler.com/check/cloudwatch_log_metric_filter_unauthorized_api_calls;"```yaml
# CloudFormation: Create metric filter and alarm for unauthorized API calls
Resources:
  MetricFilterUnauthorized:
    Type: AWS::Logs::MetricFilter
    Properties:
      LogGroupName: <example_resource_name>
      FilterPattern: '{($.errorCode = ""*UnauthorizedOperation"") || ($.errorCode = ""AccessDenied*"")}'  # Critical: detects unauthorized/denied API calls
      MetricTransformations:
        - MetricName: unauthorized_api_calls_metric
          MetricNamespace: CISBenchmark
          MetricValue: ""1""

  AlarmUnauthorized:
    Type: AWS::CloudWatch::Alarm
    Properties:
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: unauthorized_api_calls_metric  # Critical: alarm on the metric from the filter
      Namespace: CISBenchmark
      Period: 300
      Statistic: Sum
      Threshold: 1
```";"```hcl
# Terraform: Metric filter and alarm for unauthorized API calls
resource ""aws_cloudwatch_log_metric_filter"" ""unauthorized"" {
  name           = ""unauthorized_api_calls_metric""
  log_group_name = ""<example_resource_name>""
  pattern        = ""{($.errorCode = \""*UnauthorizedOperation\"") || ($.errorCode = \""AccessDenied*\"")}""  # Critical: detects unauthorized/denied API calls

  metric_transformation {
    name      = ""unauthorized_api_calls_metric""
    namespace = ""CISBenchmark""
    value     = ""1""
  }
}

resource ""aws_cloudwatch_metric_alarm"" ""unauthorized"" {
  comparison_operator = ""GreaterThanOrEqualToThreshold""
  evaluation_periods  = 1
  metric_name         = ""unauthorized_api_calls_metric""   # Critical: alarm on the metric from the filter
  namespace           = ""CISBenchmark""
  period              = 300
  statistic           = ""Sum""
  threshold           = 1
}
```";;"1. In the AWS Console, open CloudWatch > Logs > Log groups and select the CloudTrail log group
2. Go to Metric filters > Create metric filter
3. Set Filter pattern to: {($.errorCode = ""*UnauthorizedOperation"") || ($.errorCode = ""AccessDenied*"")}
4. Name the metric unauthorized_api_calls_metric, set Namespace to CISBenchmark, Value to 1, then create
5. Select the new metric filter and click Create alarm
6. Set Statistic: Sum, Period: 5 minutes, Threshold type: Static, Threshold: 1, Evaluation periods: 1
7. Create the alarm";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP04 | ISO27001-2022: A.8.15, A.8.16 | CIS-1.5: 4.1 | NIS2: 3.2.3.c, 3.2.3.g, 3.2.4, 3.4.2.c, 3.5.4 | NIST-CSF-2.0: ov_3, ra_5, ip_7, ip_8, pt_1, ae_1, ae_2, cm_1, cm_3, cm_7, dp_4 | CIS-5.0: 4.1 | GDPR: article_25 | ProwlerThreatScore-1.0: 3.3.2 | KISA-ISMS-P-2023: 2.10.1, 2.10.2, 2.11.3 | CIS-1.4: 4.1 | C5-2025: OIS-04.01AC, OIS-04.02AC, HR-03.02AC, AM-01.01AC, AM-09.03AC, OPS-11.02AC, OPS-26.05B, OPS-26.01AS, OPS-26.06B, IAM-06.05B, PSS-04.01B | ENS-RD2022: op.exp.8.aws.ct.5 | SOC2: pi_1_3 | NIST-CSF-1.1: cm_2, ra_5, sc_4 | ISO27001-2013: A.12.4.N | CIS-4.0.1: 4.1 | CIS-2.0: 4.1 | CCC: CCC.AuditLog.CN03.AR02, CCC.Monitor.CN02.AR01, CCC.Core.CN04.AR01 | CIS-3.0: 4.1 | MITRE-ATTACK: T1496 | KISA-ISMS-P-2023-korean: 2.10.1, 2.10.2, 2.11.3;logging;;;Logging and Monitoring;5.18.1;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html | https://asecure.cloud/a/unauthorized_api_calls/ | https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/CloudWatchLogs/authorization-failures-alarm.html | https://www.tenable.com/policies/[type]/AC_AWS_0559 | https://www.intelligentdiscovery.io/controls/cloudwatch/cloudwatch-unauthorized-api-calls | https://support.icompaas.com/support/solutions/articles/62000083561-ensure-a-log-metric-filter-and-alarm-exist-for-unauthorized-api-calls
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-config_recorder_all_regions_enabled-132410971304-ap-northeast-2-132410971304;aws;config_recorder_all_regions_enabled;AWS Config recorder is enabled and not in failure state or disabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;FAIL;AWS Config recorder 132410971304 is disabled.;False;config;;medium;Other;arn:aws:config:ap-northeast-2:132410971304:recorder;132410971304;;;aws;ap-northeast-2;**AWS accounts** have **AWS Config recorders** active and healthy in each Region. It identifies Regions with no recorder, a disabled recorder, or a recorder in a failure state.;**Gaps in Config recording** create **blind spots**. Changes in unmonitored Regions aren't captured, weakening **integrity** and **auditability**. Adversaries can alter resources or stage assets unnoticed, enabling misconfigurations and delaying **incident response**.;;Enable **AWS Config** in every Region with continuous recording and maintain healthy recorder status.;https://hub.prowler.com/check/config_recorder_all_regions_enabled;"```yaml
Resources:
  example_resource_recorder:
    Type: AWS::Config::ConfigurationRecorder
    Properties:
      Name: example_resource
      RoleARN: !Sub arn:aws:iam::${AWS::AccountId}:role/aws-service-role/config.amazonaws.com/AWSServiceRoleForConfig

  example_resource_channel:
    Type: AWS::Config::DeliveryChannel
    Properties:
      S3BucketName: example_resource

  example_resource_status:
    Type: AWS::Config::ConfigurationRecorderStatus
    Properties:
      Name: example_resource
      Recording: true  # This line fixes the security issue
    DependsOn:
      - example_resource_channel
```";"```hcl
resource ""aws_iam_service_linked_role"" ""example_resource"" {
  aws_service_name = ""config.amazonaws.com""
}

resource ""aws_config_configuration_recorder"" ""example_resource"" {
  name     = ""example_resource""
  role_arn = aws_iam_service_linked_role.example_resource.arn
}

resource ""aws_config_delivery_channel"" ""example_resource"" {
  s3_bucket_name = ""example_resource""
}

resource ""aws_config_configuration_recorder_status"" ""example_resource"" {
  name         = aws_config_configuration_recorder.example_resource.name
  is_recording = true  # This line fixes the security issue
  depends_on   = [aws_config_delivery_channel.example_resource]
}
```";;"1. In the AWS Console, go to Config
2. Click Set up AWS Config (or Settings)
3. Select a resource recording option (any) and choose an existing S3 bucket for delivery
4. Keep the default AWSServiceRoleForConfig role
5. Click Confirm/Turn on to start recording
6. Verify on the Settings page that Status shows Recording and not Failure";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP02 | ISO27001-2022: A.5.16, A.5.22 | PCI-3.2.1: 2.4, 2.4.a, 10.5, 10.5.2, 11.5, 11.5.a, 11.5.b | CIS-1.5: 3.5 | NIST-CSF-2.0: rm_1, po_3, po_4, ov_3, pt_1 | CIS-5.0: 3.3 | GDPR: article_25, article_30 | ProwlerThreatScore-1.0: 3.3.1 | KISA-ISMS-P-2023: 2.10.2, 2.11.3 | GxP-EU-Annex-11: 10-change-and-configuration-management, 4.5-validation-development-quality, 4.6-validation-quality-performance | CIS-1.4: 3.5 | C5-2025: OIS-05.01B, PS-02.01B, PS-02.01AS, PS-02.02AS, DEV-08.02B | ENS-RD2022: op.exp.1.aws.cfg.1, op.exp.1.aws.cfg.2, op.exp.3.aws.cfg.1, op.exp.3.r3.aws.cfg.1, op.mon.3.r2.aws.cfg.1, op.mon.3.r6.aws.cfg.1 | SOC2: cc_2_1, cc_3_1, cc_3_4, cc_8_1, pi_1_3 | NIST-CSF-1.1: cm_2, am_1, ra_5, sc_4, ip_12 | ISO27001-2013: A.12.4.P | CIS-4.0.1: 3.3 | AWS-Foundational-Security-Best-Practices: Config.1 | CIS-2.0: 3.5 | HIPAA: 164_308_a_1_ii_a | CIS-3.0: 3.3 | MITRE-ATTACK: T1190, T1078, T1204, T1098, T1136, T1525, T1562, T1110, T1040, T1119, T1530, T1485, T1486, T1491, T1499, T1496, T1498 | AWS-Account-Security-Onboarding: Enable continuous recording for most of the resources, Confirm that records are present in central aggregator | KISA-ISMS-P-2023-korean: 2.10.2, 2.11.3 | FedRAMP-20x-KSI-Low-25.05C: ksi-cmt, ksi-piy, ksi-mla-07;logging | forensics-ready;;;;5.18.1;https://repost.aws/es/questions/QUGcgeerhcTamRkwgdwh_tLQ/enable-aws-config | https://www.tenable.com/audits/items/CIS_Amazon_Web_Services_Foundations_v1.5.0_L2.audit:6a5136528bd329139e5969f8f1e5ffbc | https://aws.amazon.com/blogs/mt/aws-config-best-practices/
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-ec2_ebs_volume_protected_by_backup_plan-132410971304-ap-northeast-2-vol-0278f268cad754e55;aws;ec2_ebs_volume_protected_by_backup_plan;EBS volume is protected by a backup plan;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Effects/Data Destruction;FAIL;EBS Volume vol-0278f268cad754e55 is not protected by a backup plan.;False;ec2;;medium;AwsEc2Volume;arn:aws:ec2:ap-northeast-2:132410971304:volume/vol-0278f268cad754e55;vol-0278f268cad754e55;;;aws;ap-northeast-2;**EBS volumes** are evaluated for coverage by an **AWS Backup plan**, whether explicitly targeted or included via broad resource selection, confirming scheduled, policy-driven backups exist for the volume.;Absent backup coverage, volumes face **data loss**, weakened **integrity**, and reduced **availability**. Deletion or corruption-whether accidental or malicious-can leave no recovery path, causing prolonged outages, failed point-in-time restoration, unmet retention needs, and harder incident response.;;Include all critical EBS volumes in standardized **AWS Backup** plans aligned to your `RPO`/`RTO`. Use tags for automatic assignment, enable cross-Region/account copies, apply **Vault Lock** for WORM retention, encrypt with KMS, enforce least-privilege access, and regularly test restores to verify integrity.;https://hub.prowler.com/check/ec2_ebs_volume_protected_by_backup_plan;"```yaml
# CloudFormation: protect all EBS volumes by assigning them to a backup plan
Resources:
  <example_resource_name>BackupPlan:
    Type: AWS::Backup::BackupPlan
    Properties:
      BackupPlan:
        BackupPlanName: <example_resource_name>
        Rules:
          - RuleName: <example_rule_name>
            TargetBackupVault: Default

  <example_resource_name>BackupSelection:
    Type: AWS::Backup::BackupSelection
    Properties:
      BackupPlanId: !Ref <example_resource_name>BackupPlan
      BackupSelection:
        SelectionName: <example_resource_name>
        IamRoleArn: arn:aws:iam::<example_account_id>:role/service-role/AWSBackupDefaultServiceRole
        Resources:
          - arn:aws:ec2:*:*:volume/*  # Critical: wildcard includes all EBS volumes so they are covered by the plan
```";"```hcl
# Minimal AWS Backup plan protecting all EBS volumes
resource ""aws_backup_plan"" ""<example_resource_name>"" {
  name = ""<example_resource_name>""

  rule {
    rule_name         = ""<example_rule_name>""
    target_vault_name = ""Default""
  }
}

resource ""aws_backup_selection"" ""<example_resource_name>"" {
  name         = ""<example_resource_name>""
  plan_id      = aws_backup_plan.<example_resource_name>.id
  iam_role_arn = ""arn:aws:iam::<example_account_id>:role/service-role/AWSBackupDefaultServiceRole""

  resources = [
    ""arn:aws:ec2:*:*:volume/*"" # Critical: selects all EBS volumes to satisfy the check
  ]
}
```";"aws backup create-backup-selection --backup-plan-id <BACKUP_PLAN_ID> --backup-selection '{""SelectionName"":""<example_resource_name>"",""IamRoleArn"":""arn:aws:iam::<example_account_id>:role/service-role/AWSBackupDefaultServiceRole"",""Resources"":[""arn:aws:ec2:*:*:volume/*""]}'";"1. In the AWS Backup console, go to Backup plans and click Create backup plan
2. Choose Start with a template (any), keep the Default vault, and create the plan
3. Open the plan and click Assign resources
4. Set Selection name and choose IAM role AWSBackupDefaultServiceRole
5. Under Assign resources, choose Include specific resource types and select EBS
6. For Resources, select all EBS volumes (or the specific volumes to protect) and click Assign resources";ISO27001-2022: A.8.14 | PCI-3.2.1: 3.1, 3.1.c | NIS2: 3.6.2, 4.1.2.g, 12.1.2.c, 12.2.2.b | NIST-CSF-2.0: ds_3, ip_4, rc_rp_1 | KISA-ISMS-P-2023: 2.9.3, 2.12.1 | C5-2025: OPS-06.01B, OPS-07.01B, DEV-11.02B, BCM-01.01B, BCM-01.02B, BCM-02.01B | AWS-Foundational-Security-Best-Practices: EC2.28 | PCI-4.0: 10.3.3.12, 10.3.3.13, 10.3.3.14, 10.3.3.24 | KISA-ISMS-P-2023-korean: 2.9.3, 2.12.1;resilience;;;;5.18.1;https://docs.amazonaws.cn/en_us/aws-backup/latest/devguide/vault-lock.html | https://aws.amazon.com/blogs/storage/protecting-your-critical-amazon-ebs-volumes-using-aws-backup/ | https://docs.aws.amazon.com/config/latest/developerguide/ebs-resources-protected-by-backup-plan.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-ec2_instance_managed_by_ssm-132410971304-ap-northeast-2-i-0fbecaba3c48e7c79;aws;ec2_instance_managed_by_ssm;EC2 instance is managed by AWS Systems Manager or not running;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Patch Management;FAIL;EC2 Instance i-0fbecaba3c48e7c79 is not managed by Systems Manager.;False;ec2;;medium;AwsEc2Instance;arn:aws:ec2:ap-northeast-2:132410971304:instance/i-0fbecaba3c48e7c79;i-0fbecaba3c48e7c79;;Name=webserver;aws;ap-northeast-2;"**EC2 instances** are assessed for enrollment as **Systems Manager managed nodes**. Running instances lacking Systems Manager registration are marked as unmanaged; instances in `stopped`, `terminated`, or `pending` states are noted separately.";Unmanaged instances lack centralized patching, inventory, and secure remote access. This increases exposure to brute force on SSH/RDP, delayed patching, and poor visibility. Exploits can enable lateral movement and persistence, degrading confidentiality, integrity, and availability.;;Enroll all instances as **Systems Manager managed nodes**. Prefer **Session Manager** over SSH/RDP, restrict inbound admin ports, and use **least privilege** roles. Ensure connectivity to SSM endpoints (or private endpoints), automate patching and inventory, and monitor activity for defense-in-depth.;https://hub.prowler.com/check/ec2_instance_managed_by_ssm;"```yaml
# CloudFormation: make the instance SSM-managed by attaching the required IAM role
Resources:
  <example_resource_name>Role:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Principal:
              Service: ec2.amazonaws.com
            Action: sts:AssumeRole
      ManagedPolicyArns:
        - arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore  # CRITICAL: grants SSM permissions required for management

  <example_resource_name>InstanceProfile:
    Type: AWS::IAM::InstanceProfile
    Properties:
      Roles:
        - !Ref <example_resource_name>Role

  <example_resource_name>Instance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: ami-<example_resource_id>
      InstanceType: t3.micro
      IamInstanceProfile: !Ref <example_resource_name>InstanceProfile  # CRITICAL: attaches the SSM-enabled role to the instance
```";"```hcl
# Terraform: make the instance SSM-managed by attaching the required IAM role
resource ""aws_iam_role"" ""<example_resource_name>"" {
  name               = ""<example_resource_name>""
  assume_role_policy = jsonencode({
    Version = ""2012-10-17""
    Statement = [{
      Effect = ""Allow""
      Principal = { Service = ""ec2.amazonaws.com"" }
      Action   = ""sts:AssumeRole""
    }]
  })
}

resource ""aws_iam_role_policy_attachment"" ""<example_resource_name>_ssm"" {
  role       = aws_iam_role.<example_resource_name>.name
  policy_arn = ""arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore""  # CRITICAL: grants SSM permissions required for management
}

resource ""aws_iam_instance_profile"" ""<example_resource_name>"" {
  name = ""<example_resource_name>""
  role = aws_iam_role.<example_resource_name>.name
}

resource ""aws_instance"" ""<example_resource_name>"" {
  ami                  = ""ami-<example_resource_id>""
  instance_type        = ""t3.micro""
  iam_instance_profile = aws_iam_instance_profile.<example_resource_name>.name  # CRITICAL: attaches the SSM-enabled role to the instance
}
```";aws ec2 stop-instances --instance-ids <INSTANCE_ID>;"1. In IAM console: Create role > AWS service > EC2 > Next; attach policy ""AmazonSSMManagedInstanceCore""; Create role
2. In EC2 console: Instances > select the instance > Actions > Security > Modify IAM role > choose the role created above > Update IAM role
3. Wait a few minutes; in Systems Manager console: Managed nodes, verify the instance shows as Online
4. If the instance OS does not include SSM Agent by default, install the SSM Agent for that OS, then verify again";AWS-Well-Architected-Framework-Security-Pillar: SEC01-BP06, SEC06-BP04, SEC06-BP05 | ISO27001-2022: A.5.26 | NIST-800-171-Revision-2: 3_4_1, 3_4_2, 3_4_6, 3_4_9, 3_14_2 | NIST-800-53-Revision-4: cm_2, cm_7, cm_8_1, cm_8_3, sa_3, sa_10, si_2_2, si_7_1 | NIST-CSF-2.0: ac_3 | CISA: your-systems-1 | GxP-21-CFR-Part-11: 11.10-a, 11.10-h | NIST-800-53-Revision-5: cm_2_a, cm_2_b, cm_2_b_1, cm_2_b_2, cm_2_b_3, cm_2_2, cm_3_3, cm_6, cm_8_1, cm_8_2, cm_8_3_a, cm_8_6, cm_8_a, cm_8_a_1, cm_8_a_2, cm_8_a_3, cm_8_a_4, cm_8_a_5, cm_8_b, si_3_c_2 | KISA-ISMS-P-2023: 2.6.2, 2.10.2 | FedRamp-Moderate-Revision-4: cm-2, cm-7-a, cm-8-1, cm-8-3-a, sa-3-a, sa-10, si-2-2, si-7-1 | FedRAMP-Low-Revision-4: cm-8, sa-3 | FFIEC: d1-g-it-b-1, d3-pc-im-b-5 | ENS-RD2022: op.acc.4.aws.iam.6, op.acc.4.aws.sys.1, op.exp.1.aws.sys.1, op.exp.4.aws.sys.2, op.exp.4.r2.aws.sys.1, op.exp.9.aws.img.1, op.acc.4.aws.iam.3 | SOC2: cc_3_2, cc_7_1 | NIST-CSF-1.1: am_1, am_2, ds_3, ds_7, ds_8, ip_1, ip_2, ip_12 | AWS-Foundational-Security-Best-Practices: SSM.1 | HIPAA: 164_308_a_5_ii_b | RBI-Cyber-Security-Framework: annex_i_1_1 | KISA-ISMS-P-2023-korean: 2.6.2, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-cmt, ksi-piy;node-security;;;;5.18.1;https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/SSM/ssm-managed-instances.html | https://docs.aws.amazon.com/systems-manager/latest/userguide/managed_instances.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-ec2_instance_older_than_specific_days-132410971304-ap-northeast-2-i-0fbecaba3c48e7c79;aws;ec2_instance_older_than_specific_days;EC2 instance is not older than the configured maximum age or is not running;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Patch Management;PASS;EC2 Instance i-0fbecaba3c48e7c79 is not older than 180 days (79 days).;False;ec2;;medium;AwsEc2Instance;arn:aws:ec2:ap-northeast-2:132410971304:instance/i-0fbecaba3c48e7c79;i-0fbecaba3c48e7c79;;Name=webserver;aws;ap-northeast-2;**EC2 instances** are evaluated for age while in `running` state. Instances launched beyond the configurable limit (`max_ec2_instance_age_in_days`, default `180`) are flagged as older than the allowed lifetime. Stopped instances are ignored.;"Long-lived instances often run **unpatched OS and agents**, enabling:
- Exploitation of known CVEs  loss of confidentiality
- Privilege escalation and tampering  integrity compromise
- Malware/crypto-mining and instability  reduced availability

Aged hosts also drift from baselines and impede response.";;"Adopt **short-lived, patched workloads**:
- Rebuild regularly from hardened, updated images; rotate AMIs
- Use centralized patch management and vulnerability scanning
- Retire or modernize legacy hosts; tag for lifecycle
- Apply **least privilege** and **defense in depth** to limit blast radius

Adjust `max_ec2_instance_age_in_days` to match policy.";https://hub.prowler.com/check/ec2_instance_older_than_specific_days;;;aws ec2 stop-instances --instance-ids <example_resource_id>;"1. Sign in to the AWS Management Console and open EC2
2. Go to Instances and select the noncompliant instance
3. Choose Instance state > Stop instance
4. Confirm Stop
5. Verify the instance state is Stopped (the check passes when the instance is not running)";ISO27001-2022: A.8.10 | NIST-800-171-Revision-2: 3_4_1, 3_4_2 | NIST-800-53-Revision-4: cm_2 | CISA: your-systems-1 | GxP-21-CFR-Part-11: 11.10-a | NIST-800-53-Revision-5: cm_2_a, cm_2_b, cm_2_b_1, cm_2_b_2, cm_2_b_3, cm_2_2, cm_3_3, cm_8_6 | KISA-ISMS-P-2023: 2.9.2 | FedRamp-Moderate-Revision-4: cm-2 | FedRAMP-Low-Revision-4: cm-2 | FFIEC: d1-g-it-b-1 | NIST-CSF-1.1: ds_7, ip_1 | AWS-Foundational-Security-Best-Practices: EC2.4 | HIPAA: 164_308_a_1_ii_b | KISA-ISMS-P-2023-korean: 2.9.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-cmt;;;;;5.18.1;https://docs.aws.amazon.com/systems-manager/latest/userguide/viewing-patch-compliance-results.html | https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EC2/ec2-instance-too-old.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-ec2_instance_paravirtual_type-132410971304-ap-northeast-2-i-0fbecaba3c48e7c79;aws;ec2_instance_paravirtual_type;EC2 instance virtualization type is HVM;Software and Configuration Checks/AWS Security Best Practices;PASS;EC2 Instance i-0fbecaba3c48e7c79 virtualization type is set to HVM.;False;ec2;;medium;AwsEc2Instance;arn:aws:ec2:ap-northeast-2:132410971304:instance/i-0fbecaba3c48e7c79;i-0fbecaba3c48e7c79;;Name=webserver;aws;ap-northeast-2;"**EC2 instances** are evaluated for their virtualization mode. Instances with `virtualization_type` set to `paravirtual` are identified; those using **HVM** are recognized as hardware-assisted virtualization.";"Using **paravirtual (PV)** weakens isolation versus **HVM/Nitro** and blocks features like `ENA` and `NVMe`. Confidentiality and integrity can suffer due to reliance on legacy hypercalls/drivers; availability and performance may degrade under load, increasing exposure to kernel/driver exploits and noisy-neighbor impacts.";;"Standardize on **HVM/Nitro**. Migrate PV workloads to HVM AMIs and current instance families; ensure support for `ENA` and `NVMe`, current kernels, and hardened configs. Apply **defense in depth** and **least privilege**. Use immutable images with staged testing, then retire PV images to prevent drift and regressions.";https://hub.prowler.com/check/ec2_instance_paravirtual_type;"```yaml
# Launch an EC2 instance using an HVM-based AMI
Resources:
  <example_resource_name>:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: <HVM_AMI_ID>  # Critical: Using an HVM AMI ensures virtualization type is HVM
      InstanceType: t3.micro
```";"```hcl
# EC2 instance launched from an HVM AMI
resource ""aws_instance"" ""<example_resource_name>"" {
  ami           = ""<HVM_AMI_ID>""  # Critical: AMI must be HVM to pass the check
  instance_type = ""t3.micro""
}
```";aws ec2 terminate-instances --instance-ids <INSTANCE_ID>;"1. In the AWS Console, go to EC2 > Instances and select the instance with Virtualization type = paravirtual
2. Launch a replacement instance using any HVM-based AMI (e.g., Amazon Linux 2)
3. Verify the new instance is running
4. Back in EC2 > Instances, select the paravirtual instance, choose Instance state > Terminate instance, and confirm";ISO27001-2022: A.8.20, A.8.21, A.8.22 | KISA-ISMS-P-2023: 2.9.2 | AWS-Foundational-Security-Best-Practices: EC2.24 | KISA-ISMS-P-2023-korean: 2.9.2;node-security;;;;5.18.1;https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-24 | https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-resize.html | https://docs.aws.amazon.com/config/latest/developerguide/ec2-paravirtual-instance-check.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-ec2_instance_profile_attached-132410971304-ap-northeast-2-i-0fbecaba3c48e7c79;aws;ec2_instance_profile_attached;EC2 instance is associated with an IAM instance profile role;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;FAIL;EC2 Instance i-0fbecaba3c48e7c79 not associated with an Instance Profile Role.;False;ec2;;medium;AwsEc2Instance;arn:aws:ec2:ap-northeast-2:132410971304:instance/i-0fbecaba3c48e7c79;i-0fbecaba3c48e7c79;;Name=webserver;aws;ap-northeast-2;**EC2 instances** are evaluated for association with an **IAM instance profile role** that delivers temporary credentials to workloads running on the instance;Without an instance profile, apps often rely on long-term access keys on the host. Exposed keys can be used from anywhere to read data, alter resources, or disrupt services, impacting confidentiality, integrity, and availability. Keys may persist in AMIs, images, or logs, hindering rotation and amplifying blast radius.;;"Attach an **IAM instance profile** to every instance and grant only permissions each workload requires (**least privilege**). Eliminate static keys on hosts; use **temporary credentials** with automatic rotation. Separate roles per application, enforce **separation of duties**, and limit who can assign roles (govern via `iam:PassRole`). Monitor role usage for anomalies.";https://hub.prowler.com/check/ec2_instance_profile_attached;"```yaml
# CloudFormation: attach an IAM instance profile to the EC2 instance
Resources:
  ExampleInstance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: <AMI_ID>
      InstanceType: <INSTANCE_TYPE>
      IamInstanceProfile: <INSTANCE_PROFILE_NAME>  # Critical: associates an instance profile so the check passes
```";"```hcl
# Attach an IAM instance profile to the EC2 instance
resource ""aws_instance"" ""example"" {
  ami                  = ""<AMI_ID>""
  instance_type        = ""<INSTANCE_TYPE>""
  iam_instance_profile = ""<INSTANCE_PROFILE_NAME>""  # Critical: associates an instance profile so the check passes
}
```";aws ec2 associate-iam-instance-profile --instance-id <INSTANCE_ID> --iam-instance-profile Name=<INSTANCE_PROFILE_NAME>;"1. Open the AWS Management Console and go to EC2
2. Select Instances and choose the target instance
3. Click Actions > Security > Modify IAM role
4. Select the IAM role (instance profile) to attach
5. Click Update IAM role";AWS-Well-Architected-Framework-Security-Pillar: SEC03-BP01, SEC03-BP02, SEC06-BP04, SEC06-BP05 | ISO27001-2022: A.8.2, A.8.20, A.8.21, A.8.22 | CIS-1.5: 1.18 | NIS2: 11.1.1, 11.2.2.d | NIST-800-171-Revision-2: 3_1_1, 3_1_2 | CIS-5.0: 1.17 | GxP-21-CFR-Part-11: 11.10-d, 11.10-g | NIST-800-53-Revision-5: ac_3, cm_5_1_a, cm_6_a | ProwlerThreatScore-1.0: 1.2.4 | KISA-ISMS-P-2023: 2.5.1, 2.5.6, 2.10.2 | CIS-1.4: 1.18 | C5-2025: HR-01.01B, AM-03.01B, IAM-01.01B, IAM-01.04B, IAM-03.03B, IAM-08.02B, IAM-10.01B, IAM-10.02B, PSS-09.01AC | FFIEC: d3-pc-am-b-1 | CIS-4.0.1: 1.18 | CIS-2.0: 1.18 | CIS-3.0: 1.18 | PCI-4.0: 7.2.1.5, 7.2.2.5, 7.2.5.3, 7.3.1.3, 7.3.2.3, 7.3.3.3, 8.2.7.3, 8.2.8.5, 8.3.4.3 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.6, 2.10.2;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-ec2.html | https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EC2/ec2-instance-using-iam-roles.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-ec2_instance_public_ip-132410971304-ap-northeast-2-i-0fbecaba3c48e7c79;aws;ec2_instance_public_ip;EC2 instance does not have a public IP address;Software and Configuration Checks/AWS Security Best Practices/Network Reachability | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | TTPs/Initial Access;FAIL;EC2 Instance i-0fbecaba3c48e7c79 has a Public IP: 13.125.246.210 (ec2-13-125-246-210.ap-northeast-2.compute.amazonaws.com).;False;ec2;;medium;AwsEc2Instance;arn:aws:ec2:ap-northeast-2:132410971304:instance/i-0fbecaba3c48e7c79;i-0fbecaba3c48e7c79;;Name=webserver;aws;ap-northeast-2;"**EC2 instances** are assessed for the presence of a **public IPv4 address** and public DNS. A public IP indicates the instance is directly reachable from the Internet; no public IP implies access only through private networking paths such as load balancers, gateways, or proxies.";Publicly addressed instances are Internet-scannable, enabling direct probing and brute-force of exposed services and management ports. This increases risks of unauthorized access, remote code execution, and data exfiltration (**confidentiality, integrity**), and allows direct DDoS targeting, degrading **availability**.;;"Avoid assigning public IPs unless strictly required. Place workloads in private subnets and expose only via **load balancers** with **WAF**; use **bastions** or **Session Manager** for administration. Enforce **least privilege** security groups, prefer **private endpoints**, and route egress via **NAT** for **defense in depth**.";https://hub.prowler.com/check/ec2_instance_public_ip;"```yaml
# CloudFormation: Launch EC2 without a public IP
Resources:
  ExampleInstance:
    Type: AWS::EC2::Instance
    Properties:
      ImageId: <ami_id>
      InstanceType: <instance_type>
      NetworkInterfaces:
        - DeviceIndex: 0
          SubnetId: <example_subnet_id>
          AssociatePublicIpAddress: false  # CRITICAL: ensures the instance has no public IPv4 address
```";"```hcl
# Terraform: Launch EC2 without a public IP
resource ""aws_instance"" ""example"" {
  ami           = ""<ami_id>""
  instance_type = ""<instance_type>""
  subnet_id     = ""<example_subnet_id>""

  associate_public_ip_address = false  # CRITICAL: ensures no public IPv4 is assigned
}
```";;"1. In the AWS Console, go to EC2 > Instances and select the instance with a public IPv4 address
2. Check the Networking tab to see if an Elastic IP is attached
3. If an Elastic IP is attached:
   - Go to EC2 > Elastic IPs, select the address, choose Actions > Disassociate Elastic IP
4. If the public IPv4 is auto-assigned (no Elastic IP shown):
   - Create a new instance (or an AMI from the current one) and, during launch, in Network settings, set Auto-assign public IP to Disable
   - Verify the new instance has no public IPv4, then migrate and terminate the old instance";AWS-Well-Architected-Framework-Security-Pillar: SEC03-BP07 | ISO27001-2022: A.8.1, A.8.20, A.8.21, A.8.22 | AWS-Foundational-Technical-Review: NETSEC-001 | PCI-3.2.1: 1.3, 2.2, 2.2.2, 7.2, 7.2.1 | NIST-800-171-Revision-2: 3_1_1, 3_1_2, 3_1_3, 3_1_14, 3_13_2, 3_13_5 | NIST-800-53-Revision-4: ac_4, ac_6, ac_21, sc_7_3, sc_7 | NIST-CSF-2.0: ip_1 | CISA: your-systems-3, your-data-2 | GxP-21-CFR-Part-11: 11.10-d, 11.10-g | NIST-800-53-Revision-5: ac_2_6, ac_3, ac_3_7, ac_4_21, ac_6, ac_17_b, ac_17_1, ac_17_4_a, ac_17_9, ac_17_10, mp_2, sc_7_2, sc_7_3, sc_7_7, sc_7_9_a, sc_7_11, sc_7_12, sc_7_16, sc_7_20, sc_7_21, sc_7_24_b, sc_7_25, sc_7_26, sc_7_27, sc_7_28, sc_7_a, sc_7_b, sc_7_c, sc_25 | KISA-ISMS-P-2023: 2.6.1, 2.10.2 | FedRamp-Moderate-Revision-4: ac-3, ac-4, ac-6, ac-17-1, ac-21-b, cm-2, sc-7-3, sc-7 | C5-2025: PS-03.02B | FedRAMP-Low-Revision-4: ac-3, ac-17, cm-2, sc-7 | FFIEC: d3-pc-im-b-1 | SOC2: cc_6_6 | NIST-CSF-1.1: ac_3, ac_5, ip_8 | AWS-Foundational-Security-Best-Practices: EC2.9 | HIPAA: 164_308_a_1_ii_b, 164_308_a_3_i, 164_312_a_1 | RBI-Cyber-Security-Framework: annex_i_1_3 | MITRE-ATTACK: T1190 | KISA-ISMS-P-2023-korean: 2.6.1, 2.10.2;internet-exposed;;;;5.18.1;https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EC2/aws-ec2-public-ip.html | https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-ec2_instance_with_outdated_ami-132410971304-ap-northeast-2-i-0fbecaba3c48e7c79;aws;ec2_instance_with_outdated_ami;EC2 instance uses a non-deprecated Amazon AMI;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Patch Management | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices;PASS;EC2 Instance i-0fbecaba3c48e7c79 is not using an outdated AMI.;False;ec2;;medium;AwsEc2Instance;arn:aws:ec2:ap-northeast-2:132410971304:instance/i-0fbecaba3c48e7c79;i-0fbecaba3c48e7c79;;Name=webserver;aws;ap-northeast-2;"**EC2 instances** launched from **Amazon-owned AMIs** are evaluated for the AMI's `DeprecationTime`; instances tied to images with a deprecation date in the past are reported as using **deprecated AMIs**.";"Running on a **deprecated AMI** undermines security and availability:
- Missing patches enable exploitation of known CVEs (confidentiality/integrity)
- Unsupported components hinder hardening and forensics
- AMI removal from catalogs complicates scale-out and recovery (availability)";;Adopt **non-deprecated, maintained AMIs** and perform rolling replacements of affected instances. Standardize on hardened golden images with **regular AMI rotation** and `DeprecationTime` monitoring. Update launch templates/ASGs to reference current images. Automate patching via an image pipeline and apply **defense in depth**.;https://hub.prowler.com/check/ec2_instance_with_outdated_ami;"```yaml
# Use a non-deprecated Amazon AMI for instances launched via this template
Resources:
  <example_resource_name>:
    Type: AWS::EC2::LaunchTemplate
    Properties:
      LaunchTemplateData:
        ImageId: ""<non_deprecated_amazon_ami_id>""  # Critical: Amazon-owned AMI with no DeprecationTime
```";"```hcl
# EC2 instance using a non-deprecated Amazon AMI
resource ""aws_instance"" ""<example_resource_name>"" {
  ami           = ""<non_deprecated_amazon_ami_id>""  # Critical: Amazon-owned AMI with no DeprecationTime
  instance_type = ""t3.micro""
}
```";;"1. In the EC2 console, go to AMIs
2. Set Owner to ""Amazon"" and ensure deprecated AMIs are not included; copy the AMI ID
3. If using an Auto Scaling Group:
   - Launch templates > select the one in use > Create new version with Image ID set to the copied AMI and set it as default
   - Auto Scaling Groups > select the group > Start instance refresh
4. If it is a standalone instance:
   - Launch a new instance using the copied Amazon AMI
   - Move workloads and terminate the old instance";;vulnerabilities;;;;5.18.1;https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ami-deprecate.html | https://repost.aws/knowledge-center/ec2-find-deprecated-ami
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-ec2_networkacl_allow_ingress_tcp_port_22-132410971304-ap-northeast-2-acl-0572e1ab82993bb20;aws;ec2_networkacl_allow_ingress_tcp_port_22;Network ACL does not allow ingress from the Internet to TCP port 22 (SSH);Software and Configuration Checks/AWS Security Best Practices/Network Reachability | TTPs/Initial Access;FAIL;Network ACL acl-0572e1ab82993bb20 has SSH port 22 open to the Internet.;False;ec2;;medium;AwsEc2NetworkAcl;arn:aws:ec2:ap-northeast-2:132410971304:network-acl/acl-0572e1ab82993bb20;acl-0572e1ab82993bb20;;;aws;ap-northeast-2;**VPC network ACLs** are evaluated for inbound rules that permit `0.0.0.0/0` to access **SSH** on `TCP 22` at the subnet boundary.;"An ACL allowing Internet-wide SSH erodes **defense in depth**. Systems reachable on `TCP 22` face **brute-force**, credential stuffing, reconnaissance, and SSH exploit attempts.

Changes to routes or security groups can create direct exposure, enabling unauthorized access and **lateral movement**, undermining **confidentiality** and **integrity**.";;"Apply **least privilege** at the subnet layer:
- Do not allow `0.0.0.0/0` to `TCP 22`
- Restrict SSH to trusted sources, or avoid direct SSH via **Session Manager** or a bastion behind **VPN**

Pair tight **security groups** with periodic rule reviews and change control to maintain **defense in depth**.";https://hub.prowler.com/check/ec2_networkacl_allow_ingress_tcp_port_22;"```yaml
# CloudFormation: Deny SSH (22) from Internet on the NACL
Resources:
  <example_resource_name>:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
      NetworkAclId: <example_resource_id>
      RuleNumber: 1
      Protocol: 6
      RuleAction: deny   # Critical: blocks the traffic instead of allowing it
      Egress: false
      CidrBlock: 0.0.0.0/0  # Critical: matches Internet sources
      PortRange:
        From: 22           # Critical: SSH port
        To: 22
```";"```hcl
# Deny SSH (22) from Internet on the NACL
resource ""aws_network_acl_rule"" ""<example_resource_name>"" {
  network_acl_id = ""<example_resource_id>""
  rule_number    = 1
  egress         = false
  protocol       = ""tcp""
  rule_action    = ""deny""          # Critical: blocks SSH ingress
  cidr_block     = ""0.0.0.0/0""     # Critical: Internet sources
  from_port      = 22               # Critical: SSH port
  to_port        = 22
}
```";aws ec2 replace-network-acl-entry --network-acl-id <NETWORK_ACL_ID> --ingress --rule-number <RULE_NUMBER> --protocol 6 --rule-action deny --cidr-block 0.0.0.0/0 --port-range From=22,To=22;"1. In AWS Console, go to VPC > Network ACLs
2. Select <example_resource_name> and open the Inbound rules tab
3. Delete any rule that ALLOWS TCP port 22 from 0.0.0.0/0 or ::/0
4. Save changes
5. If you cannot delete it, edit the rule and set Action to Deny for TCP port 22 with source 0.0.0.0/0 (and ::/0 if present), then save";AWS-Well-Architected-Framework-Security-Pillar: SEC05-BP02, SEC05-BP03 | ISO27001-2022: A.8.20, A.8.21, A.8.22 | PCI-3.2.1: 1.2, 1.2.1, 1.2.1.a, 1.2.1.b, 1.2.1.c, 1.2.3, 1.2.3.b, 1.3, 1.3.2 | CIS-1.5: 5.1 | NIS2: 6.7.2.g | CIS-5.0: 5.2 | ProwlerThreatScore-1.0: 2.1.3 | KISA-ISMS-P-2023: 2.6.1, 2.6.6, 2.10.2 | CIS-1.4: 5.1 | C5-2025: PI-01.01AC | SOC2: cc_6_6 | CIS-4.0.1: 5.2 | AWS-Foundational-Security-Best-Practices: EC2.21 | CIS-2.0: 5.1 | CCC: CCC.Core.CN01.AR02, CCC.Core.CN05.AR05 | CIS-3.0: 5.1 | MITRE-ATTACK: T1199, T1048, T1499, T1498, T1046 | KISA-ISMS-P-2023-korean: 2.6.1, 2.6.6, 2.10.2;internet-exposed;;;;5.18.1;https://support.icompaas.com/support/solutions/articles/62000233578-ensure-no-network-acls-allow-ingress-from-0-0-0-0-0-to-ssh-port-22 | https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-ec2_networkacl_allow_ingress_tcp_port_22-132410971304-ap-northeast-2-acl-0d23e762ebdfb131c;aws;ec2_networkacl_allow_ingress_tcp_port_22;Network ACL does not allow ingress from the Internet to TCP port 22 (SSH);Software and Configuration Checks/AWS Security Best Practices/Network Reachability | TTPs/Initial Access;FAIL;Network ACL acl-0d23e762ebdfb131c has SSH port 22 open to the Internet.;False;ec2;;medium;AwsEc2NetworkAcl;arn:aws:ec2:ap-northeast-2:132410971304:network-acl/acl-0d23e762ebdfb131c;acl-0d23e762ebdfb131c;;;aws;ap-northeast-2;**VPC network ACLs** are evaluated for inbound rules that permit `0.0.0.0/0` to access **SSH** on `TCP 22` at the subnet boundary.;"An ACL allowing Internet-wide SSH erodes **defense in depth**. Systems reachable on `TCP 22` face **brute-force**, credential stuffing, reconnaissance, and SSH exploit attempts.

Changes to routes or security groups can create direct exposure, enabling unauthorized access and **lateral movement**, undermining **confidentiality** and **integrity**.";;"Apply **least privilege** at the subnet layer:
- Do not allow `0.0.0.0/0` to `TCP 22`
- Restrict SSH to trusted sources, or avoid direct SSH via **Session Manager** or a bastion behind **VPN**

Pair tight **security groups** with periodic rule reviews and change control to maintain **defense in depth**.";https://hub.prowler.com/check/ec2_networkacl_allow_ingress_tcp_port_22;"```yaml
# CloudFormation: Deny SSH (22) from Internet on the NACL
Resources:
  <example_resource_name>:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
      NetworkAclId: <example_resource_id>
      RuleNumber: 1
      Protocol: 6
      RuleAction: deny   # Critical: blocks the traffic instead of allowing it
      Egress: false
      CidrBlock: 0.0.0.0/0  # Critical: matches Internet sources
      PortRange:
        From: 22           # Critical: SSH port
        To: 22
```";"```hcl
# Deny SSH (22) from Internet on the NACL
resource ""aws_network_acl_rule"" ""<example_resource_name>"" {
  network_acl_id = ""<example_resource_id>""
  rule_number    = 1
  egress         = false
  protocol       = ""tcp""
  rule_action    = ""deny""          # Critical: blocks SSH ingress
  cidr_block     = ""0.0.0.0/0""     # Critical: Internet sources
  from_port      = 22               # Critical: SSH port
  to_port        = 22
}
```";aws ec2 replace-network-acl-entry --network-acl-id <NETWORK_ACL_ID> --ingress --rule-number <RULE_NUMBER> --protocol 6 --rule-action deny --cidr-block 0.0.0.0/0 --port-range From=22,To=22;"1. In AWS Console, go to VPC > Network ACLs
2. Select <example_resource_name> and open the Inbound rules tab
3. Delete any rule that ALLOWS TCP port 22 from 0.0.0.0/0 or ::/0
4. Save changes
5. If you cannot delete it, edit the rule and set Action to Deny for TCP port 22 with source 0.0.0.0/0 (and ::/0 if present), then save";AWS-Well-Architected-Framework-Security-Pillar: SEC05-BP02, SEC05-BP03 | ISO27001-2022: A.8.20, A.8.21, A.8.22 | PCI-3.2.1: 1.2, 1.2.1, 1.2.1.a, 1.2.1.b, 1.2.1.c, 1.2.3, 1.2.3.b, 1.3, 1.3.2 | CIS-1.5: 5.1 | NIS2: 6.7.2.g | CIS-5.0: 5.2 | ProwlerThreatScore-1.0: 2.1.3 | KISA-ISMS-P-2023: 2.6.1, 2.6.6, 2.10.2 | CIS-1.4: 5.1 | C5-2025: PI-01.01AC | SOC2: cc_6_6 | CIS-4.0.1: 5.2 | AWS-Foundational-Security-Best-Practices: EC2.21 | CIS-2.0: 5.1 | CCC: CCC.Core.CN01.AR02, CCC.Core.CN05.AR05 | CIS-3.0: 5.1 | MITRE-ATTACK: T1199, T1048, T1499, T1498, T1046 | KISA-ISMS-P-2023-korean: 2.6.1, 2.6.6, 2.10.2;internet-exposed;;;;5.18.1;https://support.icompaas.com/support/solutions/articles/62000233578-ensure-no-network-acls-allow-ingress-from-0-0-0-0-0-to-ssh-port-22 | https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-ec2_networkacl_allow_ingress_tcp_port_3389-132410971304-ap-northeast-2-acl-0572e1ab82993bb20;aws;ec2_networkacl_allow_ingress_tcp_port_3389;Network ACL does not allow ingress from the Internet to TCP port 3389 (RDP);Software and Configuration Checks/AWS Security Best Practices/Network Reachability | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | TTPs/Initial Access;FAIL;Network ACL acl-0572e1ab82993bb20 has Microsoft RDP port 3389 open to the Internet.;False;ec2;;medium;AwsEc2NetworkAcl;arn:aws:ec2:ap-northeast-2:132410971304:network-acl/acl-0572e1ab82993bb20;acl-0572e1ab82993bb20;;;aws;ap-northeast-2;"**VPC network ACLs** with inbound rules allowing **RDP** on `TCP 3389` from `0.0.0.0/0` are identified.

Assessment focuses on subnet-level ACL entries that permit this traffic.";Internet-exposed **RDP** enables **password spraying**, brute force, and exploitation of RDP flaws to gain remote control. Allowing it at the subnet layer weakens **defense in depth**-a misconfigured security group or route can expose instances-leading to data exfiltration, privilege escalation, and ransomware, impacting confidentiality and integrity.;;"Enforce **least privilege**: do not allow `TCP 3389` from `0.0.0.0/0` in network ACLs.

- Restrict RDP to specific admin IP ranges
- Prefer **bastion hosts** or **Session Manager** over direct RDP
- Use private subnets and layer controls for **defense in depth**";https://hub.prowler.com/check/ec2_networkacl_allow_ingress_tcp_port_3389;"```yaml
# CloudFormation: deny inbound RDP (TCP 3389) from the Internet on an existing NACL
Resources:
  NetworkAclDenyRDP:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
      NetworkAclId: <example_resource_id>
      RuleNumber: 1                 # Critical: ensure this deny is evaluated before any allow
      Protocol: 6                   # TCP
      Egress: false                 # Ingress rule
      RuleAction: deny              # Critical: block the traffic
      CidrBlock: 0.0.0.0/0          # Critical: Internet source
      PortRange:
        From: 3389                  # Critical: RDP port
        To: 3389
```";"```hcl
# Deny inbound RDP (TCP 3389) from the Internet on an existing NACL
resource ""aws_network_acl_rule"" ""<example_resource_name>"" {
  network_acl_id = ""<example_resource_id>""
  rule_number    = 1                 # Critical: lower than any allow so deny takes precedence
  egress         = false             # Ingress rule
  protocol       = ""tcp""
  rule_action    = ""deny""            # Critical: block the traffic
  cidr_block     = ""0.0.0.0/0""       # Critical: Internet source
  from_port      = 3389              # Critical: RDP port
  to_port        = 3389
}
```";aws ec2 delete-network-acl-entry --network-acl-id <NETWORK_ACL_ID> --ingress --rule-number <RULE_NUMBER>;"1. In the AWS Console, go to VPC > Network ACLs and select the ACL used by the affected subnet(s)
2. Open the Inbound rules tab
3. Find any rule allowing TCP port 3389 (RDP) from 0.0.0.0/0 or ::/0
4. Select that rule and click Delete, then Save
5. If you must keep broad allows, instead click Edit inbound rules and add a new rule with a lower rule number that Denies TCP 3389 from 0.0.0.0/0, then Save";AWS-Well-Architected-Framework-Security-Pillar: SEC05-BP03 | ISO27001-2022: A.8.20, A.8.21, A.8.22 | PCI-3.2.1: 1.2, 1.2.1, 1.2.1.a, 1.2.1.b, 1.2.1.c, 1.2.3, 1.2.3.b, 1.3, 1.3.2 | CIS-1.5: 5.1 | NIS2: 6.7.2.g | CIS-5.0: 5.2 | ProwlerThreatScore-1.0: 2.1.3 | KISA-ISMS-P-2023: 2.6.1, 2.6.6, 2.10.2 | CIS-1.4: 5.1 | C5-2025: PI-01.01AC | SOC2: cc_6_6 | CIS-4.0.1: 5.2 | AWS-Foundational-Security-Best-Practices: EC2.21 | CIS-2.0: 5.1 | CCC: CCC.Core.CN05.AR05 | CIS-3.0: 5.1 | MITRE-ATTACK: T1199, T1048, T1499, T1498, T1046 | PCI-4.0: 1.2.8.21, 1.3.1.24, 1.3.2.24, 1.4.2.22, 1.5.1.21, A1.1.3.21 | KISA-ISMS-P-2023-korean: 2.6.1, 2.6.6, 2.10.2;internet-exposed;;;;5.18.1;https://support.icompaas.com/support/solutions/articles/62000223179-ensure-no-network-acls-allow-ingress-from-0-0-0-0-0-to-microsoft-rdp-port-3389- | https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-ec2_networkacl_allow_ingress_tcp_port_3389-132410971304-ap-northeast-2-acl-0d23e762ebdfb131c;aws;ec2_networkacl_allow_ingress_tcp_port_3389;Network ACL does not allow ingress from the Internet to TCP port 3389 (RDP);Software and Configuration Checks/AWS Security Best Practices/Network Reachability | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | TTPs/Initial Access;FAIL;Network ACL acl-0d23e762ebdfb131c has Microsoft RDP port 3389 open to the Internet.;False;ec2;;medium;AwsEc2NetworkAcl;arn:aws:ec2:ap-northeast-2:132410971304:network-acl/acl-0d23e762ebdfb131c;acl-0d23e762ebdfb131c;;;aws;ap-northeast-2;"**VPC network ACLs** with inbound rules allowing **RDP** on `TCP 3389` from `0.0.0.0/0` are identified.

Assessment focuses on subnet-level ACL entries that permit this traffic.";Internet-exposed **RDP** enables **password spraying**, brute force, and exploitation of RDP flaws to gain remote control. Allowing it at the subnet layer weakens **defense in depth**-a misconfigured security group or route can expose instances-leading to data exfiltration, privilege escalation, and ransomware, impacting confidentiality and integrity.;;"Enforce **least privilege**: do not allow `TCP 3389` from `0.0.0.0/0` in network ACLs.

- Restrict RDP to specific admin IP ranges
- Prefer **bastion hosts** or **Session Manager** over direct RDP
- Use private subnets and layer controls for **defense in depth**";https://hub.prowler.com/check/ec2_networkacl_allow_ingress_tcp_port_3389;"```yaml
# CloudFormation: deny inbound RDP (TCP 3389) from the Internet on an existing NACL
Resources:
  NetworkAclDenyRDP:
    Type: AWS::EC2::NetworkAclEntry
    Properties:
      NetworkAclId: <example_resource_id>
      RuleNumber: 1                 # Critical: ensure this deny is evaluated before any allow
      Protocol: 6                   # TCP
      Egress: false                 # Ingress rule
      RuleAction: deny              # Critical: block the traffic
      CidrBlock: 0.0.0.0/0          # Critical: Internet source
      PortRange:
        From: 3389                  # Critical: RDP port
        To: 3389
```";"```hcl
# Deny inbound RDP (TCP 3389) from the Internet on an existing NACL
resource ""aws_network_acl_rule"" ""<example_resource_name>"" {
  network_acl_id = ""<example_resource_id>""
  rule_number    = 1                 # Critical: lower than any allow so deny takes precedence
  egress         = false             # Ingress rule
  protocol       = ""tcp""
  rule_action    = ""deny""            # Critical: block the traffic
  cidr_block     = ""0.0.0.0/0""       # Critical: Internet source
  from_port      = 3389              # Critical: RDP port
  to_port        = 3389
}
```";aws ec2 delete-network-acl-entry --network-acl-id <NETWORK_ACL_ID> --ingress --rule-number <RULE_NUMBER>;"1. In the AWS Console, go to VPC > Network ACLs and select the ACL used by the affected subnet(s)
2. Open the Inbound rules tab
3. Find any rule allowing TCP port 3389 (RDP) from 0.0.0.0/0 or ::/0
4. Select that rule and click Delete, then Save
5. If you must keep broad allows, instead click Edit inbound rules and add a new rule with a lower rule number that Denies TCP 3389 from 0.0.0.0/0, then Save";AWS-Well-Architected-Framework-Security-Pillar: SEC05-BP03 | ISO27001-2022: A.8.20, A.8.21, A.8.22 | PCI-3.2.1: 1.2, 1.2.1, 1.2.1.a, 1.2.1.b, 1.2.1.c, 1.2.3, 1.2.3.b, 1.3, 1.3.2 | CIS-1.5: 5.1 | NIS2: 6.7.2.g | CIS-5.0: 5.2 | ProwlerThreatScore-1.0: 2.1.3 | KISA-ISMS-P-2023: 2.6.1, 2.6.6, 2.10.2 | CIS-1.4: 5.1 | C5-2025: PI-01.01AC | SOC2: cc_6_6 | CIS-4.0.1: 5.2 | AWS-Foundational-Security-Best-Practices: EC2.21 | CIS-2.0: 5.1 | CCC: CCC.Core.CN05.AR05 | CIS-3.0: 5.1 | MITRE-ATTACK: T1199, T1048, T1499, T1498, T1046 | PCI-4.0: 1.2.8.21, 1.3.1.24, 1.3.2.24, 1.4.2.22, 1.5.1.21, A1.1.3.21 | KISA-ISMS-P-2023-korean: 2.6.1, 2.6.6, 2.10.2;internet-exposed;;;;5.18.1;https://support.icompaas.com/support/solutions/articles/62000223179-ensure-no-network-acls-allow-ingress-from-0-0-0-0-0-to-microsoft-rdp-port-3389- | https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-ec2_securitygroup_from_launch_wizard-132410971304-ap-northeast-2-sg-0a48adc1c033afb1f;aws;ec2_securitygroup_from_launch_wizard;Security group not created using the EC2 Launch Wizard;Software and Configuration Checks/AWS Security Best Practices/Network Reachability;PASS;Security group default (sg-0a48adc1c033afb1f) was not created using the EC2 Launch Wizard.;False;ec2;;medium;AwsEc2SecurityGroup;arn:aws:ec2:ap-northeast-2:132410971304:security-group/sg-0a48adc1c033afb1f;sg-0a48adc1c033afb1f;default;;aws;ap-northeast-2;**EC2 security groups** whose names include `launch-wizard` are identified as created by the **EC2 Launch Wizard**, distinguishing auto-generated groups from curated, baseline-controlled groups.;"Wizard-generated groups often include **overly permissive rules** (e.g., `0.0.0.0/0` to admin ports), expanding exposure. Attackers can run **port scans** and **brute-force** to gain entry, then **lateral movement** and **data exfiltration**, impacting **confidentiality** and **integrity**; broad egress aids command-and-control.";;Replace or harden these groups. Apply **least privilege**: restrict inbound to required sources, avoid public admin ports, and minimize egress. Use approved baseline security groups, enforce change control with IaC and guardrails, prefer private administration (bastion or Session Manager), and remove unused rules.;https://hub.prowler.com/check/ec2_securitygroup_from_launch_wizard;"```yaml
# CloudFormation: create a security group not named by Launch Wizard
Resources:
  <example_resource_name>:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: SG not created by Launch Wizard
      VpcId: <example_resource_id>
      GroupName: <example_resource_name>  # Critical: name does NOT contain ""launch-wizard"" to avoid FAIL
```";"```hcl
# Create a security group not named by Launch Wizard
resource ""aws_security_group"" ""<example_resource_name>"" {
  name   = ""<example_resource_name>""  # Critical: name does NOT contain ""launch-wizard"" to avoid FAIL
  vpc_id = ""<example_resource_id>""
}
```";aws ec2 delete-security-group --group-id <SECURITY_GROUP_ID>;"1. In the AWS console, go to EC2 > Network & Security > Security Groups
2. In the search box, filter by Name contains ""launch-wizard""
3. For each matching group, open the References tab and remove it from any ENIs/instances by replacing it with a different security group
4. Select the launch-wizard security group and choose Actions > Delete security group > Delete
5. Verify no security groups remain with names containing ""launch-wizard""";AWS-Well-Architected-Framework-Security-Pillar: SEC05-BP03 | ISO27001-2022: A.8.20, A.8.21, A.8.22 | KISA-ISMS-P-2023: 2.10.2 | ENS-RD2022: mp.com.1.aws.sg.1 | KISA-ISMS-P-2023-korean: 2.10.2;;;;;5.18.1;https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EC2/security-group-prefixed-with-launch-wizard.html | https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-ec2_securitygroup_from_launch_wizard-132410971304-ap-northeast-2-sg-0c86f4f14357f43de;aws;ec2_securitygroup_from_launch_wizard;Security group not created using the EC2 Launch Wizard;Software and Configuration Checks/AWS Security Best Practices/Network Reachability;PASS;Security group default (sg-0c86f4f14357f43de) was not created using the EC2 Launch Wizard.;False;ec2;;medium;AwsEc2SecurityGroup;arn:aws:ec2:ap-northeast-2:132410971304:security-group/sg-0c86f4f14357f43de;sg-0c86f4f14357f43de;default;;aws;ap-northeast-2;**EC2 security groups** whose names include `launch-wizard` are identified as created by the **EC2 Launch Wizard**, distinguishing auto-generated groups from curated, baseline-controlled groups.;"Wizard-generated groups often include **overly permissive rules** (e.g., `0.0.0.0/0` to admin ports), expanding exposure. Attackers can run **port scans** and **brute-force** to gain entry, then **lateral movement** and **data exfiltration**, impacting **confidentiality** and **integrity**; broad egress aids command-and-control.";;Replace or harden these groups. Apply **least privilege**: restrict inbound to required sources, avoid public admin ports, and minimize egress. Use approved baseline security groups, enforce change control with IaC and guardrails, prefer private administration (bastion or Session Manager), and remove unused rules.;https://hub.prowler.com/check/ec2_securitygroup_from_launch_wizard;"```yaml
# CloudFormation: create a security group not named by Launch Wizard
Resources:
  <example_resource_name>:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: SG not created by Launch Wizard
      VpcId: <example_resource_id>
      GroupName: <example_resource_name>  # Critical: name does NOT contain ""launch-wizard"" to avoid FAIL
```";"```hcl
# Create a security group not named by Launch Wizard
resource ""aws_security_group"" ""<example_resource_name>"" {
  name   = ""<example_resource_name>""  # Critical: name does NOT contain ""launch-wizard"" to avoid FAIL
  vpc_id = ""<example_resource_id>""
}
```";aws ec2 delete-security-group --group-id <SECURITY_GROUP_ID>;"1. In the AWS console, go to EC2 > Network & Security > Security Groups
2. In the search box, filter by Name contains ""launch-wizard""
3. For each matching group, open the References tab and remove it from any ENIs/instances by replacing it with a different security group
4. Select the launch-wizard security group and choose Actions > Delete security group > Delete
5. Verify no security groups remain with names containing ""launch-wizard""";AWS-Well-Architected-Framework-Security-Pillar: SEC05-BP03 | ISO27001-2022: A.8.20, A.8.21, A.8.22 | KISA-ISMS-P-2023: 2.10.2 | ENS-RD2022: mp.com.1.aws.sg.1 | KISA-ISMS-P-2023-korean: 2.10.2;;;;;5.18.1;https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EC2/security-group-prefixed-with-launch-wizard.html | https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-ec2_securitygroup_from_launch_wizard-132410971304-ap-northeast-2-sg-04e3503c576b68504;aws;ec2_securitygroup_from_launch_wizard;Security group not created using the EC2 Launch Wizard;Software and Configuration Checks/AWS Security Best Practices/Network Reachability;FAIL;Security group launch-wizard-1 (sg-04e3503c576b68504) was created using the EC2 Launch Wizard.;False;ec2;;medium;AwsEc2SecurityGroup;arn:aws:ec2:ap-northeast-2:132410971304:security-group/sg-04e3503c576b68504;sg-04e3503c576b68504;launch-wizard-1;;aws;ap-northeast-2;**EC2 security groups** whose names include `launch-wizard` are identified as created by the **EC2 Launch Wizard**, distinguishing auto-generated groups from curated, baseline-controlled groups.;"Wizard-generated groups often include **overly permissive rules** (e.g., `0.0.0.0/0` to admin ports), expanding exposure. Attackers can run **port scans** and **brute-force** to gain entry, then **lateral movement** and **data exfiltration**, impacting **confidentiality** and **integrity**; broad egress aids command-and-control.";;Replace or harden these groups. Apply **least privilege**: restrict inbound to required sources, avoid public admin ports, and minimize egress. Use approved baseline security groups, enforce change control with IaC and guardrails, prefer private administration (bastion or Session Manager), and remove unused rules.;https://hub.prowler.com/check/ec2_securitygroup_from_launch_wizard;"```yaml
# CloudFormation: create a security group not named by Launch Wizard
Resources:
  <example_resource_name>:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: SG not created by Launch Wizard
      VpcId: <example_resource_id>
      GroupName: <example_resource_name>  # Critical: name does NOT contain ""launch-wizard"" to avoid FAIL
```";"```hcl
# Create a security group not named by Launch Wizard
resource ""aws_security_group"" ""<example_resource_name>"" {
  name   = ""<example_resource_name>""  # Critical: name does NOT contain ""launch-wizard"" to avoid FAIL
  vpc_id = ""<example_resource_id>""
}
```";aws ec2 delete-security-group --group-id <SECURITY_GROUP_ID>;"1. In the AWS console, go to EC2 > Network & Security > Security Groups
2. In the search box, filter by Name contains ""launch-wizard""
3. For each matching group, open the References tab and remove it from any ENIs/instances by replacing it with a different security group
4. Select the launch-wizard security group and choose Actions > Delete security group > Delete
5. Verify no security groups remain with names containing ""launch-wizard""";AWS-Well-Architected-Framework-Security-Pillar: SEC05-BP03 | ISO27001-2022: A.8.20, A.8.21, A.8.22 | KISA-ISMS-P-2023: 2.10.2 | ENS-RD2022: mp.com.1.aws.sg.1 | KISA-ISMS-P-2023-korean: 2.10.2;;;;;5.18.1;https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EC2/security-group-prefixed-with-launch-wizard.html | https://docs.aws.amazon.com/eks/latest/userguide/sec-group-reqs.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-ec2_securitygroup_with_many_ingress_egress_rules-132410971304-ap-northeast-2-sg-0a48adc1c033afb1f;aws;ec2_securitygroup_with_many_ingress_egress_rules;Security group has 50 or fewer inbound rules and 50 or fewer outbound rules;Software and Configuration Checks/AWS Security Best Practices/Network Reachability | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;PASS;Security group default (sg-0a48adc1c033afb1f) has 0 inbound rules and 1 outbound rules.;False;ec2;;medium;AwsEc2SecurityGroup;arn:aws:ec2:ap-northeast-2:132410971304:security-group/sg-0a48adc1c033afb1f;sg-0a48adc1c033afb1f;default;;aws;ap-northeast-2;**EC2 security groups** are evaluated for excessive rule counts, flagging groups where `ingress` or `egress` entries exceed the configured threshold (default `50`). This targets groups with unusually large rule sets that complicate access control.;**Rule sprawl** weakens **least privilege**: large rule sets can hide overly permissive entries, exposing services to the Internet or unintended peers. This enables unauthorized access, data exfiltration, and lateral movement, impacting **confidentiality** and **integrity**, and can threaten **availability** via abuse of exposed services.;;"Apply **least privilege** and **segmentation**:
- Limit rules to required ports, protocols, and sources
- Split workloads into dedicated security groups per role
- Prefer SG-to-SG references over broad CIDRs
- Regularly review, deduplicate, and remove stale rules
- Layer controls (NACLs, private endpoints) for **defense in depth**";https://hub.prowler.com/check/ec2_securitygroup_with_many_ingress_egress_rules;"```yaml
# CloudFormation: Security group with limited number of rules
Resources:
  <example_resource_name>:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: ""<example_resource_name>""
      VpcId: <example_resource_id>
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 443
          ToPort: 443
          CidrIp: 10.0.0.0/8  # Critical: keep total inbound rules  50; this example defines only 1 rule to ensure compliance
```";"```hcl
# Terraform: Security group with limited number of rules
resource ""aws_security_group"" ""<example_resource_name>"" {
  name   = ""<example_resource_name>""
  vpc_id = ""<example_resource_id>""

  ingress {                      # Critical: keep total ingress/egress rules  50; single rule ensures PASS
    from_port   = 443
    to_port     = 443
    protocol    = ""tcp""
    cidr_blocks = [""10.0.0.0/8""]
  }
}
```";;"1. In the AWS console, go to EC2 > Security Groups
2. Select the security group that FAILED
3. In Inbound rules, click Edit inbound rules
4. Delete rules until the inbound rule count is 50 or fewer, then Save
5. In Outbound rules, click Edit outbound rules
6. Delete rules until the outbound rule count is 50 or fewer, then Save";AWS-Well-Architected-Framework-Security-Pillar: SEC05-BP03 | ISO27001-2022: A.8.20, A.8.21, A.8.22 | AWS-Foundational-Technical-Review: NETSEC-001 | KISA-ISMS-P-2023: 2.10.2 | KISA-ISMS-P-2023-korean: 2.10.2;trust-boundaries;;;;5.18.1;https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html | https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EC2/security-group-rules-counts.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-ec2_securitygroup_with_many_ingress_egress_rules-132410971304-ap-northeast-2-sg-0c86f4f14357f43de;aws;ec2_securitygroup_with_many_ingress_egress_rules;Security group has 50 or fewer inbound rules and 50 or fewer outbound rules;Software and Configuration Checks/AWS Security Best Practices/Network Reachability | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;PASS;Security group default (sg-0c86f4f14357f43de) has 0 inbound rules and 1 outbound rules.;False;ec2;;medium;AwsEc2SecurityGroup;arn:aws:ec2:ap-northeast-2:132410971304:security-group/sg-0c86f4f14357f43de;sg-0c86f4f14357f43de;default;;aws;ap-northeast-2;**EC2 security groups** are evaluated for excessive rule counts, flagging groups where `ingress` or `egress` entries exceed the configured threshold (default `50`). This targets groups with unusually large rule sets that complicate access control.;**Rule sprawl** weakens **least privilege**: large rule sets can hide overly permissive entries, exposing services to the Internet or unintended peers. This enables unauthorized access, data exfiltration, and lateral movement, impacting **confidentiality** and **integrity**, and can threaten **availability** via abuse of exposed services.;;"Apply **least privilege** and **segmentation**:
- Limit rules to required ports, protocols, and sources
- Split workloads into dedicated security groups per role
- Prefer SG-to-SG references over broad CIDRs
- Regularly review, deduplicate, and remove stale rules
- Layer controls (NACLs, private endpoints) for **defense in depth**";https://hub.prowler.com/check/ec2_securitygroup_with_many_ingress_egress_rules;"```yaml
# CloudFormation: Security group with limited number of rules
Resources:
  <example_resource_name>:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: ""<example_resource_name>""
      VpcId: <example_resource_id>
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 443
          ToPort: 443
          CidrIp: 10.0.0.0/8  # Critical: keep total inbound rules  50; this example defines only 1 rule to ensure compliance
```";"```hcl
# Terraform: Security group with limited number of rules
resource ""aws_security_group"" ""<example_resource_name>"" {
  name   = ""<example_resource_name>""
  vpc_id = ""<example_resource_id>""

  ingress {                      # Critical: keep total ingress/egress rules  50; single rule ensures PASS
    from_port   = 443
    to_port     = 443
    protocol    = ""tcp""
    cidr_blocks = [""10.0.0.0/8""]
  }
}
```";;"1. In the AWS console, go to EC2 > Security Groups
2. Select the security group that FAILED
3. In Inbound rules, click Edit inbound rules
4. Delete rules until the inbound rule count is 50 or fewer, then Save
5. In Outbound rules, click Edit outbound rules
6. Delete rules until the outbound rule count is 50 or fewer, then Save";AWS-Well-Architected-Framework-Security-Pillar: SEC05-BP03 | ISO27001-2022: A.8.20, A.8.21, A.8.22 | AWS-Foundational-Technical-Review: NETSEC-001 | KISA-ISMS-P-2023: 2.10.2 | KISA-ISMS-P-2023-korean: 2.10.2;trust-boundaries;;;;5.18.1;https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html | https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EC2/security-group-rules-counts.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-ec2_securitygroup_with_many_ingress_egress_rules-132410971304-ap-northeast-2-sg-04e3503c576b68504;aws;ec2_securitygroup_with_many_ingress_egress_rules;Security group has 50 or fewer inbound rules and 50 or fewer outbound rules;Software and Configuration Checks/AWS Security Best Practices/Network Reachability | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;PASS;Security group launch-wizard-1 (sg-04e3503c576b68504) has 1 inbound rules and 1 outbound rules.;False;ec2;;medium;AwsEc2SecurityGroup;arn:aws:ec2:ap-northeast-2:132410971304:security-group/sg-04e3503c576b68504;sg-04e3503c576b68504;launch-wizard-1;;aws;ap-northeast-2;**EC2 security groups** are evaluated for excessive rule counts, flagging groups where `ingress` or `egress` entries exceed the configured threshold (default `50`). This targets groups with unusually large rule sets that complicate access control.;**Rule sprawl** weakens **least privilege**: large rule sets can hide overly permissive entries, exposing services to the Internet or unintended peers. This enables unauthorized access, data exfiltration, and lateral movement, impacting **confidentiality** and **integrity**, and can threaten **availability** via abuse of exposed services.;;"Apply **least privilege** and **segmentation**:
- Limit rules to required ports, protocols, and sources
- Split workloads into dedicated security groups per role
- Prefer SG-to-SG references over broad CIDRs
- Regularly review, deduplicate, and remove stale rules
- Layer controls (NACLs, private endpoints) for **defense in depth**";https://hub.prowler.com/check/ec2_securitygroup_with_many_ingress_egress_rules;"```yaml
# CloudFormation: Security group with limited number of rules
Resources:
  <example_resource_name>:
    Type: AWS::EC2::SecurityGroup
    Properties:
      GroupDescription: ""<example_resource_name>""
      VpcId: <example_resource_id>
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 443
          ToPort: 443
          CidrIp: 10.0.0.0/8  # Critical: keep total inbound rules  50; this example defines only 1 rule to ensure compliance
```";"```hcl
# Terraform: Security group with limited number of rules
resource ""aws_security_group"" ""<example_resource_name>"" {
  name   = ""<example_resource_name>""
  vpc_id = ""<example_resource_id>""

  ingress {                      # Critical: keep total ingress/egress rules  50; single rule ensures PASS
    from_port   = 443
    to_port     = 443
    protocol    = ""tcp""
    cidr_blocks = [""10.0.0.0/8""]
  }
}
```";;"1. In the AWS console, go to EC2 > Security Groups
2. Select the security group that FAILED
3. In Inbound rules, click Edit inbound rules
4. Delete rules until the inbound rule count is 50 or fewer, then Save
5. In Outbound rules, click Edit outbound rules
6. Delete rules until the outbound rule count is 50 or fewer, then Save";AWS-Well-Architected-Framework-Security-Pillar: SEC05-BP03 | ISO27001-2022: A.8.20, A.8.21, A.8.22 | AWS-Foundational-Technical-Review: NETSEC-001 | KISA-ISMS-P-2023: 2.10.2 | KISA-ISMS-P-2023-korean: 2.10.2;trust-boundaries;;;;5.18.1;https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html | https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/EC2/security-group-rules-counts.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-fms_policy_compliant-132410971304-ap-northeast-2-132410971304;aws;fms_policy_compliant;All AWS FMS policies in the admin account are compliant for all accounts;Software and Configuration Checks/AWS Security Best Practices/Network Reachability | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices;FAIL;FMS without any compliant policy for account 132410971304.;False;fms;;medium;Other;arn:aws:fms:ap-northeast-2:132410971304:policy;132410971304;;;aws;ap-northeast-2;**Firewall Manager** policies in the administrator account are evaluated for organization-wide compliance. The assessment reviews each policy's account-level status and flags entries marked `NON_COMPLIANT` or unset. It also identifies when no effective policies exist within the administrator scope.;Policy drift or absence leaves in-scope resources without enforced controls, degrading **confidentiality**, **integrity**, and **availability**. Missing WAF, Shield, security group, or network firewall baselines can enable DDoS exposure, unsafe routes, and open access, leading to unauthorized entry and data exfiltration.;;Maintain centralized enforcement with **Firewall Manager**: define mandatory policies for all relevant accounts/resources, enable automatic remediation where appropriate, and continuously monitor compliance. Apply **least privilege** and **defense in depth** by standardizing web, network, and DNS protections and alerting on drift.;https://hub.prowler.com/check/fms_policy_compliant;;;;"1. Sign in to the AWS console with the Firewall Manager administrator account
2. Open Firewall Manager > Security policies
3. If no policies exist: Click Create policy, choose the policy type you use, set scope to All accounts, enable Automatic remediation, and create the policy
4. If policies exist with Noncompliant accounts: Open the policy > Edit > enable Automatic remediation and ensure scope includes All accounts > Save
5. In AWS Config (organization management account): Settings > Organization settings > Enable recording for all accounts and all regions > Save
6. Return to each Firewall Manager policy and verify Accounts within policy scope show Compliant";KISA-ISMS-P-2023: 2.10.1, 2.10.2 | C5-2025: SP-01.04B, HR-01.01B, IAM-01.01B, IAM-01.04B | ENS-RD2022: mp.com.1.aws.nfw.2 | KISA-ISMS-P-2023-korean: 2.10.1, 2.10.2;internet-exposed | trust-boundaries;;;;5.18.1;https://aws.amazon.com/firewall-manager/faqs/ | https://docs.aws.amazon.com/waf/latest/developerguide/getting-started-fms-intro.html | https://www.amazonaws.cn/en/firewall-manager/faqs/ | https://docs.aws.amazon.com/waf/latest/developerguide/fms-compliance.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_customer_unattached_policy_no_administrative_privileges-132410971304-ap-northeast-2-remediation-aws-cloudtrail-logs-policy;aws;iam_customer_unattached_policy_no_administrative_privileges;Unattached customer managed IAM policy does not allow '*:*' administrative privileges;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | TTPs/Privilege Escalation;PASS;Custom policy remediation-aws-cloudtrail-logs-policy is unattached and does not allow '*:*' administrative privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:policy/remediation-aws-cloudtrail-logs-policy;remediation-aws-cloudtrail-logs-policy;;;aws;ap-northeast-2;"**Customer-managed IAM policies** that are **unattached** are evaluated for statements granting **full administrative access** using `*:*` wildcards.

The focus is on policies whose documents include unrestricted actions on all resources.";An unattached policy with `*:*` can be attached accidentally or maliciously, granting account-wide control. Attackers could read sensitive data (**confidentiality**), alter or delete resources (**integrity**), and disrupt services (**availability**), enabling rapid **privilege escalation** and lateral movement.;;"Remove or redesign these policies to enforce **least privilege**:
- Avoid `*` in actions/resources; scope precisely and use conditions
- Apply **permissions boundaries** and **SCPs** as guardrails
- Require peer review and policy validation before attachment
- Use analysis tools to refine permissions and delete unused policies";https://hub.prowler.com/check/iam_customer_unattached_policy_no_administrative_privileges;"```yaml
# CloudFormation: managed policy without administrative '*:*' privileges
Resources:
  <example_resource_name>:
    Type: AWS::IAM::ManagedPolicy
    Properties:
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action: iam:GetAccountSummary  # Critical: use a specific action instead of '*'
            Resource: ""*""                 # Critical: combined with specific action, avoids '*:*'
```";"```hcl
# IAM policy without '*:*' administrative privileges
resource ""aws_iam_policy"" ""<example_resource_name>"" {
  name   = ""<example_resource_name>""
  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [
      {
        Effect   = ""Allow""
        Action   = ""iam:GetAccountSummary""   # Critical: specific action, not '*'
        Resource = ""*""                        # Critical: avoids '*:*' admin privileges
      }
    ]
  })
}
```";"aws iam create-policy-version --policy-arn <example_resource_arn> --set-as-default --policy-document '{""Version"":""2012-10-17"",""Statement"":[{""Effect"":""Allow"",""Action"":""iam:GetAccountSummary"",""Resource"":""*""}]}'";"1. In the AWS Console, go to IAM > Policies
2. Find the unattached customer managed policy and choose it
3. Click Edit policy > JSON
4. Remove any statement that allows Action ""*"" on Resource ""*"", or replace it with a specific action (e.g., ""iam:GetAccountSummary"")
5. Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC03-BP02, SEC03-BP04 | ISO27001-2022: A.8.2 | NIST-CSF-2.0: po_1, ac_4, ac_6 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-04.03B, OIS-04.01AC, SP-01.04B, HR-01.01B, IAM-01.01B, IAM-01.04B | ENS-RD2022: op.exp.8.r4.aws.ct.1 | CCC: CCC.LB.CN05.AR01, CCC.Vector.CN02.AR01, CCC.Core.CN05.AR02 | MITRE-ATTACK: T1078 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2;identity-access;;;CAF Security Epic: IAM;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/IAM/iam-policy-for-administration.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_customer_unattached_policy_no_administrative_privileges-132410971304-ap-northeast-2-aws_learner_dynamodb_policy;aws;iam_customer_unattached_policy_no_administrative_privileges;Unattached customer managed IAM policy does not allow '*:*' administrative privileges;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | TTPs/Privilege Escalation;PASS;Custom policy aws_learner_dynamodb_policy is unattached and does not allow '*:*' administrative privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:policy/aws_learner_dynamodb_policy;aws_learner_dynamodb_policy;;;aws;ap-northeast-2;"**Customer-managed IAM policies** that are **unattached** are evaluated for statements granting **full administrative access** using `*:*` wildcards.

The focus is on policies whose documents include unrestricted actions on all resources.";An unattached policy with `*:*` can be attached accidentally or maliciously, granting account-wide control. Attackers could read sensitive data (**confidentiality**), alter or delete resources (**integrity**), and disrupt services (**availability**), enabling rapid **privilege escalation** and lateral movement.;;"Remove or redesign these policies to enforce **least privilege**:
- Avoid `*` in actions/resources; scope precisely and use conditions
- Apply **permissions boundaries** and **SCPs** as guardrails
- Require peer review and policy validation before attachment
- Use analysis tools to refine permissions and delete unused policies";https://hub.prowler.com/check/iam_customer_unattached_policy_no_administrative_privileges;"```yaml
# CloudFormation: managed policy without administrative '*:*' privileges
Resources:
  <example_resource_name>:
    Type: AWS::IAM::ManagedPolicy
    Properties:
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action: iam:GetAccountSummary  # Critical: use a specific action instead of '*'
            Resource: ""*""                 # Critical: combined with specific action, avoids '*:*'
```";"```hcl
# IAM policy without '*:*' administrative privileges
resource ""aws_iam_policy"" ""<example_resource_name>"" {
  name   = ""<example_resource_name>""
  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [
      {
        Effect   = ""Allow""
        Action   = ""iam:GetAccountSummary""   # Critical: specific action, not '*'
        Resource = ""*""                        # Critical: avoids '*:*' admin privileges
      }
    ]
  })
}
```";"aws iam create-policy-version --policy-arn <example_resource_arn> --set-as-default --policy-document '{""Version"":""2012-10-17"",""Statement"":[{""Effect"":""Allow"",""Action"":""iam:GetAccountSummary"",""Resource"":""*""}]}'";"1. In the AWS Console, go to IAM > Policies
2. Find the unattached customer managed policy and choose it
3. Click Edit policy > JSON
4. Remove any statement that allows Action ""*"" on Resource ""*"", or replace it with a specific action (e.g., ""iam:GetAccountSummary"")
5. Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC03-BP02, SEC03-BP04 | ISO27001-2022: A.8.2 | NIST-CSF-2.0: po_1, ac_4, ac_6 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-04.03B, OIS-04.01AC, SP-01.04B, HR-01.01B, IAM-01.01B, IAM-01.04B | ENS-RD2022: op.exp.8.r4.aws.ct.1 | CCC: CCC.LB.CN05.AR01, CCC.Vector.CN02.AR01, CCC.Core.CN05.AR02 | MITRE-ATTACK: T1078 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2;identity-access;;;CAF Security Epic: IAM;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/IAM/iam-policy-for-administration.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_inline_policy_no_full_access_to_kms-132410971304-ap-northeast-2-github-actions-prowler/github-actions-prowler;aws;iam_inline_policy_no_full_access_to_kms;Inline IAM policy does not allow kms:* privileges;Software and Configuration Checks/AWS Security Best Practices | Industry and Regulatory Standards/AWS Foundational Security Best Practices | TTPs/Privilege Escalation | Effects/Data Exposure;FAIL;Inline policy github-actions-prowler attached to user github-actions-prowler allows 'kms:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:user/github-actions-prowler;github-actions-prowler/github-actions-prowler;;;aws;ap-northeast-2;**IAM inline policies** are analyzed to identify statements that grant **unrestricted AWS KMS access** via the wildcard action `kms:*`.;"Granting `kms:*` enables decryption of protected data, modification of key policies and grants, and disabling or deleting keys.

Impacts:
- **Confidentiality** via unauthorized decryption
- **Integrity** through key/grant tampering
- **Availability** if keys are disabled or deleted, breaking encrypted workloads";;Replace `kms:*` with **least-privilege**, action-scoped permissions limited to required operations and specific key ARNs. Enforce **separation of duties** for key admins vs users. Prefer **managed policies** over inline and apply guardrails (permissions boundaries/SCPs). Add conditions to constrain service, region, and encryption context.;https://hub.prowler.com/check/iam_inline_policy_no_full_access_to_kms;"```yaml
# CloudFormation: Inline IAM policy without kms:* full access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::User
    Properties:
      Policies:
        - PolicyName: <example_resource_name>-policy
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
              - Effect: Allow
                Action:
                  - kms:Encrypt  # CRITICAL: replace 'kms:*' with only required KMS action(s) to remove full access
                Resource: ""*""
```";"```hcl
# Inline IAM policy without kms:* full access
resource ""aws_iam_user_policy"" ""<example_resource_name>"" {
  name = ""<example_resource_name>-policy""
  user = ""<example_resource_name>""

  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = [
        ""kms:Encrypt"" # CRITICAL: replace 'kms:*' with specific action(s) to remove full access
      ]
      Resource = ""*""
    }]
  })
}
```";;"1. In the AWS Console, open IAM and go to Users, Roles, or Groups (where the inline policy is attached)
2. Select the entity, go to the Permissions tab, and open the inline policy that allows KMS
3. Click Edit policy and switch to the JSON editor
4. Replace any ""Action"": ""kms:*"" with only the specific KMS action(s) required (e.g., ""kms:Encrypt"")
5. Save changes";NIST-CSF-2.0: rr_1, po_1 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-08.02B, IAM-10.01B, CRY-05.02B | CCC: CCC.KeyMgmt.CN02.AR01, CCC.LB.CN05.AR01, CCC.ObjStor.CN01.AR02, CCC.ObjStor.CN01.AR04, CCC.Vector.CN02.AR01, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | PCI-4.0: 3.5.1.1.8, 3.5.1.3.16, 3.6.1.2.8, 3.6.1.3.8, 3.6.1.4.8, 3.6.1.8, 3.7.1.9, 3.7.2.8, 3.7.4.9, 3.7.6.8, 3.7.7.8, 4.2.1.1.21, 7.2.1.10, 7.2.2.10, 7.2.3.6, 7.2.5.6, 7.3.1.6, 7.3.2.6, 7.3.3.6, 8.2.7.6, 8.2.8.8, 8.3.4.6 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://support.icompaas.com/support/solutions/articles/62000233801-ensure-iam-inline-policies-that-allow-full-kms-privileges-are-not-created
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_inline_policy_no_full_access_to_kms-132410971304-ap-northeast-2-GitHubActionsProwlerRole/BedrockInvokeModel;aws;iam_inline_policy_no_full_access_to_kms;Inline IAM policy does not allow kms:* privileges;Software and Configuration Checks/AWS Security Best Practices | Industry and Regulatory Standards/AWS Foundational Security Best Practices | TTPs/Privilege Escalation | Effects/Data Exposure;PASS;Inline policy BedrockInvokeModel attached to role GitHubActionsProwlerRole does not allow 'kms:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:role/GitHubActionsProwlerRole;GitHubActionsProwlerRole/BedrockInvokeModel;;;aws;ap-northeast-2;**IAM inline policies** are analyzed to identify statements that grant **unrestricted AWS KMS access** via the wildcard action `kms:*`.;"Granting `kms:*` enables decryption of protected data, modification of key policies and grants, and disabling or deleting keys.

Impacts:
- **Confidentiality** via unauthorized decryption
- **Integrity** through key/grant tampering
- **Availability** if keys are disabled or deleted, breaking encrypted workloads";;Replace `kms:*` with **least-privilege**, action-scoped permissions limited to required operations and specific key ARNs. Enforce **separation of duties** for key admins vs users. Prefer **managed policies** over inline and apply guardrails (permissions boundaries/SCPs). Add conditions to constrain service, region, and encryption context.;https://hub.prowler.com/check/iam_inline_policy_no_full_access_to_kms;"```yaml
# CloudFormation: Inline IAM policy without kms:* full access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::User
    Properties:
      Policies:
        - PolicyName: <example_resource_name>-policy
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
              - Effect: Allow
                Action:
                  - kms:Encrypt  # CRITICAL: replace 'kms:*' with only required KMS action(s) to remove full access
                Resource: ""*""
```";"```hcl
# Inline IAM policy without kms:* full access
resource ""aws_iam_user_policy"" ""<example_resource_name>"" {
  name = ""<example_resource_name>-policy""
  user = ""<example_resource_name>""

  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = [
        ""kms:Encrypt"" # CRITICAL: replace 'kms:*' with specific action(s) to remove full access
      ]
      Resource = ""*""
    }]
  })
}
```";;"1. In the AWS Console, open IAM and go to Users, Roles, or Groups (where the inline policy is attached)
2. Select the entity, go to the Permissions tab, and open the inline policy that allows KMS
3. Click Edit policy and switch to the JSON editor
4. Replace any ""Action"": ""kms:*"" with only the specific KMS action(s) required (e.g., ""kms:Encrypt"")
5. Save changes";NIST-CSF-2.0: rr_1, po_1 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-08.02B, IAM-10.01B, CRY-05.02B | CCC: CCC.KeyMgmt.CN02.AR01, CCC.LB.CN05.AR01, CCC.ObjStor.CN01.AR02, CCC.ObjStor.CN01.AR04, CCC.Vector.CN02.AR01, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | PCI-4.0: 3.5.1.1.8, 3.5.1.3.16, 3.6.1.2.8, 3.6.1.3.8, 3.6.1.4.8, 3.6.1.8, 3.7.1.9, 3.7.2.8, 3.7.4.9, 3.7.6.8, 3.7.7.8, 4.2.1.1.21, 7.2.1.10, 7.2.2.10, 7.2.3.6, 7.2.5.6, 7.3.1.6, 7.3.2.6, 7.3.3.6, 8.2.7.6, 8.2.8.8, 8.3.4.6 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://support.icompaas.com/support/solutions/articles/62000233801-ensure-iam-inline-policies-that-allow-full-kms-privileges-are-not-created
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_inline_policy_no_full_access_to_kms-132410971304-ap-northeast-2-GitHubActionsProwlerRole/RemediationCloudTrail;aws;iam_inline_policy_no_full_access_to_kms;Inline IAM policy does not allow kms:* privileges;Software and Configuration Checks/AWS Security Best Practices | Industry and Regulatory Standards/AWS Foundational Security Best Practices | TTPs/Privilege Escalation | Effects/Data Exposure;PASS;Inline policy RemediationCloudTrail attached to role GitHubActionsProwlerRole does not allow 'kms:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:role/GitHubActionsProwlerRole;GitHubActionsProwlerRole/RemediationCloudTrail;;;aws;ap-northeast-2;**IAM inline policies** are analyzed to identify statements that grant **unrestricted AWS KMS access** via the wildcard action `kms:*`.;"Granting `kms:*` enables decryption of protected data, modification of key policies and grants, and disabling or deleting keys.

Impacts:
- **Confidentiality** via unauthorized decryption
- **Integrity** through key/grant tampering
- **Availability** if keys are disabled or deleted, breaking encrypted workloads";;Replace `kms:*` with **least-privilege**, action-scoped permissions limited to required operations and specific key ARNs. Enforce **separation of duties** for key admins vs users. Prefer **managed policies** over inline and apply guardrails (permissions boundaries/SCPs). Add conditions to constrain service, region, and encryption context.;https://hub.prowler.com/check/iam_inline_policy_no_full_access_to_kms;"```yaml
# CloudFormation: Inline IAM policy without kms:* full access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::User
    Properties:
      Policies:
        - PolicyName: <example_resource_name>-policy
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
              - Effect: Allow
                Action:
                  - kms:Encrypt  # CRITICAL: replace 'kms:*' with only required KMS action(s) to remove full access
                Resource: ""*""
```";"```hcl
# Inline IAM policy without kms:* full access
resource ""aws_iam_user_policy"" ""<example_resource_name>"" {
  name = ""<example_resource_name>-policy""
  user = ""<example_resource_name>""

  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = [
        ""kms:Encrypt"" # CRITICAL: replace 'kms:*' with specific action(s) to remove full access
      ]
      Resource = ""*""
    }]
  })
}
```";;"1. In the AWS Console, open IAM and go to Users, Roles, or Groups (where the inline policy is attached)
2. Select the entity, go to the Permissions tab, and open the inline policy that allows KMS
3. Click Edit policy and switch to the JSON editor
4. Replace any ""Action"": ""kms:*"" with only the specific KMS action(s) required (e.g., ""kms:Encrypt"")
5. Save changes";NIST-CSF-2.0: rr_1, po_1 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-08.02B, IAM-10.01B, CRY-05.02B | CCC: CCC.KeyMgmt.CN02.AR01, CCC.LB.CN05.AR01, CCC.ObjStor.CN01.AR02, CCC.ObjStor.CN01.AR04, CCC.Vector.CN02.AR01, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | PCI-4.0: 3.5.1.1.8, 3.5.1.3.16, 3.6.1.2.8, 3.6.1.3.8, 3.6.1.4.8, 3.6.1.8, 3.7.1.9, 3.7.2.8, 3.7.4.9, 3.7.6.8, 3.7.7.8, 4.2.1.1.21, 7.2.1.10, 7.2.2.10, 7.2.3.6, 7.2.5.6, 7.3.1.6, 7.3.2.6, 7.3.3.6, 8.2.7.6, 8.2.8.8, 8.3.4.6 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://support.icompaas.com/support/solutions/articles/62000233801-ensure-iam-inline-policies-that-allow-full-kms-privileges-are-not-created
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_inline_policy_no_full_access_to_kms-132410971304-ap-northeast-2-GitHubActionsProwlerRole/RemediationCloudWatch;aws;iam_inline_policy_no_full_access_to_kms;Inline IAM policy does not allow kms:* privileges;Software and Configuration Checks/AWS Security Best Practices | Industry and Regulatory Standards/AWS Foundational Security Best Practices | TTPs/Privilege Escalation | Effects/Data Exposure;PASS;Inline policy RemediationCloudWatch attached to role GitHubActionsProwlerRole does not allow 'kms:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:role/GitHubActionsProwlerRole;GitHubActionsProwlerRole/RemediationCloudWatch;;;aws;ap-northeast-2;**IAM inline policies** are analyzed to identify statements that grant **unrestricted AWS KMS access** via the wildcard action `kms:*`.;"Granting `kms:*` enables decryption of protected data, modification of key policies and grants, and disabling or deleting keys.

Impacts:
- **Confidentiality** via unauthorized decryption
- **Integrity** through key/grant tampering
- **Availability** if keys are disabled or deleted, breaking encrypted workloads";;Replace `kms:*` with **least-privilege**, action-scoped permissions limited to required operations and specific key ARNs. Enforce **separation of duties** for key admins vs users. Prefer **managed policies** over inline and apply guardrails (permissions boundaries/SCPs). Add conditions to constrain service, region, and encryption context.;https://hub.prowler.com/check/iam_inline_policy_no_full_access_to_kms;"```yaml
# CloudFormation: Inline IAM policy without kms:* full access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::User
    Properties:
      Policies:
        - PolicyName: <example_resource_name>-policy
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
              - Effect: Allow
                Action:
                  - kms:Encrypt  # CRITICAL: replace 'kms:*' with only required KMS action(s) to remove full access
                Resource: ""*""
```";"```hcl
# Inline IAM policy without kms:* full access
resource ""aws_iam_user_policy"" ""<example_resource_name>"" {
  name = ""<example_resource_name>-policy""
  user = ""<example_resource_name>""

  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = [
        ""kms:Encrypt"" # CRITICAL: replace 'kms:*' with specific action(s) to remove full access
      ]
      Resource = ""*""
    }]
  })
}
```";;"1. In the AWS Console, open IAM and go to Users, Roles, or Groups (where the inline policy is attached)
2. Select the entity, go to the Permissions tab, and open the inline policy that allows KMS
3. Click Edit policy and switch to the JSON editor
4. Replace any ""Action"": ""kms:*"" with only the specific KMS action(s) required (e.g., ""kms:Encrypt"")
5. Save changes";NIST-CSF-2.0: rr_1, po_1 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-08.02B, IAM-10.01B, CRY-05.02B | CCC: CCC.KeyMgmt.CN02.AR01, CCC.LB.CN05.AR01, CCC.ObjStor.CN01.AR02, CCC.ObjStor.CN01.AR04, CCC.Vector.CN02.AR01, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | PCI-4.0: 3.5.1.1.8, 3.5.1.3.16, 3.6.1.2.8, 3.6.1.3.8, 3.6.1.4.8, 3.6.1.8, 3.7.1.9, 3.7.2.8, 3.7.4.9, 3.7.6.8, 3.7.7.8, 4.2.1.1.21, 7.2.1.10, 7.2.2.10, 7.2.3.6, 7.2.5.6, 7.3.1.6, 7.3.2.6, 7.3.3.6, 8.2.7.6, 8.2.8.8, 8.3.4.6 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://support.icompaas.com/support/solutions/articles/62000233801-ensure-iam-inline-policies-that-allow-full-kms-privileges-are-not-created
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_inline_policy_no_full_access_to_kms-132410971304-ap-northeast-2-GitHubActionsProwlerRole/RemediationConfig;aws;iam_inline_policy_no_full_access_to_kms;Inline IAM policy does not allow kms:* privileges;Software and Configuration Checks/AWS Security Best Practices | Industry and Regulatory Standards/AWS Foundational Security Best Practices | TTPs/Privilege Escalation | Effects/Data Exposure;PASS;Inline policy RemediationConfig attached to role GitHubActionsProwlerRole does not allow 'kms:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:role/GitHubActionsProwlerRole;GitHubActionsProwlerRole/RemediationConfig;;;aws;ap-northeast-2;**IAM inline policies** are analyzed to identify statements that grant **unrestricted AWS KMS access** via the wildcard action `kms:*`.;"Granting `kms:*` enables decryption of protected data, modification of key policies and grants, and disabling or deleting keys.

Impacts:
- **Confidentiality** via unauthorized decryption
- **Integrity** through key/grant tampering
- **Availability** if keys are disabled or deleted, breaking encrypted workloads";;Replace `kms:*` with **least-privilege**, action-scoped permissions limited to required operations and specific key ARNs. Enforce **separation of duties** for key admins vs users. Prefer **managed policies** over inline and apply guardrails (permissions boundaries/SCPs). Add conditions to constrain service, region, and encryption context.;https://hub.prowler.com/check/iam_inline_policy_no_full_access_to_kms;"```yaml
# CloudFormation: Inline IAM policy without kms:* full access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::User
    Properties:
      Policies:
        - PolicyName: <example_resource_name>-policy
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
              - Effect: Allow
                Action:
                  - kms:Encrypt  # CRITICAL: replace 'kms:*' with only required KMS action(s) to remove full access
                Resource: ""*""
```";"```hcl
# Inline IAM policy without kms:* full access
resource ""aws_iam_user_policy"" ""<example_resource_name>"" {
  name = ""<example_resource_name>-policy""
  user = ""<example_resource_name>""

  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = [
        ""kms:Encrypt"" # CRITICAL: replace 'kms:*' with specific action(s) to remove full access
      ]
      Resource = ""*""
    }]
  })
}
```";;"1. In the AWS Console, open IAM and go to Users, Roles, or Groups (where the inline policy is attached)
2. Select the entity, go to the Permissions tab, and open the inline policy that allows KMS
3. Click Edit policy and switch to the JSON editor
4. Replace any ""Action"": ""kms:*"" with only the specific KMS action(s) required (e.g., ""kms:Encrypt"")
5. Save changes";NIST-CSF-2.0: rr_1, po_1 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-08.02B, IAM-10.01B, CRY-05.02B | CCC: CCC.KeyMgmt.CN02.AR01, CCC.LB.CN05.AR01, CCC.ObjStor.CN01.AR02, CCC.ObjStor.CN01.AR04, CCC.Vector.CN02.AR01, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | PCI-4.0: 3.5.1.1.8, 3.5.1.3.16, 3.6.1.2.8, 3.6.1.3.8, 3.6.1.4.8, 3.6.1.8, 3.7.1.9, 3.7.2.8, 3.7.4.9, 3.7.6.8, 3.7.7.8, 4.2.1.1.21, 7.2.1.10, 7.2.2.10, 7.2.3.6, 7.2.5.6, 7.3.1.6, 7.3.2.6, 7.3.3.6, 8.2.7.6, 8.2.8.8, 8.3.4.6 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://support.icompaas.com/support/solutions/articles/62000233801-ensure-iam-inline-policies-that-allow-full-kms-privileges-are-not-created
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_inline_policy_no_full_access_to_kms-132410971304-ap-northeast-2-GitHubActionsProwlerRole/RemediationEC2VPC;aws;iam_inline_policy_no_full_access_to_kms;Inline IAM policy does not allow kms:* privileges;Software and Configuration Checks/AWS Security Best Practices | Industry and Regulatory Standards/AWS Foundational Security Best Practices | TTPs/Privilege Escalation | Effects/Data Exposure;PASS;Inline policy RemediationEC2VPC attached to role GitHubActionsProwlerRole does not allow 'kms:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:role/GitHubActionsProwlerRole;GitHubActionsProwlerRole/RemediationEC2VPC;;;aws;ap-northeast-2;**IAM inline policies** are analyzed to identify statements that grant **unrestricted AWS KMS access** via the wildcard action `kms:*`.;"Granting `kms:*` enables decryption of protected data, modification of key policies and grants, and disabling or deleting keys.

Impacts:
- **Confidentiality** via unauthorized decryption
- **Integrity** through key/grant tampering
- **Availability** if keys are disabled or deleted, breaking encrypted workloads";;Replace `kms:*` with **least-privilege**, action-scoped permissions limited to required operations and specific key ARNs. Enforce **separation of duties** for key admins vs users. Prefer **managed policies** over inline and apply guardrails (permissions boundaries/SCPs). Add conditions to constrain service, region, and encryption context.;https://hub.prowler.com/check/iam_inline_policy_no_full_access_to_kms;"```yaml
# CloudFormation: Inline IAM policy without kms:* full access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::User
    Properties:
      Policies:
        - PolicyName: <example_resource_name>-policy
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
              - Effect: Allow
                Action:
                  - kms:Encrypt  # CRITICAL: replace 'kms:*' with only required KMS action(s) to remove full access
                Resource: ""*""
```";"```hcl
# Inline IAM policy without kms:* full access
resource ""aws_iam_user_policy"" ""<example_resource_name>"" {
  name = ""<example_resource_name>-policy""
  user = ""<example_resource_name>""

  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = [
        ""kms:Encrypt"" # CRITICAL: replace 'kms:*' with specific action(s) to remove full access
      ]
      Resource = ""*""
    }]
  })
}
```";;"1. In the AWS Console, open IAM and go to Users, Roles, or Groups (where the inline policy is attached)
2. Select the entity, go to the Permissions tab, and open the inline policy that allows KMS
3. Click Edit policy and switch to the JSON editor
4. Replace any ""Action"": ""kms:*"" with only the specific KMS action(s) required (e.g., ""kms:Encrypt"")
5. Save changes";NIST-CSF-2.0: rr_1, po_1 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-08.02B, IAM-10.01B, CRY-05.02B | CCC: CCC.KeyMgmt.CN02.AR01, CCC.LB.CN05.AR01, CCC.ObjStor.CN01.AR02, CCC.ObjStor.CN01.AR04, CCC.Vector.CN02.AR01, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | PCI-4.0: 3.5.1.1.8, 3.5.1.3.16, 3.6.1.2.8, 3.6.1.3.8, 3.6.1.4.8, 3.6.1.8, 3.7.1.9, 3.7.2.8, 3.7.4.9, 3.7.6.8, 3.7.7.8, 4.2.1.1.21, 7.2.1.10, 7.2.2.10, 7.2.3.6, 7.2.5.6, 7.3.1.6, 7.3.2.6, 7.3.3.6, 8.2.7.6, 8.2.8.8, 8.3.4.6 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://support.icompaas.com/support/solutions/articles/62000233801-ensure-iam-inline-policies-that-allow-full-kms-privileges-are-not-created
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_inline_policy_no_full_access_to_kms-132410971304-ap-northeast-2-GitHubActionsProwlerRole/RemediationFirewall;aws;iam_inline_policy_no_full_access_to_kms;Inline IAM policy does not allow kms:* privileges;Software and Configuration Checks/AWS Security Best Practices | Industry and Regulatory Standards/AWS Foundational Security Best Practices | TTPs/Privilege Escalation | Effects/Data Exposure;PASS;Inline policy RemediationFirewall attached to role GitHubActionsProwlerRole does not allow 'kms:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:role/GitHubActionsProwlerRole;GitHubActionsProwlerRole/RemediationFirewall;;;aws;ap-northeast-2;**IAM inline policies** are analyzed to identify statements that grant **unrestricted AWS KMS access** via the wildcard action `kms:*`.;"Granting `kms:*` enables decryption of protected data, modification of key policies and grants, and disabling or deleting keys.

Impacts:
- **Confidentiality** via unauthorized decryption
- **Integrity** through key/grant tampering
- **Availability** if keys are disabled or deleted, breaking encrypted workloads";;Replace `kms:*` with **least-privilege**, action-scoped permissions limited to required operations and specific key ARNs. Enforce **separation of duties** for key admins vs users. Prefer **managed policies** over inline and apply guardrails (permissions boundaries/SCPs). Add conditions to constrain service, region, and encryption context.;https://hub.prowler.com/check/iam_inline_policy_no_full_access_to_kms;"```yaml
# CloudFormation: Inline IAM policy without kms:* full access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::User
    Properties:
      Policies:
        - PolicyName: <example_resource_name>-policy
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
              - Effect: Allow
                Action:
                  - kms:Encrypt  # CRITICAL: replace 'kms:*' with only required KMS action(s) to remove full access
                Resource: ""*""
```";"```hcl
# Inline IAM policy without kms:* full access
resource ""aws_iam_user_policy"" ""<example_resource_name>"" {
  name = ""<example_resource_name>-policy""
  user = ""<example_resource_name>""

  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = [
        ""kms:Encrypt"" # CRITICAL: replace 'kms:*' with specific action(s) to remove full access
      ]
      Resource = ""*""
    }]
  })
}
```";;"1. In the AWS Console, open IAM and go to Users, Roles, or Groups (where the inline policy is attached)
2. Select the entity, go to the Permissions tab, and open the inline policy that allows KMS
3. Click Edit policy and switch to the JSON editor
4. Replace any ""Action"": ""kms:*"" with only the specific KMS action(s) required (e.g., ""kms:Encrypt"")
5. Save changes";NIST-CSF-2.0: rr_1, po_1 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-08.02B, IAM-10.01B, CRY-05.02B | CCC: CCC.KeyMgmt.CN02.AR01, CCC.LB.CN05.AR01, CCC.ObjStor.CN01.AR02, CCC.ObjStor.CN01.AR04, CCC.Vector.CN02.AR01, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | PCI-4.0: 3.5.1.1.8, 3.5.1.3.16, 3.6.1.2.8, 3.6.1.3.8, 3.6.1.4.8, 3.6.1.8, 3.7.1.9, 3.7.2.8, 3.7.4.9, 3.7.6.8, 3.7.7.8, 4.2.1.1.21, 7.2.1.10, 7.2.2.10, 7.2.3.6, 7.2.5.6, 7.3.1.6, 7.3.2.6, 7.3.3.6, 8.2.7.6, 8.2.8.8, 8.3.4.6 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://support.icompaas.com/support/solutions/articles/62000233801-ensure-iam-inline-policies-that-allow-full-kms-privileges-are-not-created
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_inline_policy_no_full_access_to_kms-132410971304-ap-northeast-2-GitHubActionsProwlerRole/RemediationIAM;aws;iam_inline_policy_no_full_access_to_kms;Inline IAM policy does not allow kms:* privileges;Software and Configuration Checks/AWS Security Best Practices | Industry and Regulatory Standards/AWS Foundational Security Best Practices | TTPs/Privilege Escalation | Effects/Data Exposure;PASS;Inline policy RemediationIAM attached to role GitHubActionsProwlerRole does not allow 'kms:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:role/GitHubActionsProwlerRole;GitHubActionsProwlerRole/RemediationIAM;;;aws;ap-northeast-2;**IAM inline policies** are analyzed to identify statements that grant **unrestricted AWS KMS access** via the wildcard action `kms:*`.;"Granting `kms:*` enables decryption of protected data, modification of key policies and grants, and disabling or deleting keys.

Impacts:
- **Confidentiality** via unauthorized decryption
- **Integrity** through key/grant tampering
- **Availability** if keys are disabled or deleted, breaking encrypted workloads";;Replace `kms:*` with **least-privilege**, action-scoped permissions limited to required operations and specific key ARNs. Enforce **separation of duties** for key admins vs users. Prefer **managed policies** over inline and apply guardrails (permissions boundaries/SCPs). Add conditions to constrain service, region, and encryption context.;https://hub.prowler.com/check/iam_inline_policy_no_full_access_to_kms;"```yaml
# CloudFormation: Inline IAM policy without kms:* full access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::User
    Properties:
      Policies:
        - PolicyName: <example_resource_name>-policy
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
              - Effect: Allow
                Action:
                  - kms:Encrypt  # CRITICAL: replace 'kms:*' with only required KMS action(s) to remove full access
                Resource: ""*""
```";"```hcl
# Inline IAM policy without kms:* full access
resource ""aws_iam_user_policy"" ""<example_resource_name>"" {
  name = ""<example_resource_name>-policy""
  user = ""<example_resource_name>""

  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = [
        ""kms:Encrypt"" # CRITICAL: replace 'kms:*' with specific action(s) to remove full access
      ]
      Resource = ""*""
    }]
  })
}
```";;"1. In the AWS Console, open IAM and go to Users, Roles, or Groups (where the inline policy is attached)
2. Select the entity, go to the Permissions tab, and open the inline policy that allows KMS
3. Click Edit policy and switch to the JSON editor
4. Replace any ""Action"": ""kms:*"" with only the specific KMS action(s) required (e.g., ""kms:Encrypt"")
5. Save changes";NIST-CSF-2.0: rr_1, po_1 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-08.02B, IAM-10.01B, CRY-05.02B | CCC: CCC.KeyMgmt.CN02.AR01, CCC.LB.CN05.AR01, CCC.ObjStor.CN01.AR02, CCC.ObjStor.CN01.AR04, CCC.Vector.CN02.AR01, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | PCI-4.0: 3.5.1.1.8, 3.5.1.3.16, 3.6.1.2.8, 3.6.1.3.8, 3.6.1.4.8, 3.6.1.8, 3.7.1.9, 3.7.2.8, 3.7.4.9, 3.7.6.8, 3.7.7.8, 4.2.1.1.21, 7.2.1.10, 7.2.2.10, 7.2.3.6, 7.2.5.6, 7.3.1.6, 7.3.2.6, 7.3.3.6, 8.2.7.6, 8.2.8.8, 8.3.4.6 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://support.icompaas.com/support/solutions/articles/62000233801-ensure-iam-inline-policies-that-allow-full-kms-privileges-are-not-created
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_inline_policy_no_full_access_to_kms-132410971304-ap-northeast-2-GitHubActionsProwlerRole/RemediationKMS;aws;iam_inline_policy_no_full_access_to_kms;Inline IAM policy does not allow kms:* privileges;Software and Configuration Checks/AWS Security Best Practices | Industry and Regulatory Standards/AWS Foundational Security Best Practices | TTPs/Privilege Escalation | Effects/Data Exposure;PASS;Inline policy RemediationKMS attached to role GitHubActionsProwlerRole does not allow 'kms:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:role/GitHubActionsProwlerRole;GitHubActionsProwlerRole/RemediationKMS;;;aws;ap-northeast-2;**IAM inline policies** are analyzed to identify statements that grant **unrestricted AWS KMS access** via the wildcard action `kms:*`.;"Granting `kms:*` enables decryption of protected data, modification of key policies and grants, and disabling or deleting keys.

Impacts:
- **Confidentiality** via unauthorized decryption
- **Integrity** through key/grant tampering
- **Availability** if keys are disabled or deleted, breaking encrypted workloads";;Replace `kms:*` with **least-privilege**, action-scoped permissions limited to required operations and specific key ARNs. Enforce **separation of duties** for key admins vs users. Prefer **managed policies** over inline and apply guardrails (permissions boundaries/SCPs). Add conditions to constrain service, region, and encryption context.;https://hub.prowler.com/check/iam_inline_policy_no_full_access_to_kms;"```yaml
# CloudFormation: Inline IAM policy without kms:* full access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::User
    Properties:
      Policies:
        - PolicyName: <example_resource_name>-policy
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
              - Effect: Allow
                Action:
                  - kms:Encrypt  # CRITICAL: replace 'kms:*' with only required KMS action(s) to remove full access
                Resource: ""*""
```";"```hcl
# Inline IAM policy without kms:* full access
resource ""aws_iam_user_policy"" ""<example_resource_name>"" {
  name = ""<example_resource_name>-policy""
  user = ""<example_resource_name>""

  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = [
        ""kms:Encrypt"" # CRITICAL: replace 'kms:*' with specific action(s) to remove full access
      ]
      Resource = ""*""
    }]
  })
}
```";;"1. In the AWS Console, open IAM and go to Users, Roles, or Groups (where the inline policy is attached)
2. Select the entity, go to the Permissions tab, and open the inline policy that allows KMS
3. Click Edit policy and switch to the JSON editor
4. Replace any ""Action"": ""kms:*"" with only the specific KMS action(s) required (e.g., ""kms:Encrypt"")
5. Save changes";NIST-CSF-2.0: rr_1, po_1 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-08.02B, IAM-10.01B, CRY-05.02B | CCC: CCC.KeyMgmt.CN02.AR01, CCC.LB.CN05.AR01, CCC.ObjStor.CN01.AR02, CCC.ObjStor.CN01.AR04, CCC.Vector.CN02.AR01, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | PCI-4.0: 3.5.1.1.8, 3.5.1.3.16, 3.6.1.2.8, 3.6.1.3.8, 3.6.1.4.8, 3.6.1.8, 3.7.1.9, 3.7.2.8, 3.7.4.9, 3.7.6.8, 3.7.7.8, 4.2.1.1.21, 7.2.1.10, 7.2.2.10, 7.2.3.6, 7.2.5.6, 7.3.1.6, 7.3.2.6, 7.3.3.6, 8.2.7.6, 8.2.8.8, 8.3.4.6 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://support.icompaas.com/support/solutions/articles/62000233801-ensure-iam-inline-policies-that-allow-full-kms-privileges-are-not-created
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_inline_policy_no_full_access_to_kms-132410971304-ap-northeast-2-GitHubActionsProwlerRole/RemediationOrganizations;aws;iam_inline_policy_no_full_access_to_kms;Inline IAM policy does not allow kms:* privileges;Software and Configuration Checks/AWS Security Best Practices | Industry and Regulatory Standards/AWS Foundational Security Best Practices | TTPs/Privilege Escalation | Effects/Data Exposure;PASS;Inline policy RemediationOrganizations attached to role GitHubActionsProwlerRole does not allow 'kms:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:role/GitHubActionsProwlerRole;GitHubActionsProwlerRole/RemediationOrganizations;;;aws;ap-northeast-2;**IAM inline policies** are analyzed to identify statements that grant **unrestricted AWS KMS access** via the wildcard action `kms:*`.;"Granting `kms:*` enables decryption of protected data, modification of key policies and grants, and disabling or deleting keys.

Impacts:
- **Confidentiality** via unauthorized decryption
- **Integrity** through key/grant tampering
- **Availability** if keys are disabled or deleted, breaking encrypted workloads";;Replace `kms:*` with **least-privilege**, action-scoped permissions limited to required operations and specific key ARNs. Enforce **separation of duties** for key admins vs users. Prefer **managed policies** over inline and apply guardrails (permissions boundaries/SCPs). Add conditions to constrain service, region, and encryption context.;https://hub.prowler.com/check/iam_inline_policy_no_full_access_to_kms;"```yaml
# CloudFormation: Inline IAM policy without kms:* full access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::User
    Properties:
      Policies:
        - PolicyName: <example_resource_name>-policy
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
              - Effect: Allow
                Action:
                  - kms:Encrypt  # CRITICAL: replace 'kms:*' with only required KMS action(s) to remove full access
                Resource: ""*""
```";"```hcl
# Inline IAM policy without kms:* full access
resource ""aws_iam_user_policy"" ""<example_resource_name>"" {
  name = ""<example_resource_name>-policy""
  user = ""<example_resource_name>""

  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = [
        ""kms:Encrypt"" # CRITICAL: replace 'kms:*' with specific action(s) to remove full access
      ]
      Resource = ""*""
    }]
  })
}
```";;"1. In the AWS Console, open IAM and go to Users, Roles, or Groups (where the inline policy is attached)
2. Select the entity, go to the Permissions tab, and open the inline policy that allows KMS
3. Click Edit policy and switch to the JSON editor
4. Replace any ""Action"": ""kms:*"" with only the specific KMS action(s) required (e.g., ""kms:Encrypt"")
5. Save changes";NIST-CSF-2.0: rr_1, po_1 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-08.02B, IAM-10.01B, CRY-05.02B | CCC: CCC.KeyMgmt.CN02.AR01, CCC.LB.CN05.AR01, CCC.ObjStor.CN01.AR02, CCC.ObjStor.CN01.AR04, CCC.Vector.CN02.AR01, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | PCI-4.0: 3.5.1.1.8, 3.5.1.3.16, 3.6.1.2.8, 3.6.1.3.8, 3.6.1.4.8, 3.6.1.8, 3.7.1.9, 3.7.2.8, 3.7.4.9, 3.7.6.8, 3.7.7.8, 4.2.1.1.21, 7.2.1.10, 7.2.2.10, 7.2.3.6, 7.2.5.6, 7.3.1.6, 7.3.2.6, 7.3.3.6, 8.2.7.6, 8.2.8.8, 8.3.4.6 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://support.icompaas.com/support/solutions/articles/62000233801-ensure-iam-inline-policies-that-allow-full-kms-privileges-are-not-created
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_inline_policy_no_full_access_to_kms-132410971304-ap-northeast-2-GitHubActionsProwlerRole/RemediationS3;aws;iam_inline_policy_no_full_access_to_kms;Inline IAM policy does not allow kms:* privileges;Software and Configuration Checks/AWS Security Best Practices | Industry and Regulatory Standards/AWS Foundational Security Best Practices | TTPs/Privilege Escalation | Effects/Data Exposure;PASS;Inline policy RemediationS3 attached to role GitHubActionsProwlerRole does not allow 'kms:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:role/GitHubActionsProwlerRole;GitHubActionsProwlerRole/RemediationS3;;;aws;ap-northeast-2;**IAM inline policies** are analyzed to identify statements that grant **unrestricted AWS KMS access** via the wildcard action `kms:*`.;"Granting `kms:*` enables decryption of protected data, modification of key policies and grants, and disabling or deleting keys.

Impacts:
- **Confidentiality** via unauthorized decryption
- **Integrity** through key/grant tampering
- **Availability** if keys are disabled or deleted, breaking encrypted workloads";;Replace `kms:*` with **least-privilege**, action-scoped permissions limited to required operations and specific key ARNs. Enforce **separation of duties** for key admins vs users. Prefer **managed policies** over inline and apply guardrails (permissions boundaries/SCPs). Add conditions to constrain service, region, and encryption context.;https://hub.prowler.com/check/iam_inline_policy_no_full_access_to_kms;"```yaml
# CloudFormation: Inline IAM policy without kms:* full access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::User
    Properties:
      Policies:
        - PolicyName: <example_resource_name>-policy
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
              - Effect: Allow
                Action:
                  - kms:Encrypt  # CRITICAL: replace 'kms:*' with only required KMS action(s) to remove full access
                Resource: ""*""
```";"```hcl
# Inline IAM policy without kms:* full access
resource ""aws_iam_user_policy"" ""<example_resource_name>"" {
  name = ""<example_resource_name>-policy""
  user = ""<example_resource_name>""

  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = [
        ""kms:Encrypt"" # CRITICAL: replace 'kms:*' with specific action(s) to remove full access
      ]
      Resource = ""*""
    }]
  })
}
```";;"1. In the AWS Console, open IAM and go to Users, Roles, or Groups (where the inline policy is attached)
2. Select the entity, go to the Permissions tab, and open the inline policy that allows KMS
3. Click Edit policy and switch to the JSON editor
4. Replace any ""Action"": ""kms:*"" with only the specific KMS action(s) required (e.g., ""kms:Encrypt"")
5. Save changes";NIST-CSF-2.0: rr_1, po_1 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-08.02B, IAM-10.01B, CRY-05.02B | CCC: CCC.KeyMgmt.CN02.AR01, CCC.LB.CN05.AR01, CCC.ObjStor.CN01.AR02, CCC.ObjStor.CN01.AR04, CCC.Vector.CN02.AR01, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | PCI-4.0: 3.5.1.1.8, 3.5.1.3.16, 3.6.1.2.8, 3.6.1.3.8, 3.6.1.4.8, 3.6.1.8, 3.7.1.9, 3.7.2.8, 3.7.4.9, 3.7.6.8, 3.7.7.8, 4.2.1.1.21, 7.2.1.10, 7.2.2.10, 7.2.3.6, 7.2.5.6, 7.3.1.6, 7.3.2.6, 7.3.3.6, 8.2.7.6, 8.2.8.8, 8.3.4.6 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://support.icompaas.com/support/solutions/articles/62000233801-ensure-iam-inline-policies-that-allow-full-kms-privileges-are-not-created
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_inline_policy_no_full_access_to_kms-132410971304-ap-northeast-2-GitHubActionsProwlerRole/RemediationSSM;aws;iam_inline_policy_no_full_access_to_kms;Inline IAM policy does not allow kms:* privileges;Software and Configuration Checks/AWS Security Best Practices | Industry and Regulatory Standards/AWS Foundational Security Best Practices | TTPs/Privilege Escalation | Effects/Data Exposure;PASS;Inline policy RemediationSSM attached to role GitHubActionsProwlerRole does not allow 'kms:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:role/GitHubActionsProwlerRole;GitHubActionsProwlerRole/RemediationSSM;;;aws;ap-northeast-2;**IAM inline policies** are analyzed to identify statements that grant **unrestricted AWS KMS access** via the wildcard action `kms:*`.;"Granting `kms:*` enables decryption of protected data, modification of key policies and grants, and disabling or deleting keys.

Impacts:
- **Confidentiality** via unauthorized decryption
- **Integrity** through key/grant tampering
- **Availability** if keys are disabled or deleted, breaking encrypted workloads";;Replace `kms:*` with **least-privilege**, action-scoped permissions limited to required operations and specific key ARNs. Enforce **separation of duties** for key admins vs users. Prefer **managed policies** over inline and apply guardrails (permissions boundaries/SCPs). Add conditions to constrain service, region, and encryption context.;https://hub.prowler.com/check/iam_inline_policy_no_full_access_to_kms;"```yaml
# CloudFormation: Inline IAM policy without kms:* full access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::User
    Properties:
      Policies:
        - PolicyName: <example_resource_name>-policy
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
              - Effect: Allow
                Action:
                  - kms:Encrypt  # CRITICAL: replace 'kms:*' with only required KMS action(s) to remove full access
                Resource: ""*""
```";"```hcl
# Inline IAM policy without kms:* full access
resource ""aws_iam_user_policy"" ""<example_resource_name>"" {
  name = ""<example_resource_name>-policy""
  user = ""<example_resource_name>""

  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = [
        ""kms:Encrypt"" # CRITICAL: replace 'kms:*' with specific action(s) to remove full access
      ]
      Resource = ""*""
    }]
  })
}
```";;"1. In the AWS Console, open IAM and go to Users, Roles, or Groups (where the inline policy is attached)
2. Select the entity, go to the Permissions tab, and open the inline policy that allows KMS
3. Click Edit policy and switch to the JSON editor
4. Replace any ""Action"": ""kms:*"" with only the specific KMS action(s) required (e.g., ""kms:Encrypt"")
5. Save changes";NIST-CSF-2.0: rr_1, po_1 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-08.02B, IAM-10.01B, CRY-05.02B | CCC: CCC.KeyMgmt.CN02.AR01, CCC.LB.CN05.AR01, CCC.ObjStor.CN01.AR02, CCC.ObjStor.CN01.AR04, CCC.Vector.CN02.AR01, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | PCI-4.0: 3.5.1.1.8, 3.5.1.3.16, 3.6.1.2.8, 3.6.1.3.8, 3.6.1.4.8, 3.6.1.8, 3.7.1.9, 3.7.2.8, 3.7.4.9, 3.7.6.8, 3.7.7.8, 4.2.1.1.21, 7.2.1.10, 7.2.2.10, 7.2.3.6, 7.2.5.6, 7.3.1.6, 7.3.2.6, 7.3.3.6, 8.2.7.6, 8.2.8.8, 8.3.4.6 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://support.icompaas.com/support/solutions/articles/62000233801-ensure-iam-inline-policies-that-allow-full-kms-privileges-are-not-created
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_inline_policy_no_full_access_to_kms-132410971304-ap-northeast-2-GitHubActionsProwlerRole/TerraformStateAccess;aws;iam_inline_policy_no_full_access_to_kms;Inline IAM policy does not allow kms:* privileges;Software and Configuration Checks/AWS Security Best Practices | Industry and Regulatory Standards/AWS Foundational Security Best Practices | TTPs/Privilege Escalation | Effects/Data Exposure;PASS;Inline policy TerraformStateAccess attached to role GitHubActionsProwlerRole does not allow 'kms:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:role/GitHubActionsProwlerRole;GitHubActionsProwlerRole/TerraformStateAccess;;;aws;ap-northeast-2;**IAM inline policies** are analyzed to identify statements that grant **unrestricted AWS KMS access** via the wildcard action `kms:*`.;"Granting `kms:*` enables decryption of protected data, modification of key policies and grants, and disabling or deleting keys.

Impacts:
- **Confidentiality** via unauthorized decryption
- **Integrity** through key/grant tampering
- **Availability** if keys are disabled or deleted, breaking encrypted workloads";;Replace `kms:*` with **least-privilege**, action-scoped permissions limited to required operations and specific key ARNs. Enforce **separation of duties** for key admins vs users. Prefer **managed policies** over inline and apply guardrails (permissions boundaries/SCPs). Add conditions to constrain service, region, and encryption context.;https://hub.prowler.com/check/iam_inline_policy_no_full_access_to_kms;"```yaml
# CloudFormation: Inline IAM policy without kms:* full access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::User
    Properties:
      Policies:
        - PolicyName: <example_resource_name>-policy
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
              - Effect: Allow
                Action:
                  - kms:Encrypt  # CRITICAL: replace 'kms:*' with only required KMS action(s) to remove full access
                Resource: ""*""
```";"```hcl
# Inline IAM policy without kms:* full access
resource ""aws_iam_user_policy"" ""<example_resource_name>"" {
  name = ""<example_resource_name>-policy""
  user = ""<example_resource_name>""

  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = [
        ""kms:Encrypt"" # CRITICAL: replace 'kms:*' with specific action(s) to remove full access
      ]
      Resource = ""*""
    }]
  })
}
```";;"1. In the AWS Console, open IAM and go to Users, Roles, or Groups (where the inline policy is attached)
2. Select the entity, go to the Permissions tab, and open the inline policy that allows KMS
3. Click Edit policy and switch to the JSON editor
4. Replace any ""Action"": ""kms:*"" with only the specific KMS action(s) required (e.g., ""kms:Encrypt"")
5. Save changes";NIST-CSF-2.0: rr_1, po_1 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-08.02B, IAM-10.01B, CRY-05.02B | CCC: CCC.KeyMgmt.CN02.AR01, CCC.LB.CN05.AR01, CCC.ObjStor.CN01.AR02, CCC.ObjStor.CN01.AR04, CCC.Vector.CN02.AR01, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | PCI-4.0: 3.5.1.1.8, 3.5.1.3.16, 3.6.1.2.8, 3.6.1.3.8, 3.6.1.4.8, 3.6.1.8, 3.7.1.9, 3.7.2.8, 3.7.4.9, 3.7.6.8, 3.7.7.8, 4.2.1.1.21, 7.2.1.10, 7.2.2.10, 7.2.3.6, 7.2.5.6, 7.3.1.6, 7.3.2.6, 7.3.3.6, 8.2.7.6, 8.2.8.8, 8.3.4.6 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://support.icompaas.com/support/solutions/articles/62000233801-ensure-iam-inline-policies-that-allow-full-kms-privileges-are-not-created
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_password_policy_expires_passwords_within_90_days_or_less-132410971304-ap-northeast-2-132410971304;aws;iam_password_policy_expires_passwords_within_90_days_or_less;IAM account password policy enforces password expiration within 90 days or less;Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;PASS;Password expiration is set lower than 90 days (90 days).;False;iam;;medium;AwsIamPolicy;arn:aws:iam:ap-northeast-2:132410971304:password-policy;132410971304;;;aws;ap-northeast-2;"**IAM account password policy** sets a **password expiration period** for IAM user console logins; configuration is aligned when rotation is enabled and set to `<= 90` days.";Without rotation, stale passwords persist, enabling **credential stuffing**, **brute force**, and **password reuse** attacks. A compromised IAM user can retain console access, enabling **data exfiltration**, privilege escalation, and loss of **confidentiality** and **integrity**.;;Enforce **password rotation** at `<= 90` days and **prevent reuse**. Pair with **MFA**, strong length/complexity, and prefer **federation/SSO** to reduce static passwords. Apply **least privilege**, monitor sign-ins, and remove inactive console passwords to limit exposure.;https://hub.prowler.com/check/iam_password_policy_expires_passwords_within_90_days_or_less;"```yaml
# CloudFormation: Set IAM account password policy to expire passwords within 90 days
Resources:
  ExampleAccountPasswordPolicy:
    Type: AWS::IAM::AccountPasswordPolicy
    Properties:
      MaxPasswordAge: 90  # Critical: enforces password expiration in 90 days or less to pass the check
```";"```hcl
# Enforce IAM password expiration within 90 days
resource ""aws_iam_account_password_policy"" ""example"" {
  max_password_age = 90  # Critical: enforces password expiration <= 90 days to pass the check
}
```";aws iam update-account-password-policy --max-password-age 90;"1. In the AWS Console, go to IAM
2. Select Account settings
3. In Password policy, click Edit
4. Check Enable password expiration and set Password expiration period (days) to 90 or less
5. Click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC03-BP06 | ISO27001-2022: A.5.15 | AWS-Foundational-Technical-Review: IAM-003 | NIS2: 1.1.1.d, 1.1.2, 9.2.c.v, 11.6.2.a | NIST-800-171-Revision-2: 3_5_5, 3_5_6, 3_5_7, 3_5_8 | ProwlerThreatScore-1.0: 1.1.12 | KISA-ISMS-P-2023: 2.5.4, 2.10.2 | C5-2025: IAM-03.02B, IAM-08.03B, IAM-08.05B, PSS-07.01B | ENS-RD2022: op.acc.6.aws.iam.3 | ISO27001-2013: A.9.2.A, A.9.3.A, A.9.4.A | AWS-Foundational-Security-Best-Practices: IAM.7, IAM.10 | CCC: CCC.Core.CN05.AR02 | MITRE-ATTACK: T1078, T1110 | PCI-4.0: 8.3.6.1, 8.6.3.2 | KISA-ISMS-P-2023-korean: 2.5.4, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-iam;identity-access;;;;5.18.1;https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_password_policy_minimum_length_14-132410971304-ap-northeast-2-132410971304;aws;iam_password_policy_minimum_length_14;IAM password policy requires passwords to be at least 14 characters long;Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices;PASS;IAM password policy requires minimum length of 14 characters.;False;iam;;medium;AwsIamPolicy;arn:aws:iam:ap-northeast-2:132410971304:password-policy;132410971304;;;aws;ap-northeast-2;**IAM password policy** is assessed for the **minimum password length** setting, confirming it meets `>= 14` characters for IAM console users.;Low minimum length reduces entropy, easing **brute force** and **credential stuffing**. Compromised IAM users enable console access, unauthorized changes, and lateral movement, leading to data exposure (confidentiality) and tampering (integrity).;;"Set the **minimum password length** to `>= 14` (prefer `16+`).
- Require mixed character types and prevent reuse
- Enforce **MFA** for all console users
- Prefer SSO over local IAM users
- Apply least privilege and monitor authentication events";https://hub.prowler.com/check/iam_password_policy_minimum_length_14;"```yaml
Resources:
  <example_resource_name>:
    Type: AWS::IAM::AccountPasswordPolicy
    Properties:
      MinimumPasswordLength: 14  # Critical: sets minimum password length to 14 to pass the check
```";"```hcl
resource ""aws_iam_account_password_policy"" ""<example_resource_name>"" {
  minimum_password_length = 14  # Critical: enforces minimum password length >=14
}
```";aws iam update-account-password-policy --minimum-password-length 14;"1. Sign in to the AWS Console and open IAM
2. Go to Account settings > Password policy and click Edit
3. Set Enforce minimum password length to 14
4. Click Save changes (and confirm Set custom if prompted)";AWS-Well-Architected-Framework-Security-Pillar: SEC02-BP01 | ISO27001-2022: A.5.15 | AWS-Foundational-Technical-Review: IAM-003 | CIS-1.5: 1.8 | NIS2: 9.2.c.v | NIST-800-171-Revision-2: 3_5_7 | CISA: your-systems-3, your-surroundings-4 | CIS-5.0: 1.7 | GxP-21-CFR-Part-11: 11.10-d, 11.10-g, 11.200, 11.300-b | NIST-800-53-Revision-5: ac_2_1, ac_2_3_a, ac_2_3_b, ac_2_3_c, ac_2_3_d, ac_2_3, ac_2_d_1, ac_3_3, ac_3_3_a, ac_3_3_b_1, ac_3_3_b_2, ac_3_3_b_3, ac_3_3_b_4, ac_3_3_b_5, ac_3_3_c, ac_3_4, ac_3_4_a, ac_3_4_b, ac_3_4_c, ac_3_4_d, ac_3_4_e, ac_3_8, ac_3_12_a, ac_3_13, ac_3_15_a, ac_3_15_b, ac_4_28, ac_7_4, ac_7_4_a, ac_24, cm_5_1_a, cm_6_a, cm_9_b, cm_12_b, ia_4_d, ia_5, ia_5_b, ia_5_c, ia_5_d, ia_5_f, ia_5_h, ia_5_1_f, ia_5_1_g, ia_5_1_h, ia_5_1_h, ia_5_18_a, ia_5_18_b, ia_8_2_b, ma_4_c, sc_23_3 | GDPR: article_25 | ProwlerThreatScore-1.0: 1.1.4 | KISA-ISMS-P-2023: 2.5.4, 2.10.2 | FedRamp-Moderate-Revision-4: ac-2-1, ac-2-f, ac-2-j, ac-2-3, ac-5-c, ia-2, ia-5-1-a-d-e, ia-5-4 | CIS-1.4: 1.8 | C5-2025: IAM-08.03B, PSS-07.01B | FedRAMP-Low-Revision-4: ac-2, ia-2 | FFIEC: d3-pc-am-b-6, d3-pc-am-b-7 | ENS-RD2022: op.acc.6.r1.aws.iam.1 | ISO27001-2013: A.9.2.C, A.9.3.C, A.9.4.C | CIS-4.0.1: 1.8 | AWS-Foundational-Security-Best-Practices: IAM.7, IAM.10 | CIS-2.0: 1.8 | CCC: CCC.Core.CN05.AR02 | HIPAA: 164_308_a_5_ii_d | CIS-3.0: 1.8 | MITRE-ATTACK: T1078, T1110 | KISA-ISMS-P-2023-korean: 2.5.4, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-iam;identity-access;;;;5.18.1;https://docs.aws.amazon.com/config/latest/developerguide/iam-password-policy.html | https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html | https://docs.aws.amazon.com/sdk-for-ruby/v3/api/Aws/IAM/Resource.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_password_policy_number-132410971304-ap-northeast-2-132410971304;aws;iam_password_policy_number;IAM password policy requires at least one number;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;PASS;IAM password policy requires at least one number.;False;iam;;medium;AwsIamPolicy;arn:aws:iam:ap-northeast-2:132410971304:password-policy;132410971304;;;aws;ap-northeast-2;**IAM account password policy** requires at least one **numeric character** (`0-9`) in IAM user passwords;Passwords without numbers have lower entropy, making **brute-force** and **credential-stuffing** more effective. A compromised IAM user can gain console access, enabling data exposure (**confidentiality**), configuration changes (**integrity**), and resource abuse or deletion (**availability**).;;Enforce the password policy option to `require at least one number`. Combine with strong length, mixed case, and symbols, and prevent reuse. Enable **MFA** for all users and prefer **federated access** to limit static credentials, supporting **defense in depth** against guessing attacks.;https://hub.prowler.com/check/iam_password_policy_number;"```yaml
# CloudFormation: Enforce at least one number in IAM user passwords
Resources:
  <example_resource_name>:
    Type: AWS::IAM::AccountPasswordPolicy
    Properties:
      RequireNumbers: true  # Critical: requires at least one number in passwords
```";"```hcl
# Enforce at least one number in IAM user passwords
resource ""aws_iam_account_password_policy"" ""<example_resource_name>"" {
  require_numbers = true  # Critical: requires at least one number in passwords
}
```";aws iam update-account-password-policy --require-numbers;"1. Open the AWS Management Console and go to IAM
2. In the left menu, click Account settings
3. In Password policy, click Edit
4. Check Require at least one number
5. Click Save changes and confirm Set custom";AWS-Well-Architected-Framework-Security-Pillar: SEC02-BP01 | ISO27001-2022: A.5.15 | AWS-Foundational-Technical-Review: IAM-003 | NIS2: 9.2.c.v | NIST-800-171-Revision-2: 3_5_7 | CISA: your-systems-3, your-surroundings-4 | GxP-21-CFR-Part-11: 11.10-d, 11.10-g, 11.200, 11.300-b | GDPR: article_25 | ProwlerThreatScore-1.0: 1.1.6 | KISA-ISMS-P-2023: 2.5.4, 2.10.2 | C5-2025: IAM-08.03B, IAM-08.05B, PSS-07.01B | FFIEC: d3-pc-am-b-6, d3-pc-am-b-7 | ENS-RD2022: op.acc.6.r1.aws.iam.1 | ISO27001-2013: A.9.2.D, A.9.3.D, A.9.4.D | AWS-Foundational-Security-Best-Practices: IAM.7, IAM.10 | CCC: CCC.Core.CN05.AR02 | HIPAA: 164_308_a_5_ii_d | MITRE-ATTACK: T1078, T1110 | KISA-ISMS-P-2023-korean: 2.5.4, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-iam;identity-access;;;;5.18.1;https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_password_policy_reuse_24-132410971304-ap-northeast-2-132410971304;aws;iam_password_policy_reuse_24;IAM password policy prevents reuse of the last 24 passwords;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;PASS;IAM password policy reuse prevention is equal to 24.;False;iam;;medium;AwsIamPolicy;arn:aws:iam:ap-northeast-2:132410971304:password-policy;132410971304;;;aws;ap-northeast-2;**IAM account password policy** uses **password reuse prevention** set to `24` remembered passwords (maximum history) for IAM users;If fewer than `24` passwords are remembered, users can cycle back to recent secrets, undermining rotation. Attackers with previously exposed passwords can regain console access after a change, reducing **confidentiality** and **integrity** and increasing success of credential-stuffing with known credentials.;;Set the password policy to remember `24` previous passwords to block reuse. Combine with **MFA**, strong length and complexity, and avoid rotation practices that encourage predictable patterns. Apply **least privilege** and monitor authentication events as part of **defense in depth**.;https://hub.prowler.com/check/iam_password_policy_reuse_24;"```yaml
Resources:
  <example_resource_name>:
    Type: AWS::IAM::AccountPasswordPolicy
    Properties:
      PasswordReusePrevention: 24  # Critical: prevents reuse of the last 24 passwords
```";"```hcl
resource ""aws_iam_account_password_policy"" ""<example_resource_name>"" {
  password_reuse_prevention = 24  # Critical: require last 24 passwords cannot be reused
}
```";aws iam update-account-password-policy --password-reuse-prevention 24;"1. Open the AWS Management Console and go to IAM
2. In the left menu, select Account settings
3. In Password policy, click Edit
4. Select Custom (if not already)
5. Set Prevent password reuse to 24
6. Click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC02-BP01 | ISO27001-2022: A.5.15 | AWS-Foundational-Technical-Review: IAM-003 | PCI-3.2.1: 8.1, 8.1.4, 8.2, 8.2.3, 8.2.3.a, 8.2.3.b, 8.2.4, 8.2.4.a, 8.2.4.b, 8.2.5, 8.2.5.a, 8.2.5.b | CIS-1.5: 1.9 | NIS2: 9.2.c.v | NIST-800-171-Revision-2: 3_5_5, 3_5_6, 3_5_7, 3_5_8 | NIST-800-53-Revision-4: ac_2_1, ac_2, ia_2, ia_5_1, ia_5_4 | CIS-5.0: 1.8 | GDPR: article_25 | ProwlerThreatScore-1.0: 1.1.5 | KISA-ISMS-P-2023: 2.5.4, 2.10.2 | CIS-1.4: 1.9 | C5-2025: IAM-01.03B, IAM-03.02B, IAM-03.03B, IAM-03.01AS, IAM-08.03B, IAM-08.05B, IAM-08.07B, PSS-07.01B | ENS-RD2022: op.acc.6.r1.aws.iam.1 | NIST-CSF-1.1: ac_1 | ISO27001-2013: A.9.2.B, A.9.3.B, A.9.4.B | CIS-4.0.1: 1.9 | AWS-Foundational-Security-Best-Practices: IAM.7, IAM.10 | CIS-2.0: 1.9 | CCC: CCC.Core.CN05.AR02 | HIPAA: 164_308_a_4_ii_c, 164_308_a_5_ii_d, 164_312_d | CIS-3.0: 1.9 | RBI-Cyber-Security-Framework: annex_i_7_2 | MITRE-ATTACK: T1078, T1110 | KISA-ISMS-P-2023-korean: 2.5.4, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-iam;identity-access;;;;5.18.1;https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_password_policy_symbol-132410971304-ap-northeast-2-132410971304;aws;iam_password_policy_symbol;IAM password policy requires at least one symbol;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | TTPs/Credential Access;PASS;IAM password policy requires at least one symbol.;False;iam;;medium;AwsIamPolicy;arn:aws:iam:ap-northeast-2:132410971304:password-policy;132410971304;;;aws;ap-northeast-2;**IAM account password policy** includes the `Require at least one non-alphanumeric character` rule for IAM user passwords;Missing a **symbol requirement** lowers password entropy, increasing success of **brute force** and **credential stuffing** against console logins. A compromised IAM user can gain unauthorized access and modify resources, threatening **confidentiality** and **integrity** across the account.;;Enforce the `Require at least one non-alphanumeric character` rule in the **IAM password policy**, alongside strong minimum length, mixed character sets, and password reuse prevention. Apply **MFA** for all human users and uphold **least privilege** to limit impact. *Consider periodic rotation based on risk.*;https://hub.prowler.com/check/iam_password_policy_symbol;"```yaml
Resources:
  <example_resource_name>:
    Type: AWS::IAM::AccountPasswordPolicy
    Properties:
      RequireSymbols: true  # Critical: requires at least one symbol in passwords
```";"```hcl
resource ""aws_iam_account_password_policy"" ""<example_resource_name>"" {
  require_symbols = true  # Critical: require at least one symbol in passwords
}
```";aws iam update-account-password-policy --require-symbols;"1. In the AWS console, open IAM
2. Go to Account settings
3. Click Edit in the Password policy section
4. Check ""Require at least one non-alphanumeric character (symbol)""
5. Click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC02-BP01 | ISO27001-2022: A.5.15 | AWS-Foundational-Technical-Review: IAM-003 | NIS2: 9.2.c.v | NIST-800-171-Revision-2: 3_5_7 | CISA: your-systems-3, your-surroundings-4 | GxP-21-CFR-Part-11: 11.10-d, 11.10-g, 11.200, 11.300-b | GDPR: article_25 | ProwlerThreatScore-1.0: 1.1.7 | KISA-ISMS-P-2023: 2.5.4, 2.10.2 | C5-2025: IAM-08.03B, PSS-07.01B | FFIEC: d3-pc-am-b-6, d3-pc-am-b-7 | ENS-RD2022: op.acc.6.r1.aws.iam.1 | ISO27001-2013: A.9.2.E, A.9.3.E, A.9.4.E | AWS-Foundational-Security-Best-Practices: IAM.7, IAM.10 | CCC: CCC.Core.CN05.AR02 | HIPAA: 164_308_a_5_ii_d | MITRE-ATTACK: T1078, T1110 | KISA-ISMS-P-2023-korean: 2.5.4, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-iam;identity-access;;;;5.18.1;https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_password_policy_uppercase-132410971304-ap-northeast-2-132410971304;aws;iam_password_policy_uppercase;IAM password policy requires at least one uppercase letter;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls (USA) | Software and Configuration Checks/Industry and Regulatory Standards/PCI-DSS;PASS;IAM password policy requires at least one uppercase letter.;False;iam;;medium;AwsIamPolicy;arn:aws:iam:ap-northeast-2:132410971304:password-policy;132410971304;;;aws;ap-northeast-2;"**IAM account password policy** enforces the presence of **at least one uppercase letter** (`A-Z`) in IAM user passwords.

*This evaluates whether the uppercase complexity rule is enabled for console passwords.*";Without an uppercase requirement, passwords have lower entropy, enabling **brute force**, **credential stuffing**, and **offline cracking**. Compromised IAM users can access the console, threatening **confidentiality** (data exposure), **integrity** (unauthorized changes), and **availability** (resource deletion).;;Enable the uppercase rule within a **strong password policy** that also requires length, lowercase, numbers, and symbols. Pair with **MFA** and **least privilege** to reduce blast radius. Regularly review policy effectiveness and prefer **federated SSO** to minimize long-lived IAM passwords.;https://hub.prowler.com/check/iam_password_policy_uppercase;"```yaml
Resources:
  <example_resource_name>:
    Type: AWS::IAM::AccountPasswordPolicy
    Properties:
      RequireUppercaseCharacters: true  # Critical: enforce at least one uppercase letter
```";"```hcl
resource ""aws_iam_account_password_policy"" ""<example_resource_name>"" {
  require_uppercase_characters = true  # Critical: enforce at least one uppercase letter
}
```";aws iam update-account-password-policy --require-uppercase-characters;"1. In the AWS Console, go to IAM
2. Open Account settings > Password policy > Edit
3. Check ""Require at least one uppercase letter (A-Z)""
4. Click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC02-BP01 | ISO27001-2022: A.5.15 | AWS-Foundational-Technical-Review: IAM-003 | NIS2: 9.2.c.v | NIST-800-171-Revision-2: 3_5_7 | CISA: your-systems-3, your-surroundings-4 | GxP-21-CFR-Part-11: 11.10-d, 11.10-g, 11.200, 11.300-b | GDPR: article_25 | ProwlerThreatScore-1.0: 1.1.9 | KISA-ISMS-P-2023: 2.5.4, 2.10.2 | C5-2025: IAM-08.03B, IAM-08.05B, PSS-07.01B | FFIEC: d3-pc-am-b-6, d3-pc-am-b-7 | ENS-RD2022: op.acc.6.r1.aws.iam.1 | ISO27001-2013: A.9.2.G, A.9.3.G, A.9.4.G | AWS-Foundational-Security-Best-Practices: IAM.7, IAM.10 | CCC: CCC.Core.CN05.AR02 | HIPAA: 164_308_a_5_ii_d | MITRE-ATTACK: T1078, T1110 | KISA-ISMS-P-2023-korean: 2.5.4, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-iam;identity-access;;;;5.18.1;https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_policy_cloudshell_admin_not_attached-132410971304-ap-northeast-2-132410971304;aws;iam_policy_cloudshell_admin_not_attached;No IAM users, groups, or roles have the AWSCloudShellFullAccess policy attached;Software and Configuration Checks/AWS Security Best Practices;PASS;AWS CloudShellFullAccess policy is not attached to any IAM entity.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::aws:policy/AWSCloudShellFullAccess;132410971304;;;aws;ap-northeast-2;"**IAM identities** with the AWS managed policy `AWSCloudShellFullAccess` attached are identified across users, groups, and roles.

This indicates principals are granted `cloudshell:*` on `*`, enabling full CloudShell features, including environment startup and file transfer.";"Granting `cloudshell:*` enables an interactive shell with Internet egress and file upload/download, degrading **confidentiality** and **integrity**.

Compromised principals can exfiltrate data, stage tooling with sudo, persist artifacts in CloudShell, and operate from AWS IP space to bypass endpoint controls.";;"Detach `AWSCloudShellFullAccess` from identities.

Apply **least privilege**: permit CloudShell only when necessary via narrowly scoped permissions, restricted roles, short-lived sessions, and approvals. Prefer controlled alternatives (local CLI, bastion, or Session Manager). Enforce **separation of duties** and monitor usage.";https://hub.prowler.com/check/iam_policy_cloudshell_admin_not_attached;"```yaml
# CloudFormation: ensure AWSCloudShellFullAccess is NOT attached to the IAM user
Resources:
  <example_resource_name>:
    Type: AWS::IAM::User
    Properties:
      ManagedPolicyArns: []  # Critical: empty list ensures AWSCloudShellFullAccess is not attached
```";"```hcl
# Terraform: ensure AWSCloudShellFullAccess is NOT attached
resource ""aws_iam_user_policy_attachment"" ""<example_resource_name>"" {
  count      = 0  # Critical: prevents creation, ensuring the policy is detached/not attached
  user       = ""<example_resource_name>""
  policy_arn = ""arn:aws:iam::aws:policy/AWSCloudShellFullAccess""  # Denied policy
}
```";;"1. In the AWS console, go to IAM > Policies
2. Search for AWSCloudShellFullAccess and open it
3. Select the Entities attached tab
4. Select all Users, Groups, and Roles listed
5. Click Detach and confirm";NIS2: 1.2.1 | CIS-5.0: 1.21 | ProwlerThreatScore-1.0: 1.3.2 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-02.01B, SP-01.04B, HR-01.01B, IAM-01.01B, IAM-01.04B, IAM-06.01B | CIS-4.0.1: 1.22 | CIS-2.0: 1.22 | PCI-4.0: 7.2.1.14, 7.2.1.15, 7.2.1.16, 7.2.2.14, 7.2.2.15, 7.2.2.16, 7.2.3.7, 7.2.5.10, 7.2.5.11, 7.2.5.12, 7.3.1.10, 7.3.1.11, 7.3.1.12, 7.3.2.10, 7.3.2.11, 7.3.2.12, 7.3.3.10, 7.3.3.11, 7.3.3.12, 8.2.7.10, 8.2.7.11, 8.2.7.12, 8.2.8.12, 8.2.8.13, 8.2.8.14, 8.3.4.10, 8.3.4.11, 8.3.4.12 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2;identity-access;;;;5.18.1;https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html#iam-27 | https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/IAM/unapproved-iam-policy-in-use.html | https://docs.aws.amazon.com/config/latest/developerguide/iam-policy-blacklisted-check.html | https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_manage-attach-detach.html | https://icompaas.freshdesk.com/support/solutions/articles/62000233099-1-22-restrict-access-to-awscloudshellfullaccess-manual-
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_policy_no_full_access_to_cloudtrail-132410971304-ap-northeast-2-GitHubActionsProwlerRole-ProwlerReadOnly;aws;iam_policy_no_full_access_to_cloudtrail;Customer managed IAM policy does not allow cloudtrail:* privileges;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | TTPs/Defense Evasion;PASS;Custom Policy GitHubActionsProwlerRole-ProwlerReadOnly does not allow 'cloudtrail:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:policy/GitHubActionsProwlerRole-ProwlerReadOnly;GitHubActionsProwlerRole-ProwlerReadOnly;;;aws;ap-northeast-2;Custom IAM policies are reviewed for statements that grant **full CloudTrail access** via the `cloudtrail:*` wildcard, indicating unrestricted permission to all CloudTrail actions.;"Unrestricted CloudTrail control lets principals stop or alter logging, delete or modify trails, and query events.

This enables log evasion, audit tampering, and reconnaissance, undermining the **integrity**, **availability**, and **confidentiality** of audit evidence and detection.";;"Apply **least privilege**: avoid `cloudtrail:*` and allow only required actions.

Enforce **separation of duties** for trail management. Use **permissions boundaries** or **SCPs** to block broad CloudTrail access, and validate policies regularly to refine scopes.";https://hub.prowler.com/check/iam_policy_no_full_access_to_cloudtrail;"```yaml
# CloudFormation managed policy without CloudTrail wildcard access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::ManagedPolicy
    Properties:
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action: cloudtrail:DescribeTrails  # Critical: replaces 'cloudtrail:*' with a specific action to remove full access
            Resource: ""*""
```";"```hcl
# IAM policy without CloudTrail wildcard access
resource ""aws_iam_policy"" ""<example_resource_name>"" {
  name   = ""<example_resource_name>""
  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = ""cloudtrail:DescribeTrails"" # Critical: replaces 'cloudtrail:*' with a specific action, removing full access
      Resource = ""*""
    }]
  })
}
```";"aws iam create-policy-version --policy-arn <example_policy_arn> --policy-document '{""Version"":""2012-10-17"",""Statement"":[{""Effect"":""Allow"",""Action"":""cloudtrail:DescribeTrails"",""Resource"":""*""}]}' --set-as-default";"1. In the AWS Console, go to IAM > Policies
2. Open the custom managed policy that contains Action: ""cloudtrail:*""
3. Click Edit JSON
4. Replace ""cloudtrail:*"" with only the specific CloudTrail actions needed (e.g., ""cloudtrail:DescribeTrails"" or ""cloudtrail:LookupEvents""), or remove CloudTrail actions entirely
5. Save changes to create/set the new default policy version
6. Verify the policy no longer contains ""cloudtrail:*""";NIS2: 11.2.2.a | NIST-CSF-2.0: rr_1, po_1, ac_1, ac_4 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: IAM-10.01B, SIM-03.07B | ENS-RD2022: op.exp.8.r4.aws.ct.1 | SOC2: cc_3_3 | CCC: CCC.LB.CN05.AR01, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | MITRE-ATTACK: T1078, T1648, T1098, T1578, T1550, T1580 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-iam;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://support.icompaas.com/support/solutions/articles/62000233808-ensure-iam-policies-that-allow-full-cloudtrail-privileges-are-not-created
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_policy_no_full_access_to_cloudtrail-132410971304-ap-northeast-2-remediation-aws-cloudtrail-logs-policy;aws;iam_policy_no_full_access_to_cloudtrail;Customer managed IAM policy does not allow cloudtrail:* privileges;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | TTPs/Defense Evasion;PASS;Custom Policy remediation-aws-cloudtrail-logs-policy does not allow 'cloudtrail:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:policy/remediation-aws-cloudtrail-logs-policy;remediation-aws-cloudtrail-logs-policy;;;aws;ap-northeast-2;Custom IAM policies are reviewed for statements that grant **full CloudTrail access** via the `cloudtrail:*` wildcard, indicating unrestricted permission to all CloudTrail actions.;"Unrestricted CloudTrail control lets principals stop or alter logging, delete or modify trails, and query events.

This enables log evasion, audit tampering, and reconnaissance, undermining the **integrity**, **availability**, and **confidentiality** of audit evidence and detection.";;"Apply **least privilege**: avoid `cloudtrail:*` and allow only required actions.

Enforce **separation of duties** for trail management. Use **permissions boundaries** or **SCPs** to block broad CloudTrail access, and validate policies regularly to refine scopes.";https://hub.prowler.com/check/iam_policy_no_full_access_to_cloudtrail;"```yaml
# CloudFormation managed policy without CloudTrail wildcard access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::ManagedPolicy
    Properties:
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action: cloudtrail:DescribeTrails  # Critical: replaces 'cloudtrail:*' with a specific action to remove full access
            Resource: ""*""
```";"```hcl
# IAM policy without CloudTrail wildcard access
resource ""aws_iam_policy"" ""<example_resource_name>"" {
  name   = ""<example_resource_name>""
  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = ""cloudtrail:DescribeTrails"" # Critical: replaces 'cloudtrail:*' with a specific action, removing full access
      Resource = ""*""
    }]
  })
}
```";"aws iam create-policy-version --policy-arn <example_policy_arn> --policy-document '{""Version"":""2012-10-17"",""Statement"":[{""Effect"":""Allow"",""Action"":""cloudtrail:DescribeTrails"",""Resource"":""*""}]}' --set-as-default";"1. In the AWS Console, go to IAM > Policies
2. Open the custom managed policy that contains Action: ""cloudtrail:*""
3. Click Edit JSON
4. Replace ""cloudtrail:*"" with only the specific CloudTrail actions needed (e.g., ""cloudtrail:DescribeTrails"" or ""cloudtrail:LookupEvents""), or remove CloudTrail actions entirely
5. Save changes to create/set the new default policy version
6. Verify the policy no longer contains ""cloudtrail:*""";NIS2: 11.2.2.a | NIST-CSF-2.0: rr_1, po_1, ac_1, ac_4 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: IAM-10.01B, SIM-03.07B | ENS-RD2022: op.exp.8.r4.aws.ct.1 | SOC2: cc_3_3 | CCC: CCC.LB.CN05.AR01, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | MITRE-ATTACK: T1078, T1648, T1098, T1578, T1550, T1580 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-iam;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://support.icompaas.com/support/solutions/articles/62000233808-ensure-iam-policies-that-allow-full-cloudtrail-privileges-are-not-created
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_policy_no_full_access_to_cloudtrail-132410971304-ap-northeast-2-aws_learner_dynamodb_policy;aws;iam_policy_no_full_access_to_cloudtrail;Customer managed IAM policy does not allow cloudtrail:* privileges;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | TTPs/Defense Evasion;PASS;Custom Policy aws_learner_dynamodb_policy does not allow 'cloudtrail:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:policy/aws_learner_dynamodb_policy;aws_learner_dynamodb_policy;;;aws;ap-northeast-2;Custom IAM policies are reviewed for statements that grant **full CloudTrail access** via the `cloudtrail:*` wildcard, indicating unrestricted permission to all CloudTrail actions.;"Unrestricted CloudTrail control lets principals stop or alter logging, delete or modify trails, and query events.

This enables log evasion, audit tampering, and reconnaissance, undermining the **integrity**, **availability**, and **confidentiality** of audit evidence and detection.";;"Apply **least privilege**: avoid `cloudtrail:*` and allow only required actions.

Enforce **separation of duties** for trail management. Use **permissions boundaries** or **SCPs** to block broad CloudTrail access, and validate policies regularly to refine scopes.";https://hub.prowler.com/check/iam_policy_no_full_access_to_cloudtrail;"```yaml
# CloudFormation managed policy without CloudTrail wildcard access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::ManagedPolicy
    Properties:
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action: cloudtrail:DescribeTrails  # Critical: replaces 'cloudtrail:*' with a specific action to remove full access
            Resource: ""*""
```";"```hcl
# IAM policy without CloudTrail wildcard access
resource ""aws_iam_policy"" ""<example_resource_name>"" {
  name   = ""<example_resource_name>""
  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = ""cloudtrail:DescribeTrails"" # Critical: replaces 'cloudtrail:*' with a specific action, removing full access
      Resource = ""*""
    }]
  })
}
```";"aws iam create-policy-version --policy-arn <example_policy_arn> --policy-document '{""Version"":""2012-10-17"",""Statement"":[{""Effect"":""Allow"",""Action"":""cloudtrail:DescribeTrails"",""Resource"":""*""}]}' --set-as-default";"1. In the AWS Console, go to IAM > Policies
2. Open the custom managed policy that contains Action: ""cloudtrail:*""
3. Click Edit JSON
4. Replace ""cloudtrail:*"" with only the specific CloudTrail actions needed (e.g., ""cloudtrail:DescribeTrails"" or ""cloudtrail:LookupEvents""), or remove CloudTrail actions entirely
5. Save changes to create/set the new default policy version
6. Verify the policy no longer contains ""cloudtrail:*""";NIS2: 11.2.2.a | NIST-CSF-2.0: rr_1, po_1, ac_1, ac_4 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: IAM-10.01B, SIM-03.07B | ENS-RD2022: op.exp.8.r4.aws.ct.1 | SOC2: cc_3_3 | CCC: CCC.LB.CN05.AR01, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | MITRE-ATTACK: T1078, T1648, T1098, T1578, T1550, T1580 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-iam;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://support.icompaas.com/support/solutions/articles/62000233808-ensure-iam-policies-that-allow-full-cloudtrail-privileges-are-not-created
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_policy_no_full_access_to_kms-132410971304-ap-northeast-2-GitHubActionsProwlerRole-ProwlerReadOnly;aws;iam_policy_no_full_access_to_kms;Custom IAM policy does not allow 'kms:*' privileges;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Exposure | Effects/Data Destruction | TTPs/Privilege Escalation;PASS;Custom Policy GitHubActionsProwlerRole-ProwlerReadOnly does not allow 'kms:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:policy/GitHubActionsProwlerRole-ProwlerReadOnly;GitHubActionsProwlerRole-ProwlerReadOnly;;;aws;ap-northeast-2;**Customer-managed IAM policies** are examined for statements that grant **AWS KMS** full access using `kms:*`. The focus is on policies allowing service-wide actions rather than narrowly scoped, key-specific permissions.;"Allowing `kms:*` lets principals decrypt data, change key policies, and disable or delete keys. Impact: **Confidentiality**-unauthorized decryption; **Integrity**-manipulation of cryptographic controls; **Availability**-data unreadable if keys are disabled/deleted. It can also enable privilege escalation.";;"Adopt **least privilege** and **separation of duties**:
- Replace `kms:*` with only needed actions scoped to specific key ARNs
- Apply policy conditions (e.g., `kms:ViaService`) and guardrails (permissions boundaries/SCPs)
- Monitor KMS usage and refine access based on activity";https://hub.prowler.com/check/iam_policy_no_full_access_to_kms;"```yaml
# CloudFormation: customer managed policy without kms:* full access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::ManagedPolicy
    Properties:
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action:
              - kms:Encrypt  # FIX: remove 'kms:*'; allow only specific KMS action
            Resource: arn:aws:kms:<REGION>:<ACCOUNT_ID>:key/<example_resource_id>  # FIX: scope to a specific key
```";"```hcl
# Customer managed policy without kms:* full access
resource ""aws_iam_policy"" ""<example_resource_name>"" {
  name   = ""<example_resource_name>""
  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = [""kms:Encrypt""]  # FIX: remove 'kms:*'; allow only specific KMS action
      Resource = ""arn:aws:kms:<REGION>:<ACCOUNT_ID>:key/<example_resource_id>""  # FIX: scope to a specific key
    }]
  })
}
```";"aws iam create-policy-version --policy-arn <POLICY_ARN> --policy-document '{""Version"":""2012-10-17"",""Statement"":[{""Effect"":""Allow"",""Action"":[""kms:Encrypt""],""Resource"":""arn:aws:kms:<REGION>:<ACCOUNT_ID>:key/<KEY_ID>""}]}' --set-as-default";"1. In the AWS Console, open IAM > Policies
2. Find the custom policy that allows kms:* and choose Edit policy > JSON
3. Replace any ""Action"": ""kms:*"" (or [""kms:*""]) with only required actions (e.g., [""kms:Encrypt""]) and, if possible, set ""Resource"" to a specific key ARN
4. Save changes (a new default policy version is created)
5. Re-run the check to confirm it passes";NIS2: 11.2.2.a | NIST-CSF-2.0: rr_1, po_1, ac_1, ac_4 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-08.02B, IAM-10.01B, CRY-05.02B | ENS-RD2022: op.exp.10.aws.cmk.1, op.exp.10.aws.cmk.2 | CCC: CCC.LB.CN05.AR01, CCC.ObjStor.CN01.AR01, CCC.ObjStor.CN01.AR02, CCC.ObjStor.CN01.AR03, CCC.ObjStor.CN01.AR04, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | MITRE-ATTACK: T1078, T1648, T1098, T1578, T1550, T1580 | PCI-4.0: 3.5.1.1.7, 3.5.1.3.15, 3.6.1.2.7, 3.6.1.3.7, 3.6.1.4.7, 3.6.1.7, 3.7.1.8, 3.7.2.7, 3.7.4.8, 3.7.6.7, 3.7.7.7, 4.2.1.1.20, 7.2.1.9, 7.2.2.9, 7.2.3.5, 7.2.5.5, 7.3.1.5, 7.3.2.5, 7.3.3.5, 8.2.7.5, 8.2.8.7, 8.3.4.5 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-iam;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://docs.aws.amazon.com/it_it/prescriptive-guidance/latest/encryption-best-practices/kms.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_policy_no_full_access_to_kms-132410971304-ap-northeast-2-remediation-aws-cloudtrail-logs-policy;aws;iam_policy_no_full_access_to_kms;Custom IAM policy does not allow 'kms:*' privileges;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Exposure | Effects/Data Destruction | TTPs/Privilege Escalation;PASS;Custom Policy remediation-aws-cloudtrail-logs-policy does not allow 'kms:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:policy/remediation-aws-cloudtrail-logs-policy;remediation-aws-cloudtrail-logs-policy;;;aws;ap-northeast-2;**Customer-managed IAM policies** are examined for statements that grant **AWS KMS** full access using `kms:*`. The focus is on policies allowing service-wide actions rather than narrowly scoped, key-specific permissions.;"Allowing `kms:*` lets principals decrypt data, change key policies, and disable or delete keys. Impact: **Confidentiality**-unauthorized decryption; **Integrity**-manipulation of cryptographic controls; **Availability**-data unreadable if keys are disabled/deleted. It can also enable privilege escalation.";;"Adopt **least privilege** and **separation of duties**:
- Replace `kms:*` with only needed actions scoped to specific key ARNs
- Apply policy conditions (e.g., `kms:ViaService`) and guardrails (permissions boundaries/SCPs)
- Monitor KMS usage and refine access based on activity";https://hub.prowler.com/check/iam_policy_no_full_access_to_kms;"```yaml
# CloudFormation: customer managed policy without kms:* full access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::ManagedPolicy
    Properties:
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action:
              - kms:Encrypt  # FIX: remove 'kms:*'; allow only specific KMS action
            Resource: arn:aws:kms:<REGION>:<ACCOUNT_ID>:key/<example_resource_id>  # FIX: scope to a specific key
```";"```hcl
# Customer managed policy without kms:* full access
resource ""aws_iam_policy"" ""<example_resource_name>"" {
  name   = ""<example_resource_name>""
  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = [""kms:Encrypt""]  # FIX: remove 'kms:*'; allow only specific KMS action
      Resource = ""arn:aws:kms:<REGION>:<ACCOUNT_ID>:key/<example_resource_id>""  # FIX: scope to a specific key
    }]
  })
}
```";"aws iam create-policy-version --policy-arn <POLICY_ARN> --policy-document '{""Version"":""2012-10-17"",""Statement"":[{""Effect"":""Allow"",""Action"":[""kms:Encrypt""],""Resource"":""arn:aws:kms:<REGION>:<ACCOUNT_ID>:key/<KEY_ID>""}]}' --set-as-default";"1. In the AWS Console, open IAM > Policies
2. Find the custom policy that allows kms:* and choose Edit policy > JSON
3. Replace any ""Action"": ""kms:*"" (or [""kms:*""]) with only required actions (e.g., [""kms:Encrypt""]) and, if possible, set ""Resource"" to a specific key ARN
4. Save changes (a new default policy version is created)
5. Re-run the check to confirm it passes";NIS2: 11.2.2.a | NIST-CSF-2.0: rr_1, po_1, ac_1, ac_4 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-08.02B, IAM-10.01B, CRY-05.02B | ENS-RD2022: op.exp.10.aws.cmk.1, op.exp.10.aws.cmk.2 | CCC: CCC.LB.CN05.AR01, CCC.ObjStor.CN01.AR01, CCC.ObjStor.CN01.AR02, CCC.ObjStor.CN01.AR03, CCC.ObjStor.CN01.AR04, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | MITRE-ATTACK: T1078, T1648, T1098, T1578, T1550, T1580 | PCI-4.0: 3.5.1.1.7, 3.5.1.3.15, 3.6.1.2.7, 3.6.1.3.7, 3.6.1.4.7, 3.6.1.7, 3.7.1.8, 3.7.2.7, 3.7.4.8, 3.7.6.7, 3.7.7.7, 4.2.1.1.20, 7.2.1.9, 7.2.2.9, 7.2.3.5, 7.2.5.5, 7.3.1.5, 7.3.2.5, 7.3.3.5, 8.2.7.5, 8.2.8.7, 8.3.4.5 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-iam;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://docs.aws.amazon.com/it_it/prescriptive-guidance/latest/encryption-best-practices/kms.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_policy_no_full_access_to_kms-132410971304-ap-northeast-2-aws_learner_dynamodb_policy;aws;iam_policy_no_full_access_to_kms;Custom IAM policy does not allow 'kms:*' privileges;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Exposure | Effects/Data Destruction | TTPs/Privilege Escalation;PASS;Custom Policy aws_learner_dynamodb_policy does not allow 'kms:*' privileges.;False;iam;;medium;AwsIamPolicy;arn:aws:iam::132410971304:policy/aws_learner_dynamodb_policy;aws_learner_dynamodb_policy;;;aws;ap-northeast-2;**Customer-managed IAM policies** are examined for statements that grant **AWS KMS** full access using `kms:*`. The focus is on policies allowing service-wide actions rather than narrowly scoped, key-specific permissions.;"Allowing `kms:*` lets principals decrypt data, change key policies, and disable or delete keys. Impact: **Confidentiality**-unauthorized decryption; **Integrity**-manipulation of cryptographic controls; **Availability**-data unreadable if keys are disabled/deleted. It can also enable privilege escalation.";;"Adopt **least privilege** and **separation of duties**:
- Replace `kms:*` with only needed actions scoped to specific key ARNs
- Apply policy conditions (e.g., `kms:ViaService`) and guardrails (permissions boundaries/SCPs)
- Monitor KMS usage and refine access based on activity";https://hub.prowler.com/check/iam_policy_no_full_access_to_kms;"```yaml
# CloudFormation: customer managed policy without kms:* full access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::ManagedPolicy
    Properties:
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action:
              - kms:Encrypt  # FIX: remove 'kms:*'; allow only specific KMS action
            Resource: arn:aws:kms:<REGION>:<ACCOUNT_ID>:key/<example_resource_id>  # FIX: scope to a specific key
```";"```hcl
# Customer managed policy without kms:* full access
resource ""aws_iam_policy"" ""<example_resource_name>"" {
  name   = ""<example_resource_name>""
  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect   = ""Allow""
      Action   = [""kms:Encrypt""]  # FIX: remove 'kms:*'; allow only specific KMS action
      Resource = ""arn:aws:kms:<REGION>:<ACCOUNT_ID>:key/<example_resource_id>""  # FIX: scope to a specific key
    }]
  })
}
```";"aws iam create-policy-version --policy-arn <POLICY_ARN> --policy-document '{""Version"":""2012-10-17"",""Statement"":[{""Effect"":""Allow"",""Action"":[""kms:Encrypt""],""Resource"":""arn:aws:kms:<REGION>:<ACCOUNT_ID>:key/<KEY_ID>""}]}' --set-as-default";"1. In the AWS Console, open IAM > Policies
2. Find the custom policy that allows kms:* and choose Edit policy > JSON
3. Replace any ""Action"": ""kms:*"" (or [""kms:*""]) with only required actions (e.g., [""kms:Encrypt""]) and, if possible, set ""Resource"" to a specific key ARN
4. Save changes (a new default policy version is created)
5. Re-run the check to confirm it passes";NIS2: 11.2.2.a | NIST-CSF-2.0: rr_1, po_1, ac_1, ac_4 | KISA-ISMS-P-2023: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | C5-2025: OIS-08.02B, IAM-10.01B, CRY-05.02B | ENS-RD2022: op.exp.10.aws.cmk.1, op.exp.10.aws.cmk.2 | CCC: CCC.LB.CN05.AR01, CCC.ObjStor.CN01.AR01, CCC.ObjStor.CN01.AR02, CCC.ObjStor.CN01.AR03, CCC.ObjStor.CN01.AR04, CCC.Core.CN05.AR01, CCC.Core.CN05.AR02, CCC.Core.CN05.AR04 | MITRE-ATTACK: T1078, T1648, T1098, T1578, T1550, T1580 | PCI-4.0: 3.5.1.1.7, 3.5.1.3.15, 3.6.1.2.7, 3.6.1.3.7, 3.6.1.4.7, 3.6.1.7, 3.7.1.8, 3.7.2.7, 3.7.4.8, 3.7.6.7, 3.7.7.7, 4.2.1.1.20, 7.2.1.9, 7.2.2.9, 7.2.3.5, 7.2.5.5, 7.3.1.5, 7.3.2.5, 7.3.3.5, 8.2.7.5, 8.2.8.7, 8.3.4.5 | KISA-ISMS-P-2023-korean: 2.5.1, 2.5.5, 2.5.6, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-iam;identity-access;;;;5.18.1;http://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html | https://docs.aws.amazon.com/it_it/prescriptive-guidance/latest/encryption-best-practices/kms.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_user_console_access_unused-132410971304-ap-northeast-2-aws_learner;aws;iam_user_console_access_unused;IAM user console access is disabled, used within the configured inactivity period, or never used;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | TTPs/Initial Access;PASS;User aws_learner does not have console access enabled or is unused.;False;iam;;medium;AwsIamUser;arn:aws:iam::132410971304:user/aws_learner;aws_learner;;;aws;ap-northeast-2;"**IAM users** with console access are evaluated by `password_last_used`. Inactivity beyond `max_console_access_days` (default `45`) marks **stale console access**.

*Users without console access are excluded*.";**Dormant console credentials** stay valid and invite **password spraying**, **credential stuffing**, and breach reuse. Compromise yields interactive access for data discovery/exfiltration and unauthorized IAM or resource changes, degrading **confidentiality** and **integrity**, and risking **availability**.;;Remove or disable console passwords for users inactive beyond your window (e.g., `45` days). Prefer roles or federation over long-lived IAM users. Enforce **least privilege**, require **MFA** for remaining console users, and run periodic reviews and deprovisioning to prevent unused credentials.;https://hub.prowler.com/check/iam_user_console_access_unused;"```yaml
# CloudFormation: IAM user without console access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::User
    Properties:
      UserName: <example_resource_name>
      # Critical: No LoginProfile property -> disables console access for the user
```";"```hcl
# IAM user with console access disabled by not creating a login profile
resource ""aws_iam_user"" ""<example_resource_name>"" {
  name = ""<example_resource_name>""
  # Critical: Do not define aws_iam_user_login_profile for this user -> no console access
}
```";aws iam delete-login-profile --user-name <USER_NAME>;"1. Open the IAM console and go to Users
2. Select the user
3. Open the Security credentials tab
4. Click Manage console access
5. Select Disable console access and Save";ISO27001-2022: A.5.15 | PCI-3.2.1: 8.1, 8.1.4 | CIS-1.5: 1.12 | NIS2: 11.3.2.d, 11.5.4 | NIST-800-171-Revision-2: 3_1_1, 3_1_2, 3_1_4, 3_1_5, 3_5_6, 3_5_7, 3_5_8 | NIST-800-53-Revision-4: ac_2_1, ac_2_3, ac_2, ac_3, ac_6 | NIST-CSF-2.0: ac_1 | CISA: your-systems-3 | CIS-5.0: 1.11 | GxP-21-CFR-Part-11: 11.10-d, 11.10-g, 11.300-b | NIST-800-53-Revision-5: ac_2_1, ac_2_3_a, ac_2_3_b, ac_2_3_c, ac_2_3_d, ac_2_3, ac_2_6, ac_2_g, ac_2_j, ac_3, ac_3_3, ac_3_3_a, ac_3_3_b_1, ac_3_3_b_2, ac_3_3_b_3, ac_3_3_b_4, ac_3_3_b_5, ac_3_3_c, ac_3_4, ac_3_4_a, ac_3_4_b, ac_3_4_c, ac_3_4_d, ac_3_4_e, ac_3_7, ac_3_8, ac_3_12_a, ac_3_13, ac_3_15_a, ac_3_15_b, ac_4_28, ac_6, ac_24, cm_5_1_a, cm_6_a, cm_9_b, mp_2, sc_23_3 | GDPR: article_25 | ProwlerThreatScore-1.0: 1.1.10 | KISA-ISMS-P-2023: 2.5.3, 2.10.2 | FedRamp-Moderate-Revision-4: ac-2-1, ac-2-f, ac-2-j, ac-2-3, ac-3, ac-5-c, ac-6 | CIS-1.4: 1.12 | C5-2025: OPS-05.02AC, IAM-03.02B, IAM-03.03B, IAM-03.01AS, IAM-05.04B, IAM-10.01B | FedRAMP-Low-Revision-4: ac-2, ac-3 | FFIEC: d3-pc-am-b-6 | ENS-RD2022: op.acc.6.aws.iam.2, op.acc.6.aws.iam.3, op.acc.6.r7.aws.iam.1 | SOC2: cc_1_3 | NIST-CSF-1.1: ac_1, ac_4 | ISO27001-2013: A.9.2.M, A.9.3.J, A.9.4.M | CIS-4.0.1: 1.12 | AWS-Foundational-Security-Best-Practices: IAM.8, IAM.22, IAM.26 | CIS-2.0: 1.12 | HIPAA: 164_308_a_3_ii_b, 164_308_a_4_ii_c, 164_308_a_5_ii_d | CIS-3.0: 1.12 | MITRE-ATTACK: T1078, T1550, T1110 | KISA-ISMS-P-2023-korean: 2.5.3, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-iam, ksi-iam-07;identity-access;;;;5.18.1;https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_finding-unused.html | https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_user_console_access_unused-132410971304-ap-northeast-2-github-actions-prowler;aws;iam_user_console_access_unused;IAM user console access is disabled, used within the configured inactivity period, or never used;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | TTPs/Initial Access;PASS;User github-actions-prowler does not have console access enabled or is unused.;False;iam;;medium;AwsIamUser;arn:aws:iam::132410971304:user/github-actions-prowler;github-actions-prowler;;;aws;ap-northeast-2;"**IAM users** with console access are evaluated by `password_last_used`. Inactivity beyond `max_console_access_days` (default `45`) marks **stale console access**.

*Users without console access are excluded*.";**Dormant console credentials** stay valid and invite **password spraying**, **credential stuffing**, and breach reuse. Compromise yields interactive access for data discovery/exfiltration and unauthorized IAM or resource changes, degrading **confidentiality** and **integrity**, and risking **availability**.;;Remove or disable console passwords for users inactive beyond your window (e.g., `45` days). Prefer roles or federation over long-lived IAM users. Enforce **least privilege**, require **MFA** for remaining console users, and run periodic reviews and deprovisioning to prevent unused credentials.;https://hub.prowler.com/check/iam_user_console_access_unused;"```yaml
# CloudFormation: IAM user without console access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::User
    Properties:
      UserName: <example_resource_name>
      # Critical: No LoginProfile property -> disables console access for the user
```";"```hcl
# IAM user with console access disabled by not creating a login profile
resource ""aws_iam_user"" ""<example_resource_name>"" {
  name = ""<example_resource_name>""
  # Critical: Do not define aws_iam_user_login_profile for this user -> no console access
}
```";aws iam delete-login-profile --user-name <USER_NAME>;"1. Open the IAM console and go to Users
2. Select the user
3. Open the Security credentials tab
4. Click Manage console access
5. Select Disable console access and Save";ISO27001-2022: A.5.15 | PCI-3.2.1: 8.1, 8.1.4 | CIS-1.5: 1.12 | NIS2: 11.3.2.d, 11.5.4 | NIST-800-171-Revision-2: 3_1_1, 3_1_2, 3_1_4, 3_1_5, 3_5_6, 3_5_7, 3_5_8 | NIST-800-53-Revision-4: ac_2_1, ac_2_3, ac_2, ac_3, ac_6 | NIST-CSF-2.0: ac_1 | CISA: your-systems-3 | CIS-5.0: 1.11 | GxP-21-CFR-Part-11: 11.10-d, 11.10-g, 11.300-b | NIST-800-53-Revision-5: ac_2_1, ac_2_3_a, ac_2_3_b, ac_2_3_c, ac_2_3_d, ac_2_3, ac_2_6, ac_2_g, ac_2_j, ac_3, ac_3_3, ac_3_3_a, ac_3_3_b_1, ac_3_3_b_2, ac_3_3_b_3, ac_3_3_b_4, ac_3_3_b_5, ac_3_3_c, ac_3_4, ac_3_4_a, ac_3_4_b, ac_3_4_c, ac_3_4_d, ac_3_4_e, ac_3_7, ac_3_8, ac_3_12_a, ac_3_13, ac_3_15_a, ac_3_15_b, ac_4_28, ac_6, ac_24, cm_5_1_a, cm_6_a, cm_9_b, mp_2, sc_23_3 | GDPR: article_25 | ProwlerThreatScore-1.0: 1.1.10 | KISA-ISMS-P-2023: 2.5.3, 2.10.2 | FedRamp-Moderate-Revision-4: ac-2-1, ac-2-f, ac-2-j, ac-2-3, ac-3, ac-5-c, ac-6 | CIS-1.4: 1.12 | C5-2025: OPS-05.02AC, IAM-03.02B, IAM-03.03B, IAM-03.01AS, IAM-05.04B, IAM-10.01B | FedRAMP-Low-Revision-4: ac-2, ac-3 | FFIEC: d3-pc-am-b-6 | ENS-RD2022: op.acc.6.aws.iam.2, op.acc.6.aws.iam.3, op.acc.6.r7.aws.iam.1 | SOC2: cc_1_3 | NIST-CSF-1.1: ac_1, ac_4 | ISO27001-2013: A.9.2.M, A.9.3.J, A.9.4.M | CIS-4.0.1: 1.12 | AWS-Foundational-Security-Best-Practices: IAM.8, IAM.22, IAM.26 | CIS-2.0: 1.12 | HIPAA: 164_308_a_3_ii_b, 164_308_a_4_ii_c, 164_308_a_5_ii_d | CIS-3.0: 1.12 | MITRE-ATTACK: T1078, T1550, T1110 | KISA-ISMS-P-2023-korean: 2.5.3, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-iam, ksi-iam-07;identity-access;;;;5.18.1;https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_finding-unused.html | https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-iam_user_console_access_unused-132410971304-ap-northeast-2-prowler;aws;iam_user_console_access_unused;IAM user console access is disabled, used within the configured inactivity period, or never used;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | TTPs/Initial Access;PASS;User prowler does not have console access enabled or is unused.;False;iam;;medium;AwsIamUser;arn:aws:iam::132410971304:user/prowler;prowler;;AKIAR5VCPCSUIUARFAPC=test;aws;ap-northeast-2;"**IAM users** with console access are evaluated by `password_last_used`. Inactivity beyond `max_console_access_days` (default `45`) marks **stale console access**.

*Users without console access are excluded*.";**Dormant console credentials** stay valid and invite **password spraying**, **credential stuffing**, and breach reuse. Compromise yields interactive access for data discovery/exfiltration and unauthorized IAM or resource changes, degrading **confidentiality** and **integrity**, and risking **availability**.;;Remove or disable console passwords for users inactive beyond your window (e.g., `45` days). Prefer roles or federation over long-lived IAM users. Enforce **least privilege**, require **MFA** for remaining console users, and run periodic reviews and deprovisioning to prevent unused credentials.;https://hub.prowler.com/check/iam_user_console_access_unused;"```yaml
# CloudFormation: IAM user without console access
Resources:
  <example_resource_name>:
    Type: AWS::IAM::User
    Properties:
      UserName: <example_resource_name>
      # Critical: No LoginProfile property -> disables console access for the user
```";"```hcl
# IAM user with console access disabled by not creating a login profile
resource ""aws_iam_user"" ""<example_resource_name>"" {
  name = ""<example_resource_name>""
  # Critical: Do not define aws_iam_user_login_profile for this user -> no console access
}
```";aws iam delete-login-profile --user-name <USER_NAME>;"1. Open the IAM console and go to Users
2. Select the user
3. Open the Security credentials tab
4. Click Manage console access
5. Select Disable console access and Save";ISO27001-2022: A.5.15 | PCI-3.2.1: 8.1, 8.1.4 | CIS-1.5: 1.12 | NIS2: 11.3.2.d, 11.5.4 | NIST-800-171-Revision-2: 3_1_1, 3_1_2, 3_1_4, 3_1_5, 3_5_6, 3_5_7, 3_5_8 | NIST-800-53-Revision-4: ac_2_1, ac_2_3, ac_2, ac_3, ac_6 | NIST-CSF-2.0: ac_1 | CISA: your-systems-3 | CIS-5.0: 1.11 | GxP-21-CFR-Part-11: 11.10-d, 11.10-g, 11.300-b | NIST-800-53-Revision-5: ac_2_1, ac_2_3_a, ac_2_3_b, ac_2_3_c, ac_2_3_d, ac_2_3, ac_2_6, ac_2_g, ac_2_j, ac_3, ac_3_3, ac_3_3_a, ac_3_3_b_1, ac_3_3_b_2, ac_3_3_b_3, ac_3_3_b_4, ac_3_3_b_5, ac_3_3_c, ac_3_4, ac_3_4_a, ac_3_4_b, ac_3_4_c, ac_3_4_d, ac_3_4_e, ac_3_7, ac_3_8, ac_3_12_a, ac_3_13, ac_3_15_a, ac_3_15_b, ac_4_28, ac_6, ac_24, cm_5_1_a, cm_6_a, cm_9_b, mp_2, sc_23_3 | GDPR: article_25 | ProwlerThreatScore-1.0: 1.1.10 | KISA-ISMS-P-2023: 2.5.3, 2.10.2 | FedRamp-Moderate-Revision-4: ac-2-1, ac-2-f, ac-2-j, ac-2-3, ac-3, ac-5-c, ac-6 | CIS-1.4: 1.12 | C5-2025: OPS-05.02AC, IAM-03.02B, IAM-03.03B, IAM-03.01AS, IAM-05.04B, IAM-10.01B | FedRAMP-Low-Revision-4: ac-2, ac-3 | FFIEC: d3-pc-am-b-6 | ENS-RD2022: op.acc.6.aws.iam.2, op.acc.6.aws.iam.3, op.acc.6.r7.aws.iam.1 | SOC2: cc_1_3 | NIST-CSF-1.1: ac_1, ac_4 | ISO27001-2013: A.9.2.M, A.9.3.J, A.9.4.M | CIS-4.0.1: 1.12 | AWS-Foundational-Security-Best-Practices: IAM.8, IAM.22, IAM.26 | CIS-2.0: 1.12 | HIPAA: 164_308_a_3_ii_b, 164_308_a_4_ii_c, 164_308_a_5_ii_d | CIS-3.0: 1.12 | MITRE-ATTACK: T1078, T1550, T1110 | KISA-ISMS-P-2023-korean: 2.5.3, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-iam, ksi-iam-07;identity-access;;;;5.18.1;https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_finding-unused.html | https://docs.aws.amazon.com/securityhub/latest/userguide/iam-controls.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-kms_cmk_not_multi_region-132410971304-ap-northeast-2-257ddf3b-bb72-4f49-a185-6227d0d9b5d4;aws;kms_cmk_not_multi_region;AWS KMS customer managed key is single-Region;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices;PASS;KMS CMK 257ddf3b-bb72-4f49-a185-6227d0d9b5d4 is a single-region key.;False;kms;;medium;AwsKmsKey;arn:aws:kms:ap-northeast-2:132410971304:key/257ddf3b-bb72-4f49-a185-6227d0d9b5d4;257ddf3b-bb72-4f49-a185-6227d0d9b5d4;;;aws;ap-northeast-2;**AWS KMS customer-managed keys** in an `Enabled` state are assessed for the `multi-Region` setting. The finding highlights keys with the `multi-Region` property enabled.;Shared key material across Regions lets access in one Region decrypt data from another, eroding **confidentiality** and **data residency**. A misconfigured policy or weaker controls in a replica expand the blast radius. For signing/HMAC keys, compromise enables cross-Region signature forgery, impacting **integrity** and **auditability**.;;"Prefer **single-Region keys** by default; use **multi-Region** only with a documented need. Apply **least privilege** and **separation of duties**; limit who can create or replicate such keys. Isolate per Region/tenant/workload, standardize policy and logging across Regions, and retire multi-Region keys where unnecessary.";https://hub.prowler.com/check/kms_cmk_not_multi_region;"```yaml
# CloudFormation: create a single-Region KMS key
Resources:
  ExampleKmsKey:
    Type: AWS::KMS::Key
    Properties:
      MultiRegion: false  # Critical: ensures the key is single-Region to pass the check
      KeyPolicy:          # Minimal policy required for key creation
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Principal:
              AWS: !Sub arn:aws:iam::${AWS::AccountId}:root
            Action: 'kms:*'
            Resource: '*'
```";"```hcl
# Terraform: create a single-Region KMS key
resource ""aws_kms_key"" ""example"" {
  multi_region = false  # Critical: creates a single-Region key to pass the check
}
```";;"1. In the AWS Console, go to Key Management Service (KMS) > Customer managed keys
2. Identify keys showing Multi-Region: Yes (these FAIL the check)
3. Click Create key and ensure Multi-Region is not selected (single-Region)
4. Update your services/aliases to use the new single-Region key
5. Re-encrypt or rotate data to the new key where required
6. After migration, disable the old multi-Region key and schedule its deletion";ISO27001-2022: A.8.11, A.8.24 | NIST-CSF-2.0: ra_1 | C5-2025: OIS-08.02B, PS-02.01B, PS-02.01AS, PS-02.02AS, CRY-03.01B, CRY-05.02B, CRY-10.01B, CRY-19.01B, PSS-12.02AC | CCC: CCC.KeyMgmt.CN02.AR01, CCC.KeyMgmt.CN04.AR01, CCC.ObjStor.CN01.AR04, CCC.Core.CN11.AR01, CCC.Core.CN11.AR02, CCC.Core.CN11.AR03, CCC.Core.CN11.AR04, CCC.Core.CN11.AR05;encryption;;;Multi-region keys should be used only when absolutely necessary, such as for cross-region disaster recovery, and should be carefully managed with strict access controls.;5.18.1;https://docs.aws.amazon.com/kms/latest/developerguide/multi-region-keys-overview.html#multi-region-concepts | https://docs.aws.amazon.com/kms/latest/developerguide/mrk-when-to-use.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-kms_cmk_not_multi_region-132410971304-ap-northeast-2-3eede833-ecd4-497c-a028-1f8a3239c3cf;aws;kms_cmk_not_multi_region;AWS KMS customer managed key is single-Region;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices;PASS;KMS CMK 3eede833-ecd4-497c-a028-1f8a3239c3cf is a single-region key.;False;kms;;medium;AwsKmsKey;arn:aws:kms:ap-northeast-2:132410971304:key/3eede833-ecd4-497c-a028-1f8a3239c3cf;3eede833-ecd4-497c-a028-1f8a3239c3cf;;;aws;ap-northeast-2;**AWS KMS customer-managed keys** in an `Enabled` state are assessed for the `multi-Region` setting. The finding highlights keys with the `multi-Region` property enabled.;Shared key material across Regions lets access in one Region decrypt data from another, eroding **confidentiality** and **data residency**. A misconfigured policy or weaker controls in a replica expand the blast radius. For signing/HMAC keys, compromise enables cross-Region signature forgery, impacting **integrity** and **auditability**.;;"Prefer **single-Region keys** by default; use **multi-Region** only with a documented need. Apply **least privilege** and **separation of duties**; limit who can create or replicate such keys. Isolate per Region/tenant/workload, standardize policy and logging across Regions, and retire multi-Region keys where unnecessary.";https://hub.prowler.com/check/kms_cmk_not_multi_region;"```yaml
# CloudFormation: create a single-Region KMS key
Resources:
  ExampleKmsKey:
    Type: AWS::KMS::Key
    Properties:
      MultiRegion: false  # Critical: ensures the key is single-Region to pass the check
      KeyPolicy:          # Minimal policy required for key creation
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Principal:
              AWS: !Sub arn:aws:iam::${AWS::AccountId}:root
            Action: 'kms:*'
            Resource: '*'
```";"```hcl
# Terraform: create a single-Region KMS key
resource ""aws_kms_key"" ""example"" {
  multi_region = false  # Critical: creates a single-Region key to pass the check
}
```";;"1. In the AWS Console, go to Key Management Service (KMS) > Customer managed keys
2. Identify keys showing Multi-Region: Yes (these FAIL the check)
3. Click Create key and ensure Multi-Region is not selected (single-Region)
4. Update your services/aliases to use the new single-Region key
5. Re-encrypt or rotate data to the new key where required
6. After migration, disable the old multi-Region key and schedule its deletion";ISO27001-2022: A.8.11, A.8.24 | NIST-CSF-2.0: ra_1 | C5-2025: OIS-08.02B, PS-02.01B, PS-02.01AS, PS-02.02AS, CRY-03.01B, CRY-05.02B, CRY-10.01B, CRY-19.01B, PSS-12.02AC | CCC: CCC.KeyMgmt.CN02.AR01, CCC.KeyMgmt.CN04.AR01, CCC.ObjStor.CN01.AR04, CCC.Core.CN11.AR01, CCC.Core.CN11.AR02, CCC.Core.CN11.AR03, CCC.Core.CN11.AR04, CCC.Core.CN11.AR05;encryption;;;Multi-region keys should be used only when absolutely necessary, such as for cross-region disaster recovery, and should be carefully managed with strict access controls.;5.18.1;https://docs.aws.amazon.com/kms/latest/developerguide/multi-region-keys-overview.html#multi-region-concepts | https://docs.aws.amazon.com/kms/latest/developerguide/mrk-when-to-use.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-kms_cmk_not_multi_region-132410971304-ap-northeast-2-47b613e5-1c8c-4b48-9845-97d471d84a0b;aws;kms_cmk_not_multi_region;AWS KMS customer managed key is single-Region;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices;PASS;KMS CMK 47b613e5-1c8c-4b48-9845-97d471d84a0b is a single-region key.;False;kms;;medium;AwsKmsKey;arn:aws:kms:ap-northeast-2:132410971304:key/47b613e5-1c8c-4b48-9845-97d471d84a0b;47b613e5-1c8c-4b48-9845-97d471d84a0b;;;aws;ap-northeast-2;**AWS KMS customer-managed keys** in an `Enabled` state are assessed for the `multi-Region` setting. The finding highlights keys with the `multi-Region` property enabled.;Shared key material across Regions lets access in one Region decrypt data from another, eroding **confidentiality** and **data residency**. A misconfigured policy or weaker controls in a replica expand the blast radius. For signing/HMAC keys, compromise enables cross-Region signature forgery, impacting **integrity** and **auditability**.;;"Prefer **single-Region keys** by default; use **multi-Region** only with a documented need. Apply **least privilege** and **separation of duties**; limit who can create or replicate such keys. Isolate per Region/tenant/workload, standardize policy and logging across Regions, and retire multi-Region keys where unnecessary.";https://hub.prowler.com/check/kms_cmk_not_multi_region;"```yaml
# CloudFormation: create a single-Region KMS key
Resources:
  ExampleKmsKey:
    Type: AWS::KMS::Key
    Properties:
      MultiRegion: false  # Critical: ensures the key is single-Region to pass the check
      KeyPolicy:          # Minimal policy required for key creation
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Principal:
              AWS: !Sub arn:aws:iam::${AWS::AccountId}:root
            Action: 'kms:*'
            Resource: '*'
```";"```hcl
# Terraform: create a single-Region KMS key
resource ""aws_kms_key"" ""example"" {
  multi_region = false  # Critical: creates a single-Region key to pass the check
}
```";;"1. In the AWS Console, go to Key Management Service (KMS) > Customer managed keys
2. Identify keys showing Multi-Region: Yes (these FAIL the check)
3. Click Create key and ensure Multi-Region is not selected (single-Region)
4. Update your services/aliases to use the new single-Region key
5. Re-encrypt or rotate data to the new key where required
6. After migration, disable the old multi-Region key and schedule its deletion";ISO27001-2022: A.8.11, A.8.24 | NIST-CSF-2.0: ra_1 | C5-2025: OIS-08.02B, PS-02.01B, PS-02.01AS, PS-02.02AS, CRY-03.01B, CRY-05.02B, CRY-10.01B, CRY-19.01B, PSS-12.02AC | CCC: CCC.KeyMgmt.CN02.AR01, CCC.KeyMgmt.CN04.AR01, CCC.ObjStor.CN01.AR04, CCC.Core.CN11.AR01, CCC.Core.CN11.AR02, CCC.Core.CN11.AR03, CCC.Core.CN11.AR04, CCC.Core.CN11.AR05;encryption;;;Multi-region keys should be used only when absolutely necessary, such as for cross-region disaster recovery, and should be carefully managed with strict access controls.;5.18.1;https://docs.aws.amazon.com/kms/latest/developerguide/multi-region-keys-overview.html#multi-region-concepts | https://docs.aws.amazon.com/kms/latest/developerguide/mrk-when-to-use.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-kms_cmk_not_multi_region-132410971304-ap-northeast-2-6b78469b-b7e8-408d-b53d-32c8b14a2d9a;aws;kms_cmk_not_multi_region;AWS KMS customer managed key is single-Region;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices;PASS;KMS CMK 6b78469b-b7e8-408d-b53d-32c8b14a2d9a is a single-region key.;False;kms;;medium;AwsKmsKey;arn:aws:kms:ap-northeast-2:132410971304:key/6b78469b-b7e8-408d-b53d-32c8b14a2d9a;6b78469b-b7e8-408d-b53d-32c8b14a2d9a;;;aws;ap-northeast-2;**AWS KMS customer-managed keys** in an `Enabled` state are assessed for the `multi-Region` setting. The finding highlights keys with the `multi-Region` property enabled.;Shared key material across Regions lets access in one Region decrypt data from another, eroding **confidentiality** and **data residency**. A misconfigured policy or weaker controls in a replica expand the blast radius. For signing/HMAC keys, compromise enables cross-Region signature forgery, impacting **integrity** and **auditability**.;;"Prefer **single-Region keys** by default; use **multi-Region** only with a documented need. Apply **least privilege** and **separation of duties**; limit who can create or replicate such keys. Isolate per Region/tenant/workload, standardize policy and logging across Regions, and retire multi-Region keys where unnecessary.";https://hub.prowler.com/check/kms_cmk_not_multi_region;"```yaml
# CloudFormation: create a single-Region KMS key
Resources:
  ExampleKmsKey:
    Type: AWS::KMS::Key
    Properties:
      MultiRegion: false  # Critical: ensures the key is single-Region to pass the check
      KeyPolicy:          # Minimal policy required for key creation
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Principal:
              AWS: !Sub arn:aws:iam::${AWS::AccountId}:root
            Action: 'kms:*'
            Resource: '*'
```";"```hcl
# Terraform: create a single-Region KMS key
resource ""aws_kms_key"" ""example"" {
  multi_region = false  # Critical: creates a single-Region key to pass the check
}
```";;"1. In the AWS Console, go to Key Management Service (KMS) > Customer managed keys
2. Identify keys showing Multi-Region: Yes (these FAIL the check)
3. Click Create key and ensure Multi-Region is not selected (single-Region)
4. Update your services/aliases to use the new single-Region key
5. Re-encrypt or rotate data to the new key where required
6. After migration, disable the old multi-Region key and schedule its deletion";ISO27001-2022: A.8.11, A.8.24 | NIST-CSF-2.0: ra_1 | C5-2025: OIS-08.02B, PS-02.01B, PS-02.01AS, PS-02.02AS, CRY-03.01B, CRY-05.02B, CRY-10.01B, CRY-19.01B, PSS-12.02AC | CCC: CCC.KeyMgmt.CN02.AR01, CCC.KeyMgmt.CN04.AR01, CCC.ObjStor.CN01.AR04, CCC.Core.CN11.AR01, CCC.Core.CN11.AR02, CCC.Core.CN11.AR03, CCC.Core.CN11.AR04, CCC.Core.CN11.AR05;encryption;;;Multi-region keys should be used only when absolutely necessary, such as for cross-region disaster recovery, and should be carefully managed with strict access controls.;5.18.1;https://docs.aws.amazon.com/kms/latest/developerguide/multi-region-keys-overview.html#multi-region-concepts | https://docs.aws.amazon.com/kms/latest/developerguide/mrk-when-to-use.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-kms_cmk_not_multi_region-132410971304-ap-northeast-2-acf8da0a-9167-44bc-9373-b769fda7443b;aws;kms_cmk_not_multi_region;AWS KMS customer managed key is single-Region;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices;PASS;KMS CMK acf8da0a-9167-44bc-9373-b769fda7443b is a single-region key.;False;kms;;medium;AwsKmsKey;arn:aws:kms:ap-northeast-2:132410971304:key/acf8da0a-9167-44bc-9373-b769fda7443b;acf8da0a-9167-44bc-9373-b769fda7443b;;;aws;ap-northeast-2;**AWS KMS customer-managed keys** in an `Enabled` state are assessed for the `multi-Region` setting. The finding highlights keys with the `multi-Region` property enabled.;Shared key material across Regions lets access in one Region decrypt data from another, eroding **confidentiality** and **data residency**. A misconfigured policy or weaker controls in a replica expand the blast radius. For signing/HMAC keys, compromise enables cross-Region signature forgery, impacting **integrity** and **auditability**.;;"Prefer **single-Region keys** by default; use **multi-Region** only with a documented need. Apply **least privilege** and **separation of duties**; limit who can create or replicate such keys. Isolate per Region/tenant/workload, standardize policy and logging across Regions, and retire multi-Region keys where unnecessary.";https://hub.prowler.com/check/kms_cmk_not_multi_region;"```yaml
# CloudFormation: create a single-Region KMS key
Resources:
  ExampleKmsKey:
    Type: AWS::KMS::Key
    Properties:
      MultiRegion: false  # Critical: ensures the key is single-Region to pass the check
      KeyPolicy:          # Minimal policy required for key creation
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Principal:
              AWS: !Sub arn:aws:iam::${AWS::AccountId}:root
            Action: 'kms:*'
            Resource: '*'
```";"```hcl
# Terraform: create a single-Region KMS key
resource ""aws_kms_key"" ""example"" {
  multi_region = false  # Critical: creates a single-Region key to pass the check
}
```";;"1. In the AWS Console, go to Key Management Service (KMS) > Customer managed keys
2. Identify keys showing Multi-Region: Yes (these FAIL the check)
3. Click Create key and ensure Multi-Region is not selected (single-Region)
4. Update your services/aliases to use the new single-Region key
5. Re-encrypt or rotate data to the new key where required
6. After migration, disable the old multi-Region key and schedule its deletion";ISO27001-2022: A.8.11, A.8.24 | NIST-CSF-2.0: ra_1 | C5-2025: OIS-08.02B, PS-02.01B, PS-02.01AS, PS-02.02AS, CRY-03.01B, CRY-05.02B, CRY-10.01B, CRY-19.01B, PSS-12.02AC | CCC: CCC.KeyMgmt.CN02.AR01, CCC.KeyMgmt.CN04.AR01, CCC.ObjStor.CN01.AR04, CCC.Core.CN11.AR01, CCC.Core.CN11.AR02, CCC.Core.CN11.AR03, CCC.Core.CN11.AR04, CCC.Core.CN11.AR05;encryption;;;Multi-region keys should be used only when absolutely necessary, such as for cross-region disaster recovery, and should be carefully managed with strict access controls.;5.18.1;https://docs.aws.amazon.com/kms/latest/developerguide/multi-region-keys-overview.html#multi-region-concepts | https://docs.aws.amazon.com/kms/latest/developerguide/mrk-when-to-use.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-networkfirewall_in_all_vpc-132410971304-ap-northeast-2-vpc-0565167ce4f7cc871;aws;networkfirewall_in_all_vpc;VPC has Network Firewall enabled;Software and Configuration Checks/AWS Security Best Practices/Network Reachability | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices;FAIL;VPC vpc-0565167ce4f7cc871 does not have Network Firewall enabled.;False;networkfirewall;;medium;AwsEc2Vpc;arn:aws:ec2:ap-northeast-2:132410971304:vpc/vpc-0565167ce4f7cc871;vpc-0565167ce4f7cc871;;;aws;ap-northeast-2;"**VPCs** with an **AWS Network Firewall** associated to the same VPC to inspect and filter network traffic.

Identifies VPCs that do not have a Network Firewall resource linked to them.";"Without a **Network Firewall**, VPC traffic can bypass deep inspection and centralized policy enforcement, enabling **data exfiltration**, **command-and-control**, and **lateral movement**. Confidentiality is reduced by unmonitored flows; integrity and availability are threatened by malware and disruptive traffic.";;"Deploy **AWS Network Firewall** in each VPC or centralize inspection through a dedicated hub VPC.

Adopt a `default-deny` posture with least-privilege rules, restrict egress to required destinations, segment workloads (**defense in depth**, **zero trust**), and enable logging to monitor and tune network policies.";https://hub.prowler.com/check/networkfirewall_in_all_vpc;"```yaml
# CloudFormation: Create a Network Firewall in the VPC
Resources:
  <example_resource_name>:
    Type: AWS::NetworkFirewall::Firewall
    Properties:
      FirewallName: <example_resource_name>
      FirewallPolicyArn: <example_resource_id>  # Critical: required policy for the firewall
      VpcId: <example_resource_id>              # Critical: associates the firewall to the target VPC (fixes the check)
      SubnetMappings:                           # Critical: creates firewall endpoints in the VPC
        - SubnetId: <example_resource_id>
```";"```hcl
# Create a Network Firewall in the VPC
resource ""aws_networkfirewall_firewall"" ""<example_resource_name>"" {
  name                = ""<example_resource_name>""
  firewall_policy_arn = ""<example_resource_id>""  # Critical: required policy
  vpc_id              = ""<example_resource_id>""  # Critical: associates firewall to the VPC (fixes the check)

  subnet_mapping {                                # Critical: creates firewall endpoint in the VPC
    subnet_id = ""<example_resource_id>""
  }
}
```";"aws network-firewall create-firewall --firewall-name <example_resource_name> --firewall-policy-arn <example_resource_id> --vpc-id <example_resource_id> --subnet-mappings ""SubnetId=<example_resource_id>""";"1. In the AWS Console, go to Network Firewall > Firewalls > Create firewall
2. Enter a name and select the target VPC
3. Select an existing Firewall policy (or create one when prompted)
4. Add at least one subnet from the VPC under Subnet mappings
5. Choose Create firewall
6. Verify the firewall shows under the selected VPC";ISO27001-2022: A.8.20, A.8.21, A.8.22 | NIS2: 6.2.1, 6.7.2.b | KISA-ISMS-P-2023: 2.10.1, 2.10.2 | C5-2025: AM-12.01AC, COS-07.04B, PI-01.01AC | ENS-RD2022: mp.com.1.aws.nfw.1 | MITRE-ATTACK: T1048, T1530, T1499, T1498, T1046 | KISA-ISMS-P-2023-korean: 2.10.1, 2.10.2;trust-boundaries;;;;5.18.1;https://docs.aws.amazon.com/network-firewall/latest/developerguide/vpc-config.html | https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/NetworkFirewall/network-firewall-in-use.html | https://docs.aws.amazon.com/network-firewall/latest/developerguide/setting-up.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-organizations_account_part_of_organizations-132410971304-ap-northeast-2-unknown;aws;organizations_account_part_of_organizations;AWS account is a member of an active AWS Organization;Software and Configuration Checks/AWS Security Best Practices;FAIL;AWS Organizations is not in-use for this AWS Account.;False;organizations;;medium;Other;arn:aws:organizations::132410971304:unknown;unknown;;;aws;ap-northeast-2;"**AWS account** membership in **AWS Organizations** with organization status `ACTIVE`.

Assesses if the account is associated with an organization and that the organization state is `ACTIVE`.";Absence of **AWS Organizations** weakens governance across accounts. Without **SCP guardrails** and centralized policy, excessive permissions, unsafe network settings, or risky services may be enabled, threatening **confidentiality** and **integrity**. Fragmented logging and response slow containment, impacting **availability** and increasing cost exposure.;;Operate all accounts under **AWS Organizations** (preferably with *all features*). Structure OUs, enforce **SCPs** for least privilege, and apply separation of duties between management and member accounts. Centralize logging and billing to support defense-in-depth, and routinely review org membership and policies.;https://hub.prowler.com/check/organizations_account_part_of_organizations;;"```hcl
# Creates an AWS Organization so this account becomes a member (status ACTIVE)
resource ""aws_organizations_organization"" ""<example_resource_name>"" {
  # Critical: creating this resource makes the account part of an active AWS Organization
}
```";aws organizations create-organization;"1. Sign in to the AWS Management Console with the account to remediate
2. Open the AWS Organizations console
3. Click ""Create an organization""
4. Confirm to create (default is All features)
5. Verify the organization status shows Active on the Settings page";AWS-Well-Architected-Framework-Security-Pillar: SEC01-BP01, SEC03-BP05, SEC08-BP04 | ISO27001-2022: A.8.3 | NIST-CSF-2.0: rm_1, rr_1, rr_2, po_3, po_4, am_6 | KISA-ISMS-P-2023: 2.10.2 | ENS-RD2022: op.acc.4.aws.iam.1, op.acc.4.aws.iam.8 | RBI-Cyber-Security-Framework: annex_i_1_1 | MITRE-ATTACK: T1078, T1087, T1580, T1538 | PCI-4.0: 7.2.1.1, 7.2.2.1, 7.2.5.1, 7.3.1.1, 7.3.2.1, 7.3.3.1, 8.2.7.1, 8.2.8.1, 8.3.4.1 | KISA-ISMS-P-2023-korean: 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-piy;identity-access;;;;5.18.1;https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_org_create.html | https://docs.aws.amazon.com/organizations/latest/userguide/orgs_view_org.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-organizations_opt_out_ai_services_policy-132410971304-ap-northeast-2-unknown;aws;organizations_opt_out_ai_services_policy;AWS Organization has opted out of all AI services and child accounts cannot override the policy;Software and Configuration Checks/AWS Security Best Practices | Effects/Data Exposure;FAIL;AWS Organizations is not in-use for this AWS Account.;False;organizations;;medium;Other;arn:aws:organizations::132410971304:unknown;unknown;;;aws;ap-northeast-2;**AWS Organizations** is assessed for an AI services opt-out policy that sets `services.default.opt_out_policy` to `optOut` and blocks child overrides via `@@operators_allowed_for_child_policies` set to `@@none`.;Without an enforced opt-out, AI services may store and use your content for model training, weakening **confidentiality** and **data sovereignty**. If child accounts can override, they can re-enable data use, risking unintended cross-Region retention and exposure of logs, documents, or code processed by these services.;;Establish an org-wide AI services opt-out: set the default to `optOut` and prohibit child policy overrides (`@@none`). Apply at the highest scope, gate exceptions through change control, and review periodically. Align with **least privilege** and **data minimization** to prevent unintended content sharing with managed AI services.;https://hub.prowler.com/check/organizations_opt_out_ai_services_policy;"```yaml
# CloudFormation: Opt out of all AI services and prevent child overrides
Resources:
  AiServicesOptOutPolicy:
    Type: AWS::Organizations::Policy
    Properties:
      Name: <example_resource_name>
      Type: AISERVICES_OPT_OUT_POLICY
      Content: |
        { ""services"": { ""default"": { ""opt_out_policy"": { ""@@assign"": ""optOut"", ""@@operators_allowed_for_child_policies"": [""@@none""] } } } }
        # Critical: @@assign ""optOut"" opts out org-wide; @@operators... [""@@none""] blocks child overrides
      TargetIds:
        - <example_resource_id> # Critical: attach to the organization root (e.g., r-xxxx)
```";"```hcl
# Enable AI services opt-out policy type
resource ""aws_organizations_organization"" ""<example_resource_name>"" {
  enabled_policy_types = [""AISERVICES_OPT_OUT_POLICY""]  # Critical: allow AI opt-out policies
}

# Create the AI opt-out policy
resource ""aws_organizations_policy"" ""<example_resource_name>"" {
  name    = ""<example_resource_name>""
  type    = ""AISERVICES_OPT_OUT_POLICY""
  content = <<JSON
{ ""services"": { ""default"": { ""opt_out_policy"": { ""@@assign"": ""optOut"", ""@@operators_allowed_for_child_policies"": [""@@none""] } } } }
JSON
  # Critical: @@assign ""optOut"" opts out; @@operators... [""@@none""] prevents child overrides
}

# Attach policy to the org root
resource ""aws_organizations_policy_attachment"" ""<example_resource_name>"" {
  policy_id = aws_organizations_policy.<example_resource_name>.id
  target_id = aws_organizations_organization.<example_resource_name>.roots[0].id  # Critical: attach to root
}
```";;"1. In the AWS Management Console, open AWS Organizations using the management account
2. Go to Policies > AI services opt-out
3. Click Opt out from all services and confirm
4. Verify the policy is attached to the Root and shows default -> opt_out_policy -> @@assign: optOut with @@operators_allowed_for_child_policies set to [""@@none""]";NIST-CSF-2.0: rm_1, rr_1, rr_2, po_3 | KISA-ISMS-P-2023: 2.10.2 | KISA-ISMS-P-2023-korean: 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-iam;gen-ai;;;;5.18.1;https://docs.aws.amazon.com/organizations/latest/userguide/disable-policy-type.html | https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_ai-opt-out_all.html | https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_ai-opt-out_syntax.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_acl_prohibited-132410971304-ap-northeast-2-aws-cloudtrail-logs-132410971304-0971c04b;aws;s3_bucket_acl_prohibited;S3 bucket has bucket ACLs disabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;FAIL;S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b has bucket ACLs enabled.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b;aws-cloudtrail-logs-132410971304-0971c04b;;;aws;ap-northeast-2;**Amazon S3 buckets** are evaluated for **Object Ownership** set to `BucketOwnerEnforced`, which disables bucket and object ACLs. Buckets using any other ownership setting indicate that ACLs remain enabled.;"With **ACLs enabled**, access can bypass centralized policy controls, impacting confidentiality and integrity.
- Unintended public or cross-account reads/writes
- Object-writer ownership blocking bucket-owner governance
- Per-object grants hinder auditing, enabling data exfiltration or tampering";;Disable ACLs by setting **Object Ownership** to `BucketOwnerEnforced` and manage access with **IAM** and **bucket policies** under **least privilege**. Centralize authorization, review policies regularly, and use organizational guardrails to prevent re-enabling ACLs. *Migrate ACL-based grants into policies before the change.*;https://hub.prowler.com/check/s3_bucket_acl_prohibited;"```yaml
# CloudFormation: Disable ACLs by enforcing bucket owner for all objects
Resources:
  <example_resource_name>OwnershipControls:
    Type: AWS::S3::BucketOwnershipControls
    Properties:
      Bucket: <example_resource_name>
      OwnershipControls:
        Rules:
          - ObjectOwnership: BucketOwnerEnforced  # Critical: Disables ACLs and makes bucket owner the object owner
```";"```hcl
# Disable ACLs by enforcing bucket owner for all objects
resource ""aws_s3_bucket_ownership_controls"" ""<example_resource_name>"" {
  bucket = ""<example_resource_id>""
  rule {
    object_ownership = ""BucketOwnerEnforced"" # Critical: Disables ACLs and enforces bucket owner
  }
}
```";"aws s3api put-bucket-ownership-controls --bucket <bucket-name> --ownership-controls ""Rules=[{ObjectOwnership=BucketOwnerEnforced}]""";"1. In the AWS Console, go to S3 > Buckets and select the target bucket
2. Open the Permissions tab
3. In Object Ownership, click Edit
4. Select Bucket owner enforced (ACLs disabled)
5. Click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC05-BP02 | AWS-Foundational-Technical-Review: S3-001 | NIST-CSF-2.0: ds_5 | CISA: your-data-2 | KISA-ISMS-P-2023: 2.6.2, 2.10.2 | AWS-Foundational-Security-Best-Practices: S3.12 | CCC: CCC.ObjStor.CN02.AR02 | PCI-4.0: 7.2.1.24, 7.2.2.24, 7.2.5.18, 7.3.1.18, 7.3.2.18, 7.3.3.18, 8.2.7.18, 8.2.8.20, 8.3.4.18 | KISA-ISMS-P-2023-korean: 2.6.2, 2.10.2;identity-access;;;;5.18.1;https://docs.aws.amazon.com/AmazonS3/latest/userguide/about-object-ownership.html | https://docs.aws.amazon.com/AmazonS3/latest/userguide/ensure-object-ownership.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_acl_prohibited-132410971304-ap-northeast-2-aws-cloudtrail-logs-132410971304-0971c04b-logs;aws;s3_bucket_acl_prohibited;S3 bucket has bucket ACLs disabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;PASS;S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b-logs has bucket ACLs disabled.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b-logs;aws-cloudtrail-logs-132410971304-0971c04b-logs;;;aws;ap-northeast-2;**Amazon S3 buckets** are evaluated for **Object Ownership** set to `BucketOwnerEnforced`, which disables bucket and object ACLs. Buckets using any other ownership setting indicate that ACLs remain enabled.;"With **ACLs enabled**, access can bypass centralized policy controls, impacting confidentiality and integrity.
- Unintended public or cross-account reads/writes
- Object-writer ownership blocking bucket-owner governance
- Per-object grants hinder auditing, enabling data exfiltration or tampering";;Disable ACLs by setting **Object Ownership** to `BucketOwnerEnforced` and manage access with **IAM** and **bucket policies** under **least privilege**. Centralize authorization, review policies regularly, and use organizational guardrails to prevent re-enabling ACLs. *Migrate ACL-based grants into policies before the change.*;https://hub.prowler.com/check/s3_bucket_acl_prohibited;"```yaml
# CloudFormation: Disable ACLs by enforcing bucket owner for all objects
Resources:
  <example_resource_name>OwnershipControls:
    Type: AWS::S3::BucketOwnershipControls
    Properties:
      Bucket: <example_resource_name>
      OwnershipControls:
        Rules:
          - ObjectOwnership: BucketOwnerEnforced  # Critical: Disables ACLs and makes bucket owner the object owner
```";"```hcl
# Disable ACLs by enforcing bucket owner for all objects
resource ""aws_s3_bucket_ownership_controls"" ""<example_resource_name>"" {
  bucket = ""<example_resource_id>""
  rule {
    object_ownership = ""BucketOwnerEnforced"" # Critical: Disables ACLs and enforces bucket owner
  }
}
```";"aws s3api put-bucket-ownership-controls --bucket <bucket-name> --ownership-controls ""Rules=[{ObjectOwnership=BucketOwnerEnforced}]""";"1. In the AWS Console, go to S3 > Buckets and select the target bucket
2. Open the Permissions tab
3. In Object Ownership, click Edit
4. Select Bucket owner enforced (ACLs disabled)
5. Click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC05-BP02 | AWS-Foundational-Technical-Review: S3-001 | NIST-CSF-2.0: ds_5 | CISA: your-data-2 | KISA-ISMS-P-2023: 2.6.2, 2.10.2 | AWS-Foundational-Security-Best-Practices: S3.12 | CCC: CCC.ObjStor.CN02.AR02 | PCI-4.0: 7.2.1.24, 7.2.2.24, 7.2.5.18, 7.3.1.18, 7.3.2.18, 7.3.3.18, 8.2.7.18, 8.2.8.20, 8.3.4.18 | KISA-ISMS-P-2023-korean: 2.6.2, 2.10.2;identity-access;;;;5.18.1;https://docs.aws.amazon.com/AmazonS3/latest/userguide/about-object-ownership.html | https://docs.aws.amazon.com/AmazonS3/latest/userguide/ensure-object-ownership.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_acl_prohibited-132410971304-ap-northeast-2-prowler-dashboard-132410971304;aws;s3_bucket_acl_prohibited;S3 bucket has bucket ACLs disabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;PASS;S3 Bucket prowler-dashboard-132410971304 has bucket ACLs disabled.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::prowler-dashboard-132410971304;prowler-dashboard-132410971304;;;aws;ap-northeast-2;**Amazon S3 buckets** are evaluated for **Object Ownership** set to `BucketOwnerEnforced`, which disables bucket and object ACLs. Buckets using any other ownership setting indicate that ACLs remain enabled.;"With **ACLs enabled**, access can bypass centralized policy controls, impacting confidentiality and integrity.
- Unintended public or cross-account reads/writes
- Object-writer ownership blocking bucket-owner governance
- Per-object grants hinder auditing, enabling data exfiltration or tampering";;Disable ACLs by setting **Object Ownership** to `BucketOwnerEnforced` and manage access with **IAM** and **bucket policies** under **least privilege**. Centralize authorization, review policies regularly, and use organizational guardrails to prevent re-enabling ACLs. *Migrate ACL-based grants into policies before the change.*;https://hub.prowler.com/check/s3_bucket_acl_prohibited;"```yaml
# CloudFormation: Disable ACLs by enforcing bucket owner for all objects
Resources:
  <example_resource_name>OwnershipControls:
    Type: AWS::S3::BucketOwnershipControls
    Properties:
      Bucket: <example_resource_name>
      OwnershipControls:
        Rules:
          - ObjectOwnership: BucketOwnerEnforced  # Critical: Disables ACLs and makes bucket owner the object owner
```";"```hcl
# Disable ACLs by enforcing bucket owner for all objects
resource ""aws_s3_bucket_ownership_controls"" ""<example_resource_name>"" {
  bucket = ""<example_resource_id>""
  rule {
    object_ownership = ""BucketOwnerEnforced"" # Critical: Disables ACLs and enforces bucket owner
  }
}
```";"aws s3api put-bucket-ownership-controls --bucket <bucket-name> --ownership-controls ""Rules=[{ObjectOwnership=BucketOwnerEnforced}]""";"1. In the AWS Console, go to S3 > Buckets and select the target bucket
2. Open the Permissions tab
3. In Object Ownership, click Edit
4. Select Bucket owner enforced (ACLs disabled)
5. Click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC05-BP02 | AWS-Foundational-Technical-Review: S3-001 | NIST-CSF-2.0: ds_5 | CISA: your-data-2 | KISA-ISMS-P-2023: 2.6.2, 2.10.2 | AWS-Foundational-Security-Best-Practices: S3.12 | CCC: CCC.ObjStor.CN02.AR02 | PCI-4.0: 7.2.1.24, 7.2.2.24, 7.2.5.18, 7.3.1.18, 7.3.2.18, 7.3.3.18, 8.2.7.18, 8.2.8.20, 8.3.4.18 | KISA-ISMS-P-2023-korean: 2.6.2, 2.10.2;identity-access;;;;5.18.1;https://docs.aws.amazon.com/AmazonS3/latest/userguide/about-object-ownership.html | https://docs.aws.amazon.com/AmazonS3/latest/userguide/ensure-object-ownership.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_acl_prohibited-132410971304-ap-northeast-2-prowler-terraform-state-132410971304;aws;s3_bucket_acl_prohibited;S3 bucket has bucket ACLs disabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;PASS;S3 Bucket prowler-terraform-state-132410971304 has bucket ACLs disabled.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::prowler-terraform-state-132410971304;prowler-terraform-state-132410971304;;;aws;ap-northeast-2;**Amazon S3 buckets** are evaluated for **Object Ownership** set to `BucketOwnerEnforced`, which disables bucket and object ACLs. Buckets using any other ownership setting indicate that ACLs remain enabled.;"With **ACLs enabled**, access can bypass centralized policy controls, impacting confidentiality and integrity.
- Unintended public or cross-account reads/writes
- Object-writer ownership blocking bucket-owner governance
- Per-object grants hinder auditing, enabling data exfiltration or tampering";;Disable ACLs by setting **Object Ownership** to `BucketOwnerEnforced` and manage access with **IAM** and **bucket policies** under **least privilege**. Centralize authorization, review policies regularly, and use organizational guardrails to prevent re-enabling ACLs. *Migrate ACL-based grants into policies before the change.*;https://hub.prowler.com/check/s3_bucket_acl_prohibited;"```yaml
# CloudFormation: Disable ACLs by enforcing bucket owner for all objects
Resources:
  <example_resource_name>OwnershipControls:
    Type: AWS::S3::BucketOwnershipControls
    Properties:
      Bucket: <example_resource_name>
      OwnershipControls:
        Rules:
          - ObjectOwnership: BucketOwnerEnforced  # Critical: Disables ACLs and makes bucket owner the object owner
```";"```hcl
# Disable ACLs by enforcing bucket owner for all objects
resource ""aws_s3_bucket_ownership_controls"" ""<example_resource_name>"" {
  bucket = ""<example_resource_id>""
  rule {
    object_ownership = ""BucketOwnerEnforced"" # Critical: Disables ACLs and enforces bucket owner
  }
}
```";"aws s3api put-bucket-ownership-controls --bucket <bucket-name> --ownership-controls ""Rules=[{ObjectOwnership=BucketOwnerEnforced}]""";"1. In the AWS Console, go to S3 > Buckets and select the target bucket
2. Open the Permissions tab
3. In Object Ownership, click Edit
4. Select Bucket owner enforced (ACLs disabled)
5. Click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC05-BP02 | AWS-Foundational-Technical-Review: S3-001 | NIST-CSF-2.0: ds_5 | CISA: your-data-2 | KISA-ISMS-P-2023: 2.6.2, 2.10.2 | AWS-Foundational-Security-Best-Practices: S3.12 | CCC: CCC.ObjStor.CN02.AR02 | PCI-4.0: 7.2.1.24, 7.2.2.24, 7.2.5.18, 7.3.1.18, 7.3.2.18, 7.3.3.18, 8.2.7.18, 8.2.8.20, 8.3.4.18 | KISA-ISMS-P-2023-korean: 2.6.2, 2.10.2;identity-access;;;;5.18.1;https://docs.aws.amazon.com/AmazonS3/latest/userguide/about-object-ownership.html | https://docs.aws.amazon.com/AmazonS3/latest/userguide/ensure-object-ownership.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_default_encryption-132410971304-ap-northeast-2-aws-cloudtrail-logs-132410971304-0971c04b;aws;s3_bucket_default_encryption;S3 bucket has default server-side encryption (SSE) enabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Exposure;PASS;S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b has Server Side Encryption with AES256.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b;aws-cloudtrail-logs-132410971304-0971c04b;;;aws;ap-northeast-2;**Amazon S3 buckets** have a default **server-side encryption** setting that automatically encrypts new objects using `SSE-S3` or `SSE-KMS`. This evaluates whether a bucket has a default encryption configuration defined.;Without default encryption, older objects may remain unencrypted and new uploads won't be forced to use `SSE-KMS`. This reduces confidentiality and governance by limiting key audit logs, rotation, and cross-account controls, and increases exposure if data is copied, replicated, or accessed outside intended paths.;;Enable default encryption on all buckets, preferring `SSE-KMS` for sensitive data to retain key control and auditing. Enforce encryption with restrictive bucket policies, apply **least privilege** to KMS keys with rotation, and re-encrypt existing objects. Use **defense in depth** monitoring to detect drift and noncompliant uploads.;https://hub.prowler.com/check/s3_bucket_default_encryption;"```yaml
Resources:
  <example_resource_name>:
    Type: AWS::S3::Bucket
    Properties:
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              SSEAlgorithm: AES256  # Critical: enables default SSE-S3 so new objects are encrypted
```";"```hcl
resource ""aws_s3_bucket"" ""<example_resource_name>"" {
  bucket = ""<example_resource_name>""
}

resource ""aws_s3_bucket_server_side_encryption_configuration"" ""<example_resource_name>"" {
  bucket = aws_s3_bucket.<example_resource_name>.id

  rule {
    apply_server_side_encryption_by_default {
      sse_algorithm = ""AES256""  # Critical: enables default SSE-S3 for the bucket
    }
  }
}
```";"aws s3api put-bucket-encryption --bucket <bucket_name> --server-side-encryption-configuration '{""Rules"":[{""ApplyServerSideEncryptionByDefault"":{""SSEAlgorithm"":""AES256""}}]}'";"1. Open the AWS S3 console and select the bucket
2. Go to the Properties tab
3. In Default encryption, click Edit
4. Enable default encryption and select SSE-S3 (AES-256)
5. Click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC08-BP03 | ISO27001-2022: A.8.11, A.8.24 | AWS-Foundational-Technical-Review: S3-001 | PCI-3.2.1: 3.4, 3.4.1, 3.4.1.a, 3.4.1.c, 3.4.a, 3.4.b, 3.4.d, 8.2, 8.2.1, 8.2.1.a | CIS-1.5: 2.1.1 | NIST-800-171-Revision-2: 3_3_8, 3_5_10, 3_13_11, 3_13_16 | NIST-800-53-Revision-4: sc_28 | NIST-CSF-2.0: ds_1, ds_3 | CISA: your-systems-3, your-data-1, your-data-2 | GxP-21-CFR-Part-11: 11.10-c, 11.30 | NIST-800-53-Revision-5: au_9_3, cm_6_a, cm_9_b, cp_9_d, cp_9_8, pm_11_b, sc_8_3, sc_8_4, sc_13_a, sc_16_1, sc_28_1, si_19_4 | GDPR: article_32 | KISA-ISMS-P-2023: 2.7.1, 2.10.2 | GxP-EU-Annex-11: 7.1-data-storage-damage-protection | FedRamp-Moderate-Revision-4: sc-13, sc-28 | CIS-1.4: 2.1.1 | C5-2025: OPS-31.01B, IAM-07.03B, CRY-01.02AC, CRY-05.01AC, PSS-12.02B | FedRAMP-Low-Revision-4: sc-13 | FFIEC: d3-pc-am-b-12 | ENS-RD2022: mp.si.2.aws.s3.1 | SOC2: pi_1_4 | NIST-CSF-1.1: ds_1 | CCC: CCC.Core.CN02.AR01 | HIPAA: 164_308_a_1_ii_b, 164_308_a_4_ii_a, 164_312_a_2_iv, 164_312_c_1, 164_312_c_2, 164_312_e_2_ii | RBI-Cyber-Security-Framework: annex_i_1_3 | MITRE-ATTACK: T1119, T1530 | PCI-4.0: 3.5.1.30, 8.3.2.48 | KISA-ISMS-P-2023-korean: 2.7.1, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-svc;encryption;;;;5.18.1;https://docs.amazonaws.cn/en_us/AmazonS3/latest/userguide/bucket-encryption.html | https://aws.amazon.com/blogs/security/how-to-prevent-uploads-of-unencrypted-objects-to-amazon-s3/ | https://docs.aws.amazon.com/us_en/AmazonS3/latest/userguide/default-encryption-faq.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_default_encryption-132410971304-ap-northeast-2-aws-cloudtrail-logs-132410971304-0971c04b-logs;aws;s3_bucket_default_encryption;S3 bucket has default server-side encryption (SSE) enabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Exposure;PASS;S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b-logs has Server Side Encryption with AES256.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b-logs;aws-cloudtrail-logs-132410971304-0971c04b-logs;;;aws;ap-northeast-2;**Amazon S3 buckets** have a default **server-side encryption** setting that automatically encrypts new objects using `SSE-S3` or `SSE-KMS`. This evaluates whether a bucket has a default encryption configuration defined.;Without default encryption, older objects may remain unencrypted and new uploads won't be forced to use `SSE-KMS`. This reduces confidentiality and governance by limiting key audit logs, rotation, and cross-account controls, and increases exposure if data is copied, replicated, or accessed outside intended paths.;;Enable default encryption on all buckets, preferring `SSE-KMS` for sensitive data to retain key control and auditing. Enforce encryption with restrictive bucket policies, apply **least privilege** to KMS keys with rotation, and re-encrypt existing objects. Use **defense in depth** monitoring to detect drift and noncompliant uploads.;https://hub.prowler.com/check/s3_bucket_default_encryption;"```yaml
Resources:
  <example_resource_name>:
    Type: AWS::S3::Bucket
    Properties:
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              SSEAlgorithm: AES256  # Critical: enables default SSE-S3 so new objects are encrypted
```";"```hcl
resource ""aws_s3_bucket"" ""<example_resource_name>"" {
  bucket = ""<example_resource_name>""
}

resource ""aws_s3_bucket_server_side_encryption_configuration"" ""<example_resource_name>"" {
  bucket = aws_s3_bucket.<example_resource_name>.id

  rule {
    apply_server_side_encryption_by_default {
      sse_algorithm = ""AES256""  # Critical: enables default SSE-S3 for the bucket
    }
  }
}
```";"aws s3api put-bucket-encryption --bucket <bucket_name> --server-side-encryption-configuration '{""Rules"":[{""ApplyServerSideEncryptionByDefault"":{""SSEAlgorithm"":""AES256""}}]}'";"1. Open the AWS S3 console and select the bucket
2. Go to the Properties tab
3. In Default encryption, click Edit
4. Enable default encryption and select SSE-S3 (AES-256)
5. Click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC08-BP03 | ISO27001-2022: A.8.11, A.8.24 | AWS-Foundational-Technical-Review: S3-001 | PCI-3.2.1: 3.4, 3.4.1, 3.4.1.a, 3.4.1.c, 3.4.a, 3.4.b, 3.4.d, 8.2, 8.2.1, 8.2.1.a | CIS-1.5: 2.1.1 | NIST-800-171-Revision-2: 3_3_8, 3_5_10, 3_13_11, 3_13_16 | NIST-800-53-Revision-4: sc_28 | NIST-CSF-2.0: ds_1, ds_3 | CISA: your-systems-3, your-data-1, your-data-2 | GxP-21-CFR-Part-11: 11.10-c, 11.30 | NIST-800-53-Revision-5: au_9_3, cm_6_a, cm_9_b, cp_9_d, cp_9_8, pm_11_b, sc_8_3, sc_8_4, sc_13_a, sc_16_1, sc_28_1, si_19_4 | GDPR: article_32 | KISA-ISMS-P-2023: 2.7.1, 2.10.2 | GxP-EU-Annex-11: 7.1-data-storage-damage-protection | FedRamp-Moderate-Revision-4: sc-13, sc-28 | CIS-1.4: 2.1.1 | C5-2025: OPS-31.01B, IAM-07.03B, CRY-01.02AC, CRY-05.01AC, PSS-12.02B | FedRAMP-Low-Revision-4: sc-13 | FFIEC: d3-pc-am-b-12 | ENS-RD2022: mp.si.2.aws.s3.1 | SOC2: pi_1_4 | NIST-CSF-1.1: ds_1 | CCC: CCC.Core.CN02.AR01 | HIPAA: 164_308_a_1_ii_b, 164_308_a_4_ii_a, 164_312_a_2_iv, 164_312_c_1, 164_312_c_2, 164_312_e_2_ii | RBI-Cyber-Security-Framework: annex_i_1_3 | MITRE-ATTACK: T1119, T1530 | PCI-4.0: 3.5.1.30, 8.3.2.48 | KISA-ISMS-P-2023-korean: 2.7.1, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-svc;encryption;;;;5.18.1;https://docs.amazonaws.cn/en_us/AmazonS3/latest/userguide/bucket-encryption.html | https://aws.amazon.com/blogs/security/how-to-prevent-uploads-of-unencrypted-objects-to-amazon-s3/ | https://docs.aws.amazon.com/us_en/AmazonS3/latest/userguide/default-encryption-faq.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_default_encryption-132410971304-ap-northeast-2-prowler-dashboard-132410971304;aws;s3_bucket_default_encryption;S3 bucket has default server-side encryption (SSE) enabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Exposure;PASS;S3 Bucket prowler-dashboard-132410971304 has Server Side Encryption with AES256.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::prowler-dashboard-132410971304;prowler-dashboard-132410971304;;;aws;ap-northeast-2;**Amazon S3 buckets** have a default **server-side encryption** setting that automatically encrypts new objects using `SSE-S3` or `SSE-KMS`. This evaluates whether a bucket has a default encryption configuration defined.;Without default encryption, older objects may remain unencrypted and new uploads won't be forced to use `SSE-KMS`. This reduces confidentiality and governance by limiting key audit logs, rotation, and cross-account controls, and increases exposure if data is copied, replicated, or accessed outside intended paths.;;Enable default encryption on all buckets, preferring `SSE-KMS` for sensitive data to retain key control and auditing. Enforce encryption with restrictive bucket policies, apply **least privilege** to KMS keys with rotation, and re-encrypt existing objects. Use **defense in depth** monitoring to detect drift and noncompliant uploads.;https://hub.prowler.com/check/s3_bucket_default_encryption;"```yaml
Resources:
  <example_resource_name>:
    Type: AWS::S3::Bucket
    Properties:
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              SSEAlgorithm: AES256  # Critical: enables default SSE-S3 so new objects are encrypted
```";"```hcl
resource ""aws_s3_bucket"" ""<example_resource_name>"" {
  bucket = ""<example_resource_name>""
}

resource ""aws_s3_bucket_server_side_encryption_configuration"" ""<example_resource_name>"" {
  bucket = aws_s3_bucket.<example_resource_name>.id

  rule {
    apply_server_side_encryption_by_default {
      sse_algorithm = ""AES256""  # Critical: enables default SSE-S3 for the bucket
    }
  }
}
```";"aws s3api put-bucket-encryption --bucket <bucket_name> --server-side-encryption-configuration '{""Rules"":[{""ApplyServerSideEncryptionByDefault"":{""SSEAlgorithm"":""AES256""}}]}'";"1. Open the AWS S3 console and select the bucket
2. Go to the Properties tab
3. In Default encryption, click Edit
4. Enable default encryption and select SSE-S3 (AES-256)
5. Click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC08-BP03 | ISO27001-2022: A.8.11, A.8.24 | AWS-Foundational-Technical-Review: S3-001 | PCI-3.2.1: 3.4, 3.4.1, 3.4.1.a, 3.4.1.c, 3.4.a, 3.4.b, 3.4.d, 8.2, 8.2.1, 8.2.1.a | CIS-1.5: 2.1.1 | NIST-800-171-Revision-2: 3_3_8, 3_5_10, 3_13_11, 3_13_16 | NIST-800-53-Revision-4: sc_28 | NIST-CSF-2.0: ds_1, ds_3 | CISA: your-systems-3, your-data-1, your-data-2 | GxP-21-CFR-Part-11: 11.10-c, 11.30 | NIST-800-53-Revision-5: au_9_3, cm_6_a, cm_9_b, cp_9_d, cp_9_8, pm_11_b, sc_8_3, sc_8_4, sc_13_a, sc_16_1, sc_28_1, si_19_4 | GDPR: article_32 | KISA-ISMS-P-2023: 2.7.1, 2.10.2 | GxP-EU-Annex-11: 7.1-data-storage-damage-protection | FedRamp-Moderate-Revision-4: sc-13, sc-28 | CIS-1.4: 2.1.1 | C5-2025: OPS-31.01B, IAM-07.03B, CRY-01.02AC, CRY-05.01AC, PSS-12.02B | FedRAMP-Low-Revision-4: sc-13 | FFIEC: d3-pc-am-b-12 | ENS-RD2022: mp.si.2.aws.s3.1 | SOC2: pi_1_4 | NIST-CSF-1.1: ds_1 | CCC: CCC.Core.CN02.AR01 | HIPAA: 164_308_a_1_ii_b, 164_308_a_4_ii_a, 164_312_a_2_iv, 164_312_c_1, 164_312_c_2, 164_312_e_2_ii | RBI-Cyber-Security-Framework: annex_i_1_3 | MITRE-ATTACK: T1119, T1530 | PCI-4.0: 3.5.1.30, 8.3.2.48 | KISA-ISMS-P-2023-korean: 2.7.1, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-svc;encryption;;;;5.18.1;https://docs.amazonaws.cn/en_us/AmazonS3/latest/userguide/bucket-encryption.html | https://aws.amazon.com/blogs/security/how-to-prevent-uploads-of-unencrypted-objects-to-amazon-s3/ | https://docs.aws.amazon.com/us_en/AmazonS3/latest/userguide/default-encryption-faq.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_default_encryption-132410971304-ap-northeast-2-prowler-terraform-state-132410971304;aws;s3_bucket_default_encryption;S3 bucket has default server-side encryption (SSE) enabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Exposure;PASS;S3 Bucket prowler-terraform-state-132410971304 has Server Side Encryption with AES256.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::prowler-terraform-state-132410971304;prowler-terraform-state-132410971304;;;aws;ap-northeast-2;**Amazon S3 buckets** have a default **server-side encryption** setting that automatically encrypts new objects using `SSE-S3` or `SSE-KMS`. This evaluates whether a bucket has a default encryption configuration defined.;Without default encryption, older objects may remain unencrypted and new uploads won't be forced to use `SSE-KMS`. This reduces confidentiality and governance by limiting key audit logs, rotation, and cross-account controls, and increases exposure if data is copied, replicated, or accessed outside intended paths.;;Enable default encryption on all buckets, preferring `SSE-KMS` for sensitive data to retain key control and auditing. Enforce encryption with restrictive bucket policies, apply **least privilege** to KMS keys with rotation, and re-encrypt existing objects. Use **defense in depth** monitoring to detect drift and noncompliant uploads.;https://hub.prowler.com/check/s3_bucket_default_encryption;"```yaml
Resources:
  <example_resource_name>:
    Type: AWS::S3::Bucket
    Properties:
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              SSEAlgorithm: AES256  # Critical: enables default SSE-S3 so new objects are encrypted
```";"```hcl
resource ""aws_s3_bucket"" ""<example_resource_name>"" {
  bucket = ""<example_resource_name>""
}

resource ""aws_s3_bucket_server_side_encryption_configuration"" ""<example_resource_name>"" {
  bucket = aws_s3_bucket.<example_resource_name>.id

  rule {
    apply_server_side_encryption_by_default {
      sse_algorithm = ""AES256""  # Critical: enables default SSE-S3 for the bucket
    }
  }
}
```";"aws s3api put-bucket-encryption --bucket <bucket_name> --server-side-encryption-configuration '{""Rules"":[{""ApplyServerSideEncryptionByDefault"":{""SSEAlgorithm"":""AES256""}}]}'";"1. Open the AWS S3 console and select the bucket
2. Go to the Properties tab
3. In Default encryption, click Edit
4. Enable default encryption and select SSE-S3 (AES-256)
5. Click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC08-BP03 | ISO27001-2022: A.8.11, A.8.24 | AWS-Foundational-Technical-Review: S3-001 | PCI-3.2.1: 3.4, 3.4.1, 3.4.1.a, 3.4.1.c, 3.4.a, 3.4.b, 3.4.d, 8.2, 8.2.1, 8.2.1.a | CIS-1.5: 2.1.1 | NIST-800-171-Revision-2: 3_3_8, 3_5_10, 3_13_11, 3_13_16 | NIST-800-53-Revision-4: sc_28 | NIST-CSF-2.0: ds_1, ds_3 | CISA: your-systems-3, your-data-1, your-data-2 | GxP-21-CFR-Part-11: 11.10-c, 11.30 | NIST-800-53-Revision-5: au_9_3, cm_6_a, cm_9_b, cp_9_d, cp_9_8, pm_11_b, sc_8_3, sc_8_4, sc_13_a, sc_16_1, sc_28_1, si_19_4 | GDPR: article_32 | KISA-ISMS-P-2023: 2.7.1, 2.10.2 | GxP-EU-Annex-11: 7.1-data-storage-damage-protection | FedRamp-Moderate-Revision-4: sc-13, sc-28 | CIS-1.4: 2.1.1 | C5-2025: OPS-31.01B, IAM-07.03B, CRY-01.02AC, CRY-05.01AC, PSS-12.02B | FedRAMP-Low-Revision-4: sc-13 | FFIEC: d3-pc-am-b-12 | ENS-RD2022: mp.si.2.aws.s3.1 | SOC2: pi_1_4 | NIST-CSF-1.1: ds_1 | CCC: CCC.Core.CN02.AR01 | HIPAA: 164_308_a_1_ii_b, 164_308_a_4_ii_a, 164_312_a_2_iv, 164_312_c_1, 164_312_c_2, 164_312_e_2_ii | RBI-Cyber-Security-Framework: annex_i_1_3 | MITRE-ATTACK: T1119, T1530 | PCI-4.0: 3.5.1.30, 8.3.2.48 | KISA-ISMS-P-2023-korean: 2.7.1, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-svc;encryption;;;;5.18.1;https://docs.amazonaws.cn/en_us/AmazonS3/latest/userguide/bucket-encryption.html | https://aws.amazon.com/blogs/security/how-to-prevent-uploads-of-unencrypted-objects-to-amazon-s3/ | https://docs.aws.amazon.com/us_en/AmazonS3/latest/userguide/default-encryption-faq.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_kms_encryption-132410971304-ap-northeast-2-aws-cloudtrail-logs-132410971304-0971c04b;aws;s3_bucket_kms_encryption;S3 bucket has server-side encryption with AWS KMS;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Exposure;FAIL;Server Side Encryption is not configured with kms for S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b;aws-cloudtrail-logs-132410971304-0971c04b;;;aws;ap-northeast-2;**Amazon S3 buckets** use server-side encryption with **AWS KMS** keys, including dual-layer `aws:kms:dsse`. The evaluation identifies buckets whose default encryption is `aws:kms` or `aws:kms:dsse` rather than SSE-S3.;Without **KMS-based encryption**, data relies only on SSE-S3, reducing **confidentiality** controls. Missing key policies and grants weakens **least privilege**, cross-account scoping, and the ability to disable or rotate keys. Lack of **KMS audit trails** obscures key usage, hindering detection of misuse and **defense in depth**.;;Enable default **SSE-KMS** (or **DSSE-KMS** for highly sensitive data). Use a customer-managed key, enforce **least privilege** and separation of duties for key usage, and require KMS encryption via bucket policy (specify `aws:kms` and a designated key). Monitor key activity in **CloudTrail** and consider **S3 Bucket Keys** to control cost.;https://hub.prowler.com/check/s3_bucket_kms_encryption;"```yaml
# CloudFormation: enable default SSE-KMS on the bucket
Resources:
  <example_resource_name>:
    Type: AWS::S3::Bucket
    Properties:
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              SSEAlgorithm: aws:kms  # Critical: sets default encryption to AWS KMS (SSE-KMS)
```";"```hcl
# Enable default SSE-KMS on an existing S3 bucket
resource ""aws_s3_bucket_server_side_encryption_configuration"" ""<example_resource_name>"" {
  bucket = ""<example_bucket_name>""

  rule {
    apply_server_side_encryption_by_default {
      sse_algorithm = ""aws:kms"" # Critical: enforces SSE-KMS by default
    }
  }
}
```";"aws s3api put-bucket-encryption --bucket <BUCKET_NAME> --server-side-encryption-configuration '{""Rules"":[{""ApplyServerSideEncryptionByDefault"":{""SSEAlgorithm"":""aws:kms""}}]}'";"1. In the AWS Console, go to S3 and open the target bucket
2. Select the Properties tab
3. Under Default encryption, click Edit
4. Choose Server-side encryption with AWS KMS keys (SSE-KMS)
5. Leave AWS managed key (aws/s3) selected (or choose your CMK if required)
6. Click Save changes";ISO27001-2022: A.8.11, A.8.24 | AWS-Foundational-Technical-Review: S3-001 | PCI-3.2.1: 3.4, 3.4.1, 3.4.1.a, 3.4.1.c, 3.4.a, 3.4.b, 3.4.d, 8.2, 8.2.1, 8.2.1.a | NIST-CSF-2.0: ds_1, ds_3, ds_5, pt_4 | KISA-ISMS-P-2023: 2.7.2, 2.10.2 | C5-2025: OIS-08.02B, OPS-31.01B, IAM-07.03B, CRY-01.02AC, CRY-05.02B, CRY-05.01AC, PSS-12.02B | SOC2: pi_1_4 | AWS-Foundational-Security-Best-Practices: S3.17 | CCC: CCC.ObjStor.CN01.AR01, CCC.ObjStor.CN01.AR03, CCC.Core.CN02.AR01 | PCI-4.0: 3.5.1.31, 8.3.2.50 | KISA-ISMS-P-2023-korean: 2.7.2, 2.10.2;encryption;;;;5.18.1;https://docs.aws.amazon.com/AmazonS3/latest/userguide/default-bucket-encryption.html | https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/S3/encrypted-with-kms-customer-master-keys.html | https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingKMSEncryption.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_kms_encryption-132410971304-ap-northeast-2-aws-cloudtrail-logs-132410971304-0971c04b-logs;aws;s3_bucket_kms_encryption;S3 bucket has server-side encryption with AWS KMS;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Exposure;FAIL;Server Side Encryption is not configured with kms for S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b-logs.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b-logs;aws-cloudtrail-logs-132410971304-0971c04b-logs;;;aws;ap-northeast-2;**Amazon S3 buckets** use server-side encryption with **AWS KMS** keys, including dual-layer `aws:kms:dsse`. The evaluation identifies buckets whose default encryption is `aws:kms` or `aws:kms:dsse` rather than SSE-S3.;Without **KMS-based encryption**, data relies only on SSE-S3, reducing **confidentiality** controls. Missing key policies and grants weakens **least privilege**, cross-account scoping, and the ability to disable or rotate keys. Lack of **KMS audit trails** obscures key usage, hindering detection of misuse and **defense in depth**.;;Enable default **SSE-KMS** (or **DSSE-KMS** for highly sensitive data). Use a customer-managed key, enforce **least privilege** and separation of duties for key usage, and require KMS encryption via bucket policy (specify `aws:kms` and a designated key). Monitor key activity in **CloudTrail** and consider **S3 Bucket Keys** to control cost.;https://hub.prowler.com/check/s3_bucket_kms_encryption;"```yaml
# CloudFormation: enable default SSE-KMS on the bucket
Resources:
  <example_resource_name>:
    Type: AWS::S3::Bucket
    Properties:
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              SSEAlgorithm: aws:kms  # Critical: sets default encryption to AWS KMS (SSE-KMS)
```";"```hcl
# Enable default SSE-KMS on an existing S3 bucket
resource ""aws_s3_bucket_server_side_encryption_configuration"" ""<example_resource_name>"" {
  bucket = ""<example_bucket_name>""

  rule {
    apply_server_side_encryption_by_default {
      sse_algorithm = ""aws:kms"" # Critical: enforces SSE-KMS by default
    }
  }
}
```";"aws s3api put-bucket-encryption --bucket <BUCKET_NAME> --server-side-encryption-configuration '{""Rules"":[{""ApplyServerSideEncryptionByDefault"":{""SSEAlgorithm"":""aws:kms""}}]}'";"1. In the AWS Console, go to S3 and open the target bucket
2. Select the Properties tab
3. Under Default encryption, click Edit
4. Choose Server-side encryption with AWS KMS keys (SSE-KMS)
5. Leave AWS managed key (aws/s3) selected (or choose your CMK if required)
6. Click Save changes";ISO27001-2022: A.8.11, A.8.24 | AWS-Foundational-Technical-Review: S3-001 | PCI-3.2.1: 3.4, 3.4.1, 3.4.1.a, 3.4.1.c, 3.4.a, 3.4.b, 3.4.d, 8.2, 8.2.1, 8.2.1.a | NIST-CSF-2.0: ds_1, ds_3, ds_5, pt_4 | KISA-ISMS-P-2023: 2.7.2, 2.10.2 | C5-2025: OIS-08.02B, OPS-31.01B, IAM-07.03B, CRY-01.02AC, CRY-05.02B, CRY-05.01AC, PSS-12.02B | SOC2: pi_1_4 | AWS-Foundational-Security-Best-Practices: S3.17 | CCC: CCC.ObjStor.CN01.AR01, CCC.ObjStor.CN01.AR03, CCC.Core.CN02.AR01 | PCI-4.0: 3.5.1.31, 8.3.2.50 | KISA-ISMS-P-2023-korean: 2.7.2, 2.10.2;encryption;;;;5.18.1;https://docs.aws.amazon.com/AmazonS3/latest/userguide/default-bucket-encryption.html | https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/S3/encrypted-with-kms-customer-master-keys.html | https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingKMSEncryption.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_kms_encryption-132410971304-ap-northeast-2-prowler-dashboard-132410971304;aws;s3_bucket_kms_encryption;S3 bucket has server-side encryption with AWS KMS;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Exposure;FAIL;Server Side Encryption is not configured with kms for S3 Bucket prowler-dashboard-132410971304.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::prowler-dashboard-132410971304;prowler-dashboard-132410971304;;;aws;ap-northeast-2;**Amazon S3 buckets** use server-side encryption with **AWS KMS** keys, including dual-layer `aws:kms:dsse`. The evaluation identifies buckets whose default encryption is `aws:kms` or `aws:kms:dsse` rather than SSE-S3.;Without **KMS-based encryption**, data relies only on SSE-S3, reducing **confidentiality** controls. Missing key policies and grants weakens **least privilege**, cross-account scoping, and the ability to disable or rotate keys. Lack of **KMS audit trails** obscures key usage, hindering detection of misuse and **defense in depth**.;;Enable default **SSE-KMS** (or **DSSE-KMS** for highly sensitive data). Use a customer-managed key, enforce **least privilege** and separation of duties for key usage, and require KMS encryption via bucket policy (specify `aws:kms` and a designated key). Monitor key activity in **CloudTrail** and consider **S3 Bucket Keys** to control cost.;https://hub.prowler.com/check/s3_bucket_kms_encryption;"```yaml
# CloudFormation: enable default SSE-KMS on the bucket
Resources:
  <example_resource_name>:
    Type: AWS::S3::Bucket
    Properties:
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              SSEAlgorithm: aws:kms  # Critical: sets default encryption to AWS KMS (SSE-KMS)
```";"```hcl
# Enable default SSE-KMS on an existing S3 bucket
resource ""aws_s3_bucket_server_side_encryption_configuration"" ""<example_resource_name>"" {
  bucket = ""<example_bucket_name>""

  rule {
    apply_server_side_encryption_by_default {
      sse_algorithm = ""aws:kms"" # Critical: enforces SSE-KMS by default
    }
  }
}
```";"aws s3api put-bucket-encryption --bucket <BUCKET_NAME> --server-side-encryption-configuration '{""Rules"":[{""ApplyServerSideEncryptionByDefault"":{""SSEAlgorithm"":""aws:kms""}}]}'";"1. In the AWS Console, go to S3 and open the target bucket
2. Select the Properties tab
3. Under Default encryption, click Edit
4. Choose Server-side encryption with AWS KMS keys (SSE-KMS)
5. Leave AWS managed key (aws/s3) selected (or choose your CMK if required)
6. Click Save changes";ISO27001-2022: A.8.11, A.8.24 | AWS-Foundational-Technical-Review: S3-001 | PCI-3.2.1: 3.4, 3.4.1, 3.4.1.a, 3.4.1.c, 3.4.a, 3.4.b, 3.4.d, 8.2, 8.2.1, 8.2.1.a | NIST-CSF-2.0: ds_1, ds_3, ds_5, pt_4 | KISA-ISMS-P-2023: 2.7.2, 2.10.2 | C5-2025: OIS-08.02B, OPS-31.01B, IAM-07.03B, CRY-01.02AC, CRY-05.02B, CRY-05.01AC, PSS-12.02B | SOC2: pi_1_4 | AWS-Foundational-Security-Best-Practices: S3.17 | CCC: CCC.ObjStor.CN01.AR01, CCC.ObjStor.CN01.AR03, CCC.Core.CN02.AR01 | PCI-4.0: 3.5.1.31, 8.3.2.50 | KISA-ISMS-P-2023-korean: 2.7.2, 2.10.2;encryption;;;;5.18.1;https://docs.aws.amazon.com/AmazonS3/latest/userguide/default-bucket-encryption.html | https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/S3/encrypted-with-kms-customer-master-keys.html | https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingKMSEncryption.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_kms_encryption-132410971304-ap-northeast-2-prowler-terraform-state-132410971304;aws;s3_bucket_kms_encryption;S3 bucket has server-side encryption with AWS KMS;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Exposure;FAIL;Server Side Encryption is not configured with kms for S3 Bucket prowler-terraform-state-132410971304.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::prowler-terraform-state-132410971304;prowler-terraform-state-132410971304;;;aws;ap-northeast-2;**Amazon S3 buckets** use server-side encryption with **AWS KMS** keys, including dual-layer `aws:kms:dsse`. The evaluation identifies buckets whose default encryption is `aws:kms` or `aws:kms:dsse` rather than SSE-S3.;Without **KMS-based encryption**, data relies only on SSE-S3, reducing **confidentiality** controls. Missing key policies and grants weakens **least privilege**, cross-account scoping, and the ability to disable or rotate keys. Lack of **KMS audit trails** obscures key usage, hindering detection of misuse and **defense in depth**.;;Enable default **SSE-KMS** (or **DSSE-KMS** for highly sensitive data). Use a customer-managed key, enforce **least privilege** and separation of duties for key usage, and require KMS encryption via bucket policy (specify `aws:kms` and a designated key). Monitor key activity in **CloudTrail** and consider **S3 Bucket Keys** to control cost.;https://hub.prowler.com/check/s3_bucket_kms_encryption;"```yaml
# CloudFormation: enable default SSE-KMS on the bucket
Resources:
  <example_resource_name>:
    Type: AWS::S3::Bucket
    Properties:
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              SSEAlgorithm: aws:kms  # Critical: sets default encryption to AWS KMS (SSE-KMS)
```";"```hcl
# Enable default SSE-KMS on an existing S3 bucket
resource ""aws_s3_bucket_server_side_encryption_configuration"" ""<example_resource_name>"" {
  bucket = ""<example_bucket_name>""

  rule {
    apply_server_side_encryption_by_default {
      sse_algorithm = ""aws:kms"" # Critical: enforces SSE-KMS by default
    }
  }
}
```";"aws s3api put-bucket-encryption --bucket <BUCKET_NAME> --server-side-encryption-configuration '{""Rules"":[{""ApplyServerSideEncryptionByDefault"":{""SSEAlgorithm"":""aws:kms""}}]}'";"1. In the AWS Console, go to S3 and open the target bucket
2. Select the Properties tab
3. Under Default encryption, click Edit
4. Choose Server-side encryption with AWS KMS keys (SSE-KMS)
5. Leave AWS managed key (aws/s3) selected (or choose your CMK if required)
6. Click Save changes";ISO27001-2022: A.8.11, A.8.24 | AWS-Foundational-Technical-Review: S3-001 | PCI-3.2.1: 3.4, 3.4.1, 3.4.1.a, 3.4.1.c, 3.4.a, 3.4.b, 3.4.d, 8.2, 8.2.1, 8.2.1.a | NIST-CSF-2.0: ds_1, ds_3, ds_5, pt_4 | KISA-ISMS-P-2023: 2.7.2, 2.10.2 | C5-2025: OIS-08.02B, OPS-31.01B, IAM-07.03B, CRY-01.02AC, CRY-05.02B, CRY-05.01AC, PSS-12.02B | SOC2: pi_1_4 | AWS-Foundational-Security-Best-Practices: S3.17 | CCC: CCC.ObjStor.CN01.AR01, CCC.ObjStor.CN01.AR03, CCC.Core.CN02.AR01 | PCI-4.0: 3.5.1.31, 8.3.2.50 | KISA-ISMS-P-2023-korean: 2.7.2, 2.10.2;encryption;;;;5.18.1;https://docs.aws.amazon.com/AmazonS3/latest/userguide/default-bucket-encryption.html | https://www.trendmicro.com/cloudoneconformity-staging/knowledge-base/aws/S3/encrypted-with-kms-customer-master-keys.html | https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingKMSEncryption.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_no_mfa_delete-132410971304-ap-northeast-2-aws-cloudtrail-logs-132410971304-0971c04b;aws;s3_bucket_no_mfa_delete;S3 bucket has MFA Delete enabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Destruction;FAIL;S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b has MFA Delete disabled.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b;aws-cloudtrail-logs-132410971304-0971c04b;;;aws;ap-northeast-2;**Amazon S3 buckets** are assessed for **MFA Delete** status. MFA Delete requires a second factor to permanently delete object versions or change `Versioning` configuration. The finding highlights buckets where this protection is not enabled.;"Without **MFA Delete**, a compromised or over-privileged identity can irrevocably purge object history or change versioning.

This erases recovery points, degrading data **availability**, weakening **integrity**, and increasing the blast radius of account compromise or ransomware.";;Enable **MFA Delete** on sensitive, versioned buckets so permanent deletions and `Versioning` changes require a second factor. Apply **least privilege** to restrict version purge actions, enforce **change control**, and combine with **Object Lock** or immutable backups for defense in depth.;https://hub.prowler.com/check/s3_bucket_no_mfa_delete;;;"aws s3api put-bucket-versioning --bucket <BUCKET_NAME> --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa ""<MFA_SERIAL_OR_ARN> <MFA_CODE>""";"1. Sign in to the AWS Management Console as the root user
2. Open the account menu > Security credentials > Multi-factor authentication (MFA) and assign an MFA device; copy its ARN/serial
3. From a machine configured to use the root user credentials, run:

```bash
aws s3api put-bucket-versioning --bucket <BUCKET_NAME> --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa ""<MFA_SERIAL_OR_ARN> <MFA_CODE>""
```";AWS-Well-Architected-Framework-Security-Pillar: SEC05-BP02 | CIS-1.5: 2.1.3 | NIS2: 11.7.2 | CIS-5.0: 2.1.2 | ProwlerThreatScore-1.0: 2.2.1 | KISA-ISMS-P-2023: 2.5.3, 2.10.2 | CIS-1.4: 2.1.3 | C5-2025: AM-07.02B, OPS-16.01B, IAM-04.06B, IAM-09.02B, IAM-09.01AC, PSS-05.01B, PSS-07.02B | CIS-4.0.1: 2.1.2 | AWS-Foundational-Security-Best-Practices: S3.20 | CIS-2.0: 2.1.2 | CIS-3.0: 2.1.2 | MITRE-ATTACK: T1485 | PCI-4.0: 10.3.2.22, 3.5.1.3.27, 8.4.1.5, 8.4.2.5, 8.4.3.5, A1.1.2.18, A3.4.1.20 | KISA-ISMS-P-2023-korean: 2.5.3, 2.10.2;identity-access;;;;5.18.1;https://docs.aws.amazon.com/AmazonS3/latest/userguide/MultiFactorAuthenticationDelete.html | https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingMFADelete.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_no_mfa_delete-132410971304-ap-northeast-2-aws-cloudtrail-logs-132410971304-0971c04b-logs;aws;s3_bucket_no_mfa_delete;S3 bucket has MFA Delete enabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Destruction;FAIL;S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b-logs has MFA Delete disabled.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b-logs;aws-cloudtrail-logs-132410971304-0971c04b-logs;;;aws;ap-northeast-2;**Amazon S3 buckets** are assessed for **MFA Delete** status. MFA Delete requires a second factor to permanently delete object versions or change `Versioning` configuration. The finding highlights buckets where this protection is not enabled.;"Without **MFA Delete**, a compromised or over-privileged identity can irrevocably purge object history or change versioning.

This erases recovery points, degrading data **availability**, weakening **integrity**, and increasing the blast radius of account compromise or ransomware.";;Enable **MFA Delete** on sensitive, versioned buckets so permanent deletions and `Versioning` changes require a second factor. Apply **least privilege** to restrict version purge actions, enforce **change control**, and combine with **Object Lock** or immutable backups for defense in depth.;https://hub.prowler.com/check/s3_bucket_no_mfa_delete;;;"aws s3api put-bucket-versioning --bucket <BUCKET_NAME> --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa ""<MFA_SERIAL_OR_ARN> <MFA_CODE>""";"1. Sign in to the AWS Management Console as the root user
2. Open the account menu > Security credentials > Multi-factor authentication (MFA) and assign an MFA device; copy its ARN/serial
3. From a machine configured to use the root user credentials, run:

```bash
aws s3api put-bucket-versioning --bucket <BUCKET_NAME> --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa ""<MFA_SERIAL_OR_ARN> <MFA_CODE>""
```";AWS-Well-Architected-Framework-Security-Pillar: SEC05-BP02 | CIS-1.5: 2.1.3 | NIS2: 11.7.2 | CIS-5.0: 2.1.2 | ProwlerThreatScore-1.0: 2.2.1 | KISA-ISMS-P-2023: 2.5.3, 2.10.2 | CIS-1.4: 2.1.3 | C5-2025: AM-07.02B, OPS-16.01B, IAM-04.06B, IAM-09.02B, IAM-09.01AC, PSS-05.01B, PSS-07.02B | CIS-4.0.1: 2.1.2 | AWS-Foundational-Security-Best-Practices: S3.20 | CIS-2.0: 2.1.2 | CIS-3.0: 2.1.2 | MITRE-ATTACK: T1485 | PCI-4.0: 10.3.2.22, 3.5.1.3.27, 8.4.1.5, 8.4.2.5, 8.4.3.5, A1.1.2.18, A3.4.1.20 | KISA-ISMS-P-2023-korean: 2.5.3, 2.10.2;identity-access;;;;5.18.1;https://docs.aws.amazon.com/AmazonS3/latest/userguide/MultiFactorAuthenticationDelete.html | https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingMFADelete.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_no_mfa_delete-132410971304-ap-northeast-2-prowler-dashboard-132410971304;aws;s3_bucket_no_mfa_delete;S3 bucket has MFA Delete enabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Destruction;FAIL;S3 Bucket prowler-dashboard-132410971304 has MFA Delete disabled.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::prowler-dashboard-132410971304;prowler-dashboard-132410971304;;;aws;ap-northeast-2;**Amazon S3 buckets** are assessed for **MFA Delete** status. MFA Delete requires a second factor to permanently delete object versions or change `Versioning` configuration. The finding highlights buckets where this protection is not enabled.;"Without **MFA Delete**, a compromised or over-privileged identity can irrevocably purge object history or change versioning.

This erases recovery points, degrading data **availability**, weakening **integrity**, and increasing the blast radius of account compromise or ransomware.";;Enable **MFA Delete** on sensitive, versioned buckets so permanent deletions and `Versioning` changes require a second factor. Apply **least privilege** to restrict version purge actions, enforce **change control**, and combine with **Object Lock** or immutable backups for defense in depth.;https://hub.prowler.com/check/s3_bucket_no_mfa_delete;;;"aws s3api put-bucket-versioning --bucket <BUCKET_NAME> --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa ""<MFA_SERIAL_OR_ARN> <MFA_CODE>""";"1. Sign in to the AWS Management Console as the root user
2. Open the account menu > Security credentials > Multi-factor authentication (MFA) and assign an MFA device; copy its ARN/serial
3. From a machine configured to use the root user credentials, run:

```bash
aws s3api put-bucket-versioning --bucket <BUCKET_NAME> --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa ""<MFA_SERIAL_OR_ARN> <MFA_CODE>""
```";AWS-Well-Architected-Framework-Security-Pillar: SEC05-BP02 | CIS-1.5: 2.1.3 | NIS2: 11.7.2 | CIS-5.0: 2.1.2 | ProwlerThreatScore-1.0: 2.2.1 | KISA-ISMS-P-2023: 2.5.3, 2.10.2 | CIS-1.4: 2.1.3 | C5-2025: AM-07.02B, OPS-16.01B, IAM-04.06B, IAM-09.02B, IAM-09.01AC, PSS-05.01B, PSS-07.02B | CIS-4.0.1: 2.1.2 | AWS-Foundational-Security-Best-Practices: S3.20 | CIS-2.0: 2.1.2 | CIS-3.0: 2.1.2 | MITRE-ATTACK: T1485 | PCI-4.0: 10.3.2.22, 3.5.1.3.27, 8.4.1.5, 8.4.2.5, 8.4.3.5, A1.1.2.18, A3.4.1.20 | KISA-ISMS-P-2023-korean: 2.5.3, 2.10.2;identity-access;;;;5.18.1;https://docs.aws.amazon.com/AmazonS3/latest/userguide/MultiFactorAuthenticationDelete.html | https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingMFADelete.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_no_mfa_delete-132410971304-ap-northeast-2-prowler-terraform-state-132410971304;aws;s3_bucket_no_mfa_delete;S3 bucket has MFA Delete enabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Destruction;FAIL;S3 Bucket prowler-terraform-state-132410971304 has MFA Delete disabled.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::prowler-terraform-state-132410971304;prowler-terraform-state-132410971304;;;aws;ap-northeast-2;**Amazon S3 buckets** are assessed for **MFA Delete** status. MFA Delete requires a second factor to permanently delete object versions or change `Versioning` configuration. The finding highlights buckets where this protection is not enabled.;"Without **MFA Delete**, a compromised or over-privileged identity can irrevocably purge object history or change versioning.

This erases recovery points, degrading data **availability**, weakening **integrity**, and increasing the blast radius of account compromise or ransomware.";;Enable **MFA Delete** on sensitive, versioned buckets so permanent deletions and `Versioning` changes require a second factor. Apply **least privilege** to restrict version purge actions, enforce **change control**, and combine with **Object Lock** or immutable backups for defense in depth.;https://hub.prowler.com/check/s3_bucket_no_mfa_delete;;;"aws s3api put-bucket-versioning --bucket <BUCKET_NAME> --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa ""<MFA_SERIAL_OR_ARN> <MFA_CODE>""";"1. Sign in to the AWS Management Console as the root user
2. Open the account menu > Security credentials > Multi-factor authentication (MFA) and assign an MFA device; copy its ARN/serial
3. From a machine configured to use the root user credentials, run:

```bash
aws s3api put-bucket-versioning --bucket <BUCKET_NAME> --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa ""<MFA_SERIAL_OR_ARN> <MFA_CODE>""
```";AWS-Well-Architected-Framework-Security-Pillar: SEC05-BP02 | CIS-1.5: 2.1.3 | NIS2: 11.7.2 | CIS-5.0: 2.1.2 | ProwlerThreatScore-1.0: 2.2.1 | KISA-ISMS-P-2023: 2.5.3, 2.10.2 | CIS-1.4: 2.1.3 | C5-2025: AM-07.02B, OPS-16.01B, IAM-04.06B, IAM-09.02B, IAM-09.01AC, PSS-05.01B, PSS-07.02B | CIS-4.0.1: 2.1.2 | AWS-Foundational-Security-Best-Practices: S3.20 | CIS-2.0: 2.1.2 | CIS-3.0: 2.1.2 | MITRE-ATTACK: T1485 | PCI-4.0: 10.3.2.22, 3.5.1.3.27, 8.4.1.5, 8.4.2.5, 8.4.3.5, A1.1.2.18, A3.4.1.20 | KISA-ISMS-P-2023-korean: 2.5.3, 2.10.2;identity-access;;;;5.18.1;https://docs.aws.amazon.com/AmazonS3/latest/userguide/MultiFactorAuthenticationDelete.html | https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingMFADelete.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_object_versioning-132410971304-ap-northeast-2-aws-cloudtrail-logs-132410971304-0971c04b;aws;s3_bucket_object_versioning;S3 bucket has object versioning enabled;Software and Configuration Checks/AWS Security Best Practices | Industry and Regulatory Standards/AWS Foundational Security Best Practices | Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Destruction;FAIL;S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b has versioning disabled.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b;aws-cloudtrail-logs-132410971304-0971c04b;;;aws;ap-northeast-2;**Amazon S3 buckets** are evaluated for **object versioning** being `Enabled`, which maintains multiple versions of the same object key for historical state retention;"Without **versioning**, deletions and overwrites remove the only copy, undermining **availability** and **integrity**.
- Compromised identities or buggy apps can mass-delete/corrupt data
- No historical versions means limited rollback and irrecoverable loss";;"Enable **S3 versioning** for buckets holding important or shared data.
- Enforce **least privilege** to limit delete/overwrite
- Use **Object Lock** and/or **MFA Delete** for stronger protection
- Apply **lifecycle rules** to manage noncurrent versions and costs
- Layer with backups/replication for **defense in depth**";https://hub.prowler.com/check/s3_bucket_object_versioning;"```yaml
# CloudFormation: enable versioning on an S3 bucket
Resources:
  <example_resource_name>:
    Type: AWS::S3::Bucket
    Properties:
      VersioningConfiguration:
        Status: Enabled  # Critical: turns on object versioning to pass the check
```";"```hcl
# Enable versioning on an existing S3 bucket
resource ""aws_s3_bucket_versioning"" ""<example_resource_name>"" {
  bucket = ""<example_resource_name>""
  versioning_configuration {
    status = ""Enabled""  # Critical: enables bucket versioning to remediate the finding
  }
}
```";aws s3api put-bucket-versioning --bucket <BUCKET_NAME> --versioning-configuration Status=Enabled;"1. In the AWS Console, go to S3 > Buckets and select the target bucket
2. Open the Properties tab
3. Find Bucket Versioning and click Edit
4. Select Enable and click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC08-BP04 | ISO27001-2022: A.8.3, A.8.10 | PCI-3.2.1: 3.1, 3.1.c, 10.5, 10.5.2, 10.5.3, 10.5.5 | NIST-800-171-Revision-2: 3_3_8 | NIST-800-53-Revision-4: cp_10, si_12 | CISA: your-systems-3, your-data-4, booting-up-thing-to-do-first-1 | GxP-21-CFR-Part-11: 11.10-a, 11.10-c | NIST-800-53-Revision-5: au_9_2, cp_1_2, cp_2_5, cp_6_a, cp_6_1, cp_6_2, cp_9_a, cp_9_b, cp_9_c, cp_10, cp_10_2, pm_11_b, pm_17_b, sc_5_2, sc_16_1, si_1_a_2, si_13_5 | KISA-ISMS-P-2023: 2.9.3, 2.12.1 | GxP-EU-Annex-11: 5-data, 7.1-data-storage-damage-protection, 7.2-data-storage-backups, 16-business-continuity, 17-archiving, 4.8-validation-data-transfer | FedRamp-Moderate-Revision-4: au-9-2, cp-9-b, cp-10, sc-5, si-12 | C5-2025: OPS-13.01AC, OPS-33.02B, DEV-07.01B | FedRAMP-Low-Revision-4: au-9, cp-9, cp-10, sc-5 | FFIEC: d5-ir-pl-b-6 | SOC2: cc_7_4, cc_a_1_1, cc_c_1_2, pi_1_5 | NIST-CSF-1.1: be_5, ds_4, ip_4, ip_9, pt_5, rp_1, rp_1 | AWS-Audit-Manager-Control-Tower-Guardrails: 5.1.1 | AWS-Foundational-Security-Best-Practices: S3.14 | CCC: CCC.ObjStor.CN03.AR01, CCC.ObjStor.CN03.AR02, CCC.ObjStor.CN04.AR01, CCC.ObjStor.CN05.AR01, CCC.ObjStor.CN05.AR02, CCC.ObjStor.CN05.AR03, CCC.ObjStor.CN05.AR04 | HIPAA: 164_308_a_1_ii_b, 164_308_a_7_i, 164_308_a_7_ii_a, 164_308_a_7_ii_b, 164_308_a_7_ii_c, 164_312_a_2_ii, 164_312_c_1, 164_312_c_2 | RBI-Cyber-Security-Framework: annex_i_12 | MITRE-ATTACK: T1485, T1486 | PCI-4.0: 10.3.4.9 | KISA-ISMS-P-2023-korean: 2.9.3, 2.12.1;resilience;;;;5.18.1;https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/Versioning.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_object_versioning-132410971304-ap-northeast-2-aws-cloudtrail-logs-132410971304-0971c04b-logs;aws;s3_bucket_object_versioning;S3 bucket has object versioning enabled;Software and Configuration Checks/AWS Security Best Practices | Industry and Regulatory Standards/AWS Foundational Security Best Practices | Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Destruction;FAIL;S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b-logs has versioning disabled.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b-logs;aws-cloudtrail-logs-132410971304-0971c04b-logs;;;aws;ap-northeast-2;**Amazon S3 buckets** are evaluated for **object versioning** being `Enabled`, which maintains multiple versions of the same object key for historical state retention;"Without **versioning**, deletions and overwrites remove the only copy, undermining **availability** and **integrity**.
- Compromised identities or buggy apps can mass-delete/corrupt data
- No historical versions means limited rollback and irrecoverable loss";;"Enable **S3 versioning** for buckets holding important or shared data.
- Enforce **least privilege** to limit delete/overwrite
- Use **Object Lock** and/or **MFA Delete** for stronger protection
- Apply **lifecycle rules** to manage noncurrent versions and costs
- Layer with backups/replication for **defense in depth**";https://hub.prowler.com/check/s3_bucket_object_versioning;"```yaml
# CloudFormation: enable versioning on an S3 bucket
Resources:
  <example_resource_name>:
    Type: AWS::S3::Bucket
    Properties:
      VersioningConfiguration:
        Status: Enabled  # Critical: turns on object versioning to pass the check
```";"```hcl
# Enable versioning on an existing S3 bucket
resource ""aws_s3_bucket_versioning"" ""<example_resource_name>"" {
  bucket = ""<example_resource_name>""
  versioning_configuration {
    status = ""Enabled""  # Critical: enables bucket versioning to remediate the finding
  }
}
```";aws s3api put-bucket-versioning --bucket <BUCKET_NAME> --versioning-configuration Status=Enabled;"1. In the AWS Console, go to S3 > Buckets and select the target bucket
2. Open the Properties tab
3. Find Bucket Versioning and click Edit
4. Select Enable and click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC08-BP04 | ISO27001-2022: A.8.3, A.8.10 | PCI-3.2.1: 3.1, 3.1.c, 10.5, 10.5.2, 10.5.3, 10.5.5 | NIST-800-171-Revision-2: 3_3_8 | NIST-800-53-Revision-4: cp_10, si_12 | CISA: your-systems-3, your-data-4, booting-up-thing-to-do-first-1 | GxP-21-CFR-Part-11: 11.10-a, 11.10-c | NIST-800-53-Revision-5: au_9_2, cp_1_2, cp_2_5, cp_6_a, cp_6_1, cp_6_2, cp_9_a, cp_9_b, cp_9_c, cp_10, cp_10_2, pm_11_b, pm_17_b, sc_5_2, sc_16_1, si_1_a_2, si_13_5 | KISA-ISMS-P-2023: 2.9.3, 2.12.1 | GxP-EU-Annex-11: 5-data, 7.1-data-storage-damage-protection, 7.2-data-storage-backups, 16-business-continuity, 17-archiving, 4.8-validation-data-transfer | FedRamp-Moderate-Revision-4: au-9-2, cp-9-b, cp-10, sc-5, si-12 | C5-2025: OPS-13.01AC, OPS-33.02B, DEV-07.01B | FedRAMP-Low-Revision-4: au-9, cp-9, cp-10, sc-5 | FFIEC: d5-ir-pl-b-6 | SOC2: cc_7_4, cc_a_1_1, cc_c_1_2, pi_1_5 | NIST-CSF-1.1: be_5, ds_4, ip_4, ip_9, pt_5, rp_1, rp_1 | AWS-Audit-Manager-Control-Tower-Guardrails: 5.1.1 | AWS-Foundational-Security-Best-Practices: S3.14 | CCC: CCC.ObjStor.CN03.AR01, CCC.ObjStor.CN03.AR02, CCC.ObjStor.CN04.AR01, CCC.ObjStor.CN05.AR01, CCC.ObjStor.CN05.AR02, CCC.ObjStor.CN05.AR03, CCC.ObjStor.CN05.AR04 | HIPAA: 164_308_a_1_ii_b, 164_308_a_7_i, 164_308_a_7_ii_a, 164_308_a_7_ii_b, 164_308_a_7_ii_c, 164_312_a_2_ii, 164_312_c_1, 164_312_c_2 | RBI-Cyber-Security-Framework: annex_i_12 | MITRE-ATTACK: T1485, T1486 | PCI-4.0: 10.3.4.9 | KISA-ISMS-P-2023-korean: 2.9.3, 2.12.1;resilience;;;;5.18.1;https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/Versioning.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_object_versioning-132410971304-ap-northeast-2-prowler-dashboard-132410971304;aws;s3_bucket_object_versioning;S3 bucket has object versioning enabled;Software and Configuration Checks/AWS Security Best Practices | Industry and Regulatory Standards/AWS Foundational Security Best Practices | Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Destruction;FAIL;S3 Bucket prowler-dashboard-132410971304 has versioning disabled.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::prowler-dashboard-132410971304;prowler-dashboard-132410971304;;;aws;ap-northeast-2;**Amazon S3 buckets** are evaluated for **object versioning** being `Enabled`, which maintains multiple versions of the same object key for historical state retention;"Without **versioning**, deletions and overwrites remove the only copy, undermining **availability** and **integrity**.
- Compromised identities or buggy apps can mass-delete/corrupt data
- No historical versions means limited rollback and irrecoverable loss";;"Enable **S3 versioning** for buckets holding important or shared data.
- Enforce **least privilege** to limit delete/overwrite
- Use **Object Lock** and/or **MFA Delete** for stronger protection
- Apply **lifecycle rules** to manage noncurrent versions and costs
- Layer with backups/replication for **defense in depth**";https://hub.prowler.com/check/s3_bucket_object_versioning;"```yaml
# CloudFormation: enable versioning on an S3 bucket
Resources:
  <example_resource_name>:
    Type: AWS::S3::Bucket
    Properties:
      VersioningConfiguration:
        Status: Enabled  # Critical: turns on object versioning to pass the check
```";"```hcl
# Enable versioning on an existing S3 bucket
resource ""aws_s3_bucket_versioning"" ""<example_resource_name>"" {
  bucket = ""<example_resource_name>""
  versioning_configuration {
    status = ""Enabled""  # Critical: enables bucket versioning to remediate the finding
  }
}
```";aws s3api put-bucket-versioning --bucket <BUCKET_NAME> --versioning-configuration Status=Enabled;"1. In the AWS Console, go to S3 > Buckets and select the target bucket
2. Open the Properties tab
3. Find Bucket Versioning and click Edit
4. Select Enable and click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC08-BP04 | ISO27001-2022: A.8.3, A.8.10 | PCI-3.2.1: 3.1, 3.1.c, 10.5, 10.5.2, 10.5.3, 10.5.5 | NIST-800-171-Revision-2: 3_3_8 | NIST-800-53-Revision-4: cp_10, si_12 | CISA: your-systems-3, your-data-4, booting-up-thing-to-do-first-1 | GxP-21-CFR-Part-11: 11.10-a, 11.10-c | NIST-800-53-Revision-5: au_9_2, cp_1_2, cp_2_5, cp_6_a, cp_6_1, cp_6_2, cp_9_a, cp_9_b, cp_9_c, cp_10, cp_10_2, pm_11_b, pm_17_b, sc_5_2, sc_16_1, si_1_a_2, si_13_5 | KISA-ISMS-P-2023: 2.9.3, 2.12.1 | GxP-EU-Annex-11: 5-data, 7.1-data-storage-damage-protection, 7.2-data-storage-backups, 16-business-continuity, 17-archiving, 4.8-validation-data-transfer | FedRamp-Moderate-Revision-4: au-9-2, cp-9-b, cp-10, sc-5, si-12 | C5-2025: OPS-13.01AC, OPS-33.02B, DEV-07.01B | FedRAMP-Low-Revision-4: au-9, cp-9, cp-10, sc-5 | FFIEC: d5-ir-pl-b-6 | SOC2: cc_7_4, cc_a_1_1, cc_c_1_2, pi_1_5 | NIST-CSF-1.1: be_5, ds_4, ip_4, ip_9, pt_5, rp_1, rp_1 | AWS-Audit-Manager-Control-Tower-Guardrails: 5.1.1 | AWS-Foundational-Security-Best-Practices: S3.14 | CCC: CCC.ObjStor.CN03.AR01, CCC.ObjStor.CN03.AR02, CCC.ObjStor.CN04.AR01, CCC.ObjStor.CN05.AR01, CCC.ObjStor.CN05.AR02, CCC.ObjStor.CN05.AR03, CCC.ObjStor.CN05.AR04 | HIPAA: 164_308_a_1_ii_b, 164_308_a_7_i, 164_308_a_7_ii_a, 164_308_a_7_ii_b, 164_308_a_7_ii_c, 164_312_a_2_ii, 164_312_c_1, 164_312_c_2 | RBI-Cyber-Security-Framework: annex_i_12 | MITRE-ATTACK: T1485, T1486 | PCI-4.0: 10.3.4.9 | KISA-ISMS-P-2023-korean: 2.9.3, 2.12.1;resilience;;;;5.18.1;https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/Versioning.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_object_versioning-132410971304-ap-northeast-2-prowler-terraform-state-132410971304;aws;s3_bucket_object_versioning;S3 bucket has object versioning enabled;Software and Configuration Checks/AWS Security Best Practices | Industry and Regulatory Standards/AWS Foundational Security Best Practices | Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Effects/Data Destruction;PASS;S3 Bucket prowler-terraform-state-132410971304 has versioning enabled.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::prowler-terraform-state-132410971304;prowler-terraform-state-132410971304;;;aws;ap-northeast-2;**Amazon S3 buckets** are evaluated for **object versioning** being `Enabled`, which maintains multiple versions of the same object key for historical state retention;"Without **versioning**, deletions and overwrites remove the only copy, undermining **availability** and **integrity**.
- Compromised identities or buggy apps can mass-delete/corrupt data
- No historical versions means limited rollback and irrecoverable loss";;"Enable **S3 versioning** for buckets holding important or shared data.
- Enforce **least privilege** to limit delete/overwrite
- Use **Object Lock** and/or **MFA Delete** for stronger protection
- Apply **lifecycle rules** to manage noncurrent versions and costs
- Layer with backups/replication for **defense in depth**";https://hub.prowler.com/check/s3_bucket_object_versioning;"```yaml
# CloudFormation: enable versioning on an S3 bucket
Resources:
  <example_resource_name>:
    Type: AWS::S3::Bucket
    Properties:
      VersioningConfiguration:
        Status: Enabled  # Critical: turns on object versioning to pass the check
```";"```hcl
# Enable versioning on an existing S3 bucket
resource ""aws_s3_bucket_versioning"" ""<example_resource_name>"" {
  bucket = ""<example_resource_name>""
  versioning_configuration {
    status = ""Enabled""  # Critical: enables bucket versioning to remediate the finding
  }
}
```";aws s3api put-bucket-versioning --bucket <BUCKET_NAME> --versioning-configuration Status=Enabled;"1. In the AWS Console, go to S3 > Buckets and select the target bucket
2. Open the Properties tab
3. Find Bucket Versioning and click Edit
4. Select Enable and click Save changes";AWS-Well-Architected-Framework-Security-Pillar: SEC08-BP04 | ISO27001-2022: A.8.3, A.8.10 | PCI-3.2.1: 3.1, 3.1.c, 10.5, 10.5.2, 10.5.3, 10.5.5 | NIST-800-171-Revision-2: 3_3_8 | NIST-800-53-Revision-4: cp_10, si_12 | CISA: your-systems-3, your-data-4, booting-up-thing-to-do-first-1 | GxP-21-CFR-Part-11: 11.10-a, 11.10-c | NIST-800-53-Revision-5: au_9_2, cp_1_2, cp_2_5, cp_6_a, cp_6_1, cp_6_2, cp_9_a, cp_9_b, cp_9_c, cp_10, cp_10_2, pm_11_b, pm_17_b, sc_5_2, sc_16_1, si_1_a_2, si_13_5 | KISA-ISMS-P-2023: 2.9.3, 2.12.1 | GxP-EU-Annex-11: 5-data, 7.1-data-storage-damage-protection, 7.2-data-storage-backups, 16-business-continuity, 17-archiving, 4.8-validation-data-transfer | FedRamp-Moderate-Revision-4: au-9-2, cp-9-b, cp-10, sc-5, si-12 | C5-2025: OPS-13.01AC, OPS-33.02B, DEV-07.01B | FedRAMP-Low-Revision-4: au-9, cp-9, cp-10, sc-5 | FFIEC: d5-ir-pl-b-6 | SOC2: cc_7_4, cc_a_1_1, cc_c_1_2, pi_1_5 | NIST-CSF-1.1: be_5, ds_4, ip_4, ip_9, pt_5, rp_1, rp_1 | AWS-Audit-Manager-Control-Tower-Guardrails: 5.1.1 | AWS-Foundational-Security-Best-Practices: S3.14 | CCC: CCC.ObjStor.CN03.AR01, CCC.ObjStor.CN03.AR02, CCC.ObjStor.CN04.AR01, CCC.ObjStor.CN05.AR01, CCC.ObjStor.CN05.AR02, CCC.ObjStor.CN05.AR03, CCC.ObjStor.CN05.AR04 | HIPAA: 164_308_a_1_ii_b, 164_308_a_7_i, 164_308_a_7_ii_a, 164_308_a_7_ii_b, 164_308_a_7_ii_c, 164_312_a_2_ii, 164_312_c_1, 164_312_c_2 | RBI-Cyber-Security-Framework: annex_i_12 | MITRE-ATTACK: T1485, T1486 | PCI-4.0: 10.3.4.9 | KISA-ISMS-P-2023-korean: 2.9.3, 2.12.1;resilience;;;;5.18.1;https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/Versioning.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_secure_transport_policy-132410971304-ap-northeast-2-aws-cloudtrail-logs-132410971304-0971c04b;aws;s3_bucket_secure_transport_policy;S3 bucket policy denies requests over insecure transport;Software and Configuration Checks/AWS Security Best Practices/Network Reachability | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;FAIL;S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b allows requests over insecure transport in the bucket policy.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b;aws-cloudtrail-logs-132410971304-0971c04b;;;aws;ap-northeast-2;"**Amazon S3 buckets** are evaluated for a bucket policy that enforces **secure transport** by denying requests when `aws:SecureTransport` is `false`.

Buckets without this explicit denial, or without a policy, are treated as allowing access over insecure transport.";HTTP access exposes object data and auth details to **eavesdropping** and **man-in-the-middle** attacks. Captured **pre-signed URLs** can be replayed to exfiltrate data. Traffic can be intercepted or altered, undermining **confidentiality** and **integrity** of S3 content.;;"Enforce **HTTPS-only** access with a bucket policy that denies requests when `aws:SecureTransport=false`.

Prefer **private access** (VPC endpoints or CloudFront with TLS), avoid S3 website endpoints, apply **least privilege**, use short-lived HTTPS **pre-signed URLs**, and monitor logs for insecure access attempts.";https://hub.prowler.com/check/s3_bucket_secure_transport_policy;"```yaml
# CloudFormation: Deny non-SSL (HTTP) requests to the S3 bucket
Resources:
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket: <example_resource_name>
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Deny
            Principal: ""*""
            Action: s3:*
            Resource: arn:aws:s3:::<example_resource_name>/*
            Condition:
              Bool:
                aws:SecureTransport: ""false""  # Critical: deny requests not using SSL/TLS
```";"```hcl
# Deny non-SSL (HTTP) requests to the S3 bucket
resource ""aws_s3_bucket_policy"" ""policy"" {
  bucket = ""<example_resource_name>""
  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect    = ""Deny""
      Principal = ""*""
      Action    = ""s3:*""
      Resource  = ""arn:aws:s3:::<example_resource_name>/*""
      Condition = {
        Bool = {
          ""aws:SecureTransport"" = ""false"" # Critical: deny requests not using SSL/TLS
        }
      }
    }]
  })
}
```";"aws s3api put-bucket-policy --bucket <example_resource_name> --policy '{""Version"":""2012-10-17"",""Statement"":[{""Effect"":""Deny"",""Principal"":""*"",""Action"":""s3:*"",""Resource"":""arn:aws:s3:::<example_resource_name>/*"",""Condition"":{""Bool"":{""aws:SecureTransport"":""false""}}}]}'";"1. In the AWS Console, go to S3 and open the bucket <example_resource_name>
2. Select the Permissions tab and click Edit in Bucket policy
3. Paste this policy, replacing the bucket name:
   ```
   {
     ""Version"": ""2012-10-17"",
     ""Statement"": [
       {
         ""Effect"": ""Deny"",
         ""Principal"": ""*"",
         ""Action"": ""s3:*"",
         ""Resource"": ""arn:aws:s3:::<example_resource_name>/*"",
         ""Condition"": { ""Bool"": { ""aws:SecureTransport"": ""false"" } }
       }
     ]
   }
   ```
4. Click Save changes
";AWS-Well-Architected-Framework-Security-Pillar: SEC09-BP02 | AWS-Foundational-Technical-Review: S3-001 | CIS-1.5: 2.1.2 | NIST-800-171-Revision-2: 3_1_13, 3_5_10, 3_13_1, 3_13_5, 3_13_8, 3_13_11, 3_13_16 | NIST-800-53-Revision-4: ac_17_2, sc_7, sc_8_1, sc_8 | NIST-CSF-2.0: ds_2, pt_4 | CISA: your-systems-3, your-data-2 | CIS-5.0: 2.1.1 | GxP-21-CFR-Part-11: 11.10-c, 11.30 | NIST-800-53-Revision-5: ac_4, ac_4_22, ac_17_2, ac_24_1, au_9_3, ca_9_b, cm_6_a, cm_9_b, ia_5_1_c, pm_11_b, pm_17_b, sc_7_4_b, sc_7_4_g, sc_7_5, sc_8, sc_8_1, sc_8_2, sc_8_3, sc_8_4, sc_8_5, sc_13_a, sc_16_1, sc_23, si_1_a_2 | GDPR: article_32 | ProwlerThreatScore-1.0: 4.1.1 | KISA-ISMS-P-2023: 2.7.1, 2.10.2 | FedRamp-Moderate-Revision-4: ac-17-2, sc-7, sc-8-1, sc-8, sc-23 | CIS-1.4: 2.1.2 | FedRAMP-Low-Revision-4: ac-17, sc-7 | FFIEC: d3-pc-am-b-12, d3-pc-am-b-13, d3-pc-am-b-15 | ENS-RD2022: mp.com.1.aws.s3.1, mp.com.3.aws.s3.1 | NIST-CSF-1.1: ds_2 | CIS-4.0.1: 2.1.1 | AWS-Foundational-Security-Best-Practices: S3.5 | CIS-2.0: 2.1.1 | CCC: CCC.Core.CN01.AR01, CCC.Core.CN01.AR03, CCC.Core.CN01.AR07, CCC.Core.CN01.AR08 | HIPAA: 164_308_a_1_ii_b, 164_312_a_2_iv, 164_312_c_1, 164_312_c_2, 164_312_e_1, 164_312_e_2_i, 164_312_e_2_ii | CIS-3.0: 2.1.1 | RBI-Cyber-Security-Framework: annex_i_1_3 | MITRE-ATTACK: T1040 | PCI-4.0: 1.2.5.15, 2.2.5.15, 2.2.7.19, 4.2.1.1.27, 4.2.1.19, 8.3.2.49 | KISA-ISMS-P-2023-korean: 2.7.1, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-svc;encryption;;;;5.18.1;https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/S3/secure-transport.html | https://aws.amazon.com/premiumsupport/knowledge-center/s3-bucket-policy-for-config-rule/
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_secure_transport_policy-132410971304-ap-northeast-2-aws-cloudtrail-logs-132410971304-0971c04b-logs;aws;s3_bucket_secure_transport_policy;S3 bucket policy denies requests over insecure transport;Software and Configuration Checks/AWS Security Best Practices/Network Reachability | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;FAIL;S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b-logs does not have a bucket policy, thus it allows HTTP requests.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b-logs;aws-cloudtrail-logs-132410971304-0971c04b-logs;;;aws;ap-northeast-2;"**Amazon S3 buckets** are evaluated for a bucket policy that enforces **secure transport** by denying requests when `aws:SecureTransport` is `false`.

Buckets without this explicit denial, or without a policy, are treated as allowing access over insecure transport.";HTTP access exposes object data and auth details to **eavesdropping** and **man-in-the-middle** attacks. Captured **pre-signed URLs** can be replayed to exfiltrate data. Traffic can be intercepted or altered, undermining **confidentiality** and **integrity** of S3 content.;;"Enforce **HTTPS-only** access with a bucket policy that denies requests when `aws:SecureTransport=false`.

Prefer **private access** (VPC endpoints or CloudFront with TLS), avoid S3 website endpoints, apply **least privilege**, use short-lived HTTPS **pre-signed URLs**, and monitor logs for insecure access attempts.";https://hub.prowler.com/check/s3_bucket_secure_transport_policy;"```yaml
# CloudFormation: Deny non-SSL (HTTP) requests to the S3 bucket
Resources:
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket: <example_resource_name>
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Deny
            Principal: ""*""
            Action: s3:*
            Resource: arn:aws:s3:::<example_resource_name>/*
            Condition:
              Bool:
                aws:SecureTransport: ""false""  # Critical: deny requests not using SSL/TLS
```";"```hcl
# Deny non-SSL (HTTP) requests to the S3 bucket
resource ""aws_s3_bucket_policy"" ""policy"" {
  bucket = ""<example_resource_name>""
  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect    = ""Deny""
      Principal = ""*""
      Action    = ""s3:*""
      Resource  = ""arn:aws:s3:::<example_resource_name>/*""
      Condition = {
        Bool = {
          ""aws:SecureTransport"" = ""false"" # Critical: deny requests not using SSL/TLS
        }
      }
    }]
  })
}
```";"aws s3api put-bucket-policy --bucket <example_resource_name> --policy '{""Version"":""2012-10-17"",""Statement"":[{""Effect"":""Deny"",""Principal"":""*"",""Action"":""s3:*"",""Resource"":""arn:aws:s3:::<example_resource_name>/*"",""Condition"":{""Bool"":{""aws:SecureTransport"":""false""}}}]}'";"1. In the AWS Console, go to S3 and open the bucket <example_resource_name>
2. Select the Permissions tab and click Edit in Bucket policy
3. Paste this policy, replacing the bucket name:
   ```
   {
     ""Version"": ""2012-10-17"",
     ""Statement"": [
       {
         ""Effect"": ""Deny"",
         ""Principal"": ""*"",
         ""Action"": ""s3:*"",
         ""Resource"": ""arn:aws:s3:::<example_resource_name>/*"",
         ""Condition"": { ""Bool"": { ""aws:SecureTransport"": ""false"" } }
       }
     ]
   }
   ```
4. Click Save changes
";AWS-Well-Architected-Framework-Security-Pillar: SEC09-BP02 | AWS-Foundational-Technical-Review: S3-001 | CIS-1.5: 2.1.2 | NIST-800-171-Revision-2: 3_1_13, 3_5_10, 3_13_1, 3_13_5, 3_13_8, 3_13_11, 3_13_16 | NIST-800-53-Revision-4: ac_17_2, sc_7, sc_8_1, sc_8 | NIST-CSF-2.0: ds_2, pt_4 | CISA: your-systems-3, your-data-2 | CIS-5.0: 2.1.1 | GxP-21-CFR-Part-11: 11.10-c, 11.30 | NIST-800-53-Revision-5: ac_4, ac_4_22, ac_17_2, ac_24_1, au_9_3, ca_9_b, cm_6_a, cm_9_b, ia_5_1_c, pm_11_b, pm_17_b, sc_7_4_b, sc_7_4_g, sc_7_5, sc_8, sc_8_1, sc_8_2, sc_8_3, sc_8_4, sc_8_5, sc_13_a, sc_16_1, sc_23, si_1_a_2 | GDPR: article_32 | ProwlerThreatScore-1.0: 4.1.1 | KISA-ISMS-P-2023: 2.7.1, 2.10.2 | FedRamp-Moderate-Revision-4: ac-17-2, sc-7, sc-8-1, sc-8, sc-23 | CIS-1.4: 2.1.2 | FedRAMP-Low-Revision-4: ac-17, sc-7 | FFIEC: d3-pc-am-b-12, d3-pc-am-b-13, d3-pc-am-b-15 | ENS-RD2022: mp.com.1.aws.s3.1, mp.com.3.aws.s3.1 | NIST-CSF-1.1: ds_2 | CIS-4.0.1: 2.1.1 | AWS-Foundational-Security-Best-Practices: S3.5 | CIS-2.0: 2.1.1 | CCC: CCC.Core.CN01.AR01, CCC.Core.CN01.AR03, CCC.Core.CN01.AR07, CCC.Core.CN01.AR08 | HIPAA: 164_308_a_1_ii_b, 164_312_a_2_iv, 164_312_c_1, 164_312_c_2, 164_312_e_1, 164_312_e_2_i, 164_312_e_2_ii | CIS-3.0: 2.1.1 | RBI-Cyber-Security-Framework: annex_i_1_3 | MITRE-ATTACK: T1040 | PCI-4.0: 1.2.5.15, 2.2.5.15, 2.2.7.19, 4.2.1.1.27, 4.2.1.19, 8.3.2.49 | KISA-ISMS-P-2023-korean: 2.7.1, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-svc;encryption;;;;5.18.1;https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/S3/secure-transport.html | https://aws.amazon.com/premiumsupport/knowledge-center/s3-bucket-policy-for-config-rule/
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_secure_transport_policy-132410971304-ap-northeast-2-prowler-dashboard-132410971304;aws;s3_bucket_secure_transport_policy;S3 bucket policy denies requests over insecure transport;Software and Configuration Checks/AWS Security Best Practices/Network Reachability | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;FAIL;S3 Bucket prowler-dashboard-132410971304 does not have a bucket policy, thus it allows HTTP requests.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::prowler-dashboard-132410971304;prowler-dashboard-132410971304;;;aws;ap-northeast-2;"**Amazon S3 buckets** are evaluated for a bucket policy that enforces **secure transport** by denying requests when `aws:SecureTransport` is `false`.

Buckets without this explicit denial, or without a policy, are treated as allowing access over insecure transport.";HTTP access exposes object data and auth details to **eavesdropping** and **man-in-the-middle** attacks. Captured **pre-signed URLs** can be replayed to exfiltrate data. Traffic can be intercepted or altered, undermining **confidentiality** and **integrity** of S3 content.;;"Enforce **HTTPS-only** access with a bucket policy that denies requests when `aws:SecureTransport=false`.

Prefer **private access** (VPC endpoints or CloudFront with TLS), avoid S3 website endpoints, apply **least privilege**, use short-lived HTTPS **pre-signed URLs**, and monitor logs for insecure access attempts.";https://hub.prowler.com/check/s3_bucket_secure_transport_policy;"```yaml
# CloudFormation: Deny non-SSL (HTTP) requests to the S3 bucket
Resources:
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket: <example_resource_name>
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Deny
            Principal: ""*""
            Action: s3:*
            Resource: arn:aws:s3:::<example_resource_name>/*
            Condition:
              Bool:
                aws:SecureTransport: ""false""  # Critical: deny requests not using SSL/TLS
```";"```hcl
# Deny non-SSL (HTTP) requests to the S3 bucket
resource ""aws_s3_bucket_policy"" ""policy"" {
  bucket = ""<example_resource_name>""
  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect    = ""Deny""
      Principal = ""*""
      Action    = ""s3:*""
      Resource  = ""arn:aws:s3:::<example_resource_name>/*""
      Condition = {
        Bool = {
          ""aws:SecureTransport"" = ""false"" # Critical: deny requests not using SSL/TLS
        }
      }
    }]
  })
}
```";"aws s3api put-bucket-policy --bucket <example_resource_name> --policy '{""Version"":""2012-10-17"",""Statement"":[{""Effect"":""Deny"",""Principal"":""*"",""Action"":""s3:*"",""Resource"":""arn:aws:s3:::<example_resource_name>/*"",""Condition"":{""Bool"":{""aws:SecureTransport"":""false""}}}]}'";"1. In the AWS Console, go to S3 and open the bucket <example_resource_name>
2. Select the Permissions tab and click Edit in Bucket policy
3. Paste this policy, replacing the bucket name:
   ```
   {
     ""Version"": ""2012-10-17"",
     ""Statement"": [
       {
         ""Effect"": ""Deny"",
         ""Principal"": ""*"",
         ""Action"": ""s3:*"",
         ""Resource"": ""arn:aws:s3:::<example_resource_name>/*"",
         ""Condition"": { ""Bool"": { ""aws:SecureTransport"": ""false"" } }
       }
     ]
   }
   ```
4. Click Save changes
";AWS-Well-Architected-Framework-Security-Pillar: SEC09-BP02 | AWS-Foundational-Technical-Review: S3-001 | CIS-1.5: 2.1.2 | NIST-800-171-Revision-2: 3_1_13, 3_5_10, 3_13_1, 3_13_5, 3_13_8, 3_13_11, 3_13_16 | NIST-800-53-Revision-4: ac_17_2, sc_7, sc_8_1, sc_8 | NIST-CSF-2.0: ds_2, pt_4 | CISA: your-systems-3, your-data-2 | CIS-5.0: 2.1.1 | GxP-21-CFR-Part-11: 11.10-c, 11.30 | NIST-800-53-Revision-5: ac_4, ac_4_22, ac_17_2, ac_24_1, au_9_3, ca_9_b, cm_6_a, cm_9_b, ia_5_1_c, pm_11_b, pm_17_b, sc_7_4_b, sc_7_4_g, sc_7_5, sc_8, sc_8_1, sc_8_2, sc_8_3, sc_8_4, sc_8_5, sc_13_a, sc_16_1, sc_23, si_1_a_2 | GDPR: article_32 | ProwlerThreatScore-1.0: 4.1.1 | KISA-ISMS-P-2023: 2.7.1, 2.10.2 | FedRamp-Moderate-Revision-4: ac-17-2, sc-7, sc-8-1, sc-8, sc-23 | CIS-1.4: 2.1.2 | FedRAMP-Low-Revision-4: ac-17, sc-7 | FFIEC: d3-pc-am-b-12, d3-pc-am-b-13, d3-pc-am-b-15 | ENS-RD2022: mp.com.1.aws.s3.1, mp.com.3.aws.s3.1 | NIST-CSF-1.1: ds_2 | CIS-4.0.1: 2.1.1 | AWS-Foundational-Security-Best-Practices: S3.5 | CIS-2.0: 2.1.1 | CCC: CCC.Core.CN01.AR01, CCC.Core.CN01.AR03, CCC.Core.CN01.AR07, CCC.Core.CN01.AR08 | HIPAA: 164_308_a_1_ii_b, 164_312_a_2_iv, 164_312_c_1, 164_312_c_2, 164_312_e_1, 164_312_e_2_i, 164_312_e_2_ii | CIS-3.0: 2.1.1 | RBI-Cyber-Security-Framework: annex_i_1_3 | MITRE-ATTACK: T1040 | PCI-4.0: 1.2.5.15, 2.2.5.15, 2.2.7.19, 4.2.1.1.27, 4.2.1.19, 8.3.2.49 | KISA-ISMS-P-2023-korean: 2.7.1, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-svc;encryption;;;;5.18.1;https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/S3/secure-transport.html | https://aws.amazon.com/premiumsupport/knowledge-center/s3-bucket-policy-for-config-rule/
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_secure_transport_policy-132410971304-ap-northeast-2-prowler-terraform-state-132410971304;aws;s3_bucket_secure_transport_policy;S3 bucket policy denies requests over insecure transport;Software and Configuration Checks/AWS Security Best Practices/Network Reachability | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;FAIL;S3 Bucket prowler-terraform-state-132410971304 does not have a bucket policy, thus it allows HTTP requests.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::prowler-terraform-state-132410971304;prowler-terraform-state-132410971304;;;aws;ap-northeast-2;"**Amazon S3 buckets** are evaluated for a bucket policy that enforces **secure transport** by denying requests when `aws:SecureTransport` is `false`.

Buckets without this explicit denial, or without a policy, are treated as allowing access over insecure transport.";HTTP access exposes object data and auth details to **eavesdropping** and **man-in-the-middle** attacks. Captured **pre-signed URLs** can be replayed to exfiltrate data. Traffic can be intercepted or altered, undermining **confidentiality** and **integrity** of S3 content.;;"Enforce **HTTPS-only** access with a bucket policy that denies requests when `aws:SecureTransport=false`.

Prefer **private access** (VPC endpoints or CloudFront with TLS), avoid S3 website endpoints, apply **least privilege**, use short-lived HTTPS **pre-signed URLs**, and monitor logs for insecure access attempts.";https://hub.prowler.com/check/s3_bucket_secure_transport_policy;"```yaml
# CloudFormation: Deny non-SSL (HTTP) requests to the S3 bucket
Resources:
  BucketPolicy:
    Type: AWS::S3::BucketPolicy
    Properties:
      Bucket: <example_resource_name>
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Deny
            Principal: ""*""
            Action: s3:*
            Resource: arn:aws:s3:::<example_resource_name>/*
            Condition:
              Bool:
                aws:SecureTransport: ""false""  # Critical: deny requests not using SSL/TLS
```";"```hcl
# Deny non-SSL (HTTP) requests to the S3 bucket
resource ""aws_s3_bucket_policy"" ""policy"" {
  bucket = ""<example_resource_name>""
  policy = jsonencode({
    Version   = ""2012-10-17""
    Statement = [{
      Effect    = ""Deny""
      Principal = ""*""
      Action    = ""s3:*""
      Resource  = ""arn:aws:s3:::<example_resource_name>/*""
      Condition = {
        Bool = {
          ""aws:SecureTransport"" = ""false"" # Critical: deny requests not using SSL/TLS
        }
      }
    }]
  })
}
```";"aws s3api put-bucket-policy --bucket <example_resource_name> --policy '{""Version"":""2012-10-17"",""Statement"":[{""Effect"":""Deny"",""Principal"":""*"",""Action"":""s3:*"",""Resource"":""arn:aws:s3:::<example_resource_name>/*"",""Condition"":{""Bool"":{""aws:SecureTransport"":""false""}}}]}'";"1. In the AWS Console, go to S3 and open the bucket <example_resource_name>
2. Select the Permissions tab and click Edit in Bucket policy
3. Paste this policy, replacing the bucket name:
   ```
   {
     ""Version"": ""2012-10-17"",
     ""Statement"": [
       {
         ""Effect"": ""Deny"",
         ""Principal"": ""*"",
         ""Action"": ""s3:*"",
         ""Resource"": ""arn:aws:s3:::<example_resource_name>/*"",
         ""Condition"": { ""Bool"": { ""aws:SecureTransport"": ""false"" } }
       }
     ]
   }
   ```
4. Click Save changes
";AWS-Well-Architected-Framework-Security-Pillar: SEC09-BP02 | AWS-Foundational-Technical-Review: S3-001 | CIS-1.5: 2.1.2 | NIST-800-171-Revision-2: 3_1_13, 3_5_10, 3_13_1, 3_13_5, 3_13_8, 3_13_11, 3_13_16 | NIST-800-53-Revision-4: ac_17_2, sc_7, sc_8_1, sc_8 | NIST-CSF-2.0: ds_2, pt_4 | CISA: your-systems-3, your-data-2 | CIS-5.0: 2.1.1 | GxP-21-CFR-Part-11: 11.10-c, 11.30 | NIST-800-53-Revision-5: ac_4, ac_4_22, ac_17_2, ac_24_1, au_9_3, ca_9_b, cm_6_a, cm_9_b, ia_5_1_c, pm_11_b, pm_17_b, sc_7_4_b, sc_7_4_g, sc_7_5, sc_8, sc_8_1, sc_8_2, sc_8_3, sc_8_4, sc_8_5, sc_13_a, sc_16_1, sc_23, si_1_a_2 | GDPR: article_32 | ProwlerThreatScore-1.0: 4.1.1 | KISA-ISMS-P-2023: 2.7.1, 2.10.2 | FedRamp-Moderate-Revision-4: ac-17-2, sc-7, sc-8-1, sc-8, sc-23 | CIS-1.4: 2.1.2 | FedRAMP-Low-Revision-4: ac-17, sc-7 | FFIEC: d3-pc-am-b-12, d3-pc-am-b-13, d3-pc-am-b-15 | ENS-RD2022: mp.com.1.aws.s3.1, mp.com.3.aws.s3.1 | NIST-CSF-1.1: ds_2 | CIS-4.0.1: 2.1.1 | AWS-Foundational-Security-Best-Practices: S3.5 | CIS-2.0: 2.1.1 | CCC: CCC.Core.CN01.AR01, CCC.Core.CN01.AR03, CCC.Core.CN01.AR07, CCC.Core.CN01.AR08 | HIPAA: 164_308_a_1_ii_b, 164_312_a_2_iv, 164_312_c_1, 164_312_c_2, 164_312_e_1, 164_312_e_2_i, 164_312_e_2_ii | CIS-3.0: 2.1.1 | RBI-Cyber-Security-Framework: annex_i_1_3 | MITRE-ATTACK: T1040 | PCI-4.0: 1.2.5.15, 2.2.5.15, 2.2.7.19, 4.2.1.1.27, 4.2.1.19, 8.3.2.49 | KISA-ISMS-P-2023-korean: 2.7.1, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-svc;encryption;;;;5.18.1;https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/S3/secure-transport.html | https://aws.amazon.com/premiumsupport/knowledge-center/s3-bucket-policy-for-config-rule/
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_server_access_logging_enabled-132410971304-ap-northeast-2-aws-cloudtrail-logs-132410971304-0971c04b;aws;s3_bucket_server_access_logging_enabled;S3 bucket has server access logging enabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;FAIL;S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b has server access logging disabled.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b;aws-cloudtrail-logs-132410971304-0971c04b;;;aws;ap-northeast-2;**Amazon S3 buckets** are evaluated for **server access logging** configured to record access requests and deliver logs to a designated destination bucket.;Without access logs, object reads, writes, and deletions may go untracked, hindering detection of unauthorized access and data exfiltration. This degrades forensic visibility, delays incident response, and weakens evidence integrity, impacting confidentiality and integrity.;;Enable **server access logging** and send logs to a dedicated log bucket with least privilege, retention, and monitoring. Complement with **CloudTrail data events** for object-level visibility. Apply **defense in depth** by centralizing logs and protecting them from tampering.;https://hub.prowler.com/check/s3_bucket_server_access_logging_enabled;"```yaml
Resources:
  <example_resource_name>:
    Type: AWS::S3::Bucket
    Properties:
      LoggingConfiguration:
        DestinationBucketName: <example_resource_id>  # CRITICAL: Enables server access logging by sending logs to this bucket
```";"```hcl
resource ""aws_s3_bucket_logging"" ""<example_resource_name>"" {
  bucket        = ""<example_bucket_name>""
  target_bucket = ""<example_log_bucket_name>""  # CRITICAL: Enables server access logging by specifying the target bucket
}
```";"aws s3api put-bucket-logging --bucket <BUCKET_NAME> --bucket-logging-status '{""LoggingEnabled"":{""TargetBucket"":""<LOG_BUCKET>"",""TargetPrefix"":""logs/""}}'";"1. Open the AWS Management Console and go to S3
2. Select the bucket with the finding
3. Go to the Properties tab
4. In Server access logging, click Edit
5. Toggle Enable, choose the target log bucket, and Save";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP01 | ISO27001-2022: A.8.15 | AWS-Foundational-Technical-Review: S3-001 | PCI-3.2.1: 10.1, 10.2, 10.2.1, 10.2.2, 10.2.3, 10.2.4, 10.2.6, 10.2.7, 10.3, 10.3.1, 10.3.2, 10.3.3, 10.3.4, 10.3.5, 10.3.6, 10.5, 10.5.4 | NIS2: 1.1.1.h, 3.2.3.c, 11.2.2.f | NIST-800-171-Revision-2: 3_1_12, 3_3_1, 3_3_2, 3_3_3, 3_6_1, 3_6_2, 3_13_1, 3_14_6, 3_14_7 | NIST-800-53-Revision-4: ac_2, au_2, au_3, au_12 | CISA: your-systems-3, your-data-2 | GxP-21-CFR-Part-11: 11.10-e, 11.10-k | NIST-800-53-Revision-5: ac_2_4, ac_3_1, ac_3_10, ac_4_26, ac_6_9, au_2_b, au_3_a, au_3_b, au_3_c, au_3_d, au_3_e, au_3_f, au_6_3, au_6_4, au_6_6, au_6_9, au_8_b, au_10, au_12_a, au_12_c, au_12_1, au_12_2, au_12_3, au_12_4, au_14_a, au_14_b, au_14_3, ca_7_b, cm_5_1_b, cm_6_a, cm_9_b, ia_3_3_b, ma_4_1_a, pm_14_a_1, pm_14_b, pm_31, sc_7_9_b, si_1_1_c, si_3_8_b, si_4_2, si_4_17, si_4_20, si_7_8, si_10_1_c | KISA-ISMS-P-2023: 2.9.4, 2.10.2 | FedRamp-Moderate-Revision-4: ac-2-4, ac-2-g, au-2-a-d, au-3, au-6-1-3, au-12-a-c | C5-2025: AM-01.01AC, OPS-11.02AC, OPS-15.01B, OPS-15.02B, OPS-15.03B, OPS-15.01AC, OPS-26.05B, OPS-26.01AS, IAM-06.04B, IAM-07.04B, IAM-10.01B, SSO-05.01AC, PSS-04.05B | FedRAMP-Low-Revision-4: ac-2, au-2 | FFIEC: d2-ma-ma-b-1, d2-ma-ma-b-2, d3-dc-an-b-3, d3-dc-an-b-4, d5-dr-de-b-3 | SOC2: cc_7_2, cc_7_3, cc_a_1_1 | NIST-CSF-1.1: ae_1, ae_3, ae_4, cm_1, cm_3, cm_6, cm_7, am_3, ac_6, ds_5, pt_1 | AWS-Foundational-Security-Best-Practices: S3.9 | CCC: CCC.AuditLog.CN04.AR01, CCC.ObjStor.CN06.AR01, CCC.Core.CN09.AR03 | HIPAA: 164_308_a_1_ii_d, 164_308_a_3_ii_a, 164_308_a_6_ii, 164_312_b, 164_312_e_2_i | RBI-Cyber-Security-Framework: annex_i_7_4 | PCI-4.0: 10.2.1.1.30, 10.2.1.2.27, 10.2.1.3.27, 10.2.1.4.27, 10.2.1.5.27, 10.2.1.6.27, 10.2.1.7.27, 10.2.1.27, 10.2.2.27, 10.3.1.27, 10.6.3.34, 5.3.4.32, A1.2.1.32 | KISA-ISMS-P-2023-korean: 2.9.4, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-mla;logging | forensics-ready;;;;5.18.1;https://docs.amazonaws.cn/en_us/config/latest/developerguide/s3-bucket-logging-enabled.html | https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_server_access_logging_enabled-132410971304-ap-northeast-2-aws-cloudtrail-logs-132410971304-0971c04b-logs;aws;s3_bucket_server_access_logging_enabled;S3 bucket has server access logging enabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;FAIL;S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b-logs has server access logging disabled.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b-logs;aws-cloudtrail-logs-132410971304-0971c04b-logs;;;aws;ap-northeast-2;**Amazon S3 buckets** are evaluated for **server access logging** configured to record access requests and deliver logs to a designated destination bucket.;Without access logs, object reads, writes, and deletions may go untracked, hindering detection of unauthorized access and data exfiltration. This degrades forensic visibility, delays incident response, and weakens evidence integrity, impacting confidentiality and integrity.;;Enable **server access logging** and send logs to a dedicated log bucket with least privilege, retention, and monitoring. Complement with **CloudTrail data events** for object-level visibility. Apply **defense in depth** by centralizing logs and protecting them from tampering.;https://hub.prowler.com/check/s3_bucket_server_access_logging_enabled;"```yaml
Resources:
  <example_resource_name>:
    Type: AWS::S3::Bucket
    Properties:
      LoggingConfiguration:
        DestinationBucketName: <example_resource_id>  # CRITICAL: Enables server access logging by sending logs to this bucket
```";"```hcl
resource ""aws_s3_bucket_logging"" ""<example_resource_name>"" {
  bucket        = ""<example_bucket_name>""
  target_bucket = ""<example_log_bucket_name>""  # CRITICAL: Enables server access logging by specifying the target bucket
}
```";"aws s3api put-bucket-logging --bucket <BUCKET_NAME> --bucket-logging-status '{""LoggingEnabled"":{""TargetBucket"":""<LOG_BUCKET>"",""TargetPrefix"":""logs/""}}'";"1. Open the AWS Management Console and go to S3
2. Select the bucket with the finding
3. Go to the Properties tab
4. In Server access logging, click Edit
5. Toggle Enable, choose the target log bucket, and Save";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP01 | ISO27001-2022: A.8.15 | AWS-Foundational-Technical-Review: S3-001 | PCI-3.2.1: 10.1, 10.2, 10.2.1, 10.2.2, 10.2.3, 10.2.4, 10.2.6, 10.2.7, 10.3, 10.3.1, 10.3.2, 10.3.3, 10.3.4, 10.3.5, 10.3.6, 10.5, 10.5.4 | NIS2: 1.1.1.h, 3.2.3.c, 11.2.2.f | NIST-800-171-Revision-2: 3_1_12, 3_3_1, 3_3_2, 3_3_3, 3_6_1, 3_6_2, 3_13_1, 3_14_6, 3_14_7 | NIST-800-53-Revision-4: ac_2, au_2, au_3, au_12 | CISA: your-systems-3, your-data-2 | GxP-21-CFR-Part-11: 11.10-e, 11.10-k | NIST-800-53-Revision-5: ac_2_4, ac_3_1, ac_3_10, ac_4_26, ac_6_9, au_2_b, au_3_a, au_3_b, au_3_c, au_3_d, au_3_e, au_3_f, au_6_3, au_6_4, au_6_6, au_6_9, au_8_b, au_10, au_12_a, au_12_c, au_12_1, au_12_2, au_12_3, au_12_4, au_14_a, au_14_b, au_14_3, ca_7_b, cm_5_1_b, cm_6_a, cm_9_b, ia_3_3_b, ma_4_1_a, pm_14_a_1, pm_14_b, pm_31, sc_7_9_b, si_1_1_c, si_3_8_b, si_4_2, si_4_17, si_4_20, si_7_8, si_10_1_c | KISA-ISMS-P-2023: 2.9.4, 2.10.2 | FedRamp-Moderate-Revision-4: ac-2-4, ac-2-g, au-2-a-d, au-3, au-6-1-3, au-12-a-c | C5-2025: AM-01.01AC, OPS-11.02AC, OPS-15.01B, OPS-15.02B, OPS-15.03B, OPS-15.01AC, OPS-26.05B, OPS-26.01AS, IAM-06.04B, IAM-07.04B, IAM-10.01B, SSO-05.01AC, PSS-04.05B | FedRAMP-Low-Revision-4: ac-2, au-2 | FFIEC: d2-ma-ma-b-1, d2-ma-ma-b-2, d3-dc-an-b-3, d3-dc-an-b-4, d5-dr-de-b-3 | SOC2: cc_7_2, cc_7_3, cc_a_1_1 | NIST-CSF-1.1: ae_1, ae_3, ae_4, cm_1, cm_3, cm_6, cm_7, am_3, ac_6, ds_5, pt_1 | AWS-Foundational-Security-Best-Practices: S3.9 | CCC: CCC.AuditLog.CN04.AR01, CCC.ObjStor.CN06.AR01, CCC.Core.CN09.AR03 | HIPAA: 164_308_a_1_ii_d, 164_308_a_3_ii_a, 164_308_a_6_ii, 164_312_b, 164_312_e_2_i | RBI-Cyber-Security-Framework: annex_i_7_4 | PCI-4.0: 10.2.1.1.30, 10.2.1.2.27, 10.2.1.3.27, 10.2.1.4.27, 10.2.1.5.27, 10.2.1.6.27, 10.2.1.7.27, 10.2.1.27, 10.2.2.27, 10.3.1.27, 10.6.3.34, 5.3.4.32, A1.2.1.32 | KISA-ISMS-P-2023-korean: 2.9.4, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-mla;logging | forensics-ready;;;;5.18.1;https://docs.amazonaws.cn/en_us/config/latest/developerguide/s3-bucket-logging-enabled.html | https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_server_access_logging_enabled-132410971304-ap-northeast-2-prowler-dashboard-132410971304;aws;s3_bucket_server_access_logging_enabled;S3 bucket has server access logging enabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;FAIL;S3 Bucket prowler-dashboard-132410971304 has server access logging disabled.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::prowler-dashboard-132410971304;prowler-dashboard-132410971304;;;aws;ap-northeast-2;**Amazon S3 buckets** are evaluated for **server access logging** configured to record access requests and deliver logs to a designated destination bucket.;Without access logs, object reads, writes, and deletions may go untracked, hindering detection of unauthorized access and data exfiltration. This degrades forensic visibility, delays incident response, and weakens evidence integrity, impacting confidentiality and integrity.;;Enable **server access logging** and send logs to a dedicated log bucket with least privilege, retention, and monitoring. Complement with **CloudTrail data events** for object-level visibility. Apply **defense in depth** by centralizing logs and protecting them from tampering.;https://hub.prowler.com/check/s3_bucket_server_access_logging_enabled;"```yaml
Resources:
  <example_resource_name>:
    Type: AWS::S3::Bucket
    Properties:
      LoggingConfiguration:
        DestinationBucketName: <example_resource_id>  # CRITICAL: Enables server access logging by sending logs to this bucket
```";"```hcl
resource ""aws_s3_bucket_logging"" ""<example_resource_name>"" {
  bucket        = ""<example_bucket_name>""
  target_bucket = ""<example_log_bucket_name>""  # CRITICAL: Enables server access logging by specifying the target bucket
}
```";"aws s3api put-bucket-logging --bucket <BUCKET_NAME> --bucket-logging-status '{""LoggingEnabled"":{""TargetBucket"":""<LOG_BUCKET>"",""TargetPrefix"":""logs/""}}'";"1. Open the AWS Management Console and go to S3
2. Select the bucket with the finding
3. Go to the Properties tab
4. In Server access logging, click Edit
5. Toggle Enable, choose the target log bucket, and Save";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP01 | ISO27001-2022: A.8.15 | AWS-Foundational-Technical-Review: S3-001 | PCI-3.2.1: 10.1, 10.2, 10.2.1, 10.2.2, 10.2.3, 10.2.4, 10.2.6, 10.2.7, 10.3, 10.3.1, 10.3.2, 10.3.3, 10.3.4, 10.3.5, 10.3.6, 10.5, 10.5.4 | NIS2: 1.1.1.h, 3.2.3.c, 11.2.2.f | NIST-800-171-Revision-2: 3_1_12, 3_3_1, 3_3_2, 3_3_3, 3_6_1, 3_6_2, 3_13_1, 3_14_6, 3_14_7 | NIST-800-53-Revision-4: ac_2, au_2, au_3, au_12 | CISA: your-systems-3, your-data-2 | GxP-21-CFR-Part-11: 11.10-e, 11.10-k | NIST-800-53-Revision-5: ac_2_4, ac_3_1, ac_3_10, ac_4_26, ac_6_9, au_2_b, au_3_a, au_3_b, au_3_c, au_3_d, au_3_e, au_3_f, au_6_3, au_6_4, au_6_6, au_6_9, au_8_b, au_10, au_12_a, au_12_c, au_12_1, au_12_2, au_12_3, au_12_4, au_14_a, au_14_b, au_14_3, ca_7_b, cm_5_1_b, cm_6_a, cm_9_b, ia_3_3_b, ma_4_1_a, pm_14_a_1, pm_14_b, pm_31, sc_7_9_b, si_1_1_c, si_3_8_b, si_4_2, si_4_17, si_4_20, si_7_8, si_10_1_c | KISA-ISMS-P-2023: 2.9.4, 2.10.2 | FedRamp-Moderate-Revision-4: ac-2-4, ac-2-g, au-2-a-d, au-3, au-6-1-3, au-12-a-c | C5-2025: AM-01.01AC, OPS-11.02AC, OPS-15.01B, OPS-15.02B, OPS-15.03B, OPS-15.01AC, OPS-26.05B, OPS-26.01AS, IAM-06.04B, IAM-07.04B, IAM-10.01B, SSO-05.01AC, PSS-04.05B | FedRAMP-Low-Revision-4: ac-2, au-2 | FFIEC: d2-ma-ma-b-1, d2-ma-ma-b-2, d3-dc-an-b-3, d3-dc-an-b-4, d5-dr-de-b-3 | SOC2: cc_7_2, cc_7_3, cc_a_1_1 | NIST-CSF-1.1: ae_1, ae_3, ae_4, cm_1, cm_3, cm_6, cm_7, am_3, ac_6, ds_5, pt_1 | AWS-Foundational-Security-Best-Practices: S3.9 | CCC: CCC.AuditLog.CN04.AR01, CCC.ObjStor.CN06.AR01, CCC.Core.CN09.AR03 | HIPAA: 164_308_a_1_ii_d, 164_308_a_3_ii_a, 164_308_a_6_ii, 164_312_b, 164_312_e_2_i | RBI-Cyber-Security-Framework: annex_i_7_4 | PCI-4.0: 10.2.1.1.30, 10.2.1.2.27, 10.2.1.3.27, 10.2.1.4.27, 10.2.1.5.27, 10.2.1.6.27, 10.2.1.7.27, 10.2.1.27, 10.2.2.27, 10.3.1.27, 10.6.3.34, 5.3.4.32, A1.2.1.32 | KISA-ISMS-P-2023-korean: 2.9.4, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-mla;logging | forensics-ready;;;;5.18.1;https://docs.amazonaws.cn/en_us/config/latest/developerguide/s3-bucket-logging-enabled.html | https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-s3_bucket_server_access_logging_enabled-132410971304-ap-northeast-2-prowler-terraform-state-132410971304;aws;s3_bucket_server_access_logging_enabled;S3 bucket has server access logging enabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark;FAIL;S3 Bucket prowler-terraform-state-132410971304 has server access logging disabled.;False;s3;;medium;AwsS3Bucket;arn:aws:s3:::prowler-terraform-state-132410971304;prowler-terraform-state-132410971304;;;aws;ap-northeast-2;**Amazon S3 buckets** are evaluated for **server access logging** configured to record access requests and deliver logs to a designated destination bucket.;Without access logs, object reads, writes, and deletions may go untracked, hindering detection of unauthorized access and data exfiltration. This degrades forensic visibility, delays incident response, and weakens evidence integrity, impacting confidentiality and integrity.;;Enable **server access logging** and send logs to a dedicated log bucket with least privilege, retention, and monitoring. Complement with **CloudTrail data events** for object-level visibility. Apply **defense in depth** by centralizing logs and protecting them from tampering.;https://hub.prowler.com/check/s3_bucket_server_access_logging_enabled;"```yaml
Resources:
  <example_resource_name>:
    Type: AWS::S3::Bucket
    Properties:
      LoggingConfiguration:
        DestinationBucketName: <example_resource_id>  # CRITICAL: Enables server access logging by sending logs to this bucket
```";"```hcl
resource ""aws_s3_bucket_logging"" ""<example_resource_name>"" {
  bucket        = ""<example_bucket_name>""
  target_bucket = ""<example_log_bucket_name>""  # CRITICAL: Enables server access logging by specifying the target bucket
}
```";"aws s3api put-bucket-logging --bucket <BUCKET_NAME> --bucket-logging-status '{""LoggingEnabled"":{""TargetBucket"":""<LOG_BUCKET>"",""TargetPrefix"":""logs/""}}'";"1. Open the AWS Management Console and go to S3
2. Select the bucket with the finding
3. Go to the Properties tab
4. In Server access logging, click Edit
5. Toggle Enable, choose the target log bucket, and Save";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP01 | ISO27001-2022: A.8.15 | AWS-Foundational-Technical-Review: S3-001 | PCI-3.2.1: 10.1, 10.2, 10.2.1, 10.2.2, 10.2.3, 10.2.4, 10.2.6, 10.2.7, 10.3, 10.3.1, 10.3.2, 10.3.3, 10.3.4, 10.3.5, 10.3.6, 10.5, 10.5.4 | NIS2: 1.1.1.h, 3.2.3.c, 11.2.2.f | NIST-800-171-Revision-2: 3_1_12, 3_3_1, 3_3_2, 3_3_3, 3_6_1, 3_6_2, 3_13_1, 3_14_6, 3_14_7 | NIST-800-53-Revision-4: ac_2, au_2, au_3, au_12 | CISA: your-systems-3, your-data-2 | GxP-21-CFR-Part-11: 11.10-e, 11.10-k | NIST-800-53-Revision-5: ac_2_4, ac_3_1, ac_3_10, ac_4_26, ac_6_9, au_2_b, au_3_a, au_3_b, au_3_c, au_3_d, au_3_e, au_3_f, au_6_3, au_6_4, au_6_6, au_6_9, au_8_b, au_10, au_12_a, au_12_c, au_12_1, au_12_2, au_12_3, au_12_4, au_14_a, au_14_b, au_14_3, ca_7_b, cm_5_1_b, cm_6_a, cm_9_b, ia_3_3_b, ma_4_1_a, pm_14_a_1, pm_14_b, pm_31, sc_7_9_b, si_1_1_c, si_3_8_b, si_4_2, si_4_17, si_4_20, si_7_8, si_10_1_c | KISA-ISMS-P-2023: 2.9.4, 2.10.2 | FedRamp-Moderate-Revision-4: ac-2-4, ac-2-g, au-2-a-d, au-3, au-6-1-3, au-12-a-c | C5-2025: AM-01.01AC, OPS-11.02AC, OPS-15.01B, OPS-15.02B, OPS-15.03B, OPS-15.01AC, OPS-26.05B, OPS-26.01AS, IAM-06.04B, IAM-07.04B, IAM-10.01B, SSO-05.01AC, PSS-04.05B | FedRAMP-Low-Revision-4: ac-2, au-2 | FFIEC: d2-ma-ma-b-1, d2-ma-ma-b-2, d3-dc-an-b-3, d3-dc-an-b-4, d5-dr-de-b-3 | SOC2: cc_7_2, cc_7_3, cc_a_1_1 | NIST-CSF-1.1: ae_1, ae_3, ae_4, cm_1, cm_3, cm_6, cm_7, am_3, ac_6, ds_5, pt_1 | AWS-Foundational-Security-Best-Practices: S3.9 | CCC: CCC.AuditLog.CN04.AR01, CCC.ObjStor.CN06.AR01, CCC.Core.CN09.AR03 | HIPAA: 164_308_a_1_ii_d, 164_308_a_3_ii_a, 164_308_a_6_ii, 164_312_b, 164_312_e_2_i | RBI-Cyber-Security-Framework: annex_i_7_4 | PCI-4.0: 10.2.1.1.30, 10.2.1.2.27, 10.2.1.3.27, 10.2.1.4.27, 10.2.1.5.27, 10.2.1.6.27, 10.2.1.7.27, 10.2.1.27, 10.2.2.27, 10.3.1.27, 10.6.3.34, 5.3.4.32, A1.2.1.32 | KISA-ISMS-P-2023-korean: 2.9.4, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-mla;logging | forensics-ready;;;;5.18.1;https://docs.amazonaws.cn/en_us/config/latest/developerguide/s3-bucket-logging-enabled.html | https://docs.aws.amazon.com/AmazonS3/latest/dev/security-best-practices.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-vpc_different_regions-132410971304-ap-northeast-2-132410971304;aws;vpc_different_regions;VPCs are present in more than one region;Software and Configuration Checks/AWS Security Best Practices | Effects/Denial of Service;FAIL;VPCs found only in one region.;False;vpc;;medium;AwsEc2Vpc;arn:aws:ec2:ap-northeast-2:132410971304:vpc;132410971304;;;aws;ap-northeast-2;Non-default **VPCs** are evaluated across the account to determine whether they exist in **more than one region**. The result reflects if your custom network topology is regionally distributed or concentrated in a single region.;Single-region VPC deployment weakens **availability** and **resilience**. A regional outage, service disruption, or network control misconfiguration can cause broad downtime, hinder recovery, and increase the **blast radius** of incidents impacting business continuity.;;"Adopt a **multi-region network design**:
- Create VPCs in at least two regions for critical workloads
- Replicate routing, security controls, and endpoints consistently
- Apply **fault tolerance** and **defense in depth** with data replication and resilient DNS/failover to avoid single-region dependency";https://hub.prowler.com/check/vpc_different_regions;"```yaml
# Deploy this stack in a second AWS region to pass the check
Resources:
  <example_resource_name>:
    Type: AWS::EC2::VPC
    Properties:
      CidrBlock: 10.0.0.0/16  # Critical: creates a non-default VPC in this region
```";"```hcl
provider ""aws"" {
  alias  = ""other""
  region = ""<OTHER_REGION>"" # Critical: ensures the VPC is created in a second region
}

resource ""aws_vpc"" ""<example_resource_name>"" {
  provider   = aws.other
  cidr_block = ""10.0.0.0/16"" # Critical: creates a non-default VPC in that region
}
```";aws ec2 create-vpc --region <OTHER_REGION> --cidr-block <CIDR_BLOCK>;"1. Open the AWS Console and go to VPC
2. In the Region selector (top right), choose a different region than your existing non-default VPCs
3. Click Create VPC > VPC only
4. Enter an IPv4 CIDR block (e.g., 10.0.0.0/16)
5. Click Create VPC
6. Verify a non-default VPC now exists in this second region";ISO27001-2022: A.8.20, A.8.21, A.8.22 | KISA-ISMS-P-2023: 2.9.2 | C5-2025: PS-02.01B, PS-02.01AS, PS-02.02AS | ENS-RD2022: mp.com.4.r1.aws.vpc.1, mp.com.4.r3.aws.vpc.1 | KISA-ISMS-P-2023-korean: 2.9.2;resilience;;;;5.18.1;https://docs.aws.amazon.com/vpc/latest/userguide/vpc-example-private-subnets-nat.html | https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Scenario2.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-vpc_endpoint_for_ec2_enabled-132410971304-ap-northeast-2-vpc-0565167ce4f7cc871;aws;vpc_endpoint_for_ec2_enabled;VPC has an Amazon EC2 VPC endpoint;Software and Configuration Checks/AWS Security Best Practices/Network Reachability;FAIL;VPC vpc-0565167ce4f7cc871 has no EC2 endpoint.;False;vpc;;medium;AwsEc2VpcEndpointService;arn:aws:ec2:ap-northeast-2:132410971304:vpc/vpc-0565167ce4f7cc871;vpc-0565167ce4f7cc871;;;aws;ap-northeast-2;**Amazon VPCs** are evaluated for an **interface VPC endpoint** to the **Amazon EC2 API** (`ec2`). Its presence indicates private EC2 API connectivity over **AWS PrivateLink** within the VPC.;Without a private EC2 endpoint, EC2 API traffic exits via IGW/NAT. This expands exposure to network path threats (e.g., DNS hijack, MITM) and weakens egress isolation. It also adds an internet egress dependency for API access, reducing availability if NAT/edge paths fail.;;"Use an **interface VPC endpoint** for the EC2 service in each VPC that requires EC2 API access.
- Enable **private DNS** to keep calls on the AWS network
- Apply restrictive endpoint policies (least privilege)
- Reduce reliance on public egress and layer controls for **defense in depth**";https://hub.prowler.com/check/vpc_endpoint_for_ec2_enabled;"```yaml
# CloudFormation: create an EC2 interface VPC endpoint in the VPC
Resources:
  VPCEndpoint:
    Type: AWS::EC2::VPCEndpoint
    Properties:
      VpcId: ""<example_resource_id>""                 # CRITICAL: target VPC for the endpoint
      ServiceName: !Sub ""com.amazonaws.${AWS::Region}.ec2""  # CRITICAL: EC2 interface endpoint service
      VpcEndpointType: Interface                      # CRITICAL: create an interface endpoint
      SubnetIds:                                      # CRITICAL: subnets to place the endpoint ENIs
        - ""<example_resource_id>""
```";"```hcl
# Create an EC2 interface VPC endpoint
resource ""aws_vpc_endpoint"" ""<example_resource_name>"" {
  vpc_id            = ""<example_resource_id>""           # CRITICAL: target VPC
  service_name      = ""com.amazonaws.<region>.ec2""      # CRITICAL: EC2 interface endpoint service
  vpc_endpoint_type = ""Interface""                       # CRITICAL: interface endpoint
  subnet_ids        = [""<example_resource_id>""]         # CRITICAL: subnet(s) for endpoint ENIs
}
```";aws ec2 create-vpc-endpoint --vpc-id <VPC_ID> --service-name com.amazonaws.<REGION>.ec2 --vpc-endpoint-type Interface --subnet-ids <SUBNET_ID>;"1. In the AWS console, go to VPC > Endpoints
2. Click Create endpoint
3. For Service category, choose AWS services and select Service name com.amazonaws.<region>.ec2
4. Select your VPC and at least one subnet
5. Click Create endpoint";ISO27001-2022: A.8.20, A.8.21, A.8.22 | PCI-3.2.1: 1.3, 2.2, 2.2.2 | NIST-CSF-2.0: ra_5, ae_1 | KISA-ISMS-P-2023: 2.6.1, 2.10.2 | AWS-Foundational-Security-Best-Practices: EC2.10 | CCC: CCC.LB.CN09.AR01, CCC.Core.CN05.AR05 | PCI-4.0: 1.2.8.18, 1.2.8.38, 1.3.1.21, 1.3.1.42, 1.3.2.21, 1.3.2.42, 1.4.1.5, 1.4.2.19, 1.4.2.40, 1.4.4.5, 1.5.1.18, 1.5.1.38, A1.1.3.18, A1.1.3.38 | KISA-ISMS-P-2023-korean: 2.6.1, 2.10.2;internet-exposed | trust-boundaries;;;;5.18.1;https://docs.aws.amazon.com/config/latest/developerguide/service-vpc-endpoint-enabled.html | https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-10 | https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/interface-vpc-endpoints.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-vpc_flow_logs_enabled-132410971304-ap-northeast-2-vpc-0565167ce4f7cc871;aws;vpc_flow_logs_enabled;VPC flow logs are enabled;Software and Configuration Checks/AWS Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/AWS Foundational Security Best Practices | Software and Configuration Checks/Industry and Regulatory Standards/CIS AWS Foundations Benchmark | Software and Configuration Checks/Industry and Regulatory Standards/PCI-DSS | Software and Configuration Checks/Industry and Regulatory Standards/NIST 800-53 Controls (USA) | Software and Configuration Checks/Industry and Regulatory Standards/NIST CSF Controls (USA);FAIL;VPC vpc-0565167ce4f7cc871 Flow logs are disabled.;False;vpc;;medium;AwsEc2Vpc;arn:aws:ec2:ap-northeast-2:132410971304:vpc/vpc-0565167ce4f7cc871;vpc-0565167ce4f7cc871;;;aws;ap-northeast-2;"**AWS VPCs** have **Flow Logs** configured to capture IP traffic for their network interfaces and deliver records to a logging destination.

VPCs lacking an active flow log configuration are highlighted.";"Without flow logs, network activity is opaque, hindering detection and investigation of malicious traffic. Attackers can probe, exfiltrate, or move laterally unnoticed, impacting **confidentiality** and **integrity**; outages and misconfigurations are harder to diagnose, reducing **availability**.";;"Enable **VPC Flow Logs** for all VPCs to provide baseline telemetry.
Prefer capturing at least `REJECT` and, for sensitive networks, `ALL`. Send logs to a centralized, access-controlled destination with retention. Apply **least privilege** to writers/readers and integrate with monitoring for **defense in depth**.";https://hub.prowler.com/check/vpc_flow_logs_enabled;"```yaml
# CloudFormation: Enable VPC Flow Logs to S3 for an existing VPC
Resources:
  FlowLog:
    Type: AWS::EC2::FlowLog
    Properties:
      ResourceId: <example_resource_id>         # Critical: target the VPC ID
      ResourceType: VPC                         # Critical: enable flow logs at VPC level
      TrafficType: ALL                          # Critical: log all traffic
      LogDestinationType: s3                    # Critical: send logs to S3 (no IAM role needed)
      LogDestination: arn:aws:s3:::<example_resource_name>  # Critical: S3 bucket ARN
```";"```hcl
# Enable VPC Flow Logs to S3 for an existing VPC
resource ""aws_flow_log"" ""vpc"" {
  vpc_id               = ""<example_resource_id>""                 # Critical: target the VPC to enable flow logs
  traffic_type         = ""ALL""                                   # Critical: log all traffic
  log_destination_type = ""s3""                                    # Critical: send logs to S3 (no IAM role needed)
  log_destination      = ""arn:aws:s3:::<example_resource_name>""  # Critical: S3 bucket ARN
}
```";aws ec2 create-flow-logs --resource-type VPC --resource-ids <VPC_ID> --traffic-type ALL --log-destination-type s3 --log-destination arn:aws:s3:::<S3_BUCKET_NAME>;"1. In the AWS Console, go to VPC > Your VPCs
2. Select the target VPC
3. Open the Flow logs tab and click Create flow log
4. Set Traffic type to All
5. Set Destination to S3 and enter Bucket ARN: arn:aws:s3:::<example_resource_name>
6. Click Create flow log";AWS-Well-Architected-Framework-Security-Pillar: SEC04-BP01, SEC04-BP02, SEC04-BP03, SEC05-BP04, SEC09-BP04 | ISO27001-2022: A.8.15, A.8.16, A.8.20, A.8.21, A.8.22, A.8.23 | PCI-3.2.1: 4.1, 4.1.e, 4.1.f, 10.1 | CIS-1.5: 3.9 | NIS2: 3.2.3.c | NIST-800-171-Revision-2: 3_3_1, 3_3_3, 3_6_1, 3_6_2, 3_13_1, 3_14_6, 3_14_7 | NIST-800-53-Revision-4: au_2, au_3, au_12 | NIST-CSF-2.0: po_4, pt_1, pt_4, ae_1, cm_1 | CISA: your-surroundings-1, your-data-2 | CIS-5.0: 3.7 | GxP-21-CFR-Part-11: 11.10-e | NIST-800-53-Revision-5: ac_4_26, au_2_b, au_3_a, au_3_b, au_3_c, au_3_d, au_3_e, au_6_3, au_6_4, au_6_6, au_6_9, au_8_b, au_12_a, au_12_c, au_12_1, au_12_2, au_12_3, au_12_4, au_14_a, au_14_b, au_14_3, ca_7_b, cm_5_1_b, cm_6_a, cm_9_b, ia_3_3_b, ma_4_1_a, pm_14_a_1, pm_14_b, pm_31, si_4_17, si_7_8 | GDPR: article_25, article_30 | ProwlerThreatScore-1.0: 3.1.4 | KISA-ISMS-P-2023: 2.9.4, 2.10.2 | FedRamp-Moderate-Revision-4: au-2-a-d, au-3, au-6-1-3, au-12-a-c | CIS-1.4: 3.9 | C5-2025: AM-01.01AC, OPS-11.02AC, OPS-26.05B, OPS-26.01AS | FedRAMP-Low-Revision-4: au-2 | FFIEC: d2-ma-ma-b-1, d2-ma-ma-b-2, d3-dc-an-b-3, d3-dc-an-b-4, d3-dc-ev-b-1, d3-dc-ev-b-3, d3-pc-im-b-3 | ENS-RD2022: op.mon.1.aws.flow.1 | SOC2: cc_7_2, cc_7_3 | NIST-CSF-1.1: ae_1, ae_3, cm_1, cm_7, am_3, ds_5, pt_1 | ISO27001-2013: A.12.4.R | CIS-4.0.1: 3.7 | AWS-Foundational-Security-Best-Practices: EC2.6 | CIS-2.0: 3.9 | CCC: CCC.LB.CN01.AR01, CCC.LB.CN01.AR02, CCC.LB.CN06.AR01, CCC.Logging.CN01.AR01, CCC.Logging.CN01.AR02, CCC.VPC.CN04.AR01, CCC.Core.CN09.AR02, CCC.Core.CN04.AR01, CCC.Core.CN04.AR02, CCC.Core.CN04.AR03 | HIPAA: 164_308_a_1_ii_d, 164_308_a_3_ii_a, 164_308_a_6_ii, 164_312_b, 164_312_c_2 | CIS-3.0: 3.7 | RBI-Cyber-Security-Framework: annex_i_7_4 | PCI-4.0: 10.2.1.1.34, 10.2.1.2.29, 10.2.1.3.29, 10.2.1.4.29, 10.2.1.5.29, 10.2.1.6.29, 10.2.1.7.29, 10.2.1.29, 10.2.2.29, 10.3.1.29, 10.6.3.39, 5.3.4.34, A1.2.1.34 | AWS-Account-Security-Onboarding: Send VPC Flow Logs (only DENYs) to S3 bucket | KISA-ISMS-P-2023-korean: 2.9.4, 2.10.2 | FedRAMP-20x-KSI-Low-25.05C: ksi-mla;logging | forensics-ready;;;;5.18.1;http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/flow-logs.html | https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/VPC/vpc-flow-logs-enabled.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-vpc_subnet_different_az-132410971304-ap-northeast-2-vpc-0565167ce4f7cc871;aws;vpc_subnet_different_az;VPC has subnets in more than one Availability Zone;Software and Configuration Checks/AWS Security Best Practices | Effects/Denial of Service;PASS;VPC vpc-0565167ce4f7cc871 has subnets in more than one availability zone.;False;vpc;;medium;AwsEc2Subnet;arn:aws:ec2:ap-northeast-2:132410971304:vpc/vpc-0565167ce4f7cc871;vpc-0565167ce4f7cc871;;;aws;ap-northeast-2;**VPCs** are assessed for **subnets spread across multiple Availability Zones**. The finding distinguishes VPCs with subnets confined to a single AZ or with no subnets from those with subnets in `2+` distinct AZs.;Single-AZ subnet layouts create a **single point of failure**, leading to **service downtime** during AZ outages, maintenance, or capacity events. Lack of **zonal redundancy** constrains load balancing and egress design, reduces **fault isolation**, and undermines availability and recovery objectives.;;Distribute subnets across `2+` **Availability Zones** and deploy workloads in separate AZs for **high availability**. Mirror network tiers per AZ, align routing and egress per AZ, and enforce multi-AZ layouts with IaC and policy guardrails. *Regularly test failover* to validate resilience.;https://hub.prowler.com/check/vpc_subnet_different_az;"```yaml
# CloudFormation: create two subnets in different AZs to ensure VPC spans multiple AZs
Resources:
  SubnetA:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: <example_resource_id>
      CidrBlock: 10.0.0.0/24
      AvailabilityZone: <example_az_1>  # Critical: place subnet in AZ1 to start AZ diversity
  SubnetB:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: <example_resource_id>
      CidrBlock: 10.0.1.0/24
      AvailabilityZone: <example_az_2>  # Critical: second AZ ensures VPC has subnets in more than one AZ
```";"```hcl
# Create two subnets in different AZs so the VPC spans multiple Availability Zones
resource ""aws_subnet"" ""subnet_a"" {
  vpc_id            = ""<example_resource_id>""
  cidr_block        = ""10.0.0.0/24""
  availability_zone = ""<example_az_1>"" # Critical: first AZ
}

resource ""aws_subnet"" ""subnet_b"" {
  vpc_id            = ""<example_resource_id>""
  cidr_block        = ""10.0.1.0/24""
  availability_zone = ""<example_az_2>"" # Critical: second AZ; ensures subnets in more than one AZ
}
```";;"1. In the AWS Console, go to VPC > Subnets
2. Click Create subnet
3. Select the target VPC (<example_resource_id>)
4. Add two subnets with non-overlapping CIDRs in different Availability Zones (e.g., <example_az_1> and <example_az_2>)
5. Click Create subnet to save
";ISO27001-2022: A.8.14, A.8.20, A.8.21, A.8.22 | NIST-CSF-2.0: be_5, ac_5 | KISA-ISMS-P-2023: 2.9.2 | C5-2025: PS-02.01B, PS-02.02AS | ENS-RD2022: mp.com.4.r3.aws.vpc.1 | KISA-ISMS-P-2023-korean: 2.9.2;resilience;;;;5.18.1;https://docs.aws.amazon.com/pdfs/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/building-scalable-secure-multi-vpc-network-infrastructure.pdf | https://docs.aws.amazon.com/vpc/latest/userguide/configure-subnets.html
profile: None;2026-02-12 07:58:01.872890;132410971304;;;;;;prowler-aws-vpc_subnet_separate_private_public-132410971304-ap-northeast-2-vpc-0565167ce4f7cc871;aws;vpc_subnet_separate_private_public;VPC has both public and private subnets;Software and Configuration Checks/AWS Security Best Practices/Network Reachability;FAIL;VPC vpc-0565167ce4f7cc871 has only public subnets.;False;vpc;;medium;AwsEc2Subnet;arn:aws:ec2:ap-northeast-2:132410971304:vpc/vpc-0565167ce4f7cc871;vpc-0565167ce4f7cc871;;;aws;ap-northeast-2;"**Amazon VPCs** are assessed for network segmentation: at least one **public subnet** (internet-routable) and one **private subnet** (non-internet-routable).

It flags VPCs with no subnets, only public subnets, or only private subnets.";"Missing subnet separation erodes **segmentation**.
- Only public: workloads face Internet exposure, enabling scanning, brute force, and lateral movement, threatening **confidentiality** and **integrity**.
- Only private: no controlled egress can break patching and dependencies, impacting **availability**.
- No subnets: misconfiguration leaves services unreachable.";;Segment each VPC: put internet-facing endpoints in **public subnets** and internal workloads in **private subnets**. Restrict ingress/egress with tight route tables, NACLs, and security groups, minimizing `0.0.0.0/0`. Apply **least privilege** and **defense in depth**. Provide controlled outbound for private subnets via managed egress and use hardened admin access patterns.;https://hub.prowler.com/check/vpc_subnet_separate_private_public;"```yaml
# CloudFormation: add one public and one private subnet to a VPC
Resources:
  InternetGateway:
    Type: AWS::EC2::InternetGateway

  VPCGatewayAttachment:
    Type: AWS::EC2::VPCGatewayAttachment
    Properties:
      VpcId: <example_resource_id>
      InternetGatewayId: !Ref InternetGateway

  PublicSubnet:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: <example_resource_id>
      CidrBlock: 10.0.1.0/24  # creates a subnet to be made public via route

  PrivateSubnet:
    Type: AWS::EC2::Subnet
    Properties:
      VpcId: <example_resource_id>
      CidrBlock: 10.0.2.0/24  # creates a subnet that remains private (no IGW route)

  PublicRouteTable:
    Type: AWS::EC2::RouteTable
    Properties:
      VpcId: <example_resource_id>

  PublicDefaultRoute:
    Type: AWS::EC2::Route
    DependsOn: VPCGatewayAttachment
    Properties:
      RouteTableId: !Ref PublicRouteTable
      DestinationCidrBlock: 0.0.0.0/0  # CRITICAL: makes routes to the Internet
      GatewayId: !Ref InternetGateway    # CRITICAL: via Internet Gateway

  PublicAssociation:
    Type: AWS::EC2::SubnetRouteTableAssociation
    Properties:
      SubnetId: !Ref PublicSubnet
      RouteTableId: !Ref PublicRouteTable  # CRITICAL: marks this subnet as public

  PrivateRouteTable:
    Type: AWS::EC2::RouteTable
    Properties:
      VpcId: <example_resource_id>

  PrivateAssociation:
    Type: AWS::EC2::SubnetRouteTableAssociation
    Properties:
      SubnetId: !Ref PrivateSubnet
      RouteTableId: !Ref PrivateRouteTable  # CRITICAL: no IGW route -> private subnet
```";"```hcl
# Terraform: add one public and one private subnet to a VPC
resource ""aws_internet_gateway"" ""<example_resource_name>"" {
  vpc_id = ""<example_resource_id>""
}

resource ""aws_subnet"" ""public_<example_resource_name>"" {
  vpc_id     = ""<example_resource_id>""
  cidr_block = ""10.0.1.0/24""
}

resource ""aws_subnet"" ""private_<example_resource_name>"" {
  vpc_id     = ""<example_resource_id>""
  cidr_block = ""10.0.2.0/24""
}

resource ""aws_route_table"" ""public_<example_resource_name>"" {
  vpc_id = ""<example_resource_id>""
  route {                         # CRITICAL: makes subnet public via IGW
    cidr_block = ""0.0.0.0/0""      # default route to Internet
    gateway_id = aws_internet_gateway.<example_resource_name>.id
  }
}

resource ""aws_route_table_association"" ""public_assoc_<example_resource_name>"" {
  subnet_id      = aws_subnet.public_<example_resource_name>.id
  route_table_id = aws_route_table.public_<example_resource_name>.id  # CRITICAL
}

resource ""aws_route_table"" ""private_<example_resource_name>"" {
  vpc_id = ""<example_resource_id>""  # CRITICAL: no IGW route keeps subnet private
}

resource ""aws_route_table_association"" ""private_assoc_<example_resource_name>"" {
  subnet_id      = aws_subnet.private_<example_resource_name>.id
  route_table_id = aws_route_table.private_<example_resource_name>.id  # CRITICAL
}
```";;"1. In the AWS console, go to VPC > Your VPCs and select the failing VPC
2. Attach an Internet Gateway if none exists: Internet Gateways > Create > Attach to the VPC
3. Create two subnets: Subnets > Create subnet
   - Subnet A (public): CIDR e.g., 10.0.1.0/24
   - Subnet B (private): CIDR e.g., 10.0.2.0/24
4. Create a route table for public subnet: Route tables > Create
   - Add route: 0.0.0.0/0 -> Internet Gateway (IGW)
   - Associate this route table to Subnet A (public)
5. Create a route table for private subnet: Route tables > Create
   - Do not add a route to an Internet Gateway
   - Associate this route table to Subnet B (private)
6. Verify the VPC now has at least one subnet with an IGW route (public) and one without (private)";ISO27001-2022: A.8.20, A.8.21, A.8.22 | AWS-Foundational-Technical-Review: NETSEC-002 | NIST-CSF-2.0: be_5, ac_5 | KISA-ISMS-P-2023: 2.6.1, 2.10.2 | C5-2025: PS-03.02B, COS-02.01B, COS-07.04B | ENS-RD2022: mp.com.4.aws.vpc.1, mp.com.4.r1.aws.vpc.1 | SOC2: cc_6_6 | KISA-ISMS-P-2023-korean: 2.6.1, 2.10.2;trust-boundaries;;;;5.18.1;https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Scenario2.html
