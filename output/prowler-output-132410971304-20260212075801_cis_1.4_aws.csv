PROVIDER;DESCRIPTION;ACCOUNTID;REGION;ASSESSMENTDATE;REQUIREMENTS_ID;REQUIREMENTS_DESCRIPTION;REQUIREMENTS_ATTRIBUTES_SECTION;REQUIREMENTS_ATTRIBUTES_SUBSECTION;REQUIREMENTS_ATTRIBUTES_PROFILE;REQUIREMENTS_ATTRIBUTES_ASSESSMENTSTATUS;REQUIREMENTS_ATTRIBUTES_DESCRIPTION;REQUIREMENTS_ATTRIBUTES_RATIONALESTATEMENT;REQUIREMENTS_ATTRIBUTES_IMPACTSTATEMENT;REQUIREMENTS_ATTRIBUTES_REMEDIATIONPROCEDURE;REQUIREMENTS_ATTRIBUTES_AUDITPROCEDURE;REQUIREMENTS_ATTRIBUTES_ADDITIONALINFORMATION;REQUIREMENTS_ATTRIBUTES_DEFAULTVALUE;REQUIREMENTS_ATTRIBUTES_REFERENCES;STATUS;STATUSEXTENDED;RESOURCEID;RESOURCENAME;CHECKID;MUTED;FRAMEWORK;NAME
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;1.1;Maintain current contact details;1 Identity and Access Management;;Level 1;Manual;"Ensure contact email and telephone details for AWS accounts are current and map to more than one individual in your organization.  An AWS account supports a number of contact details, and AWS will use these to contact the account owner if activity judged to be in breach of Acceptable Use Policy or indicative of likely security compromise is observed by the AWS Abuse team. Contact details should not be for a single individual, as circumstances may arise where that individual is unavailable. Email contact details should point to a mail alias which forwards email to multiple individuals within the organization; where feasible, phone contact details should point to a PABX hunt group or other call-forwarding system.";If an AWS account is observed to be behaving in a prohibited or suspicious manner, AWS will attempt to contact the account owner by email and phone using the contact details listed. If this is unsuccessful and the account behavior needs urgent mitigation, proactive measures may be taken, including throttling of traffic between the account exhibiting suspicious behavior and the AWS API endpoints and the Internet. This will result in impaired service to and from the account in question, so it is in both the customers' and AWS' best interests that prompt contact can be established. This is best achieved by setting AWS account contact details to point to resources which have multiple individuals as recipients, such as email aliases and PABX hunt groups.;;This activity can only be performed via the AWS Console, with a user who has permission to read and write Billing information (aws-portal:\*Billing ).  1. Sign in to the AWS Management Console and open the `Billing and Cost Management` console at https://console.aws.amazon.com/billing/home#/. 2. On the navigation bar, choose your account name, and then choose `My Account`. 3. On the `Account Settings` page, next to `Account Settings`, choose `Edit`. 4. Next to the field that you need to update, choose `Edit`. 5. After you have entered your changes, choose `Save changes`. 6. After you have made your changes, choose `Done`. 7. To edit your contact information, under `Contact Information`, choose `Edit`. 8. For the fields that you want to change, type your updated information, and then choose `Update`.;This activity can only be performed via the AWS Console, with a user who has permission to read and write Billing information (aws-portal:\*Billing )  1. Sign in to the AWS Management Console and open the `Billing and Cost Management` console at https://console.aws.amazon.com/billing/home#/. 2. On the navigation bar, choose your account name, and then choose `My Account`. 3. On the `Account Settings` page, review and verify the current details. 4. Under `Contact Information`, review and verify the current details.;;;https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/manage-account-payment.html#contact-info;MANUAL;Login to the AWS Console. Choose your account name on the top right of the window -> My Account -> Contact Information.;arn:aws:iam::132410971304:root;132410971304;account_maintain_current_contact_details;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;1.2;Ensure security contact information is registered;1 Identity and Access Management;;Level 1;Manual;AWS provides customers with the option of specifying the contact information for account's security team. It is recommended that this information be provided.;Specifying security-specific contact information will help ensure that security advisories sent by AWS reach the team in your organization that is best equipped to respond to them.;;Perform the following to establish security contact information:  **From Console:**  1. Click on your account name at the top right corner of the console. 2. From the drop-down menu Click `My Account`  3. Scroll down to the `Alternate Contacts` section 4. Enter contact information in the `Security` section  **Note:** Consider specifying an internal email distribution list to ensure emails are regularly monitored by more than one individual.;Perform the following to determine if security contact information is present:  **From Console:**  1. Click on your account name at the top right corner of the console 2. From the drop-down menu Click `My Account`  3. Scroll down to the `Alternate Contacts` section 4. Ensure contact information is specified in the `Security` section;;;;MANUAL;Login to the AWS Console. Choose your account name on the top right of the window -> My Account -> Alternate Contacts -> Security Section.;arn:aws:iam::132410971304:root;132410971304;account_security_contact_information_is_registered;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;1.3;Ensure security questions are registered in the AWS account;1 Identity and Access Management;;Level 1;Manual;The AWS support portal allows account owners to establish security questions that can be used to authenticate individuals calling AWS customer service for support. It is recommended that security questions be established.;When creating a new AWS account, a default super user is automatically created. This account is referred to as the 'root user' or 'root' account. It is recommended that the use of this account be limited and highly controlled. During events in which the 'root' password is no longer accessible or the MFA token associated with 'root' is lost/destroyed it is possible, through authentication using secret questions and associated answers, to recover 'root' user login access.;;**From Console:**  1. Login to the AWS Account as the 'root' user 2. Click on the _<Root\_Account\_Name>_ from the top right of the console 3. From the drop-down menu Click _My Account_ 4. Scroll down to the `Configure Security Questions` section 5. Click on `Edit`  6. Click on each `Question`   - From the drop-down select an appropriate question  - Click on the `Answer` section  - Enter an appropriate answer   - Follow process for all 3 questions 7. Click `Update` when complete 8. Save Questions and Answers and place in a secure physical location;**From Console:**  1. Login to the AWS account as the 'root' user 2. On the top right you will see the _<Root\_Account\_Name>_ 3. Click on the _<Root\_Account\_Name>_ 4. From the drop-down menu Click `My Account`  5. In the `Configure Security Challenge Questions` section on the `Personal Information` page, configure three security challenge questions. 6. Click `Save questions` .;;;;MANUAL;Login to the AWS Console as root. Choose your account name on the top right of the window -> My Account -> Configure Security Challenge Questions.;arn:aws:iam::132410971304:root;132410971304;account_security_questions_are_registered_in_the_aws_account;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;3.7;Ensure CloudTrail logs are encrypted at rest using KMS CMKs;3 Logging;;Level 2;Automated;AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS.;Configuring CloudTrail to use SSE-KMS provides additional confidentiality controls on log data as a given user must have S3 read permission on the corresponding log bucket and must be granted decrypt permission by the CMK policy.;Customer created keys incur an additional cost. See https://aws.amazon.com/kms/pricing/ for more information.;Perform the following to configure CloudTrail to use SSE-KMS:  **From Console:**  1. Sign in to the AWS Management Console and open the CloudTrail console at [https://console.aws.amazon.com/cloudtrail](https://console.aws.amazon.com/cloudtrail) 2. In the left navigation pane, choose `Trails` . 3. Click on a Trail 4. Under the `S3` section click on the edit button (pencil icon) 5. Click `Advanced`  6. Select an existing CMK from the `KMS key Id` drop-down menu  - Note: Ensure the CMK is located in the same region as the S3 bucket  - Note: You will need to apply a KMS Key policy on the selected CMK in order for CloudTrail as a service to encrypt and decrypt log files using the CMK provided. Steps are provided [here](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/create-kms-key-policy-for-cloudtrail.html) for editing the selected CMK Key policy 7. Click `Save`  8. You will see a notification message stating that you need to have decrypt permissions on the specified KMS key to decrypt log files. 9. Click `Yes`   **From Command Line:** ``` aws cloudtrail update-trail --name <trail_name> --kms-id <cloudtrail_kms_key> aws kms put-key-policy --key-id <cloudtrail_kms_key> --policy <cloudtrail_kms_key_policy> ```;Perform the following to determine if CloudTrail is configured to use SSE-KMS:  **From Console:**  1. Sign in to the AWS Management Console and open the CloudTrail console at [https://console.aws.amazon.com/cloudtrail](https://console.aws.amazon.com/cloudtrail) 2. In the left navigation pane, choose `Trails` . 3. Select a Trail 4. Under the `S3` section, ensure `Encrypt log files` is set to `Yes` and a KMS key ID is specified in the `KSM Key Id` field.  **From Command Line:**  1. Run the following command: ```  aws cloudtrail describe-trails  ``` 2. For each trail listed, SSE-KMS is enabled if the trail has a `KmsKeyId` property defined.;"3 statements which need to be added to the CMK policy:  1\. Enable Cloudtrail to describe CMK properties ``` <pre class=""programlisting"" style=""font-style: normal;"">{  ""Sid"": ""Allow CloudTrail access"",  ""Effect"": ""Allow"",  ""Principal"": {  ""Service"": ""cloudtrail.amazonaws.com""  },  ""Action"": ""kms:DescribeKey"",  ""Resource"": ""*"" } ``` 2\. Granting encrypt permissions ``` <pre class=""programlisting"" style=""font-style: normal;"">{  ""Sid"": ""Allow CloudTrail to encrypt logs"",  ""Effect"": ""Allow"",  ""Principal"": {  ""Service"": ""cloudtrail.amazonaws.com""  },  ""Action"": ""kms:GenerateDataKey*"",  ""Resource"": ""*"",  ""Condition"": {  ""StringLike"": {  ""kms:EncryptionContext:aws:cloudtrail:arn"": [  ""arn:aws:cloudtrail:*:aws-account-id:trail/*""  ]  }  } } ``` 3\. Granting decrypt permissions ``` <pre class=""programlisting"" style=""font-style: normal;"">{  ""Sid"": ""Enable CloudTrail log decrypt permissions"",  ""Effect"": ""Allow"",  ""Principal"": {  ""AWS"": ""arn:aws:iam::aws-account-id:user/username""  },  ""Action"": ""kms:Decrypt"",  ""Resource"": ""*"",  ""Condition"": {  ""Null"": {  ""kms:EncryptionContext:aws:cloudtrail:arn"": ""false""  }  } } ```";;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/encrypting-cloudtrail-log-files-with-aws-kms.html:https://docs.aws.amazon.com/kms/latest/developerguide/create-keys.html;PASS;Multiregion trail security-cloudtail has encryption enabled.;arn:aws:cloudtrail:ap-northeast-2:132410971304:trail/security-cloudtail;security-cloudtail;cloudtrail_kms_encryption_enabled;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;3.2;Ensure CloudTrail log file validation is enabled;3 Logging;;Level 2;Automated;CloudTrail log file validation creates a digitally signed digest file containing a hash of each log that CloudTrail writes to S3. These digest files can be used to determine whether a log file was changed, deleted, or unchanged after CloudTrail delivered the log. It is recommended that file validation be enabled on all CloudTrails.;Enabling log file validation will provide additional integrity checking of CloudTrail logs.;;Perform the following to enable log file validation on a given trail:  **From Console:**  1. Sign in to the AWS Management Console and open the IAM console at [https://console.aws.amazon.com/cloudtrail](https://console.aws.amazon.com/cloudtrail) 2. Click on `Trails` on the left navigation pane 3. Click on target trail 4. Within the `General details` section click `edit` 5. Under the `Advanced settings` section 6. Check the enable box under `Log file validation`  7. Click `Save changes`   **From Command Line:** ``` aws cloudtrail update-trail --name <trail_name> --enable-log-file-validation ``` Note that periodic validation of logs using these digests can be performed by running the following command: ``` aws cloudtrail validate-logs --trail-arn <trail_arn> --start-time <start_time> --end-time <end_time> ```;Perform the following on each trail to determine if log file validation is enabled:  **From Console:**  1. Sign in to the AWS Management Console and open the IAM console at [https://console.aws.amazon.com/cloudtrail](https://console.aws.amazon.com/cloudtrail) 2. Click on `Trails` on the left navigation pane 3. For Every Trail: - Click on a trail via the link in the _Name_ column - Under the `General details` section, ensure `Log file validation` is set to `Enabled`   **From Command Line:** ``` aws cloudtrail describe-trails ``` Ensure `LogFileValidationEnabled` is set to `true` for each trail;;;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-log-file-validation-enabling.html;PASS;Multiregion trail security-cloudtail has log file validation enabled.;arn:aws:cloudtrail:ap-northeast-2:132410971304:trail/security-cloudtail;security-cloudtail;cloudtrail_log_file_validation_enabled;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;3.6;Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket;3 Logging;;Level 1;Automated;S3 Bucket Access Logging generates a log that contains access records for each request made to your S3 bucket. An access log record contains details about the request, such as the request type, the resources specified in the request worked, and the time and date the request was processed. It is recommended that bucket access logging be enabled on the CloudTrail S3 bucket.;By enabling S3 bucket logging on target S3 buckets, it is possible to capture all events which may affect objects within any target buckets. Configuring logs to be placed in a separate bucket allows access to log information which can be useful in security and incident response workflows.;;"Perform the following to enable S3 bucket logging:  **From Console:**  1. Sign in to the AWS Management Console and open the S3 console at [https://console.aws.amazon.com/s3](https://console.aws.amazon.com/s3). 2. Under `All Buckets` click on the target S3 bucket 3. Click on `Properties` in the top right of the console 4. Under `Bucket:` <s3\_bucket\_for\_cloudtrail> click on `Logging`  5. Configure bucket logging  - Click on the `Enabled` checkbox  - Select Target Bucket from list  - Enter a Target Prefix 6. Click `Save`.  **From Command Line:**  1. Get the name of the S3 bucket that CloudTrail is logging to: ``` aws cloudtrail describe-trails --region <region-name> --query trailList[*].S3BucketName ``` 2. Copy and add target bucket name at `<Logging_BucketName>`, Prefix for logfile at `<LogFilePrefix>` and optionally add an email address in the following template and save it as `<FileName.Json>`: ``` {  ""LoggingEnabled"": {  ""TargetBucket"": ""<Logging_BucketName>"",  ""TargetPrefix"": ""<LogFilePrefix>"",  ""TargetGrants"": [  {  ""Grantee"": {  ""Type"": ""AmazonCustomerByEmail"",  ""EmailAddress"": ""<EmailID>""  },  ""Permission"": ""FULL_CONTROL""  }  ]  }  } ``` 3. Run the `put-bucket-logging` command with bucket name and `<FileName.Json>` as input, for more information refer at [put-bucket-logging](https://docs.aws.amazon.com/cli/latest/reference/s3api/put-bucket-logging.html): ``` aws s3api put-bucket-logging --bucket <BucketName> --bucket-logging-status file://<FileName.Json> ```";"Perform the following ensure the CloudTrail S3 bucket has access logging is enabled:  **From Console:**  1. Go to the Amazon CloudTrail console at [https://console.aws.amazon.com/cloudtrail/home](https://console.aws.amazon.com/cloudtrail/home) 2. In the API activity history pane on the left, click Trails 3. In the Trails pane, note the bucket names in the S3 bucket column 4. Sign in to the AWS Management Console and open the S3 console at [https://console.aws.amazon.com/s3](https://console.aws.amazon.com/s3). 5. Under `All Buckets` click on a target S3 bucket 6. Click on `Properties` in the top right of the console 7. Under `Bucket:` _ `<bucket_name>` _ click on `Logging`  8. Ensure `Enabled` is checked.  **From Command Line:**  1. Get the name of the S3 bucket that CloudTrail is logging to: ```  aws cloudtrail describe-trails --query 'trailList[*].S3BucketName'  ``` 2. Ensure Bucket Logging is enabled: ``` aws s3api get-bucket-logging --bucket <s3_bucket_for_cloudtrail> ``` Ensure command does not returns empty output.  Sample Output for a bucket with logging enabled:  ``` {  ""LoggingEnabled"": {  ""TargetPrefix"": ""<Prefix_Test>"",  ""TargetBucket"": ""<Bucket_name_for_Storing_Logs>""  } } ```";;;https://docs.aws.amazon.com/AmazonS3/latest/dev/ServerLogs.html;FAIL;Multiregion Trail security-cloudtail S3 bucket access logging is not enabled for bucket aws-cloudtrail-logs-132410971304-0971c04b.;arn:aws:cloudtrail:ap-northeast-2:132410971304:trail/security-cloudtail;security-cloudtail;cloudtrail_logs_s3_bucket_access_logging_enabled;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;4.11;Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL);4 Monitoring;;Level 2;Automated;Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. It is recommended that a metric filter and alarm be established for changes made to NACLs.;Monitoring changes to NACLs will help ensure that AWS resources and services are not unintentionally exposed.;;Perform the following to setup the metric filter, alarm, SNS topic, and subscription:  1. Create a metric filter based on filter pattern provided which checks for NACL changes and the `<cloudtrail_log_group_name>` taken from audit step 1. ``` aws logs put-metric-filter --log-group-name <cloudtrail_log_group_name> --filter-name `<nacl_changes_metric>` --metric-transformations metricName= `<nacl_changes_metric>` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventName = CreateNetworkAcl) || ($.eventName = CreateNetworkAclEntry) || ($.eventName = DeleteNetworkAcl) || ($.eventName = DeleteNetworkAclEntry) || ($.eventName = ReplaceNetworkAclEntry) || ($.eventName = ReplaceNetworkAclAssociation) }' ```  **Note**: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together.  2. Create an SNS topic that the alarm will notify ``` aws sns create-topic --name <sns_topic_name> ```  **Note**: you can execute this command once and then re-use the same topic for all monitoring alarms.  3. Create an SNS subscription to the topic created in step 2 ``` aws sns subscribe --topic-arn <sns_topic_arn> --protocol <protocol_for_sns> --notification-endpoint <sns_subscription_endpoints> ```  **Note**: you can execute this command once and then re-use the SNS subscription for all monitoring alarms.  4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2 ``` aws cloudwatch put-metric-alarm --alarm-name `<nacl_changes_alarm>` --metric-name `<nacl_changes_metric>` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions <sns_topic_arn> ```;"Perform the following to ensure that there is at least one active multi-region CloudTrail with prescribed metric filters and alarms configured:  1. Identify the log group name configured for use with active multi-region CloudTrail:  - List all CloudTrails: `aws cloudtrail describe-trails`  - Identify Multi region Cloudtrails: `Trails with ""IsMultiRegionTrail"" set to true`  - From value associated with CloudWatchLogsLogGroupArn note `<cloudtrail_log_group_name>`  Example: for CloudWatchLogsLogGroupArn that looks like `arn:aws:logs:<region>:<aws_account_number>:log-group:NewGroup:*`, `<cloudtrail_log_group_name>` would be `NewGroup`  - Ensure Identified Multi region CloudTrail is active  `aws cloudtrail get-trail-status --name <Name of a Multi-region CloudTrail>`  ensure `IsLogging` is set to `TRUE`  - Ensure identified Multi-region Cloudtrail captures all Management Events  `aws cloudtrail get-event-selectors --trail-name <trailname shown in describe-trails>`  Ensure there is at least one Event Selector for a Trail with `IncludeManagementEvents` set to `true` and `ReadWriteType` set to `All`  2. Get a list of all associated metric filters for this `<cloudtrail_log_group_name>`: ``` aws logs describe-metric-filters --log-group-name ""<cloudtrail_log_group_name>"" ``` 3. Ensure the output from the above command contains the following: ``` ""filterPattern"": ""{ ($.eventName = CreateNetworkAcl) || ($.eventName = CreateNetworkAclEntry) || ($.eventName = DeleteNetworkAcl) || ($.eventName = DeleteNetworkAclEntry) || ($.eventName = ReplaceNetworkAclEntry) || ($.eventName = ReplaceNetworkAclAssociation) }"" ``` 4. Note the `<nacl_changes_metric>` value associated with the `filterPattern` found in step 3.  5. Get a list of CloudWatch alarms and filter on the `<nacl_changes_metric>` captured in step 4. ``` aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName== `<nacl_changes_metric>`]' ``` 6. Note the `AlarmActions` value - this will provide the SNS topic ARN value.  7. Ensure there is at least one active subscriber to the SNS topic ``` aws sns list-subscriptions-by-topic --topic-arn <sns_topic_arn>  ``` at least one subscription should have ""SubscriptionArn"" with valid aws ARN. ``` Example of valid ""SubscriptionArn"": ""arn:aws:sns:<region>:<aws_account_number>:<SnsTopicName>:<SubscriptionID>"" ```";Configuring log metric filter and alarm on Multi-region (global) CloudTrail - ensures that activities from all regions (used as well as unused) are monitored - ensures that activities on all supported global services are monitored - ensures that all management events across all regions are monitored;;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html:https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html:https://docs.aws.amazon.com/sns/latest/dg/SubscribeTopic.html;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;cloudwatch_changes_to_network_acls_alarm_configured;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;4.12;Ensure a log metric filter and alarm exist for changes to network gateways;4 Monitoring;;Level 1;Automated;Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. It is recommended that a metric filter and alarm be established for changes to network gateways.;Monitoring changes to network gateways will help ensure that all ingress/egress traffic traverses the VPC border via a controlled path.;;Perform the following to setup the metric filter, alarm, SNS topic, and subscription:  1. Create a metric filter based on filter pattern provided which checks for network gateways changes and the `<cloudtrail_log_group_name>` taken from audit step 1. ``` aws logs put-metric-filter --log-group-name <cloudtrail_log_group_name> --filter-name `<network_gw_changes_metric>` --metric-transformations metricName= `<network_gw_changes_metric>` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventName = CreateCustomerGateway) || ($.eventName = DeleteCustomerGateway) || ($.eventName = AttachInternetGateway) || ($.eventName = CreateInternetGateway) || ($.eventName = DeleteInternetGateway) || ($.eventName = DetachInternetGateway) }' ```  **Note**: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together.  2. Create an SNS topic that the alarm will notify ``` aws sns create-topic --name <sns_topic_name> ```  **Note**: you can execute this command once and then re-use the same topic for all monitoring alarms.  3. Create an SNS subscription to the topic created in step 2 ``` aws sns subscribe --topic-arn <sns_topic_arn> --protocol <protocol_for_sns> --notification-endpoint <sns_subscription_endpoints> ```  **Note**: you can execute this command once and then re-use the SNS subscription for all monitoring alarms.  4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2 ``` aws cloudwatch put-metric-alarm --alarm-name `<network_gw_changes_alarm>` --metric-name `<network_gw_changes_metric>` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions <sns_topic_arn> ```;"Perform the following to ensure that there is at least one active multi-region CloudTrail with prescribed metric filters and alarms configured:  1. Identify the log group name configured for use with active multi-region CloudTrail:  - List all CloudTrails: `aws cloudtrail describe-trails`  - Identify Multi region Cloudtrails: `Trails with ""IsMultiRegionTrail"" set to true`  - From value associated with CloudWatchLogsLogGroupArn note `<cloudtrail_log_group_name>`  Example: for CloudWatchLogsLogGroupArn that looks like `arn:aws:logs:<region>:<aws_account_number>:log-group:NewGroup:*`, `<cloudtrail_log_group_name>` would be `NewGroup`  - Ensure Identified Multi region CloudTrail is active  `aws cloudtrail get-trail-status --name <Name of a Multi-region CloudTrail>`  ensure `IsLogging` is set to `TRUE`  - Ensure identified Multi-region Cloudtrail captures all Management Events  `aws cloudtrail get-event-selectors --trail-name <trailname shown in describe-trails>`  Ensure there is at least one Event Selector for a Trail with `IncludeManagementEvents` set to `true` and `ReadWriteType` set to `All`  2. Get a list of all associated metric filters for this `<cloudtrail_log_group_name>`: ``` aws logs describe-metric-filters --log-group-name ""<cloudtrail_log_group_name>"" ``` 3. Ensure the output from the above command contains the following: ``` ""filterPattern"": ""{ ($.eventName = CreateCustomerGateway) || ($.eventName = DeleteCustomerGateway) || ($.eventName = AttachInternetGateway) || ($.eventName = CreateInternetGateway) || ($.eventName = DeleteInternetGateway) || ($.eventName = DetachInternetGateway) }"" ``` 4. Note the `<network_gw_changes_metric>` value associated with the `filterPattern` found in step 3.  5. Get a list of CloudWatch alarms and filter on the `<network_gw_changes_metric>` captured in step 4. ``` aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName== `<network_gw_changes_metric>`]' ``` 6. Note the `AlarmActions` value - this will provide the SNS topic ARN value.  7. Ensure there is at least one active subscriber to the SNS topic ``` aws sns list-subscriptions-by-topic --topic-arn <sns_topic_arn>  ``` at least one subscription should have ""SubscriptionArn"" with valid aws ARN. ``` Example of valid ""SubscriptionArn"": ""arn:aws:sns:<region>:<aws_account_number>:<SnsTopicName>:<SubscriptionID>"" ```";Configuring log metric filter and alarm on Multi-region (global) CloudTrail - ensures that activities from all regions (used as well as unused) are monitored - ensures that activities on all supported global services are monitored - ensures that all management events across all regions are monitored;;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html:https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html:https://docs.aws.amazon.com/sns/latest/dg/SubscribeTopic.html;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;cloudwatch_changes_to_network_gateways_alarm_configured;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;4.13;Ensure a log metric filter and alarm exist for route table changes;4 Monitoring;;Level 1;Automated;Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. It is recommended that a metric filter and alarm be established for changes to route tables.;Monitoring changes to route tables will help ensure that all VPC traffic flows through an expected path.;;Perform the following to setup the metric filter, alarm, SNS topic, and subscription:  1. Create a metric filter based on filter pattern provided which checks for route table changes and the `<cloudtrail_log_group_name>` taken from audit step 1. ``` aws logs put-metric-filter --log-group-name <cloudtrail_log_group_name> --filter-name `<route_table_changes_metric>` --metric-transformations metricName= `<route_table_changes_metric>` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventName = CreateRoute) || ($.eventName = CreateRouteTable) || ($.eventName = ReplaceRoute) || ($.eventName = ReplaceRouteTableAssociation) || ($.eventName = DeleteRouteTable) || ($.eventName = DeleteRoute) || ($.eventName = DisassociateRouteTable) }' ```  **Note**: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together.  2. Create an SNS topic that the alarm will notify ``` aws sns create-topic --name <sns_topic_name> ```  **Note**: you can execute this command once and then re-use the same topic for all monitoring alarms.  3. Create an SNS subscription to the topic created in step 2 ``` aws sns subscribe --topic-arn <sns_topic_arn> --protocol <protocol_for_sns> --notification-endpoint <sns_subscription_endpoints> ```  **Note**: you can execute this command once and then re-use the SNS subscription for all monitoring alarms.  4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2 ``` aws cloudwatch put-metric-alarm --alarm-name `<route_table_changes_alarm>` --metric-name `<route_table_changes_metric>` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions <sns_topic_arn> ```;"Perform the following to ensure that there is at least one active multi-region CloudTrail with prescribed metric filters and alarms configured:  1. Identify the log group name configured for use with active multi-region CloudTrail:  - List all CloudTrails: `aws cloudtrail describe-trails`  - Identify Multi region Cloudtrails: `Trails with ""IsMultiRegionTrail"" set to true`  - From value associated with CloudWatchLogsLogGroupArn note `<cloudtrail_log_group_name>`  Example: for CloudWatchLogsLogGroupArn that looks like `arn:aws:logs:<region>:<aws_account_number>:log-group:NewGroup:*`, `<cloudtrail_log_group_name>` would be `NewGroup`  - Ensure Identified Multi region CloudTrail is active  `aws cloudtrail get-trail-status --name <Name of a Multi-region CloudTrail>`  ensure `IsLogging` is set to `TRUE`  - Ensure identified Multi-region Cloudtrail captures all Management Events  `aws cloudtrail get-event-selectors --trail-name <trailname shown in describe-trails>`  Ensure there is at least one Event Selector for a Trail with `IncludeManagementEvents` set to `true` and `ReadWriteType` set to `All`  2. Get a list of all associated metric filters for this `<cloudtrail_log_group_name>`:  ``` aws logs describe-metric-filters --log-group-name ""<cloudtrail_log_group_name>"" ```  3. Ensure the output from the above command contains the following:  ``` ""filterPattern"": ""{ ($.eventName = CreateRoute) || ($.eventName = CreateRouteTable) || ($.eventName = ReplaceRoute) || ($.eventName = ReplaceRouteTableAssociation) || ($.eventName = DeleteRouteTable) || ($.eventName = DeleteRoute) || ($.eventName = DisassociateRouteTable) }"" ```  4. Note the `<route_table_changes_metric>` value associated with the `filterPattern` found in step 3.  5. Get a list of CloudWatch alarms and filter on the `<route_table_changes_metric>` captured in step 4.  ``` aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName== `<route_table_changes_metric>`]' ```  6. Note the `AlarmActions` value - this will provide the SNS topic ARN value.  7. Ensure there is at least one active subscriber to the SNS topic  ``` aws sns list-subscriptions-by-topic --topic-arn <sns_topic_arn>  ``` at least one subscription should have ""SubscriptionArn"" with valid aws ARN.  ``` Example of valid ""SubscriptionArn"": ""arn:aws:sns:<region>:<aws_account_number>:<SnsTopicName>:<SubscriptionID>"" ```";Configuring log metric filter and alarm on Multi-region (global) CloudTrail - ensures that activities from all regions (used as well as unused) are monitored - ensures that activities on all supported global services are monitored - ensures that all management events across all regions are monitored;;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html:https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html:https://docs.aws.amazon.com/sns/latest/dg/SubscribeTopic.html;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;cloudwatch_changes_to_network_route_tables_alarm_configured;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;4.14;Ensure a log metric filter and alarm exist for VPC changes;4 Monitoring;;Level 1;Automated;Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs.;Monitoring changes to VPC will help ensure VPC traffic flow is not getting impacted.;;Perform the following to setup the metric filter, alarm, SNS topic, and subscription:  1. Create a metric filter based on filter pattern provided which checks for VPC changes and the `<cloudtrail_log_group_name>` taken from audit step 1. ``` aws logs put-metric-filter --log-group-name <cloudtrail_log_group_name> --filter-name `<vpc_changes_metric>` --metric-transformations metricName= `<vpc_changes_metric>` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventName = CreateVpc) || ($.eventName = DeleteVpc) || ($.eventName = ModifyVpcAttribute) || ($.eventName = AcceptVpcPeeringConnection) || ($.eventName = CreateVpcPeeringConnection) || ($.eventName = DeleteVpcPeeringConnection) || ($.eventName = RejectVpcPeeringConnection) || ($.eventName = AttachClassicLinkVpc) || ($.eventName = DetachClassicLinkVpc) || ($.eventName = DisableVpcClassicLink) || ($.eventName = EnableVpcClassicLink) }' ```  **Note**: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together.  2. Create an SNS topic that the alarm will notify ``` aws sns create-topic --name <sns_topic_name> ```  **Note**: you can execute this command once and then re-use the same topic for all monitoring alarms.  3. Create an SNS subscription to the topic created in step 2 ``` aws sns subscribe --topic-arn <sns_topic_arn> --protocol <protocol_for_sns> --notification-endpoint <sns_subscription_endpoints> ```  **Note**: you can execute this command once and then re-use the SNS subscription for all monitoring alarms.  4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2 ``` aws cloudwatch put-metric-alarm --alarm-name `<vpc_changes_alarm>` --metric-name `<vpc_changes_metric>` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions <sns_topic_arn> ```;"Perform the following to ensure that there is at least one active multi-region CloudTrail with prescribed metric filters and alarms configured:  1. Identify the log group name configured for use with active multi-region CloudTrail:  - List all CloudTrails: `aws cloudtrail describe-trails`  - Identify Multi region Cloudtrails: `Trails with ""IsMultiRegionTrail"" set to true`  - From value associated with CloudWatchLogsLogGroupArn note `<cloudtrail_log_group_name>`  Example: for CloudWatchLogsLogGroupArn that looks like `arn:aws:logs:<region>:<aws_account_number>:log-group:NewGroup:*`, `<cloudtrail_log_group_name>` would be `NewGroup`  - Ensure Identified Multi region CloudTrail is active  `aws cloudtrail get-trail-status --name <Name of a Multi-region CloudTrail>`  ensure `IsLogging` is set to `TRUE`  - Ensure identified Multi-region Cloudtrail captures all Management Events  `aws cloudtrail get-event-selectors --trail-name <trailname shown in describe-trails>`  Ensure there is at least one Event Selector for a Trail with `IncludeManagementEvents` set to `true` and `ReadWriteType` set to `All`  2. Get a list of all associated metric filters for this `<cloudtrail_log_group_name>`:  ``` aws logs describe-metric-filters --log-group-name ""<cloudtrail_log_group_name>"" ```  3. Ensure the output from the above command contains the following:  ``` ""filterPattern"": ""{ ($.eventName = CreateVpc) || ($.eventName = DeleteVpc) || ($.eventName = ModifyVpcAttribute) || ($.eventName = AcceptVpcPeeringConnection) || ($.eventName = CreateVpcPeeringConnection) || ($.eventName = DeleteVpcPeeringConnection) || ($.eventName = RejectVpcPeeringConnection) || ($.eventName = AttachClassicLinkVpc) || ($.eventName = DetachClassicLinkVpc) || ($.eventName = DisableVpcClassicLink) || ($.eventName = EnableVpcClassicLink) }"" ```  4. Note the `<vpc_changes_metric>` value associated with the `filterPattern` found in step 3.  5. Get a list of CloudWatch alarms and filter on the `<vpc_changes_metric>` captured in step 4.  ``` aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName== `<vpc_changes_metric>`]' ```  6. Note the `AlarmActions` value - this will provide the SNS topic ARN value.  7. Ensure there is at least one active subscriber to the SNS topic  ``` aws sns list-subscriptions-by-topic --topic-arn <sns_topic_arn>  ``` at least one subscription should have ""SubscriptionArn"" with valid aws ARN.  ``` Example of valid ""SubscriptionArn"": ""arn:aws:sns:<region>:<aws_account_number>:<SnsTopicName>:<SubscriptionID>"" ```";Configuring log metric filter and alarm on Multi-region (global) CloudTrail - ensures that activities from all regions (used as well as unused) are monitored - ensures that activities on all supported global services are monitored - ensures that all management events across all regions are monitored;;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html:https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html:https://docs.aws.amazon.com/sns/latest/dg/SubscribeTopic.html;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;cloudwatch_changes_to_vpcs_alarm_configured;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;4.9;Ensure a log metric filter and alarm exist for AWS Config configuration changes;4 Monitoring;;Level 2;Automated;Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.;Monitoring changes to AWS Config configuration will help ensure sustained visibility of configuration items within the AWS account.;;Perform the following to setup the metric filter, alarm, SNS topic, and subscription:  1. Create a metric filter based on filter pattern provided which checks for AWS Configuration changes and the `<cloudtrail_log_group_name>` taken from audit step 1. ``` aws logs put-metric-filter --log-group-name <cloudtrail_log_group_name> --filter-name `<aws_config_changes_metric>` --metric-transformations metricName= `<aws_config_changes_metric>` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventSource = config.amazonaws.com) && (($.eventName=StopConfigurationRecorder)||($.eventName=DeleteDeliveryChannel)||($.eventName=PutDeliveryChannel)||($.eventName=PutConfigurationRecorder)) }' ```  **Note**: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together.  2. Create an SNS topic that the alarm will notify ``` aws sns create-topic --name <sns_topic_name> ```  **Note**: you can execute this command once and then re-use the same topic for all monitoring alarms.  3. Create an SNS subscription to topic created in step 2 ``` aws sns subscribe --topic-arn <sns_topic_arn> --protocol <protocol_for_sns> --notification-endpoint <sns_subscription_endpoints> ```  **Note**: you can execute this command once and then re-use the SNS subscription for all monitoring alarms.  4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2 ``` aws cloudwatch put-metric-alarm --alarm-name `<aws_config_changes_alarm>` --metric-name `<aws_config_changes_metric>` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions <sns_topic_arn> ```;"Perform the following to ensure that there is at least one active multi-region CloudTrail with prescribed metric filters and alarms configured:  1. Identify the log group name configured for use with active multi-region CloudTrail:  - List all CloudTrails: `aws cloudtrail describe-trails`  - Identify Multi region Cloudtrails: `Trails with ""IsMultiRegionTrail"" set to true`  - From value associated with CloudWatchLogsLogGroupArn note `<cloudtrail_log_group_name>`  Example: for CloudWatchLogsLogGroupArn that looks like `arn:aws:logs:<region>:<aws_account_number>:log-group:NewGroup:*`, `<cloudtrail_log_group_name>` would be `NewGroup`  - Ensure Identified Multi region CloudTrail is active  `aws cloudtrail get-trail-status --name <Name of a Multi-region CloudTrail>`  ensure `IsLogging` is set to `TRUE`  - Ensure identified Multi-region Cloudtrail captures all Management Events  `aws cloudtrail get-event-selectors --trail-name <trailname shown in describe-trails>`  Ensure there is at least one Event Selector for a Trail with `IncludeManagementEvents` set to `true` and `ReadWriteType` set to `All`  2. Get a list of all associated metric filters for this `<cloudtrail_log_group_name>`: ``` aws logs describe-metric-filters --log-group-name ""<cloudtrail_log_group_name>"" ``` 3. Ensure the output from the above command contains the following: ``` ""filterPattern"": ""{ ($.eventSource = config.amazonaws.com) && (($.eventName=StopConfigurationRecorder)||($.eventName=DeleteDeliveryChannel)||($.eventName=PutDeliveryChannel)||($.eventName=PutConfigurationRecorder)) }"" ``` 4. Note the `<aws_config_changes_metric>` value associated with the `filterPattern` found in step 3.  5. Get a list of CloudWatch alarms and filter on the `<aws_config_changes_metric>` captured in step 4. ``` aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName== `<aws_config_changes_metric>`]' ``` 6. Note the `AlarmActions` value - this will provide the SNS topic ARN value.  7. Ensure there is at least one active subscriber to the SNS topic ``` aws sns list-subscriptions-by-topic --topic-arn <sns_topic_arn>  ``` at least one subscription should have ""SubscriptionArn"" with valid aws ARN. ``` Example of valid ""SubscriptionArn"": ""arn:aws:sns:<region>:<aws_account_number>:<SnsTopicName>:<SubscriptionID>"" ```";Configuring log metric filter and alarm on Multi-region (global) CloudTrail - ensures that activities from all regions (used as well as unused) are monitored - ensures that activities on all supported global services are monitored - ensures that all management events across all regions are monitored;;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html:https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html:https://docs.aws.amazon.com/sns/latest/dg/SubscribeTopic.html;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;cloudwatch_log_metric_filter_and_alarm_for_aws_config_configuration_changes_enabled;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;4.5;Ensure a log metric filter and alarm exist for CloudTrail configuration changes;4 Monitoring;;Level 1;Automated;Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.;Monitoring changes to CloudTrail's configuration will help ensure sustained visibility to activities performed in the AWS account.;;Perform the following to setup the metric filter, alarm, SNS topic, and subscription:  1. Create a metric filter based on filter pattern provided which checks for cloudtrail configuration changes and the `<cloudtrail_log_group_name>` taken from audit step 1. ``` aws logs put-metric-filter --log-group-name <cloudtrail_log_group_name> --filter-name `<cloudtrail_cfg_changes_metric>` --metric-transformations metricName= `<cloudtrail_cfg_changes_metric>` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventName = CreateTrail) || ($.eventName = UpdateTrail) || ($.eventName = DeleteTrail) || ($.eventName = StartLogging) || ($.eventName = StopLogging) }' ```  **Note**: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together.  2. Create an SNS topic that the alarm will notify ``` aws sns create-topic --name <sns_topic_name> ```  **Note**: you can execute this command once and then re-use the same topic for all monitoring alarms.  3. Create an SNS subscription to the topic created in step 2 ``` aws sns subscribe --topic-arn <sns_topic_arn> --protocol <protocol_for_sns> --notification-endpoint <sns_subscription_endpoints> ```  **Note**: you can execute this command once and then re-use the SNS subscription for all monitoring alarms.  4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2 ``` aws cloudwatch put-metric-alarm --alarm-name `<cloudtrail_cfg_changes_alarm>` --metric-name `<cloudtrail_cfg_changes_metric>` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions <sns_topic_arn> ```;"Perform the following to ensure that there is at least one active multi-region CloudTrail with prescribed metric filters and alarms configured:  1. Identify the log group name configured for use with active multi-region CloudTrail:  - List all CloudTrails: `aws cloudtrail describe-trails`  - Identify Multi region Cloudtrails: `Trails with ""IsMultiRegionTrail"" set to true`  - From value associated with CloudWatchLogsLogGroupArn note `<cloudtrail_log_group_name>`  Example: for CloudWatchLogsLogGroupArn that looks like `arn:aws:logs:<region>:<aws_account_number>:log-group:NewGroup:*`, `<cloudtrail_log_group_name>` would be `NewGroup`  - Ensure Identified Multi region CloudTrail is active  `aws cloudtrail get-trail-status --name <Name of a Multi-region CloudTrail>`  ensure `IsLogging` is set to `TRUE`  - Ensure identified Multi-region Cloudtrail captures all Management Events  `aws cloudtrail get-event-selectors --trail-name <trailname shown in describe-trails>`  Ensure there is at least one Event Selector for a Trail with `IncludeManagementEvents` set to `true` and `ReadWriteType` set to `All`  2. Get a list of all associated metric filters for this `<cloudtrail_log_group_name>`:  ``` aws logs describe-metric-filters --log-group-name ""<cloudtrail_log_group_name>"" ```  3. Ensure the output from the above command contains the following:  ``` ""filterPattern"": ""{ ($.eventName = CreateTrail) || ($.eventName = UpdateTrail) || ($.eventName = DeleteTrail) || ($.eventName = StartLogging) || ($.eventName = StopLogging) }"" ```  4. Note the `<cloudtrail_cfg_changes_metric>` value associated with the `filterPattern` found in step 3.  5. Get a list of CloudWatch alarms and filter on the `<cloudtrail_cfg_changes_metric>` captured in step 4.  ``` aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName== `<cloudtrail_cfg_changes_metric>`]' ```  6. Note the `AlarmActions` value - this will provide the SNS topic ARN value.  7. Ensure there is at least one active subscriber to the SNS topic  ``` aws sns list-subscriptions-by-topic --topic-arn <sns_topic_arn>  ``` at least one subscription should have ""SubscriptionArn"" with valid aws ARN.  ``` Example of valid ""SubscriptionArn"": ""arn:aws:sns:<region>:<aws_account_number>:<SnsTopicName>:<SubscriptionID>"" ```";Configuring log metric filter and alarm on Multi-region (global) CloudTrail - ensures that activities from all regions (used as well as unused) are monitored - ensures that activities on all supported global services are monitored - ensures that all management events across all regions are monitored;;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html:https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html:https://docs.aws.amazon.com/sns/latest/dg/SubscribeTopic.html;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;cloudwatch_log_metric_filter_and_alarm_for_cloudtrail_configuration_changes_enabled;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;4.6;Ensure a log metric filter and alarm exist for AWS Management Console authentication failures;4 Monitoring;;Level 2;Automated;Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for failed console authentication attempts.;Monitoring failed console logins may decrease lead time to detect an attempt to brute force a credential, which may provide an indicator, such as source IP, that can be used in other event correlation.;;"Perform the following to setup the metric filter, alarm, SNS topic, and subscription:  1. Create a metric filter based on filter pattern provided which checks for AWS management Console Login Failures and the `<cloudtrail_log_group_name>` taken from audit step 1. ``` aws logs put-metric-filter --log-group-name <cloudtrail_log_group_name> --filter-name `<console_signin_failure_metric>` --metric-transformations metricName= `<console_signin_failure_metric>` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventName = ConsoleLogin) && ($.errorMessage = ""Failed authentication"") }' ``` **Note**: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together.  2. Create an SNS topic that the alarm will notify ``` aws sns create-topic --name <sns_topic_name> ``` **Note**: you can execute this command once and then re-use the same topic for all monitoring alarms.  3. Create an SNS subscription to the topic created in step 2 ``` aws sns subscribe --topic-arn <sns_topic_arn> --protocol <protocol_for_sns> --notification-endpoint <sns_subscription_endpoints> ``` **Note**: you can execute this command once and then re-use the SNS subscription for all monitoring alarms.  4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2 ``` aws cloudwatch put-metric-alarm --alarm-name `<console_signin_failure_alarm>` --metric-name `<console_signin_failure_metric>` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions <sns_topic_arn> ```";"Perform the following to ensure that there is at least one active multi-region CloudTrail with prescribed metric filters and alarms configured:  1. Identify the log group name configured for use with active multi-region CloudTrail:  - List all CloudTrails: `aws cloudtrail describe-trails`  - Identify Multi region Cloudtrails: `Trails with ""IsMultiRegionTrail"" set to true`  - From value associated with CloudWatchLogsLogGroupArn note `<cloudtrail_log_group_name>`  Example: for CloudWatchLogsLogGroupArn that looks like `arn:aws:logs:<region>:<aws_account_number>:log-group:NewGroup:*`, `<cloudtrail_log_group_name>` would be `NewGroup`  - Ensure Identified Multi region CloudTrail is active  `aws cloudtrail get-trail-status --name <Name of a Multi-region CloudTrail>`  ensure `IsLogging` is set to `TRUE`  - Ensure identified Multi-region Cloudtrail captures all Management Events  `aws cloudtrail get-event-selectors --trail-name <trailname shown in describe-trails>`  Ensure there is at least one Event Selector for a Trail with `IncludeManagementEvents` set to `true` and `ReadWriteType` set to `All`  2. Get a list of all associated metric filters for this `<cloudtrail_log_group_name>`: ``` aws logs describe-metric-filters --log-group-name ""<cloudtrail_log_group_name>"" ``` 3. Ensure the output from the above command contains the following: ``` ""filterPattern"": ""{ ($.eventName = ConsoleLogin) && ($.errorMessage = ""Failed authentication"") }"" ```  4. Note the `<console_signin_failure_metric>` value associated with the `filterPattern` found in step 3.  5. Get a list of CloudWatch alarms and filter on the `<console_signin_failure_metric>` captured in step 4. ``` aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName== `<console_signin_failure_metric>`]' ``` 6. Note the `AlarmActions` value - this will provide the SNS topic ARN value.  7. Ensure there is at least one active subscriber to the SNS topic ``` aws sns list-subscriptions-by-topic --topic-arn <sns_topic_arn>  ``` at least one subscription should have ""SubscriptionArn"" with valid aws ARN. ``` Example of valid ""SubscriptionArn"": ""arn:aws:sns:<region>:<aws_account_number>:<SnsTopicName>:<SubscriptionID>"" ```";Configuring log metric filter and alarm on Multi-region (global) CloudTrail - ensures that activities from all regions (used as well as unused) are monitored - ensures that activities on all supported global services are monitored - ensures that all management events across all regions are monitored;;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html:https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html:https://docs.aws.amazon.com/sns/latest/dg/SubscribeTopic.html;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;cloudwatch_log_metric_filter_authentication_failures;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;4.15;Ensure a log metric filter and alarm exists for AWS Organizations changes;4 Monitoring;;Level 1;Automated;Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for AWS Organizations changes made in the master AWS Account.;Monitoring AWS Organizations changes can help you prevent any unwanted, accidental or intentional modifications that may lead to unauthorized access or other security breaches. This monitoring technique helps you to ensure that any unexpected changes performed within your AWS Organizations can be investigated and any unwanted changes can be rolled back.;;"Perform the following to setup the metric filter, alarm, SNS topic, and subscription:  1. Create a metric filter based on filter pattern provided which checks for AWS Organizations changes and the `<cloudtrail_log_group_name>` taken from audit step 1: ``` aws logs put-metric-filter --log-group-name <cloudtrail_log_group_name> --filter-name `<organizations_changes>` --metric-transformations metricName= `<organizations_changes>` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventSource = organizations.amazonaws.com) && (($.eventName = ""AcceptHandshake"") || ($.eventName = ""AttachPolicy"") || ($.eventName = ""CreateAccount"") || ($.eventName = ""CreateOrganizationalUnit"") || ($.eventName = ""CreatePolicy"") || ($.eventName = ""DeclineHandshake"") || ($.eventName = ""DeleteOrganization"") || ($.eventName = ""DeleteOrganizationalUnit"") || ($.eventName = ""DeletePolicy"") || ($.eventName = ""DetachPolicy"") || ($.eventName = ""DisablePolicyType"") || ($.eventName = ""EnablePolicyType"") || ($.eventName = ""InviteAccountToOrganization"") || ($.eventName = ""LeaveOrganization"") || ($.eventName = ""MoveAccount"") || ($.eventName = ""RemoveAccountFromOrganization"") || ($.eventName = ""UpdatePolicy"") || ($.eventName = ""UpdateOrganizationalUnit"")) }' ``` **Note:** You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together.  2. Create an SNS topic that the alarm will notify: ``` aws sns create-topic --name <sns_topic_name> ``` **Note:** you can execute this command once and then re-use the same topic for all monitoring alarms.  3. Create an SNS subscription to the topic created in step 2: ``` aws sns subscribe --topic-arn <sns_topic_arn> --protocol <protocol_for_sns> --notification-endpoint <sns_subscription_endpoints> ``` **Note:** you can execute this command once and then re-use the SNS subscription for all monitoring alarms.  4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2: ``` aws cloudwatch put-metric-alarm --alarm-name `<organizations_changes>` --metric-name `<organizations_changes>` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions <sns_topic_arn> ```";"1. Perform the following to ensure that there is at least one active multi-region CloudTrail with prescribed metric filters and alarms configured: - Identify the log group name configured for use with active multi-region CloudTrail: - List all CloudTrails:  ``` aws cloudtrail describe-trails ``` - Identify Multi region Cloudtrails, Trails with `""IsMultiRegionTrail""` set to true - From value associated with CloudWatchLogsLogGroupArn note <cloudtrail_log_group_name>  **Example:** for CloudWatchLogsLogGroupArn that looks like arn:aws:logs:<region>:<aws_account_number>:log-group:NewGroup:*, <cloudtrail_log_group_name> would be NewGroup  - Ensure Identified Multi region CloudTrail is active: ``` aws cloudtrail get-trail-status --name <Name of a Multi-region CloudTrail> ``` Ensure `IsLogging` is set to `TRUE`  - Ensure identified Multi-region Cloudtrail captures all Management Events: ``` aws cloudtrail get-event-selectors --trail-name <trailname shown in describe-trails> ``` - Ensure there is at least one Event Selector for a Trail with `IncludeManagementEvents` set to true and `ReadWriteType` set to `All`.  2. Get a list of all associated metric filters for this <cloudtrail_log_group_name>: ``` aws logs describe-metric-filters --log-group-name ""<cloudtrail_log_group_name>"" ``` 3. Ensure the output from the above command contains the following: ``` ""filterPattern"": ""{ ($.eventSource = organizations.amazonaws.com) && (($.eventName = ""AcceptHandshake"") || ($.eventName = ""AttachPolicy"") || ($.eventName = ""CreateAccount"") || ($.eventName = ""CreateOrganizationalUnit"") || ($.eventName = ""CreatePolicy"") || ($.eventName = ""DeclineHandshake"") || ($.eventName = ""DeleteOrganization"") || ($.eventName = ""DeleteOrganizationalUnit"") || ($.eventName = ""DeletePolicy"") || ($.eventName = ""DetachPolicy"") || ($.eventName = ""DisablePolicyType"") || ($.eventName = ""EnablePolicyType"") || ($.eventName = ""InviteAccountToOrganization"") || ($.eventName = ""LeaveOrganization"") || ($.eventName = ""MoveAccount"") || ($.eventName = ""RemoveAccountFromOrganization"") || ($.eventName = ""UpdatePolicy"") || ($.eventName = ""UpdateOrganizationalUnit"")) }"" ``` 4. Note the `<organizations_changes>` value associated with the filterPattern found in step 3.  5. Get a list of CloudWatch alarms and filter on the `<organizations_changes>` captured in step 4: ``` aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName== `<organizations_changes>`]' ``` 6. Note the AlarmActions value - this will provide the SNS topic ARN value.  7. Ensure there is at least one active subscriber to the SNS topic: ``` aws sns list-subscriptions-by-topic --topic-arn <sns_topic_arn>  ``` at least one subscription should have ""SubscriptionArn"" with valid aws ARN. Example of valid ""SubscriptionArn"":  ``` ""arn:aws:sns:<region>:<aws_account_number>:<SnsTopicName>:<SubscriptionID>"" ```";;;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html:https://docs.aws.amazon.com/organizations/latest/userguide/orgs_security_incident-response.html;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;cloudwatch_log_metric_filter_aws_organizations_changes;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;4.7;Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs;4 Monitoring;;Level 2;Automated;Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion.;Data encrypted with disabled or deleted keys will no longer be accessible.;;Perform the following to setup the metric filter, alarm, SNS topic, and subscription:  1. Create a metric filter based on filter pattern provided which checks for disabled or scheduled for deletion CMK's and the `<cloudtrail_log_group_name>` taken from audit step 1. ``` aws logs put-metric-filter --log-group-name <cloudtrail_log_group_name> --filter-name `<disable_or_delete_cmk_changes_metric>` --metric-transformations metricName= `<disable_or_delete_cmk_changes_metric>` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{($.eventSource = kms.amazonaws.com) && (($.eventName=DisableKey)||($.eventName=ScheduleKeyDeletion)) }' ``` **Note**: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together.  2. Create an SNS topic that the alarm will notify ``` aws sns create-topic --name <sns_topic_name> ``` **Note**: you can execute this command once and then re-use the same topic for all monitoring alarms.  3. Create an SNS subscription to the topic created in step 2 ``` aws sns subscribe --topic-arn <sns_topic_arn> --protocol <protocol_for_sns> --notification-endpoint <sns_subscription_endpoints> ``` **Note**: you can execute this command once and then re-use the SNS subscription for all monitoring alarms.  4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2 ``` aws cloudwatch put-metric-alarm --alarm-name `<disable_or_delete_cmk_changes_alarm>` --metric-name `<disable_or_delete_cmk_changes_metric>` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions <sns_topic_arn> ```;"Perform the following to ensure that there is at least one active multi-region CloudTrail with prescribed metric filters and alarms configured:  1. Identify the log group name configured for use with active multi-region CloudTrail:  - List all CloudTrails: `aws cloudtrail describe-trails`  - Identify Multi region Cloudtrails: `Trails with ""IsMultiRegionTrail"" set to true`  - From value associated with CloudWatchLogsLogGroupArn note `<cloudtrail_log_group_name>`  Example: for CloudWatchLogsLogGroupArn that looks like `arn:aws:logs:<region>:<aws_account_number>:log-group:NewGroup:*`, `<cloudtrail_log_group_name>` would be `NewGroup`  - Ensure Identified Multi region CloudTrail is active  `aws cloudtrail get-trail-status --name <Name of a Multi-region CloudTrail>`  ensure `IsLogging` is set to `TRUE`  - Ensure identified Multi-region Cloudtrail captures all Management Events  `aws cloudtrail get-event-selectors --trail-name <trailname shown in describe-trails>`  Ensure there is at least one Event Selector for a Trail with `IncludeManagementEvents` set to `true` and `ReadWriteType` set to `All`  2. Get a list of all associated metric filters for this `<cloudtrail_log_group_name>`: ``` aws logs describe-metric-filters --log-group-name ""<cloudtrail_log_group_name>"" ``` 3. Ensure the output from the above command contains the following: ``` ""filterPattern"": ""{($.eventSource = kms.amazonaws.com) && (($.eventName=DisableKey)||($.eventName=ScheduleKeyDeletion)) }"" ``` 4. Note the `<disable_or_delete_cmk_changes_metric>` value associated with the `filterPattern` found in step 3.  5. Get a list of CloudWatch alarms and filter on the `<disable_or_delete_cmk_changes_metric>` captured in step 4. ``` aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName== `<disable_or_delete_cmk_changes_metric>`]' ``` 6. Note the `AlarmActions` value - this will provide the SNS topic ARN value.  7. Ensure there is at least one active subscriber to the SNS topic ``` aws sns list-subscriptions-by-topic --topic-arn <sns_topic_arn>  ``` at least one subscription should have ""SubscriptionArn"" with valid aws ARN. ``` Example of valid ""SubscriptionArn"": ""arn:aws:sns:<region>:<aws_account_number>:<SnsTopicName>:<SubscriptionID>"" ```";Configuring log metric filter and alarm on Multi-region (global) CloudTrail - ensures that activities from all regions (used as well as unused) are monitored - ensures that activities on all supported global services are monitored - ensures that all management events across all regions are monitored;;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html:https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html:https://docs.aws.amazon.com/sns/latest/dg/SubscribeTopic.html;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;cloudwatch_log_metric_filter_disable_or_scheduled_deletion_of_kms_cmk;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;4.8;Ensure a log metric filter and alarm exist for S3 bucket policy changes;4 Monitoring;;Level 1;Automated;Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for changes to S3 bucket policies.;Monitoring changes to S3 bucket policies may reduce time to detect and correct permissive policies on sensitive S3 buckets.;;Perform the following to setup the metric filter, alarm, SNS topic, and subscription:  1. Create a metric filter based on filter pattern provided which checks for S3 bucket policy changes and the `<cloudtrail_log_group_name>` taken from audit step 1. ``` aws logs put-metric-filter --log-group-name <cloudtrail_log_group_name> --filter-name `<s3_bucket_policy_changes_metric>` --metric-transformations metricName= `<s3_bucket_policy_changes_metric>` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventSource = s3.amazonaws.com) && (($.eventName = PutBucketAcl) || ($.eventName = PutBucketPolicy) || ($.eventName = PutBucketCors) || ($.eventName = PutBucketLifecycle) || ($.eventName = PutBucketReplication) || ($.eventName = DeleteBucketPolicy) || ($.eventName = DeleteBucketCors) || ($.eventName = DeleteBucketLifecycle) || ($.eventName = DeleteBucketReplication)) }' ```  **Note**: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together.  2. Create an SNS topic that the alarm will notify ``` aws sns create-topic --name <sns_topic_name> ```  **Note**: you can execute this command once and then re-use the same topic for all monitoring alarms.  3. Create an SNS subscription to the topic created in step 2 ``` aws sns subscribe --topic-arn <sns_topic_arn> --protocol <protocol_for_sns> --notification-endpoint <sns_subscription_endpoints> ```  **Note**: you can execute this command once and then re-use the SNS subscription for all monitoring alarms.  4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2 ``` aws cloudwatch put-metric-alarm --alarm-name `<s3_bucket_policy_changes_alarm>` --metric-name `<s3_bucket_policy_changes_metric>` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions <sns_topic_arn> ```;"Perform the following to ensure that there is at least one active multi-region CloudTrail with prescribed metric filters and alarms configured:  1. Identify the log group name configured for use with active multi-region CloudTrail:  - List all CloudTrails: `aws cloudtrail describe-trails`  - Identify Multi region Cloudtrails: `Trails with ""IsMultiRegionTrail"" set to true`  - From value associated with CloudWatchLogsLogGroupArn note `<cloudtrail_log_group_name>`  Example: for CloudWatchLogsLogGroupArn that looks like `arn:aws:logs:<region>:<aws_account_number>:log-group:NewGroup:*`, `<cloudtrail_log_group_name>` would be `NewGroup`  - Ensure Identified Multi region CloudTrail is active  `aws cloudtrail get-trail-status --name <Name of a Multi-region CloudTrail>`  ensure `IsLogging` is set to `TRUE`  - Ensure identified Multi-region Cloudtrail captures all Management Events  `aws cloudtrail get-event-selectors --trail-name <trailname shown in describe-trails>`  Ensure there is at least one Event Selector for a Trail with `IncludeManagementEvents` set to `true` and `ReadWriteType` set to `All`  2. Get a list of all associated metric filters for this `<cloudtrail_log_group_name>`: ``` aws logs describe-metric-filters --log-group-name ""<cloudtrail_log_group_name>"" ``` 3. Ensure the output from the above command contains the following: ``` ""filterPattern"": ""{ ($.eventSource = s3.amazonaws.com) && (($.eventName = PutBucketAcl) || ($.eventName = PutBucketPolicy) || ($.eventName = PutBucketCors) || ($.eventName = PutBucketLifecycle) || ($.eventName = PutBucketReplication) || ($.eventName = DeleteBucketPolicy) || ($.eventName = DeleteBucketCors) || ($.eventName = DeleteBucketLifecycle) || ($.eventName = DeleteBucketReplication)) }"" ``` 4. Note the `<s3_bucket_policy_changes_metric>` value associated with the `filterPattern` found in step 3.  5. Get a list of CloudWatch alarms and filter on the `<s3_bucket_policy_changes_metric>` captured in step 4. ``` aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName== `<s3_bucket_policy_changes_metric>`]' ``` 6. Note the `AlarmActions` value - this will provide the SNS topic ARN value.  7. Ensure there is at least one active subscriber to the SNS topic ``` aws sns list-subscriptions-by-topic --topic-arn <sns_topic_arn>  ``` at least one subscription should have ""SubscriptionArn"" with valid aws ARN. ``` Example of valid ""SubscriptionArn"": ""arn:aws:sns:<region>:<aws_account_number>:<SnsTopicName>:<SubscriptionID>"" ```";Configuring log metric filter and alarm on Multi-region (global) CloudTrail - ensures that activities from all regions (used as well as unused) are monitored - ensures that activities on all supported global services are monitored - ensures that all management events across all regions are monitored;;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html:https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html:https://docs.aws.amazon.com/sns/latest/dg/SubscribeTopic.html;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;cloudwatch_log_metric_filter_for_s3_bucket_policy_changes;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;4.4;Ensure a log metric filter and alarm exist for IAM policy changes;4 Monitoring;;Level 1;Automated;Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies.;Monitoring changes to IAM policies will help ensure authentication and authorization controls remain intact.;;Perform the following to setup the metric filter, alarm, SNS topic, and subscription:  1. Create a metric filter based on filter pattern provided which checks for IAM policy changes and the `<cloudtrail_log_group_name>` taken from audit step 1. ``` aws logs put-metric-filter --log-group-name `<cloudtrail_log_group_name>` --filter-name `<iam_changes_metric>` --metric-transformations metricName= `<iam_changes_metric>` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{($.eventName=DeleteGroupPolicy)||($.eventName=DeleteRolePolicy)||($.eventName=DeleteUserPolicy)||($.eventName=PutGroupPolicy)||($.eventName=PutRolePolicy)||($.eventName=PutUserPolicy)||($.eventName=CreatePolicy)||($.eventName=DeletePolicy)||($.eventName=CreatePolicyVersion)||($.eventName=DeletePolicyVersion)||($.eventName=AttachRolePolicy)||($.eventName=DetachRolePolicy)||($.eventName=AttachUserPolicy)||($.eventName=DetachUserPolicy)||($.eventName=AttachGroupPolicy)||($.eventName=DetachGroupPolicy)}' ```  **Note**: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together.  2. Create an SNS topic that the alarm will notify ``` aws sns create-topic --name <sns_topic_name> ```  **Note**: you can execute this command once and then re-use the same topic for all monitoring alarms.  3. Create an SNS subscription to the topic created in step 2 ``` aws sns subscribe --topic-arn <sns_topic_arn> --protocol <protocol_for_sns> --notification-endpoint <sns_subscription_endpoints> ```  **Note**: you can execute this command once and then re-use the SNS subscription for all monitoring alarms.  4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2 ``` aws cloudwatch put-metric-alarm --alarm-name `<iam_changes_alarm>` --metric-name `<iam_changes_metric>` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions <sns_topic_arn> ```;"Perform the following to ensure that there is at least one active multi-region CloudTrail with prescribed metric filters and alarms configured:  1. Identify the log group name configured for use with active multi-region CloudTrail:  - List all CloudTrails:  `aws cloudtrail describe-trails`  - Identify Multi region Cloudtrails: `Trails with ""IsMultiRegionTrail"" set to true`  - From value associated with CloudWatchLogsLogGroupArn note `<cloudtrail_log_group_name>`  Example: for CloudWatchLogsLogGroupArn that looks like `arn:aws:logs:<region>:<aws_account_number>:log-group:NewGroup:*`, `<cloudtrail_log_group_name>` would be `NewGroup`  - Ensure Identified Multi region CloudTrail is active  `aws cloudtrail get-trail-status --name <Name of a Multi-region CloudTrail>`  ensure `IsLogging` is set to `TRUE`  - Ensure identified Multi-region Cloudtrail captures all Management Events  `aws cloudtrail get-event-selectors --trail-name <trailname shown in describe-trails>`  Ensure there is at least one Event Selector for a Trail with `IncludeManagementEvents` set to `true` and `ReadWriteType` set to `All`  2. Get a list of all associated metric filters for this `<cloudtrail_log_group_name>`:  ``` aws logs describe-metric-filters --log-group-name ""<cloudtrail_log_group_name>"" ```  3. Ensure the output from the above command contains the following:  ``` ""filterPattern"": ""{($.eventName=DeleteGroupPolicy)||($.eventName=DeleteRolePolicy)||($.eventName=DeleteUserPolicy)||($.eventName=PutGroupPolicy)||($.eventName=PutRolePolicy)||($.eventName=PutUserPolicy)||($.eventName=CreatePolicy)||($.eventName=DeletePolicy)||($.eventName=CreatePolicyVersion)||($.eventName=DeletePolicyVersion)||($.eventName=AttachRolePolicy)||($.eventName=DetachRolePolicy)||($.eventName=AttachUserPolicy)||($.eventName=DetachUserPolicy)||($.eventName=AttachGroupPolicy)||($.eventName=DetachGroupPolicy)}"" ```  4. Note the `<iam_changes_metric>` value associated with the `filterPattern` found in step 3.  5. Get a list of CloudWatch alarms and filter on the `<iam_changes_metric>` captured in step 4.  ``` aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName== `<iam_changes_metric>`]' ```  6. Note the `AlarmActions` value - this will provide the SNS topic ARN value.  7. Ensure there is at least one active subscriber to the SNS topic  ``` aws sns list-subscriptions-by-topic --topic-arn <sns_topic_arn>  ``` at least one subscription should have ""SubscriptionArn"" with valid aws ARN.  ``` Example of valid ""SubscriptionArn"": ""arn:aws:sns:<region>:<aws_account_number>:<SnsTopicName>:<SubscriptionID>"" ```";Configuring log metric filter and alarm on Multi-region (global) CloudTrail - ensures that activities from all regions (used as well as unused) are monitored - ensures that activities on all supported global services are monitored - ensures that all management events across all regions are monitored;;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html:https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html:https://docs.aws.amazon.com/sns/latest/dg/SubscribeTopic.html;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;cloudwatch_log_metric_filter_policy_changes;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;4.3;Ensure a log metric filter and alarm exist for usage of 'root' account;4 Monitoring;;Level 1;Automated;Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for 'root' login attempts.;Monitoring for 'root' account logins will provide visibility into the use of a fully privileged account and an opportunity to reduce the use of it.;;"Perform the following to setup the metric filter, alarm, SNS topic, and subscription:  1. Create a metric filter based on filter pattern provided which checks for 'Root' account usage and the `<cloudtrail_log_group_name>` taken from audit step 1. ``` aws logs put-metric-filter --log-group-name `<cloudtrail_log_group_name>` --filter-name `<root_usage_metric>` --metric-transformations metricName= `<root_usage_metric>` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ $.userIdentity.type = ""Root"" && $.userIdentity.invokedBy NOT EXISTS && $.eventType != ""AwsServiceEvent"" }' ```  **Note**: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together.  2. Create an SNS topic that the alarm will notify ``` aws sns create-topic --name <sns_topic_name> ```  **Note**: you can execute this command once and then re-use the same topic for all monitoring alarms.  3. Create an SNS subscription to the topic created in step 2 ``` aws sns subscribe --topic-arn <sns_topic_arn> --protocol <protocol_for_sns> --notification-endpoint <sns_subscription_endpoints> ```  **Note**: you can execute this command once and then re-use the SNS subscription for all monitoring alarms.  4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2 ``` aws cloudwatch put-metric-alarm --alarm-name `<root_usage_alarm>` --metric-name `<root_usage_metric>` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions <sns_topic_arn> ```";"Perform the following to ensure that there is at least one active multi-region CloudTrail with prescribed metric filters and alarms configured:  1. Identify the log group name configured for use with active multi-region CloudTrail:  - List all CloudTrails:  `aws cloudtrail describe-trails`  - Identify Multi region Cloudtrails: `Trails with ""IsMultiRegionTrail"" set to true`  - From value associated with CloudWatchLogsLogGroupArn note `<cloudtrail_log_group_name>`  Example: for CloudWatchLogsLogGroupArn that looks like `arn:aws:logs:<region>:<aws_account_number>:log-group:NewGroup:*`, `<cloudtrail_log_group_name>` would be `NewGroup`  - Ensure Identified Multi region CloudTrail is active  `aws cloudtrail get-trail-status --name <Name of a Multi-region CloudTrail>`  ensure `IsLogging` is set to `TRUE`  - Ensure identified Multi-region Cloudtrail captures all Management Events  `aws cloudtrail get-event-selectors --trail-name <trailname shown in describe-trails>`  Ensure there is at least one Event Selector for a Trail with `IncludeManagementEvents` set to `true` and `ReadWriteType` set to `All`  2. Get a list of all associated metric filters for this `<cloudtrail_log_group_name>`:  ``` aws logs describe-metric-filters --log-group-name ""<cloudtrail_log_group_name>"" ```  3. Ensure the output from the above command contains the following:  ``` ""filterPattern"": ""{ $.userIdentity.type = ""Root"" && $.userIdentity.invokedBy NOT EXISTS && $.eventType != ""AwsServiceEvent"" }"" ```  4. Note the `<root_usage_metric>` value associated with the `filterPattern` found in step 3.  5. Get a list of CloudWatch alarms and filter on the `<root_usage_metric>` captured in step 4.  ``` aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName== `<root_usage_metric>`]' ```  6. Note the `AlarmActions` value - this will provide the SNS topic ARN value.  7. Ensure there is at least one active subscriber to the SNS topic  ``` aws sns list-subscriptions-by-topic --topic-arn <sns_topic_arn>  ``` at least one subscription should have ""SubscriptionArn"" with valid aws ARN.  ``` Example of valid ""SubscriptionArn"": ""arn:aws:sns:<region>:<aws_account_number>:<SnsTopicName>:<SubscriptionID>"" ```";**Configuring log metric filter and alarm on Multi-region (global) CloudTrail**  - ensures that activities from all regions (used as well as unused) are monitored  - ensures that activities on all supported global services are monitored  - ensures that all management events across all regions are monitored;;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html:https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html:https://docs.aws.amazon.com/sns/latest/dg/SubscribeTopic.html;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;cloudwatch_log_metric_filter_root_usage;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;4.10;Ensure a log metric filter and alarm exist for security group changes;4 Monitoring;;Level 2;Automated;Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Security Groups are a stateful packet filter that controls ingress and egress traffic within a VPC. It is recommended that a metric filter and alarm be established for detecting changes to Security Groups.;Monitoring changes to security group will help ensure that resources and services are not unintentionally exposed.;;"Perform the following to setup the metric filter, alarm, SNS topic, and subscription:  1. Create a metric filter based on filter pattern provided which checks for security groups changes and the `<cloudtrail_log_group_name>` taken from audit step 1. ``` aws logs put-metric-filter --log-group-name ""<cloudtrail_log_group_name>"" --filter-name ""<security_group_changes_metric>"" --metric-transformations metricName= ""<security_group_changes_metric>"" ,metricNamespace=""CISBenchmark"",metricValue=1 --filter-pattern ""{ ($.eventName = AuthorizeSecurityGroupIngress) || ($.eventName = AuthorizeSecurityGroupEgress) || ($.eventName = RevokeSecurityGroupIngress) || ($.eventName = RevokeSecurityGroupEgress) || ($.eventName = CreateSecurityGroup) || ($.eventName = DeleteSecurityGroup) }"" ```  **Note**: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together.  2. Create an SNS topic that the alarm will notify ``` aws sns create-topic --name ""<sns_topic_name>"" ```  **Note**: you can execute this command once and then re-use the same topic for all monitoring alarms.  3. Create an SNS subscription to the topic created in step 2 ``` aws sns subscribe --topic-arn ""<sns_topic_arn>"" --protocol <protocol_for_sns> --notification-endpoint ""<sns_subscription_endpoints>"" ```  **Note**: you can execute this command once and then re-use the SNS subscription for all monitoring alarms.  4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2 ``` aws cloudwatch put-metric-alarm --alarm-name ""<security_group_changes_alarm>"" --metric-name ""<security_group_changes_metric>"" --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace ""CISBenchmark"" --alarm-actions ""<sns_topic_arn>"" ```";"Perform the following to ensure that there is at least one active multi-region CloudTrail with prescribed metric filters and alarms configured:  1. Identify the log group name configured for use with active multi-region CloudTrail:  - List all CloudTrails: `aws cloudtrail describe-trails`  - Identify Multi region Cloudtrails: `Trails with ""IsMultiRegionTrail"" set to true`  - From value associated with CloudWatchLogsLogGroupArn note `<cloudtrail_log_group_name>`  Example: for CloudWatchLogsLogGroupArn that looks like `arn:aws:logs:<region>:<aws_account_number>:log-group:NewGroup:*`, `<cloudtrail_log_group_name>` would be `NewGroup`  - Ensure Identified Multi region CloudTrail is active  `aws cloudtrail get-trail-status --name <Name of a Multi-region CloudTrail>`  ensure `IsLogging` is set to `TRUE`  - Ensure identified Multi-region Cloudtrail captures all Management Events  `aws cloudtrail get-event-selectors --trail-name <trailname shown in describe-trails>`  Ensure there is at least one Event Selector for a Trail with `IncludeManagementEvents` set to `true` and `ReadWriteType` set to `All`  2. Get a list of all associated metric filters for this `<cloudtrail_log_group_name>`: ``` aws logs describe-metric-filters --log-group-name ""<cloudtrail_log_group_name>"" ``` 3. Ensure the output from the above command contains the following: ``` ""filterPattern"": ""{ ($.eventName = AuthorizeSecurityGroupIngress) || ($.eventName = AuthorizeSecurityGroupEgress) || ($.eventName = RevokeSecurityGroupIngress) || ($.eventName = RevokeSecurityGroupEgress) || ($.eventName = CreateSecurityGroup) || ($.eventName = DeleteSecurityGroup) }"" ``` 4. Note the `<security_group_changes_metric>` value associated with the `filterPattern` found in step 3.  5. Get a list of CloudWatch alarms and filter on the `<security_group_changes_metric>` captured in step 4. ``` aws cloudwatch describe-alarms --query ""MetricAlarms[?MetricName== '<security_group_changes_metric>']"" ``` 6. Note the `AlarmActions` value - this will provide the SNS topic ARN value.  7. Ensure there is at least one active subscriber to the SNS topic ``` aws sns list-subscriptions-by-topic --topic-arn <sns_topic_arn>  ``` at least one subscription should have ""SubscriptionArn"" with valid aws ARN. ``` Example of valid ""SubscriptionArn"": ""arn:aws:sns:<region>:<aws_account_number>:<SnsTopicName>:<SubscriptionID>"" ```";Configuring log metric filter and alarm on Multi-region (global) CloudTrail - ensures that activities from all regions (used as well as unused) are monitored - ensures that activities on all supported global services are monitored - ensures that all management events across all regions are monitored;;https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html:https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html:https://docs.aws.amazon.com/sns/latest/dg/SubscribeTopic.html;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;cloudwatch_log_metric_filter_security_group_changes;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;4.2;Ensure a log metric filter and alarm exist for Management Console sign-in without MFA;4 Monitoring;;Level 1;Automated;Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA).;Monitoring for single-factor console logins will increase visibility into accounts that are not protected by MFA.;;"Perform the following to setup the metric filter, alarm, SNS topic, and subscription:  1. Create a metric filter based on filter pattern provided which checks for AWS Management Console sign-in without MFA and the `<cloudtrail_log_group_name>` taken from audit step 1.  Use Command:   ``` aws logs put-metric-filter --log-group-name <cloudtrail_log_group_name> --filter-name `<no_mfa_console_signin_metric>` --metric-transformations metricName= `<no_mfa_console_signin_metric>` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventName = ""ConsoleLogin"") && ($.additionalEventData.MFAUsed != ""Yes"") }' ```  Or (To reduce false positives incase Single Sign-On (SSO) is used in organization):  ``` aws logs put-metric-filter --log-group-name <cloudtrail_log_group_name> --filter-name `<no_mfa_console_signin_metric>` --metric-transformations metricName= `<no_mfa_console_signin_metric>` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventName = ""ConsoleLogin"") && ($.additionalEventData.MFAUsed != ""Yes"") && ($.userIdentity.type = ""IAMUser"") && ($.responseElements.ConsoleLogin = ""Success"") }' ```  **Note**: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together.  2. Create an SNS topic that the alarm will notify ``` aws sns create-topic --name <sns_topic_name> ```  **Note**: you can execute this command once and then re-use the same topic for all monitoring alarms.  3. Create an SNS subscription to the topic created in step 2 ``` aws sns subscribe --topic-arn <sns_topic_arn> --protocol <protocol_for_sns> --notification-endpoint <sns_subscription_endpoints> ```  **Note**: you can execute this command once and then re-use the SNS subscription for all monitoring alarms.  4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2 ``` aws cloudwatch put-metric-alarm --alarm-name `<no_mfa_console_signin_alarm>` --metric-name `<no_mfa_console_signin_metric>` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions <sns_topic_arn> ```";"Perform the following to ensure that there is at least one active multi-region CloudTrail with prescribed metric filters and alarms configured:  1. Identify the log group name configured for use with active multi-region CloudTrail:  - List all `CloudTrails`:  ``` aws cloudtrail describe-trails ```  - Identify Multi region Cloudtrails: `Trails with ""IsMultiRegionTrail"" set to true`  - From value associated with CloudWatchLogsLogGroupArn note `<cloudtrail_log_group_name>`  Example: for CloudWatchLogsLogGroupArn that looks like `arn:aws:logs:<region>:<aws_account_number>:log-group:NewGroup:*`, `<cloudtrail_log_group_name>` would be `NewGroup`  - Ensure Identified Multi region `CloudTrail` is active  ``` aws cloudtrail get-trail-status --name <Name of a Multi-region CloudTrail> ```  Ensure in the output that `IsLogging` is set to `TRUE`  - Ensure identified Multi-region 'Cloudtrail' captures all Management Events  ``` aws cloudtrail get-event-selectors --trail-name <trailname shown in describe-trails> ```  Ensure in the output there is at least one Event Selector for a Trail with `IncludeManagementEvents` set to `true` and `ReadWriteType` set to `All`  2. Get a list of all associated metric filters for this `<cloudtrail_log_group_name>`: ``` aws logs describe-metric-filters --log-group-name ""<cloudtrail_log_group_name>"" ``` 3. Ensure the output from the above command contains the following: ``` ""filterPattern"": ""{ ($.eventName = ""ConsoleLogin"") && ($.additionalEventData.MFAUsed != ""Yes"") }"" ```  Or (To reduce false positives incase Single Sign-On (SSO) is used in organization):  ``` ""filterPattern"": ""{ ($.eventName = ""ConsoleLogin"") && ($.additionalEventData.MFAUsed != ""Yes"") && ($.userIdentity.type = ""IAMUser"") && ($.responseElements.ConsoleLogin = ""Success"") }"" ```  4. Note the `<no_mfa_console_signin_metric>` value associated with the `filterPattern` found in step 3.  5. Get a list of CloudWatch alarms and filter on the `<no_mfa_console_signin_metric>` captured in step 4.  ``` aws cloudwatch describe-alarms --query 'MetricAlarms[?MetricName== `<no_mfa_console_signin_metric>`]' ``` 6. Note the `AlarmActions` value - this will provide the SNS topic ARN value.  7. Ensure there is at least one active subscriber to the SNS topic ``` aws sns list-subscriptions-by-topic --topic-arn <sns_topic_arn>  ``` at least one subscription should have ""SubscriptionArn"" with valid aws ARN. ``` Example of valid ""SubscriptionArn"": ""arn:aws:sns:<region>:<aws_account_number>:<SnsTopicName>:<SubscriptionID>"" ```";"Configuring log metric filter and alarm on Multi-region (global) CloudTrail - ensures that activities from all regions (used as well as unused) are monitored - ensures that activities on all supported global services are monitored - ensures that all management events across all regions are monitored -Filter pattern set to `{ ($.eventName = ""ConsoleLogin"") && ($.additionalEventData.MFAUsed != ""Yes"") && ($.userIdentity.type = ""IAMUser"") && ($.responseElements.ConsoleLogin = ""Success""}` reduces false alarms raised when user logs in via SSO account.";;https://docs.aws.amazon.com/AmazonCloudWatch/latest/DeveloperGuide/viewing_metrics_with_cloudwatch.html:https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html:https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html:https://docs.aws.amazon.com/sns/latest/dg/SubscribeTopic.html;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;cloudwatch_log_metric_filter_sign_in_without_mfa;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;4.1;Ensure a log metric filter and alarm exist for unauthorized API calls;4 Monitoring;;Level 1;Automated;Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for unauthorized API calls.;Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.;This alert may be triggered by normal read-only console activities that attempt to opportunistically gather optional information, but gracefully fail if they don't have permissions.  If an excessive number of alerts are being generated then an organization may wish to consider adding read access to the limited IAM user permissions simply to quiet the alerts.  In some cases doing this may allow the users to actually view some areas of the system - any additional access given should be reviewed for alignment with the original limited IAM user intent.;"Perform the following to setup the metric filter, alarm, SNS topic, and subscription:  1. Create a metric filter based on filter pattern provided which checks for unauthorized API calls and the `<cloudtrail_log_group_name>` taken from audit step 1. ``` aws logs put-metric-filter --log-group-name ""cloudtrail_log_group_name"" --filter-name ""<unauthorized_api_calls_metric>"" --metric-transformations metricName=unauthorized_api_calls_metric,metricNamespace=CISBenchmark,metricValue=1 --filter-pattern ""{ ($.errorCode = ""*UnauthorizedOperation"") || ($.errorCode = ""AccessDenied*"") || ($.sourceIPAddress!=""delivery.logs.amazonaws.com"") || ($.eventName!=""HeadBucket"") }"" ```  **Note**: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together.  2. Create an SNS topic that the alarm will notify ``` aws sns create-topic --name <sns_topic_name> ``` **Note**: you can execute this command once and then re-use the same topic for all monitoring alarms. **Note**: Capture the TopicArn displayed when creating the SNS Topic in Step 2.  3. Create an SNS subscription to the topic created in step 2 ``` aws sns subscribe --topic-arn <sns_topic_arn from step 2> --protocol <protocol_for_sns> --notification-endpoint <sns_subscription_endpoints> ```  **Note**: you can execute this command once and then re-use the SNS subscription for all monitoring alarms.  4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2 ``` aws cloudwatch put-metric-alarm --alarm-name ""unauthorized_api_calls_alarm"" --metric-name ""unauthorized_api_calls_metric"" --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace ""CISBenchmark"" --alarm-actions <sns_topic_arn> ```";"Perform the following to ensure that there is at least one active multi-region CloudTrail with prescribed metric filters and alarms configured:  1. Identify the log group name configured for use with active multi-region CloudTrail:  - List all CloudTrails: `aws cloudtrail describe-trails`  - Identify Multi region Cloudtrails: `Trails with ""IsMultiRegionTrail"" set to true`  - From value associated with ""Name"":` note `<cloudtrail__name>`  - From value associated with ""CloudWatchLogsLogGroupArn"" note <cloudtrail_log_group_name>  Example: for CloudWatchLogsLogGroupArn that looks like arn:aws:logs:<region>:<aws_account_number>:log-group:NewGroup:*, <cloudtrail_log_group_name> would be NewGroup  - Ensure Identified Multi region CloudTrail is active  `aws cloudtrail get-trail-status --name <Name of a Multi-region CloudTrail>`  ensure `IsLogging` is set to `TRUE`  - Ensure identified Multi-region Cloudtrail captures all Management Events  `aws cloudtrail get-event-selectors --trail-name <""Name"" as shown in describe-trails>`  Ensure there is at least one Event Selector for a Trail with `IncludeManagementEvents` set to `true` and `ReadWriteType` set to `All`  2. Get a list of all associated metric filters for this `<cloudtrail_log_group_name>` that you captured in step 1:  ``` aws logs describe-metric-filters --log-group-name ""<cloudtrail_log_group_name>"" ```  3. Ensure the output from the above command contains the following:  ``` ""filterPattern"": ""{ ($.errorCode = *UnauthorizedOperation) || ($.errorCode = AccessDenied*) || ($.sourceIPAddress!=delivery.logs.amazonaws.com) || ($.eventName!=HeadBucket) }"", ```  4. Note the ""filterName"" `<unauthorized_api_calls_metric>` value associated with the `filterPattern` found in step 3.  5. Get a list of CloudWatch alarms and filter on the `<unauthorized_api_calls_metric>` captured in step 4.  ``` aws cloudwatch describe-alarms --query ""MetricAlarms[?MetricName == `unauthorized_api_calls_metric`]"" ```  6. Note the `AlarmActions` value - this will provide the SNS topic ARN value.  7. Ensure there is at least one active subscriber to the SNS topic  ``` aws sns list-subscriptions-by-topic --topic-arn <sns_topic_arn>  ``` at least one subscription should have ""SubscriptionArn"" with valid aws ARN.  ``` Example of valid ""SubscriptionArn"": ""arn:aws:sns:<region>:<aws_account_number>:<SnsTopicName>:<SubscriptionID>"" ```";Configuring log metric filter and alarm on Multi-region (global) CloudTrail - ensures that activities from all regions (used as well as unused) are monitored - ensures that activities on all supported global services are monitored - ensures that all management events across all regions are monitored;;https://aws.amazon.com/sns/:https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html:https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail.html:https://docs.aws.amazon.com/sns/latest/dg/SubscribeTopic.html;FAIL;No CloudWatch log groups found with metric filters or alarms associated.;arn:aws:logs:ap-northeast-2:132410971304:log-group;132410971304;cloudwatch_log_metric_filter_unauthorized_api_calls;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;3.5;Ensure AWS Config is enabled in all regions;3 Logging;;Level 2;Automated;AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. It is recommended AWS Config be enabled in all regions.;The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing.;It is recommended AWS Config be enabled in all regions.;To implement AWS Config configuration:  **From Console:**  1. Select the region you want to focus on in the top right of the console 2. Click `Services`  3. Click `Config`  4. Define which resources you want to record in the selected region 5. Choose to include global resources (IAM resources) 6. Specify an S3 bucket in the same account or in another managed AWS account 7. Create an SNS Topic from the same AWS account or another managed AWS account  **From Command Line:**  1. Ensure there is an appropriate S3 bucket, SNS topic, and IAM role per the [AWS Config Service prerequisites](http://docs.aws.amazon.com/config/latest/developerguide/gs-cli-prereq.html). 2. Run this command to set up the configuration recorder ``` aws configservice subscribe --s3-bucket my-config-bucket --sns-topic arn:aws:sns:us-east-1:012345678912:my-config-notice --iam-role arn:aws:iam::012345678912:role/myConfigRole ``` 3. Run this command to start the configuration recorder: ``` start-configuration-recorder --configuration-recorder-name <value> ```;"Process to evaluate AWS Config configuration per region  **From Console:**  1. Sign in to the AWS Management Console and open the AWS Config console at [https://console.aws.amazon.com/config/](https://console.aws.amazon.com/config/). 2. On the top right of the console select target Region. 3. If presented with Setup AWS Config - follow remediation procedure: 4. On the Resource inventory page, Click on edit (the gear icon). The Set Up AWS Config page appears. 5. Ensure 1 or both check-boxes under ""All Resources"" is checked.  - Include global resources related to IAM resources - which needs to be enabled in 1 region only 6. Ensure the correct S3 bucket has been defined. 7. Ensure the correct SNS topic has been defined. 8. Repeat steps 2 to 7 for each region.  **From Command Line:**  1. Run this command to show all AWS Config recorders and their properties: ``` aws configservice describe-configuration-recorders ``` 2. Evaluate the output to ensure that there's at least one recorder for which `recordingGroup` object includes `""allSupported"": true` AND `""includeGlobalResourceTypes"": true`  Note: There is one more parameter ""ResourceTypes"" in recordingGroup object. We don't need to check the same as whenever we set ""allSupported"": true, AWS enforces resource types to be empty (""ResourceTypes"":[])  Sample Output:  ``` {  ""ConfigurationRecorders"": [  {  ""recordingGroup"": {  ""allSupported"": true,  ""resourceTypes"": [],  ""includeGlobalResourceTypes"": true  },  ""roleARN"": ""arn:aws:iam::<AWS_Account_ID>:role/service-role/<config-role-name>"",  ""name"": ""default""  }  ] } ```  3. Run this command to show the status for all AWS Config recorders: ``` aws configservice describe-configuration-recorder-status ``` 4. In the output, find recorders with `name` key matching the recorders that met criteria in step 2. Ensure that at least one of them includes `""recording"": true` and `""lastStatus"": ""SUCCESS""`";;;https://docs.aws.amazon.com/cli/latest/reference/configservice/describe-configuration-recorder-status.html;FAIL;AWS Config recorder 132410971304 is disabled.;arn:aws:config:ap-northeast-2:132410971304:recorder;132410971304;config_recorder_all_regions_enabled;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;1.18;Ensure IAM instance roles are used for AWS resource access from instances;1 Identity and Access Management;;Level 2;Manual;"AWS access from within AWS instances can be done by either encoding AWS keys into AWS API calls or by assigning the instance to a role which has an appropriate permissions policy for the required access. ""AWS Access"" means accessing the APIs of AWS in order to access AWS resources or manage AWS account resources.";AWS IAM roles reduce the risks associated with sharing and rotating credentials that can be used outside of AWS itself. If credentials are compromised, they can be used from outside of the AWS account they give access to. In contrast, in order to leverage role permissions an attacker would need to gain and maintain access to a specific instance to use the privileges associated with it.  Additionally, if credentials are encoded into compiled applications or other hard to change mechanisms, then they are even more unlikely to be properly rotated due to service disruption risks. As time goes on, credentials that cannot be rotated are more likely to be known by an increasing number of individuals who no longer work for the organization owning the credentials.;;IAM roles can only be associated at the launch of an instance. To remediate an instance to add it to a role you must create a new instance.  If the instance has no external dependencies on its current private ip or public addresses are elastic IPs:  1. In AWS IAM create a new role. Assign a permissions policy if needed permissions are already known. 2. In the AWS console launch a new instance with identical settings to the existing instance, and ensure that the newly created role is selected. 3. Shutdown both the existing instance and the new instance. 4. Detach disks from both instances. 5. Attach the existing instance disks to the new instance. 6. Boot the new instance and you should have the same machine, but with the associated role.  **Note:** if your environment has dependencies on a dynamically assigned PRIVATE IP address you can create an AMI from the existing instance, destroy the old one and then when launching from the AMI, manually assign the previous private IP address.  **Note: **if your environment has dependencies on a dynamically assigned PUBLIC IP address there is not a way ensure the address is retained and assign an instance role. Dependencies on dynamically assigned public IP addresses are a bad practice and, if possible, you may wish to rebuild the instance with a new elastic IP address and make the investment to remediate affected systems while assigning the system to a role.;"Where an instance is associated with a Role:  For instances that are known to perform AWS actions, ensure that they belong to an instance role that has the necessary permissions:  1. Login to AWS Console (with appropriate permissions to View Identity Access Management Account Settings) 2. Open the EC2 Dashboard and choose ""Instances"" 3. Click the EC2 instance that performs AWS actions, in the lower pane details find ""IAM Role"" 4. If the Role is blank, the instance is not assigned to one. 5. If the Role is filled in, it does not mean the instance might not \*also\* have credentials encoded on it for some activities.  Where an Instance Contains Embedded Credentials:  - On the instance that is known to perform AWS actions, audit all scripts and environment variables to ensure that none of them contain AWS credentials.  Where an Instance Application Contains Embedded Credentials:  - Applications that run on an instance may also have credentials embedded. This is a bad practice, but even worse if the source code is stored in a public code repository such as github. When an application contains credentials can be determined by eliminating all other sources of credentials and if the application can still access AWS resources - it likely contains embedded credentials. Another method is to examine all source code and configuration files of the application.";;;https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-ec2.html:https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-roles-for-amazon-ec2.html;FAIL;EC2 Instance i-0fbecaba3c48e7c79 not associated with an Instance Profile Role.;arn:aws:ec2:ap-northeast-2:132410971304:instance/i-0fbecaba3c48e7c79;i-0fbecaba3c48e7c79;ec2_instance_profile_attached;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;5.1;Ensure no Network ACLs allow ingress from 0.0.0.0/0 to remote server administration ports;5 Networking;;Level 1;Automated;The Network Access Control List (NACL) function provide stateless filtering of ingress and egress network traffic to AWS resources. It is recommended that no NACL allows unrestricted ingress access to remote server administration ports, such as SSH to port `22` and RDP to port `3389`.;Public access to remote server administration ports, such as 22 and 3389, increases resource attack surface and unnecessarily raises the risk of resource compromise.;;**From Console:**  Perform the following: 1. Login to the AWS Management Console at https://console.aws.amazon.com/vpc/home 2. In the left pane, click `Network ACLs` 3. For each network ACL to remediate, perform the following:  - Select the network ACL  - Click the `Inbound Rules` tab  - Click `Edit inbound rules`  - Either A) update the Source field to a range other than 0.0.0.0/0, or, B) Click `Delete` to remove the offending inbound rule  - Click `Save`;**From Console:**  Perform the following to determine if the account is configured as prescribed: 1. Login to the AWS Management Console at https://console.aws.amazon.com/vpc/home 2. In the left pane, click `Network ACLs` 3. For each network ACL, perform the following:  - Select the network ACL  - Click the `Inbound Rules` tab  - Ensure no rule exists that has a port range that includes port `22`, `3389`, or other remote server administration ports for your environment and has a `Source` of `0.0.0.0/0` and shows `ALLOW`  **Note:** A Port value of `ALL` or a port range such as `0-1024` are inclusive of port `22`, `3389`, and other remote server administration ports;;;https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html:https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Security.html#VPC_Security_Comparison;FAIL;Network ACL acl-0572e1ab82993bb20 has SSH port 22 open to the Internet.;arn:aws:ec2:ap-northeast-2:132410971304:network-acl/acl-0572e1ab82993bb20;acl-0572e1ab82993bb20;ec2_networkacl_allow_ingress_tcp_port_22;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;5.1;Ensure no Network ACLs allow ingress from 0.0.0.0/0 to remote server administration ports;5 Networking;;Level 1;Automated;The Network Access Control List (NACL) function provide stateless filtering of ingress and egress network traffic to AWS resources. It is recommended that no NACL allows unrestricted ingress access to remote server administration ports, such as SSH to port `22` and RDP to port `3389`.;Public access to remote server administration ports, such as 22 and 3389, increases resource attack surface and unnecessarily raises the risk of resource compromise.;;**From Console:**  Perform the following: 1. Login to the AWS Management Console at https://console.aws.amazon.com/vpc/home 2. In the left pane, click `Network ACLs` 3. For each network ACL to remediate, perform the following:  - Select the network ACL  - Click the `Inbound Rules` tab  - Click `Edit inbound rules`  - Either A) update the Source field to a range other than 0.0.0.0/0, or, B) Click `Delete` to remove the offending inbound rule  - Click `Save`;**From Console:**  Perform the following to determine if the account is configured as prescribed: 1. Login to the AWS Management Console at https://console.aws.amazon.com/vpc/home 2. In the left pane, click `Network ACLs` 3. For each network ACL, perform the following:  - Select the network ACL  - Click the `Inbound Rules` tab  - Ensure no rule exists that has a port range that includes port `22`, `3389`, or other remote server administration ports for your environment and has a `Source` of `0.0.0.0/0` and shows `ALLOW`  **Note:** A Port value of `ALL` or a port range such as `0-1024` are inclusive of port `22`, `3389`, and other remote server administration ports;;;https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html:https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Security.html#VPC_Security_Comparison;FAIL;Network ACL acl-0d23e762ebdfb131c has SSH port 22 open to the Internet.;arn:aws:ec2:ap-northeast-2:132410971304:network-acl/acl-0d23e762ebdfb131c;acl-0d23e762ebdfb131c;ec2_networkacl_allow_ingress_tcp_port_22;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;5.1;Ensure no Network ACLs allow ingress from 0.0.0.0/0 to remote server administration ports;5 Networking;;Level 1;Automated;The Network Access Control List (NACL) function provide stateless filtering of ingress and egress network traffic to AWS resources. It is recommended that no NACL allows unrestricted ingress access to remote server administration ports, such as SSH to port `22` and RDP to port `3389`.;Public access to remote server administration ports, such as 22 and 3389, increases resource attack surface and unnecessarily raises the risk of resource compromise.;;**From Console:**  Perform the following: 1. Login to the AWS Management Console at https://console.aws.amazon.com/vpc/home 2. In the left pane, click `Network ACLs` 3. For each network ACL to remediate, perform the following:  - Select the network ACL  - Click the `Inbound Rules` tab  - Click `Edit inbound rules`  - Either A) update the Source field to a range other than 0.0.0.0/0, or, B) Click `Delete` to remove the offending inbound rule  - Click `Save`;**From Console:**  Perform the following to determine if the account is configured as prescribed: 1. Login to the AWS Management Console at https://console.aws.amazon.com/vpc/home 2. In the left pane, click `Network ACLs` 3. For each network ACL, perform the following:  - Select the network ACL  - Click the `Inbound Rules` tab  - Ensure no rule exists that has a port range that includes port `22`, `3389`, or other remote server administration ports for your environment and has a `Source` of `0.0.0.0/0` and shows `ALLOW`  **Note:** A Port value of `ALL` or a port range such as `0-1024` are inclusive of port `22`, `3389`, and other remote server administration ports;;;https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html:https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Security.html#VPC_Security_Comparison;FAIL;Network ACL acl-0572e1ab82993bb20 has Microsoft RDP port 3389 open to the Internet.;arn:aws:ec2:ap-northeast-2:132410971304:network-acl/acl-0572e1ab82993bb20;acl-0572e1ab82993bb20;ec2_networkacl_allow_ingress_tcp_port_3389;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;5.1;Ensure no Network ACLs allow ingress from 0.0.0.0/0 to remote server administration ports;5 Networking;;Level 1;Automated;The Network Access Control List (NACL) function provide stateless filtering of ingress and egress network traffic to AWS resources. It is recommended that no NACL allows unrestricted ingress access to remote server administration ports, such as SSH to port `22` and RDP to port `3389`.;Public access to remote server administration ports, such as 22 and 3389, increases resource attack surface and unnecessarily raises the risk of resource compromise.;;**From Console:**  Perform the following: 1. Login to the AWS Management Console at https://console.aws.amazon.com/vpc/home 2. In the left pane, click `Network ACLs` 3. For each network ACL to remediate, perform the following:  - Select the network ACL  - Click the `Inbound Rules` tab  - Click `Edit inbound rules`  - Either A) update the Source field to a range other than 0.0.0.0/0, or, B) Click `Delete` to remove the offending inbound rule  - Click `Save`;**From Console:**  Perform the following to determine if the account is configured as prescribed: 1. Login to the AWS Management Console at https://console.aws.amazon.com/vpc/home 2. In the left pane, click `Network ACLs` 3. For each network ACL, perform the following:  - Select the network ACL  - Click the `Inbound Rules` tab  - Ensure no rule exists that has a port range that includes port `22`, `3389`, or other remote server administration ports for your environment and has a `Source` of `0.0.0.0/0` and shows `ALLOW`  **Note:** A Port value of `ALL` or a port range such as `0-1024` are inclusive of port `22`, `3389`, and other remote server administration ports;;;https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html:https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Security.html#VPC_Security_Comparison;FAIL;Network ACL acl-0d23e762ebdfb131c has Microsoft RDP port 3389 open to the Internet.;arn:aws:ec2:ap-northeast-2:132410971304:network-acl/acl-0d23e762ebdfb131c;acl-0d23e762ebdfb131c;ec2_networkacl_allow_ingress_tcp_port_3389;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;1.8;Ensure IAM password policy requires minimum length of 14 or greater;1 Identity and Access Management;;Level 1;Automated;Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.;Setting a password complexity policy increases account resiliency against brute force login attempts.;;"Perform the following to set the password policy as prescribed:  **From Console:**  1. Login to AWS Console (with appropriate permissions to View Identity Access Management Account Settings) 2. Go to IAM Service on the AWS Console 3. Click on Account Settings on the Left Pane 4. Set ""Minimum password length"" to `14` or greater. 5. Click ""Apply password policy""  **From Command Line:** ```  aws iam update-account-password-policy --minimum-password-length 14 ``` Note: All commands starting with ""aws iam update-account-password-policy"" can be combined into a single command.";"Perform the following to ensure the password policy is configured as prescribed:  **From Console:**  1. Login to AWS Console (with appropriate permissions to View Identity Access Management Account Settings) 2. Go to IAM Service on the AWS Console 3. Click on Account Settings on the Left Pane 4. Ensure ""Minimum password length"" is set to 14 or greater.  **From Command Line:** ``` aws iam get-account-password-policy ``` Ensure the output of the above command includes ""MinimumPasswordLength"": 14 (or higher)";;;https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html:https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#configure-strong-password-policy;PASS;IAM password policy requires minimum length of 14 characters.;arn:aws:iam:ap-northeast-2:132410971304:password-policy;132410971304;iam_password_policy_minimum_length_14;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;1.9;Ensure IAM password policy prevents password reuse;1 Identity and Access Management;;Level 1;Automated;IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.;Preventing password reuse increases account resiliency against brute force login attempts.;;"Perform the following to set the password policy as prescribed:  **From Console:**  1. Login to AWS Console (with appropriate permissions to View Identity Access Management Account Settings) 2. Go to IAM Service on the AWS Console 3. Click on Account Settings on the Left Pane 4. Check ""Prevent password reuse"" 5. Set ""Number of passwords to remember"" is set to `24`   **From Command Line:** ```  aws iam update-account-password-policy --password-reuse-prevention 24 ``` Note: All commands starting with ""aws iam update-account-password-policy"" can be combined into a single command.";"Perform the following to ensure the password policy is configured as prescribed:  **From Console:**  1. Login to AWS Console (with appropriate permissions to View Identity Access Management Account Settings) 2. Go to IAM Service on the AWS Console 3. Click on Account Settings on the Left Pane 4. Ensure ""Prevent password reuse"" is checked 5. Ensure ""Number of passwords to remember"" is set to 24  **From Command Line:** ``` aws iam get-account-password-policy  ``` Ensure the output of the above command includes ""PasswordReusePrevention"": 24";;;https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_account-policy.html:https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#configure-strong-password-policy;PASS;IAM password policy reuse prevention is equal to 24.;arn:aws:iam:ap-northeast-2:132410971304:password-policy;132410971304;iam_password_policy_reuse_24;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;1.12;Ensure credentials unused for 45 days or greater are disabled;1 Identity and Access Management;;Level 1;Automated;AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all credentials that have been unused in 45 or greater days be deactivated or removed.;Disabling or removing unnecessary credentials will reduce the window of opportunity for credentials associated with a compromised or abandoned account to be used.;;**From Console:**  Perform the following to manage Unused Password (IAM user console access)  1. Login to the AWS Management Console: 2. Click `Services`  3. Click `IAM`  4. Click on `Users`  5. Click on `Security Credentials`  6. Select user whose `Console last sign-in` is greater than 45 days 7. Click `Security credentials` 8. In section `Sign-in credentials`, `Console password` click `Manage`  9. Under Console Access select `Disable` 10.Click `Apply`  Perform the following to deactivate Access Keys:  1. Login to the AWS Management Console: 2. Click `Services`  3. Click `IAM`  4. Click on `Users`  5. Click on `Security Credentials`  6. Select any access keys that are over 45 days old and that have been used and   - Click on `Make Inactive` 7. Select any access keys that are over 45 days old and that have not been used and   - Click the X to `Delete`;Perform the following to determine if unused credentials exist:  **From Console:**  1. Login to the AWS Management Console 2. Click `Services`  3. Click `IAM` 4. Click on `Users` 5. Click the `Settings` (gear) icon. 6. Select `Console last sign-in`, `Access key last used`, and `Access Key Id` 7. Click on `Close`  8. Check and ensure that `Console last sign-in` is less than 45 days ago.  **Note** - `Never` means the user has never logged in.  9. Check and ensure that `Access key age` is less than 45 days and that `Access key last used` does not say `None`  If the user hasn't signed into the Console in the last 45 days or Access keys are over 45 days old refer to the remediation.  **From Command Line:**  **Download Credential Report:**  1. Run the following commands: ```  aws iam generate-credential-report   aws iam get-credential-report --query 'Content' --output text | base64 -d | cut -d, -f1,4,5,6,9,10,11,14,15,16 | grep -v '^<root_account>' ```  **Ensure unused credentials do not exist:**  2. For each user having `password_enabled` set to `TRUE` , ensure `password_last_used_date` is less than `45` days ago.  - When `password_enabled` is set to `TRUE` and `password_last_used` is set to `No_Information` , ensure `password_last_changed` is less than 45 days ago.  3. For each user having an `access_key_1_active` or `access_key_2_active` to `TRUE` , ensure the corresponding `access_key_n_last_used_date` is less than `45` days ago.  - When a user having an `access_key_x_active` (where x is 1 or 2) to `TRUE` and corresponding access_key_x_last_used_date is set to `N/A', ensure `access_key_x_last_rotated` is less than 45 days ago.;<root_account> is excluded in the audit since the root account should not be used for day to day business and would likely be unused for more than 45 days.;;https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#remove-credentials:https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_finding-unused.html:https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_admin-change-user.html:https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html;PASS;User aws_learner does not have console access enabled or is unused.;arn:aws:iam::132410971304:user/aws_learner;aws_learner;iam_user_console_access_unused;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;1.12;Ensure credentials unused for 45 days or greater are disabled;1 Identity and Access Management;;Level 1;Automated;AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all credentials that have been unused in 45 or greater days be deactivated or removed.;Disabling or removing unnecessary credentials will reduce the window of opportunity for credentials associated with a compromised or abandoned account to be used.;;**From Console:**  Perform the following to manage Unused Password (IAM user console access)  1. Login to the AWS Management Console: 2. Click `Services`  3. Click `IAM`  4. Click on `Users`  5. Click on `Security Credentials`  6. Select user whose `Console last sign-in` is greater than 45 days 7. Click `Security credentials` 8. In section `Sign-in credentials`, `Console password` click `Manage`  9. Under Console Access select `Disable` 10.Click `Apply`  Perform the following to deactivate Access Keys:  1. Login to the AWS Management Console: 2. Click `Services`  3. Click `IAM`  4. Click on `Users`  5. Click on `Security Credentials`  6. Select any access keys that are over 45 days old and that have been used and   - Click on `Make Inactive` 7. Select any access keys that are over 45 days old and that have not been used and   - Click the X to `Delete`;Perform the following to determine if unused credentials exist:  **From Console:**  1. Login to the AWS Management Console 2. Click `Services`  3. Click `IAM` 4. Click on `Users` 5. Click the `Settings` (gear) icon. 6. Select `Console last sign-in`, `Access key last used`, and `Access Key Id` 7. Click on `Close`  8. Check and ensure that `Console last sign-in` is less than 45 days ago.  **Note** - `Never` means the user has never logged in.  9. Check and ensure that `Access key age` is less than 45 days and that `Access key last used` does not say `None`  If the user hasn't signed into the Console in the last 45 days or Access keys are over 45 days old refer to the remediation.  **From Command Line:**  **Download Credential Report:**  1. Run the following commands: ```  aws iam generate-credential-report   aws iam get-credential-report --query 'Content' --output text | base64 -d | cut -d, -f1,4,5,6,9,10,11,14,15,16 | grep -v '^<root_account>' ```  **Ensure unused credentials do not exist:**  2. For each user having `password_enabled` set to `TRUE` , ensure `password_last_used_date` is less than `45` days ago.  - When `password_enabled` is set to `TRUE` and `password_last_used` is set to `No_Information` , ensure `password_last_changed` is less than 45 days ago.  3. For each user having an `access_key_1_active` or `access_key_2_active` to `TRUE` , ensure the corresponding `access_key_n_last_used_date` is less than `45` days ago.  - When a user having an `access_key_x_active` (where x is 1 or 2) to `TRUE` and corresponding access_key_x_last_used_date is set to `N/A', ensure `access_key_x_last_rotated` is less than 45 days ago.;<root_account> is excluded in the audit since the root account should not be used for day to day business and would likely be unused for more than 45 days.;;https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#remove-credentials:https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_finding-unused.html:https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_admin-change-user.html:https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html;PASS;User github-actions-prowler does not have console access enabled or is unused.;arn:aws:iam::132410971304:user/github-actions-prowler;github-actions-prowler;iam_user_console_access_unused;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;1.12;Ensure credentials unused for 45 days or greater are disabled;1 Identity and Access Management;;Level 1;Automated;AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all credentials that have been unused in 45 or greater days be deactivated or removed.;Disabling or removing unnecessary credentials will reduce the window of opportunity for credentials associated with a compromised or abandoned account to be used.;;**From Console:**  Perform the following to manage Unused Password (IAM user console access)  1. Login to the AWS Management Console: 2. Click `Services`  3. Click `IAM`  4. Click on `Users`  5. Click on `Security Credentials`  6. Select user whose `Console last sign-in` is greater than 45 days 7. Click `Security credentials` 8. In section `Sign-in credentials`, `Console password` click `Manage`  9. Under Console Access select `Disable` 10.Click `Apply`  Perform the following to deactivate Access Keys:  1. Login to the AWS Management Console: 2. Click `Services`  3. Click `IAM`  4. Click on `Users`  5. Click on `Security Credentials`  6. Select any access keys that are over 45 days old and that have been used and   - Click on `Make Inactive` 7. Select any access keys that are over 45 days old and that have not been used and   - Click the X to `Delete`;Perform the following to determine if unused credentials exist:  **From Console:**  1. Login to the AWS Management Console 2. Click `Services`  3. Click `IAM` 4. Click on `Users` 5. Click the `Settings` (gear) icon. 6. Select `Console last sign-in`, `Access key last used`, and `Access Key Id` 7. Click on `Close`  8. Check and ensure that `Console last sign-in` is less than 45 days ago.  **Note** - `Never` means the user has never logged in.  9. Check and ensure that `Access key age` is less than 45 days and that `Access key last used` does not say `None`  If the user hasn't signed into the Console in the last 45 days or Access keys are over 45 days old refer to the remediation.  **From Command Line:**  **Download Credential Report:**  1. Run the following commands: ```  aws iam generate-credential-report   aws iam get-credential-report --query 'Content' --output text | base64 -d | cut -d, -f1,4,5,6,9,10,11,14,15,16 | grep -v '^<root_account>' ```  **Ensure unused credentials do not exist:**  2. For each user having `password_enabled` set to `TRUE` , ensure `password_last_used_date` is less than `45` days ago.  - When `password_enabled` is set to `TRUE` and `password_last_used` is set to `No_Information` , ensure `password_last_changed` is less than 45 days ago.  3. For each user having an `access_key_1_active` or `access_key_2_active` to `TRUE` , ensure the corresponding `access_key_n_last_used_date` is less than `45` days ago.  - When a user having an `access_key_x_active` (where x is 1 or 2) to `TRUE` and corresponding access_key_x_last_used_date is set to `N/A', ensure `access_key_x_last_rotated` is less than 45 days ago.;<root_account> is excluded in the audit since the root account should not be used for day to day business and would likely be unused for more than 45 days.;;https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#remove-credentials:https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_finding-unused.html:https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_passwords_admin-change-user.html:https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html;PASS;User prowler does not have console access enabled or is unused.;arn:aws:iam::132410971304:user/prowler;prowler;iam_user_console_access_unused;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;2.1.1;Ensure all S3 buckets employ encryption-at-rest;2 Storage;2.1 Simple Storage Service (S3);Level 2;Automated;Amazon S3 provides a variety of no, or low, cost encryption options to protect data at rest.;Encrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.;Amazon S3 buckets with default bucket encryption using SSE-KMS cannot be used as destination buckets for Amazon S3 server access logging. Only SSE-S3 default encryption is supported for server access log destination buckets.;"**From Console:**  1. Login to AWS Management Console and open the Amazon S3 console using https://console.aws.amazon.com/s3/  2. Select a Bucket. 3. Click on 'Properties'. 4. Click edit on `Default Encryption`. 5. Select either `AES-256`, `AWS-KMS`, `SSE-KMS` or `SSE-S3`. 6. Click `Save` 7. Repeat for all the buckets in your AWS account lacking encryption.  **From Command Line:**  Run either  ``` aws s3api put-bucket-encryption --bucket <bucket name> --server-side-encryption-configuration '{""Rules"": [{""ApplyServerSideEncryptionByDefault"": {""SSEAlgorithm"": ""AES256""}}]}' ```  or  ``` aws s3api put-bucket-encryption --bucket <bucket name> --server-side-encryption-configuration '{""Rules"": [{""ApplyServerSideEncryptionByDefault"": {""SSEAlgorithm"": ""aws:kms"",""KMSMasterKeyID"": ""aws/s3""}}]}' ```  **Note:** the KMSMasterKeyID can be set to the master key of your choosing; aws/s3 is an AWS preconfigured default.";"**From Console:**  1. Login to AWS Management Console and open the Amazon S3 console using https://console.aws.amazon.com/s3/  2. Select a Bucket. 3. Click on 'Properties'. 4. Verify that `Default Encryption` is enabled, and displays either `AES-256`, `AWS-KMS`, `SSE-KMS` or `SSE-S3`. 5. Repeat for all the buckets in your AWS account.  **From Command Line:**  1. Run command to list buckets ``` aws s3 ls ``` 2. For each bucket, run  ``` aws s3api get-bucket-encryption --bucket <bucket name> ``` 3. Verify that either  ``` ""SSEAlgorithm"": ""AES256"" ```  or  ``` ""SSEAlgorithm"": ""aws:kms""```  is displayed.";S3 bucket encryption only applies to objects as they are placed in the bucket. Enabling S3 bucket encryption does **not** encrypt objects previously stored within the bucket.;;https://docs.aws.amazon.com/AmazonS3/latest/user-guide/default-bucket-encryption.html:https://docs.aws.amazon.com/AmazonS3/latest/dev/bucket-encryption.html#bucket-encryption-related-resources;PASS;S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b has Server Side Encryption with AES256.;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b;aws-cloudtrail-logs-132410971304-0971c04b;s3_bucket_default_encryption;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;2.1.1;Ensure all S3 buckets employ encryption-at-rest;2 Storage;2.1 Simple Storage Service (S3);Level 2;Automated;Amazon S3 provides a variety of no, or low, cost encryption options to protect data at rest.;Encrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.;Amazon S3 buckets with default bucket encryption using SSE-KMS cannot be used as destination buckets for Amazon S3 server access logging. Only SSE-S3 default encryption is supported for server access log destination buckets.;"**From Console:**  1. Login to AWS Management Console and open the Amazon S3 console using https://console.aws.amazon.com/s3/  2. Select a Bucket. 3. Click on 'Properties'. 4. Click edit on `Default Encryption`. 5. Select either `AES-256`, `AWS-KMS`, `SSE-KMS` or `SSE-S3`. 6. Click `Save` 7. Repeat for all the buckets in your AWS account lacking encryption.  **From Command Line:**  Run either  ``` aws s3api put-bucket-encryption --bucket <bucket name> --server-side-encryption-configuration '{""Rules"": [{""ApplyServerSideEncryptionByDefault"": {""SSEAlgorithm"": ""AES256""}}]}' ```  or  ``` aws s3api put-bucket-encryption --bucket <bucket name> --server-side-encryption-configuration '{""Rules"": [{""ApplyServerSideEncryptionByDefault"": {""SSEAlgorithm"": ""aws:kms"",""KMSMasterKeyID"": ""aws/s3""}}]}' ```  **Note:** the KMSMasterKeyID can be set to the master key of your choosing; aws/s3 is an AWS preconfigured default.";"**From Console:**  1. Login to AWS Management Console and open the Amazon S3 console using https://console.aws.amazon.com/s3/  2. Select a Bucket. 3. Click on 'Properties'. 4. Verify that `Default Encryption` is enabled, and displays either `AES-256`, `AWS-KMS`, `SSE-KMS` or `SSE-S3`. 5. Repeat for all the buckets in your AWS account.  **From Command Line:**  1. Run command to list buckets ``` aws s3 ls ``` 2. For each bucket, run  ``` aws s3api get-bucket-encryption --bucket <bucket name> ``` 3. Verify that either  ``` ""SSEAlgorithm"": ""AES256"" ```  or  ``` ""SSEAlgorithm"": ""aws:kms""```  is displayed.";S3 bucket encryption only applies to objects as they are placed in the bucket. Enabling S3 bucket encryption does **not** encrypt objects previously stored within the bucket.;;https://docs.aws.amazon.com/AmazonS3/latest/user-guide/default-bucket-encryption.html:https://docs.aws.amazon.com/AmazonS3/latest/dev/bucket-encryption.html#bucket-encryption-related-resources;PASS;S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b-logs has Server Side Encryption with AES256.;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b-logs;aws-cloudtrail-logs-132410971304-0971c04b-logs;s3_bucket_default_encryption;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;2.1.1;Ensure all S3 buckets employ encryption-at-rest;2 Storage;2.1 Simple Storage Service (S3);Level 2;Automated;Amazon S3 provides a variety of no, or low, cost encryption options to protect data at rest.;Encrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.;Amazon S3 buckets with default bucket encryption using SSE-KMS cannot be used as destination buckets for Amazon S3 server access logging. Only SSE-S3 default encryption is supported for server access log destination buckets.;"**From Console:**  1. Login to AWS Management Console and open the Amazon S3 console using https://console.aws.amazon.com/s3/  2. Select a Bucket. 3. Click on 'Properties'. 4. Click edit on `Default Encryption`. 5. Select either `AES-256`, `AWS-KMS`, `SSE-KMS` or `SSE-S3`. 6. Click `Save` 7. Repeat for all the buckets in your AWS account lacking encryption.  **From Command Line:**  Run either  ``` aws s3api put-bucket-encryption --bucket <bucket name> --server-side-encryption-configuration '{""Rules"": [{""ApplyServerSideEncryptionByDefault"": {""SSEAlgorithm"": ""AES256""}}]}' ```  or  ``` aws s3api put-bucket-encryption --bucket <bucket name> --server-side-encryption-configuration '{""Rules"": [{""ApplyServerSideEncryptionByDefault"": {""SSEAlgorithm"": ""aws:kms"",""KMSMasterKeyID"": ""aws/s3""}}]}' ```  **Note:** the KMSMasterKeyID can be set to the master key of your choosing; aws/s3 is an AWS preconfigured default.";"**From Console:**  1. Login to AWS Management Console and open the Amazon S3 console using https://console.aws.amazon.com/s3/  2. Select a Bucket. 3. Click on 'Properties'. 4. Verify that `Default Encryption` is enabled, and displays either `AES-256`, `AWS-KMS`, `SSE-KMS` or `SSE-S3`. 5. Repeat for all the buckets in your AWS account.  **From Command Line:**  1. Run command to list buckets ``` aws s3 ls ``` 2. For each bucket, run  ``` aws s3api get-bucket-encryption --bucket <bucket name> ``` 3. Verify that either  ``` ""SSEAlgorithm"": ""AES256"" ```  or  ``` ""SSEAlgorithm"": ""aws:kms""```  is displayed.";S3 bucket encryption only applies to objects as they are placed in the bucket. Enabling S3 bucket encryption does **not** encrypt objects previously stored within the bucket.;;https://docs.aws.amazon.com/AmazonS3/latest/user-guide/default-bucket-encryption.html:https://docs.aws.amazon.com/AmazonS3/latest/dev/bucket-encryption.html#bucket-encryption-related-resources;PASS;S3 Bucket prowler-dashboard-132410971304 has Server Side Encryption with AES256.;arn:aws:s3:::prowler-dashboard-132410971304;prowler-dashboard-132410971304;s3_bucket_default_encryption;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;2.1.1;Ensure all S3 buckets employ encryption-at-rest;2 Storage;2.1 Simple Storage Service (S3);Level 2;Automated;Amazon S3 provides a variety of no, or low, cost encryption options to protect data at rest.;Encrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.;Amazon S3 buckets with default bucket encryption using SSE-KMS cannot be used as destination buckets for Amazon S3 server access logging. Only SSE-S3 default encryption is supported for server access log destination buckets.;"**From Console:**  1. Login to AWS Management Console and open the Amazon S3 console using https://console.aws.amazon.com/s3/  2. Select a Bucket. 3. Click on 'Properties'. 4. Click edit on `Default Encryption`. 5. Select either `AES-256`, `AWS-KMS`, `SSE-KMS` or `SSE-S3`. 6. Click `Save` 7. Repeat for all the buckets in your AWS account lacking encryption.  **From Command Line:**  Run either  ``` aws s3api put-bucket-encryption --bucket <bucket name> --server-side-encryption-configuration '{""Rules"": [{""ApplyServerSideEncryptionByDefault"": {""SSEAlgorithm"": ""AES256""}}]}' ```  or  ``` aws s3api put-bucket-encryption --bucket <bucket name> --server-side-encryption-configuration '{""Rules"": [{""ApplyServerSideEncryptionByDefault"": {""SSEAlgorithm"": ""aws:kms"",""KMSMasterKeyID"": ""aws/s3""}}]}' ```  **Note:** the KMSMasterKeyID can be set to the master key of your choosing; aws/s3 is an AWS preconfigured default.";"**From Console:**  1. Login to AWS Management Console and open the Amazon S3 console using https://console.aws.amazon.com/s3/  2. Select a Bucket. 3. Click on 'Properties'. 4. Verify that `Default Encryption` is enabled, and displays either `AES-256`, `AWS-KMS`, `SSE-KMS` or `SSE-S3`. 5. Repeat for all the buckets in your AWS account.  **From Command Line:**  1. Run command to list buckets ``` aws s3 ls ``` 2. For each bucket, run  ``` aws s3api get-bucket-encryption --bucket <bucket name> ``` 3. Verify that either  ``` ""SSEAlgorithm"": ""AES256"" ```  or  ``` ""SSEAlgorithm"": ""aws:kms""```  is displayed.";S3 bucket encryption only applies to objects as they are placed in the bucket. Enabling S3 bucket encryption does **not** encrypt objects previously stored within the bucket.;;https://docs.aws.amazon.com/AmazonS3/latest/user-guide/default-bucket-encryption.html:https://docs.aws.amazon.com/AmazonS3/latest/dev/bucket-encryption.html#bucket-encryption-related-resources;PASS;S3 Bucket prowler-terraform-state-132410971304 has Server Side Encryption with AES256.;arn:aws:s3:::prowler-terraform-state-132410971304;prowler-terraform-state-132410971304;s3_bucket_default_encryption;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;2.1.3;Ensure MFA Delete is enabled on S3 buckets;2 Storage;2.1 Simple Storage Service (S3);Level 1;Automated;Once MFA Delete is enabled on your sensitive and classified S3 bucket it requires the user to have two forms of authentication.;Adding MFA delete to an S3 bucket, requires additional authentication when you change the version state of your bucket or you delete and object version adding another layer of security in the event your security credentials are compromised or unauthorized access is granted.;;Perform the steps below to enable MFA delete on an S3 bucket.  Note: -You cannot enable MFA Delete using the AWS Management Console. You must use the AWS CLI or API. -You must use your 'root' account to enable MFA Delete on S3 buckets.  **From Command line:**  1. Run the s3api put-bucket-versioning command  ``` aws s3api put-bucket-versioning --profile my-root-profile --bucket Bucket_Name --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa arn:aws:iam::aws_account_id:mfa/root-account-mfa-device passcode ```;"Perform the steps below to confirm MFA delete is configured on an S3 Bucket  **From Console:**  1. Login to the S3 console at `https://console.aws.amazon.com/s3/`  2. Click the `Check` box next to the Bucket name you want to confirm  3. In the window under `Properties`  4. Confirm that Versioning is `Enabled`  5. Confirm that MFA Delete is `Enabled`  **From Command Line:**  1. Run the `get-bucket-versioning` ``` aws s3api get-bucket-versioning --bucket my-bucket ```  Output example: ``` <VersioningConfiguration xmlns=""http://s3.amazonaws.com/doc/2006-03-01/"">   <Status>Enabled</Status>  <MfaDelete>Enabled</MfaDelete>  </VersioningConfiguration> ```  If the Console or the CLI output does not show Versioning and MFA Delete `enabled` refer to the remediation below.";;;https://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html#MultiFactorAuthenticationDelete:https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingMFADelete.html:https://aws.amazon.com/blogs/security/securing-access-to-aws-using-mfa-part-3/:https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_lost-or-broken.html;FAIL;S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b has MFA Delete disabled.;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b;aws-cloudtrail-logs-132410971304-0971c04b;s3_bucket_no_mfa_delete;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;2.1.3;Ensure MFA Delete is enabled on S3 buckets;2 Storage;2.1 Simple Storage Service (S3);Level 1;Automated;Once MFA Delete is enabled on your sensitive and classified S3 bucket it requires the user to have two forms of authentication.;Adding MFA delete to an S3 bucket, requires additional authentication when you change the version state of your bucket or you delete and object version adding another layer of security in the event your security credentials are compromised or unauthorized access is granted.;;Perform the steps below to enable MFA delete on an S3 bucket.  Note: -You cannot enable MFA Delete using the AWS Management Console. You must use the AWS CLI or API. -You must use your 'root' account to enable MFA Delete on S3 buckets.  **From Command line:**  1. Run the s3api put-bucket-versioning command  ``` aws s3api put-bucket-versioning --profile my-root-profile --bucket Bucket_Name --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa arn:aws:iam::aws_account_id:mfa/root-account-mfa-device passcode ```;"Perform the steps below to confirm MFA delete is configured on an S3 Bucket  **From Console:**  1. Login to the S3 console at `https://console.aws.amazon.com/s3/`  2. Click the `Check` box next to the Bucket name you want to confirm  3. In the window under `Properties`  4. Confirm that Versioning is `Enabled`  5. Confirm that MFA Delete is `Enabled`  **From Command Line:**  1. Run the `get-bucket-versioning` ``` aws s3api get-bucket-versioning --bucket my-bucket ```  Output example: ``` <VersioningConfiguration xmlns=""http://s3.amazonaws.com/doc/2006-03-01/"">   <Status>Enabled</Status>  <MfaDelete>Enabled</MfaDelete>  </VersioningConfiguration> ```  If the Console or the CLI output does not show Versioning and MFA Delete `enabled` refer to the remediation below.";;;https://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html#MultiFactorAuthenticationDelete:https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingMFADelete.html:https://aws.amazon.com/blogs/security/securing-access-to-aws-using-mfa-part-3/:https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_lost-or-broken.html;FAIL;S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b-logs has MFA Delete disabled.;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b-logs;aws-cloudtrail-logs-132410971304-0971c04b-logs;s3_bucket_no_mfa_delete;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;2.1.3;Ensure MFA Delete is enabled on S3 buckets;2 Storage;2.1 Simple Storage Service (S3);Level 1;Automated;Once MFA Delete is enabled on your sensitive and classified S3 bucket it requires the user to have two forms of authentication.;Adding MFA delete to an S3 bucket, requires additional authentication when you change the version state of your bucket or you delete and object version adding another layer of security in the event your security credentials are compromised or unauthorized access is granted.;;Perform the steps below to enable MFA delete on an S3 bucket.  Note: -You cannot enable MFA Delete using the AWS Management Console. You must use the AWS CLI or API. -You must use your 'root' account to enable MFA Delete on S3 buckets.  **From Command line:**  1. Run the s3api put-bucket-versioning command  ``` aws s3api put-bucket-versioning --profile my-root-profile --bucket Bucket_Name --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa arn:aws:iam::aws_account_id:mfa/root-account-mfa-device passcode ```;"Perform the steps below to confirm MFA delete is configured on an S3 Bucket  **From Console:**  1. Login to the S3 console at `https://console.aws.amazon.com/s3/`  2. Click the `Check` box next to the Bucket name you want to confirm  3. In the window under `Properties`  4. Confirm that Versioning is `Enabled`  5. Confirm that MFA Delete is `Enabled`  **From Command Line:**  1. Run the `get-bucket-versioning` ``` aws s3api get-bucket-versioning --bucket my-bucket ```  Output example: ``` <VersioningConfiguration xmlns=""http://s3.amazonaws.com/doc/2006-03-01/"">   <Status>Enabled</Status>  <MfaDelete>Enabled</MfaDelete>  </VersioningConfiguration> ```  If the Console or the CLI output does not show Versioning and MFA Delete `enabled` refer to the remediation below.";;;https://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html#MultiFactorAuthenticationDelete:https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingMFADelete.html:https://aws.amazon.com/blogs/security/securing-access-to-aws-using-mfa-part-3/:https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_lost-or-broken.html;FAIL;S3 Bucket prowler-dashboard-132410971304 has MFA Delete disabled.;arn:aws:s3:::prowler-dashboard-132410971304;prowler-dashboard-132410971304;s3_bucket_no_mfa_delete;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;2.1.3;Ensure MFA Delete is enabled on S3 buckets;2 Storage;2.1 Simple Storage Service (S3);Level 1;Automated;Once MFA Delete is enabled on your sensitive and classified S3 bucket it requires the user to have two forms of authentication.;Adding MFA delete to an S3 bucket, requires additional authentication when you change the version state of your bucket or you delete and object version adding another layer of security in the event your security credentials are compromised or unauthorized access is granted.;;Perform the steps below to enable MFA delete on an S3 bucket.  Note: -You cannot enable MFA Delete using the AWS Management Console. You must use the AWS CLI or API. -You must use your 'root' account to enable MFA Delete on S3 buckets.  **From Command line:**  1. Run the s3api put-bucket-versioning command  ``` aws s3api put-bucket-versioning --profile my-root-profile --bucket Bucket_Name --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa arn:aws:iam::aws_account_id:mfa/root-account-mfa-device passcode ```;"Perform the steps below to confirm MFA delete is configured on an S3 Bucket  **From Console:**  1. Login to the S3 console at `https://console.aws.amazon.com/s3/`  2. Click the `Check` box next to the Bucket name you want to confirm  3. In the window under `Properties`  4. Confirm that Versioning is `Enabled`  5. Confirm that MFA Delete is `Enabled`  **From Command Line:**  1. Run the `get-bucket-versioning` ``` aws s3api get-bucket-versioning --bucket my-bucket ```  Output example: ``` <VersioningConfiguration xmlns=""http://s3.amazonaws.com/doc/2006-03-01/"">   <Status>Enabled</Status>  <MfaDelete>Enabled</MfaDelete>  </VersioningConfiguration> ```  If the Console or the CLI output does not show Versioning and MFA Delete `enabled` refer to the remediation below.";;;https://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html#MultiFactorAuthenticationDelete:https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingMFADelete.html:https://aws.amazon.com/blogs/security/securing-access-to-aws-using-mfa-part-3/:https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_lost-or-broken.html;FAIL;S3 Bucket prowler-terraform-state-132410971304 has MFA Delete disabled.;arn:aws:s3:::prowler-terraform-state-132410971304;prowler-terraform-state-132410971304;s3_bucket_no_mfa_delete;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;2.1.2;Ensure S3 Bucket Policy is set to deny HTTP requests;2 Storage;2.1 Simple Storage Service (S3);Level 2;Automated;At the Amazon S3 bucket level, you can configure permissions through a bucket policy making the objects accessible only through HTTPS.;By default, Amazon S3 allows both HTTP and HTTPS requests. To achieve only allowing access to Amazon S3 objects through HTTPS you also have to explicitly deny access to HTTP requests. Bucket policies that allow HTTPS requests without explicitly denying HTTP requests will not comply with this recommendation.;;"**From Console:**  1. Login to AWS Management Console and open the Amazon S3 console using https://console.aws.amazon.com/s3/ 2. Select the Check box next to the Bucket. 3. Click on 'Permissions'. 4. Click 'Bucket Policy' 5. Add this to the existing policy filling in the required information ``` {  ""Sid"": <optional>"",  ""Effect"": ""Deny"",  ""Principal"": ""*"",  ""Action"": ""s3:*"",  ""Resource"": ""arn:aws:s3:::<bucket_name>/*"",  ""Condition"": {  ""Bool"": {  ""aws:SecureTransport"": ""false""  }  }  } ``` 6. Save 7. Repeat for all the buckets in your AWS account that contain sensitive data.  **From Console**   using AWS Policy Generator:  1. Repeat steps 1-4 above. 2. Click on `Policy Generator` at the bottom of the Bucket Policy Editor 3. Select Policy Type `S3 Bucket Policy` 4. Add Statements - `Effect` = Deny - `Principal` = * - `AWS Service` = Amazon S3 - `Actions` = * - `Amazon Resource Name` = <ARN of the S3 Bucket> 5. Generate Policy 6. Copy the text and add it to the Bucket Policy.  **From Command Line:**  1. Export the bucket policy to a json file. ``` aws s3api get-bucket-policy --bucket <bucket_name> --query Policy --output text > policy.json ```  2. Modify the policy.json file by adding in this statement: ``` {  ""Sid"": <optional>"",  ""Effect"": ""Deny"",  ""Principal"": ""*"",  ""Action"": ""s3:*"",  ""Resource"": ""arn:aws:s3:::<bucket_name>/*"",  ""Condition"": {  ""Bool"": {  ""aws:SecureTransport"": ""false""  }  }  } ``` 3. Apply this modified policy back to the S3 bucket: ``` aws s3api put-bucket-policy --bucket <bucket_name> --policy file://policy.json ```";"To allow access to HTTPS you can use a condition that checks for the key `""aws:SecureTransport: true""`. This means that the request is sent through HTTPS but that HTTP can still be used. So to make sure you do not allow HTTP access confirm that there is a bucket policy that explicitly denies access for HTTP requests and that it contains the key ""aws:SecureTransport"": ""false"".  **From Console:**  1. Login to AWS Management Console and open the Amazon S3 console using https://console.aws.amazon.com/s3/ 2. Select the Check box next to the Bucket. 3. Click on 'Permissions', then Click on `Bucket Policy`. 4. Ensure that a policy is listed that matches: ``` '{  ""Sid"": <optional>,  ""Effect"": ""Deny"",  ""Principal"": ""*"",  ""Action"": ""s3:*"",  ""Resource"": ""arn:aws:s3:::<bucket_name>/*"",  ""Condition"": {  ""Bool"": {  ""aws:SecureTransport"": ""false""  }' ``` `<optional>` and `<bucket_name>` will be specific to your account  5. Repeat for all the buckets in your AWS account.  **From Command Line:**  1. List all of the S3 Buckets  ``` aws s3 ls ``` 2. Using the list of buckets run this command on each of them: ``` aws s3api get-bucket-policy --bucket <bucket_name> | grep aws:SecureTransport ``` 3. Confirm that `aws:SecureTransport` is set to false `aws:SecureTransport:false` 4. Confirm that the policy line has Effect set to Deny 'Effect:Deny'";;;https://aws.amazon.com/premiumsupport/knowledge-center/s3-bucket-policy-for-config-rule/:https://aws.amazon.com/blogs/security/how-to-use-bucket-policies-and-apply-defense-in-depth-to-help-secure-your-amazon-s3-data/:https://awscli.amazonaws.com/v2/documentation/api/latest/reference/s3api/get-bucket-policy.html;FAIL;S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b allows requests over insecure transport in the bucket policy.;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b;aws-cloudtrail-logs-132410971304-0971c04b;s3_bucket_secure_transport_policy;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;2.1.2;Ensure S3 Bucket Policy is set to deny HTTP requests;2 Storage;2.1 Simple Storage Service (S3);Level 2;Automated;At the Amazon S3 bucket level, you can configure permissions through a bucket policy making the objects accessible only through HTTPS.;By default, Amazon S3 allows both HTTP and HTTPS requests. To achieve only allowing access to Amazon S3 objects through HTTPS you also have to explicitly deny access to HTTP requests. Bucket policies that allow HTTPS requests without explicitly denying HTTP requests will not comply with this recommendation.;;"**From Console:**  1. Login to AWS Management Console and open the Amazon S3 console using https://console.aws.amazon.com/s3/ 2. Select the Check box next to the Bucket. 3. Click on 'Permissions'. 4. Click 'Bucket Policy' 5. Add this to the existing policy filling in the required information ``` {  ""Sid"": <optional>"",  ""Effect"": ""Deny"",  ""Principal"": ""*"",  ""Action"": ""s3:*"",  ""Resource"": ""arn:aws:s3:::<bucket_name>/*"",  ""Condition"": {  ""Bool"": {  ""aws:SecureTransport"": ""false""  }  }  } ``` 6. Save 7. Repeat for all the buckets in your AWS account that contain sensitive data.  **From Console**   using AWS Policy Generator:  1. Repeat steps 1-4 above. 2. Click on `Policy Generator` at the bottom of the Bucket Policy Editor 3. Select Policy Type `S3 Bucket Policy` 4. Add Statements - `Effect` = Deny - `Principal` = * - `AWS Service` = Amazon S3 - `Actions` = * - `Amazon Resource Name` = <ARN of the S3 Bucket> 5. Generate Policy 6. Copy the text and add it to the Bucket Policy.  **From Command Line:**  1. Export the bucket policy to a json file. ``` aws s3api get-bucket-policy --bucket <bucket_name> --query Policy --output text > policy.json ```  2. Modify the policy.json file by adding in this statement: ``` {  ""Sid"": <optional>"",  ""Effect"": ""Deny"",  ""Principal"": ""*"",  ""Action"": ""s3:*"",  ""Resource"": ""arn:aws:s3:::<bucket_name>/*"",  ""Condition"": {  ""Bool"": {  ""aws:SecureTransport"": ""false""  }  }  } ``` 3. Apply this modified policy back to the S3 bucket: ``` aws s3api put-bucket-policy --bucket <bucket_name> --policy file://policy.json ```";"To allow access to HTTPS you can use a condition that checks for the key `""aws:SecureTransport: true""`. This means that the request is sent through HTTPS but that HTTP can still be used. So to make sure you do not allow HTTP access confirm that there is a bucket policy that explicitly denies access for HTTP requests and that it contains the key ""aws:SecureTransport"": ""false"".  **From Console:**  1. Login to AWS Management Console and open the Amazon S3 console using https://console.aws.amazon.com/s3/ 2. Select the Check box next to the Bucket. 3. Click on 'Permissions', then Click on `Bucket Policy`. 4. Ensure that a policy is listed that matches: ``` '{  ""Sid"": <optional>,  ""Effect"": ""Deny"",  ""Principal"": ""*"",  ""Action"": ""s3:*"",  ""Resource"": ""arn:aws:s3:::<bucket_name>/*"",  ""Condition"": {  ""Bool"": {  ""aws:SecureTransport"": ""false""  }' ``` `<optional>` and `<bucket_name>` will be specific to your account  5. Repeat for all the buckets in your AWS account.  **From Command Line:**  1. List all of the S3 Buckets  ``` aws s3 ls ``` 2. Using the list of buckets run this command on each of them: ``` aws s3api get-bucket-policy --bucket <bucket_name> | grep aws:SecureTransport ``` 3. Confirm that `aws:SecureTransport` is set to false `aws:SecureTransport:false` 4. Confirm that the policy line has Effect set to Deny 'Effect:Deny'";;;https://aws.amazon.com/premiumsupport/knowledge-center/s3-bucket-policy-for-config-rule/:https://aws.amazon.com/blogs/security/how-to-use-bucket-policies-and-apply-defense-in-depth-to-help-secure-your-amazon-s3-data/:https://awscli.amazonaws.com/v2/documentation/api/latest/reference/s3api/get-bucket-policy.html;FAIL;S3 Bucket aws-cloudtrail-logs-132410971304-0971c04b-logs does not have a bucket policy, thus it allows HTTP requests.;arn:aws:s3:::aws-cloudtrail-logs-132410971304-0971c04b-logs;aws-cloudtrail-logs-132410971304-0971c04b-logs;s3_bucket_secure_transport_policy;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;2.1.2;Ensure S3 Bucket Policy is set to deny HTTP requests;2 Storage;2.1 Simple Storage Service (S3);Level 2;Automated;At the Amazon S3 bucket level, you can configure permissions through a bucket policy making the objects accessible only through HTTPS.;By default, Amazon S3 allows both HTTP and HTTPS requests. To achieve only allowing access to Amazon S3 objects through HTTPS you also have to explicitly deny access to HTTP requests. Bucket policies that allow HTTPS requests without explicitly denying HTTP requests will not comply with this recommendation.;;"**From Console:**  1. Login to AWS Management Console and open the Amazon S3 console using https://console.aws.amazon.com/s3/ 2. Select the Check box next to the Bucket. 3. Click on 'Permissions'. 4. Click 'Bucket Policy' 5. Add this to the existing policy filling in the required information ``` {  ""Sid"": <optional>"",  ""Effect"": ""Deny"",  ""Principal"": ""*"",  ""Action"": ""s3:*"",  ""Resource"": ""arn:aws:s3:::<bucket_name>/*"",  ""Condition"": {  ""Bool"": {  ""aws:SecureTransport"": ""false""  }  }  } ``` 6. Save 7. Repeat for all the buckets in your AWS account that contain sensitive data.  **From Console**   using AWS Policy Generator:  1. Repeat steps 1-4 above. 2. Click on `Policy Generator` at the bottom of the Bucket Policy Editor 3. Select Policy Type `S3 Bucket Policy` 4. Add Statements - `Effect` = Deny - `Principal` = * - `AWS Service` = Amazon S3 - `Actions` = * - `Amazon Resource Name` = <ARN of the S3 Bucket> 5. Generate Policy 6. Copy the text and add it to the Bucket Policy.  **From Command Line:**  1. Export the bucket policy to a json file. ``` aws s3api get-bucket-policy --bucket <bucket_name> --query Policy --output text > policy.json ```  2. Modify the policy.json file by adding in this statement: ``` {  ""Sid"": <optional>"",  ""Effect"": ""Deny"",  ""Principal"": ""*"",  ""Action"": ""s3:*"",  ""Resource"": ""arn:aws:s3:::<bucket_name>/*"",  ""Condition"": {  ""Bool"": {  ""aws:SecureTransport"": ""false""  }  }  } ``` 3. Apply this modified policy back to the S3 bucket: ``` aws s3api put-bucket-policy --bucket <bucket_name> --policy file://policy.json ```";"To allow access to HTTPS you can use a condition that checks for the key `""aws:SecureTransport: true""`. This means that the request is sent through HTTPS but that HTTP can still be used. So to make sure you do not allow HTTP access confirm that there is a bucket policy that explicitly denies access for HTTP requests and that it contains the key ""aws:SecureTransport"": ""false"".  **From Console:**  1. Login to AWS Management Console and open the Amazon S3 console using https://console.aws.amazon.com/s3/ 2. Select the Check box next to the Bucket. 3. Click on 'Permissions', then Click on `Bucket Policy`. 4. Ensure that a policy is listed that matches: ``` '{  ""Sid"": <optional>,  ""Effect"": ""Deny"",  ""Principal"": ""*"",  ""Action"": ""s3:*"",  ""Resource"": ""arn:aws:s3:::<bucket_name>/*"",  ""Condition"": {  ""Bool"": {  ""aws:SecureTransport"": ""false""  }' ``` `<optional>` and `<bucket_name>` will be specific to your account  5. Repeat for all the buckets in your AWS account.  **From Command Line:**  1. List all of the S3 Buckets  ``` aws s3 ls ``` 2. Using the list of buckets run this command on each of them: ``` aws s3api get-bucket-policy --bucket <bucket_name> | grep aws:SecureTransport ``` 3. Confirm that `aws:SecureTransport` is set to false `aws:SecureTransport:false` 4. Confirm that the policy line has Effect set to Deny 'Effect:Deny'";;;https://aws.amazon.com/premiumsupport/knowledge-center/s3-bucket-policy-for-config-rule/:https://aws.amazon.com/blogs/security/how-to-use-bucket-policies-and-apply-defense-in-depth-to-help-secure-your-amazon-s3-data/:https://awscli.amazonaws.com/v2/documentation/api/latest/reference/s3api/get-bucket-policy.html;FAIL;S3 Bucket prowler-dashboard-132410971304 does not have a bucket policy, thus it allows HTTP requests.;arn:aws:s3:::prowler-dashboard-132410971304;prowler-dashboard-132410971304;s3_bucket_secure_transport_policy;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;2.1.2;Ensure S3 Bucket Policy is set to deny HTTP requests;2 Storage;2.1 Simple Storage Service (S3);Level 2;Automated;At the Amazon S3 bucket level, you can configure permissions through a bucket policy making the objects accessible only through HTTPS.;By default, Amazon S3 allows both HTTP and HTTPS requests. To achieve only allowing access to Amazon S3 objects through HTTPS you also have to explicitly deny access to HTTP requests. Bucket policies that allow HTTPS requests without explicitly denying HTTP requests will not comply with this recommendation.;;"**From Console:**  1. Login to AWS Management Console and open the Amazon S3 console using https://console.aws.amazon.com/s3/ 2. Select the Check box next to the Bucket. 3. Click on 'Permissions'. 4. Click 'Bucket Policy' 5. Add this to the existing policy filling in the required information ``` {  ""Sid"": <optional>"",  ""Effect"": ""Deny"",  ""Principal"": ""*"",  ""Action"": ""s3:*"",  ""Resource"": ""arn:aws:s3:::<bucket_name>/*"",  ""Condition"": {  ""Bool"": {  ""aws:SecureTransport"": ""false""  }  }  } ``` 6. Save 7. Repeat for all the buckets in your AWS account that contain sensitive data.  **From Console**   using AWS Policy Generator:  1. Repeat steps 1-4 above. 2. Click on `Policy Generator` at the bottom of the Bucket Policy Editor 3. Select Policy Type `S3 Bucket Policy` 4. Add Statements - `Effect` = Deny - `Principal` = * - `AWS Service` = Amazon S3 - `Actions` = * - `Amazon Resource Name` = <ARN of the S3 Bucket> 5. Generate Policy 6. Copy the text and add it to the Bucket Policy.  **From Command Line:**  1. Export the bucket policy to a json file. ``` aws s3api get-bucket-policy --bucket <bucket_name> --query Policy --output text > policy.json ```  2. Modify the policy.json file by adding in this statement: ``` {  ""Sid"": <optional>"",  ""Effect"": ""Deny"",  ""Principal"": ""*"",  ""Action"": ""s3:*"",  ""Resource"": ""arn:aws:s3:::<bucket_name>/*"",  ""Condition"": {  ""Bool"": {  ""aws:SecureTransport"": ""false""  }  }  } ``` 3. Apply this modified policy back to the S3 bucket: ``` aws s3api put-bucket-policy --bucket <bucket_name> --policy file://policy.json ```";"To allow access to HTTPS you can use a condition that checks for the key `""aws:SecureTransport: true""`. This means that the request is sent through HTTPS but that HTTP can still be used. So to make sure you do not allow HTTP access confirm that there is a bucket policy that explicitly denies access for HTTP requests and that it contains the key ""aws:SecureTransport"": ""false"".  **From Console:**  1. Login to AWS Management Console and open the Amazon S3 console using https://console.aws.amazon.com/s3/ 2. Select the Check box next to the Bucket. 3. Click on 'Permissions', then Click on `Bucket Policy`. 4. Ensure that a policy is listed that matches: ``` '{  ""Sid"": <optional>,  ""Effect"": ""Deny"",  ""Principal"": ""*"",  ""Action"": ""s3:*"",  ""Resource"": ""arn:aws:s3:::<bucket_name>/*"",  ""Condition"": {  ""Bool"": {  ""aws:SecureTransport"": ""false""  }' ``` `<optional>` and `<bucket_name>` will be specific to your account  5. Repeat for all the buckets in your AWS account.  **From Command Line:**  1. List all of the S3 Buckets  ``` aws s3 ls ``` 2. Using the list of buckets run this command on each of them: ``` aws s3api get-bucket-policy --bucket <bucket_name> | grep aws:SecureTransport ``` 3. Confirm that `aws:SecureTransport` is set to false `aws:SecureTransport:false` 4. Confirm that the policy line has Effect set to Deny 'Effect:Deny'";;;https://aws.amazon.com/premiumsupport/knowledge-center/s3-bucket-policy-for-config-rule/:https://aws.amazon.com/blogs/security/how-to-use-bucket-policies-and-apply-defense-in-depth-to-help-secure-your-amazon-s3-data/:https://awscli.amazonaws.com/v2/documentation/api/latest/reference/s3api/get-bucket-policy.html;FAIL;S3 Bucket prowler-terraform-state-132410971304 does not have a bucket policy, thus it allows HTTP requests.;arn:aws:s3:::prowler-terraform-state-132410971304;prowler-terraform-state-132410971304;s3_bucket_secure_transport_policy;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
aws;The CIS Benchmark for CIS Amazon Web Services Foundations Benchmark, v1.4.0, Level 1 and 2 provides prescriptive guidance for configuring security options for a subset of Amazon Web Services. It has an emphasis on foundational, testable, and architecture agnostic settings;132410971304;ap-northeast-2;2026-02-12 07:58:01.872890;3.9;Ensure VPC flow logging is enabled in all VPCs;3 Logging;;Level 2;Automated;"VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet ""Rejects"" for VPCs.";VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.;By default, CloudWatch Logs will store Logs indefinitely unless a specific retention period is defined for the log group. When choosing the number of days to retain, keep in mind the average days it takes an organization to realize they have been breached is 210 days (at the time of this writing). Since additional time is required to research a breach, a minimum 365 day retention policy allows time for detection and research. You may also wish to archive the logs to a cheaper storage service rather than simply deleting them. See the following AWS resource to manage CloudWatch Logs retention periods:  1. https://docs.aws.amazon.com/AmazonCloudWatch/latest/DeveloperGuide/SettingLogRetention.html;"Perform the following to determine if VPC Flow logs is enabled:  **From Console:**  1. Sign into the management console 2. Select `Services` then `VPC`  3. In the left navigation pane, select `Your VPCs`  4. Select a VPC 5. In the right pane, select the `Flow Logs` tab. 6. If no Flow Log exists, click `Create Flow Log`  7. For Filter, select `Reject` 8. Enter in a `Role` and `Destination Log Group`  9. Click `Create Log Flow`  10. Click on `CloudWatch Logs Group`   **Note:** Setting the filter to ""Reject"" will dramatically reduce the logging data accumulation for this recommendation and provide sufficient information for the purposes of breach detection, research and remediation. However, during periods of least privilege security group engineering, setting this the filter to ""All"" can be very helpful in discovering existing traffic flows required for proper operation of an already running environment.  **From Command Line:**  1. Create a policy document and name it as `role_policy_document.json` and paste the following content: ``` {  ""Version"": ""2012-10-17"",  ""Statement"": [  {  ""Sid"": ""test"",  ""Effect"": ""Allow"",  ""Principal"": {  ""Service"": ""ec2.amazonaws.com""  },  ""Action"": ""sts:AssumeRole""  }  ] } ``` 2. Create another policy document and name it as `iam_policy.json` and paste the following content: ``` {  ""Version"": ""2012-10-17"",  ""Statement"": [  {  ""Effect"": ""Allow"",  ""Action"":[  ""logs:CreateLogGroup"",  ""logs:CreateLogStream"",  ""logs:DescribeLogGroups"",  ""logs:DescribeLogStreams"",  ""logs:PutLogEvents"",  ""logs:GetLogEvents"",  ""logs:FilterLogEvents""  ],  ""Resource"": ""*""  }  ] } ``` 3. Run the below command to create an IAM role: ``` aws iam create-role --role-name <aws_support_iam_role> --assume-role-policy-document file://<file-path>role_policy_document.json  ``` 4. Run the below command to create an IAM policy: ``` aws iam create-policy --policy-name <ami-policy-name> --policy-document file://<file-path>iam-policy.json ``` 5. Run `attach-group-policy` command using the IAM policy ARN returned at the previous step to attach the policy to the IAM role (if the command succeeds, no output is returned): ``` aws iam attach-group-policy --policy-arn arn:aws:iam::<aws-account-id>:policy/<iam-policy-name> --group-name <group-name> ``` 6. Run `describe-vpcs` to get the VpcId available in the selected region: ``` aws ec2 describe-vpcs --region <region> ``` 7. The command output should return the VPC Id available in the selected region. 8. Run `create-flow-logs` to create a flow log for the vpc: ``` aws ec2 create-flow-logs --resource-type VPC --resource-ids <vpc-id> --traffic-type REJECT --log-group-name <log-group-name> --deliver-logs-permission-arn <iam-role-arn> ``` 9. Repeat step 8 for other vpcs available in the selected region. 10. Change the region by updating --region and repeat remediation procedure for other vpcs.";"Perform the following to determine if VPC Flow logs are enabled:  **From Console:**  1. Sign into the management console 2. Select `Services` then `VPC`  3. In the left navigation pane, select `Your VPCs`  4. Select a VPC 5. In the right pane, select the `Flow Logs` tab. 6. Ensure a Log Flow exists that has `Active` in the `Status` column.  **From Command Line:**  1. Run `describe-vpcs` command (OSX/Linux/UNIX) to list the VPC networks available in the current AWS region: ``` aws ec2 describe-vpcs --region <region> --query Vpcs[].VpcId ``` 2. The command output returns the `VpcId` available in the selected region. 3. Run `describe-flow-logs` command (OSX/Linux/UNIX) using the VPC ID to determine if the selected virtual network has the Flow Logs feature enabled: ``` aws ec2 describe-flow-logs --filter ""Name=resource-id,Values=<vpc-id>"" ``` 4. If there are no Flow Logs created for the selected VPC, the command output will return an `empty list []`. 5. Repeat step 3 for other VPCs available in the same region. 6. Change the region by updating `--region` and repeat steps 1 - 5 for all the VPCs.";;;https://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/flow-logs.html;FAIL;VPC vpc-0565167ce4f7cc871 Flow logs are disabled.;arn:aws:ec2:ap-northeast-2:132410971304:vpc/vpc-0565167ce4f7cc871;vpc-0565167ce4f7cc871;vpc_flow_logs_enabled;False;CIS;CIS Amazon Web Services Foundations Benchmark v1.4.0
